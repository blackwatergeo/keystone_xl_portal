//>>built
require({cache:{"jimu/ConfigManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dojo/Deferred ./utils ./WidgetManager ./shared/AppVersionManager ./shared/utils ./ConfigLoader ./tokenUtils esri/config esri/tasks/GeometryService".split(" "),function(n,b,g,e,k,m,a,q,d,l,p,h,s){function r(c){var f=b.clone(c),a=m.widgetProperties;delete f.mode;d.visitElement(f,function(c,d){c.widgets?(delete c.isPreload,delete c.gid,"jimu.js/images/group_icon.png"===c.icon&&delete c.icon,
delete c.openType,d.isOnScreen&&c.panel&&m.isEqual(c.panel,f.widgetOnScreen.panel)&&delete c.panel):(c.icon&&c.icon===c.amdFolder+"images/icon.png"&&delete c.icon,delete c.panel,delete c.folderUrl,delete c.amdFolder,delete c.thumbnail,delete c.configFile,delete c.gid,delete c.isPreload,a.forEach(function(f){delete c[f]}),c.visible&&delete c.visible,delete c.manifest)});delete f.rawAppConfig;delete f._ssl;delete f.getConfigElementById;delete f.processNoUriWidgets;delete f.addElementId;delete f.getCleanConfig;
delete f.visitElement;delete f.agolConfig;delete f._itemData;delete f.oldWabVersion;return f}var t=null,f;f=n(null,{urlParams:null,appConfig:null,configFile:null,_configLoaded:!1,portalSelf:null,constructor:function(c){this.urlParams=c||{};this.listenBuilderEvents();this.isRunInPortal=!1;this.versionManager=new q;this.widgetManager=a.getInstance();this.configLoader=l.getInstance(this.urlParams,{versionManager:this.versionManager});"config"===this.urlParams.mode&&(window.parent.setConfigViewerTopic&&
b.isFunction(window.parent.setConfigViewerTopic))&&window.parent.setConfigViewerTopic(e);"preview"===this.urlParams.mode&&(window.parent.setPreviewViewerTopic&&b.isFunction(window.parent.setPreviewViewerTopic))&&window.parent.setPreviewViewerTopic(e)},listenBuilderEvents:function(){e.subscribe("builder/widgetChanged",b.hitch(this,this._onWidgetChanged));e.subscribe("builder/groupChanged",b.hitch(this,this._onGroupChanged));e.subscribe("builder/widgetPoolChanged",b.hitch(this,this._onWidgetPoolChanged));
e.subscribe("builder/mapChanged",b.hitch(this,this._onMapChanged));e.subscribe("builder/mapOptionsChanged",b.hitch(this,this._onMapOptionsChanged));e.subscribe("builder/appAttributeChanged",b.hitch(this,this._onAppAttributeChanged));e.subscribe("builder/setAppConfig",b.hitch(this,this._onAppConfigSet));e.subscribe("builder/themeChanged",b.hitch(this,this._onThemeChanged));e.subscribe("builder/layoutChanged",b.hitch(this,this._onLayoutChanged));e.subscribe("builder/styleChanged",b.hitch(this,this._onStyleChanged));
e.subscribe("builder/syncExtent",b.hitch(this,this._onSyncExtent))},loadConfig:function(){if(!("preview"===this.urlParams.mode||"config"===this.urlParams.mode))return this.configLoader.loadConfig().then(b.hitch(this,function(c){this.portalSelf=this.configLoader.portalSelf;this.appConfig=this._addDefaultValues(c);console.timeEnd("Load Config");e.publish("appConfigLoaded",this.getConfig());return this.getConfig()}),function(c){console.error(c)})},getConfig:function(){var c=b.clone(this.appConfig);c.getConfigElementById=
function(c){return d.getConfigElementById(this,c)};c.getCleanConfig=function(){return r(this)};c.visitElement=function(c){d.visitElement(this,c)};return c},_onWidgetChanged:function(c){var f=m.reCreateObject(c);c=d.getConfigElementById(this.appConfig,c.id);for(var a in f)c[a]=f[a];this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);e.publish("appConfigChanged",this.getConfig(),"widgetChange",f)},_onGroupChanged:function(c){var f=m.reCreateObject(c);c=d.getConfigElementById(this.appConfig,
c.id);for(var a in f)c[a]=f[a];this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);e.publish("appConfigChanged",this.getConfig(),"groupChange",f)},_onWidgetPoolChanged:function(c){c=m.reCreateObject(c);this.appConfig.widgetPool.widgets=c.widgets;this.appConfig.widgetPool.groups=c.groups;this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);e.publish("appConfigChanged",this.getConfig(),"widgetPoolChange",c)},_onAppAttributeChanged:function(c){c=
m.reCreateObject(c);b.mixin(this.appConfig,c);this.configLoader.processProxy(this.appConfig);this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);e.publish("appConfigChanged",this.getConfig(),"attributeChange",c)},_onMapChanged:function(c){c=m.reCreateObject(c);c.itemId&&c.itemId!==this.appConfig.map.itemId&&this.appConfig.map.mapOptions&&(delete this.appConfig.map.mapOptions.extent,delete this.appConfig.map.mapOptions.lods,delete this.appConfig.map.mapOptions.center,
delete this.appConfig.map.mapOptions.scale,delete this.appConfig.map.mapOptions.zoom);b.mixin(this.appConfig.map,c);this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);e.publish("appConfigChanged",this.getConfig(),"mapChange",c)},_onMapOptionsChanged:function(c){c=m.reCreateObject(c);this.appConfig.map.mapOptions||(this.appConfig.map.mapOptions={});b.mixin(this.appConfig.map.mapOptions,c);e.publish("appConfigChanged",this.getConfig(),"mapOptionsChange",c)},_onThemeChanged:function(c){this._getAppConfigFromTheme(c).then(b.hitch(this,
function(f){this.appConfig=f;e.publish("appConfigChanged",this.getConfig(),"themeChange",c.getName())}))},_onLayoutChanged:function(c){var f=c.layoutConfig,a=f.widgetOnScreen,d=this.appConfig.widgetOnScreen;a&&(a.panel&&a.panel.uri&&(d.panel.uri=a.panel.uri),g.forEach(a.widgets,function(c,f){d.widgets[f]&&c&&(c.position&&(d.widgets[f].position=c.position),c.positionRelativeTo&&(d.widgets[f].positionRelativeTo=c.positionRelativeTo),d.widgets[f].panel={uri:d.panel.uri,position:d.widgets[f].position,
positionRelativeTo:d.widgets[f].positionRelativeTo})},this),g.forEach(a.groups,function(c,f){d.groups[f]&&(c&&c.panel)&&(d.groups[f].panel=c.panel)},this));f.map&&(this.appConfig.map.position=f.map.position);f.widgetPool&&(f.widgetPool.panel&&(this.appConfig.widgetPool.panel=f.widgetPool.panel),g.forEach(f.widgetPool.groups,function(c,f){this.appConfig.widgetPool.groups[f]&&(c&&c.panel)&&(this.appConfig.widgetPool.groups[f].panel=c.panel)},this));e.publish("appConfigChanged",this.getConfig(),"layoutChange",
c.name)},_onStyleChanged:function(c){this.appConfig.theme.styles=this._genStyles(this.appConfig.theme.styles,c.name);e.publish("appConfigChanged",this.getConfig(),"styleChange",c.name)},_onSyncExtent:function(c){e.publish("syncExtent",c)},_genStyles:function(c,f){var a=[];a.push(f);g.forEach(c,function(c){0>a.indexOf(c)&&a.push(c)});return a},_getAppConfigFromTheme:function(c){var f=new k,a,d=[],d=this.getConfig().getCleanConfig();d.mode=this.urlParams.mode;g.forEach(d.widgetPool.groups,function(c){delete c.panel},
this);if(c.appConfig)a=b.clone(c.appConfig),a.map=d.map,a.map.position=c.appConfig.map.position,d.widgetPool.widgets&&(a.widgetPool.widgets=d.widgetPool.widgets),d.widgetPool.groups&&(a.widgetPool.groups=d.widgetPool.groups),d.links&&(a.links=d.links);else{var h=c.getCurrentLayout(),l=c.getCurrentStyle();a=b.clone(d);a.widgetOnScreen=h.layoutConfig.widgetOnScreen;h.layoutConfig.widgetPool&&h.layoutConfig.widgetPool.panel&&(a.widgetPool.panel=h.layoutConfig.widgetPool.panel);h.layoutConfig.map&&h.layoutConfig.map.position&&
(a.map.position=h.layoutConfig.map.position);d=this._genStyles(g.map(c.getStyles(),function(c){return c.name}),l.name);a.theme={name:c.getName(),styles:d,version:c.getVersion()}}this.configLoader.addNeedValues(a);this._addDefaultValues(a);this.configLoader.loadWidgetsManifest(a).then(function(){f.resolve(a)});return f},_onAppConfigSet:function(c){c=m.reCreateObject(c);this.configLoader.processProxy(c);this.configLoader.addNeedValues(c);this._addDefaultValues(c);p.setPortalUrl(c.portalUrl);this.appConfig?
(c.map.itemId&&c.map.itemId!==this.appConfig.map.itemId&&c.map.mapOptions&&delete c.map.mapOptions.extent,this.appConfig=c,e.publish("appConfigChanged",this.getConfig(),"resetConfig",c)):(this.appConfig=c,e.publish("appConfigLoaded",this.getConfig()))},_addDefaultValues:function(c){this._addDefaultPortalUrl(c);this._addDefaultGeometryService(c);this._addDefaultStyle(c);this._addDefaultMap(c);this._addDefaultVisible(c);"undefined"===typeof c.widgetOnScreen&&(c.widgetOnScreen={});"undefined"===typeof c.widgetPool&&
(c.widgetPool={});this._addDefaultPanelAndPosition(c);this._addDefaultOfWidgetGroup(c);(c.widgetPool.widgets&&0<c.widgetPool.widgets.length&&void 0===c.widgetPool.widgets[0].index||c.widgetPool.groups&&0<c.widgetPool.groups.length&&void 0===c.widgetPool.groups[0].index)&&this._addIndexForWidgetPool(c);return c},_addDefaultPortalUrl:function(c){"undefined"===typeof c.portalUrl&&(c.portalUrl="http://www.arcgis.com/");c.portalUrl&&"/"!==c.portalUrl.substr(c.portalUrl.length-1)&&(c.portalUrl+="/")},_addDefaultGeometryService:function(c){var f=
c&&c.geometryService,f=f&&"string"===typeof f&&b.trim(f)?b.trim(f):this.portalSelf.helperServices.geometry.url;c.geometryService=f;h.defaults.geometryService=new s(c.geometryService)},_addDefaultStyle:function(c){if(c.theme&&(!c.theme.styles||0===c.theme.styles.length))c.theme.styles=["default"]},_addDefaultMap:function(c){c.map.id="map";"undefined"===typeof c.map["3D"]&&"undefined"===typeof c.map["2D"]&&(c.map["2D"]=!0);"undefined"===typeof c.map.position&&(c.map.position={left:0,right:0,top:0,bottom:0});
"undefined"===typeof c.map.portalUrl&&(c.map.portalUrl=c.portalUrl)},_addDefaultVisible:function(c){d.visitElement(c,function(c){void 0===c.visible&&(c.visible=!0)})},_addDefaultPanelAndPosition:function(c){var f,a,d=c.widgetOnScreen,h=c.widgetPool;"undefined"===typeof d.panel||"undefined"===typeof d.panel.uri?d.panel={uri:"jimu/PreloadWidgetIconPanel",positionRelativeTo:"map"}:"undefined"===typeof d.panel.positionRelativeTo&&(d.panel.positionRelativeTo="map");"undefined"===typeof h.panel||"undefined"===
typeof h.panel.uri?h.panel={uri:"jimu/PreloadWidgetIconPanel",positionRelativeTo:"map"}:"undefined"===typeof h.panel.positionRelativeTo&&(h.panel.positionRelativeTo="map");if(d.widgets)for(f=0;f<d.widgets.length;f++)d.widgets[f].position||(d.widgets[f].position={left:0,top:0}),d.widgets[f].positionRelativeTo||(d.widgets[f].positionRelativeTo="map"),d.widgets[f].panel||(d.widgets[f].panel=b.clone(d.panel),d.widgets[f].panel.position=d.widgets[f].position,d.widgets[f].panel.positionRelativeTo=d.widgets[f].positionRelativeTo);
if(d.groups)for(f=0;f<d.groups.length;f++){d.groups[f].position||(d.groups[f].position={left:0,top:0});d.groups[f].panel||(d.groups[f].panel=d.panel);for(a=0;a<d.groups[f].widgets.length;a++)d.groups[f].widgets[a].panel=d.groups[f].panel}if(h){if(h.groups)for(f=0;f<h.groups.length;f++){h.groups[f].panel?h.groups[f].panel.positionRelativeTo||(h.groups[f].panel.positionRelativeTo="map"):h.groups[f].panel=h.panel;for(a=0;a<h.groups[f].widgets.length;a++)h.groups[f].widgets[a].panel=h.groups[f].panel}if(h.widgets)for(f=
0;f<h.widgets.length;f++)h.widgets[f].panel||(h.widgets[f].panel=c.widgetPool.panel)}},_addDefaultOfWidgetGroup:function(c){d.visitElement(c,b.hitch(this,function(c,f){c.isPreload=f.isOnScreen;c.widgets?(c.gid=c.id,1===c.widgets.length?(c.label||(c.label=c.widgets[0].label?c.widgets[0].label:"Group"),c.icon||(c.icon=c.widgets[0].uri?this._getDefaultIconFromUri(c.widgets[0].uri):"jimu.js/images/group_icon.png")):(c.icon=c.icon?c.icon:"jimu.js/images/group_icon.png",c.label=c.label?c.label:"Group_"+
f.index)):(c.gid=f.groupId,c.uri&&m.processWidgetSetting(c))}))},_getDefaultIconFromUri:function(c){c=c.split("/");c.pop();return c.join("/")+"/images/icon.png"},_addIndexForWidgetPool:function(c){var f=0,a,d;if(c.widgetPool.widgets)for(a=0;a<c.widgetPool.widgets.length;a++)c.widgetPool.widgets[a].index=f,f++;if(c.widgetPool.groups)for(a=0;a<c.widgetPool.groups.length;a++){c.widgetPool.groups[a].index=f;f++;for(d=0;d<c.widgetPool.groups[a].widgets.length;d++)c.widgetPool.groups[a].widgets[d].index=
d}}});f.getInstance=function(c){null===t?t=new f(c):t.urlParams=c;window.getAppConfig=b.hitch(t,t.getConfig);return t};return f})},"jimu/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/sniff dojo/_base/config dojo/io-query dojo/query dojo/NodeList-traverse dojo/Deferred dojo/on dojo/json dojo/cookie dojo/number dojo/date/locale esri/arcgis/utils esri/SpatialReference esri/geometry/Extent esri/geometry/webMercatorUtils esri/tasks/GeometryService esri/tasks/ProjectParameters jimu/portalUrlUtils esri/urlUtils esri/request ./shared/utils".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c,u,w,A,x,B,C,F){function G(c,f){var a=c.match(/url\([^)]+\)/gi),d,h;if(null===a||""===f)return c;for(d=0;d<a.length;d++)if(h=a[d].match(/(url\(["|']?)(.*)((?:['|"]?)\))/i),4<=h.length){var l=h[2];f.endWith("/")||(f+="/");c=c.replace(h[1]+l+h[3],h[1]+f+l+h[3])}return c}function z(c,f){var a=Array.isArray(f),d=a&&[]||{};a?(c=c||[],d=d.concat(c),f.forEach(function(f,a){"undefined"===typeof c[a]?d[a]=f:"object"===typeof f?d[a]=z(c[a],f):-1===c.indexOf(f)&&d.push(f)})):
(c&&"object"===typeof c&&Object.keys(c).forEach(function(f){d[f]=c[f]}),Object.keys(f).forEach(function(a){d[a]="object"!==typeof f[a]||!f[a]?f[a]:c[a]?z(c[a],f[a]):f[a]}));return d}function y(c){var f,a={};f=c.indexOf("/");c.substring(0,f);c=c.substring(0,c.lastIndexOf("/")+1);a.folderUrl=require(v.getRequireConfig()).toUrl(c);a.amdFolder=c;return a}function J(c){c.panels.forEach(function(c){c.uri="panels/"+c.name+"/Panel.js"});c.styles.forEach(function(c){c.uri="styles/"+c.name+"/style.css"});c.layouts.forEach(function(c){c.uri=
"layouts/"+c.name+"/config.json";c.icon="layouts/"+c.name+"/icon.png";c.RTLIcon="layouts/"+c.name+"/icon_rtl.png"})}var v={},H={geometryService:"http://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer"};n.mixin(v,F);var M=[];require.on("error",function(c){b.forEach(M,function(f){c.info[0]&&-1<c.info[0].indexOf(f.resKey)&&f.def.reject(c);for(var a in c.info)-1<a.indexOf(f.resKey)&&f.def.reject(c)})});v.checkError=function(c,f){M.push({resKey:c,def:f})};v.replacePlaceHolder=function(c,
f){var a=JSON.stringify(c),d=a.match(/\$\{(\w)+\}/g),h;if(null===d)return c;for(h=0;h<d.length;h++){var l=d[h].match(/(\w)+/g)[0];f[l]&&(a=a.replace(d[h],f[l]))}return JSON.parse(a)};v.changeUnit=function(c){var f=Math.abs(c),a;c=Math.floor(f);a=Math.floor(60*(f-c));f=(60*(60*(f-c)-a)).toFixed(2);return c+"\u00b0"+(10>a?"0"+a:a)+"'"+(10>f?"0"+f:f)+'"'};v.formatTime=function(c){var f=c/1E3;c=Math.floor(f/60);f=Number(f-60*c).toFixed(1);return(10>c?"0"+c:c)+":"+(10>f?"0"+f:f)};v.parseTime=function(c){var f=
/(\d{2,})\:(\d{2})\.(\d{1})/;if(!f.test(c))return console.log("wrong time format."),-1;c=c.match(f);return 1E3*(60*parseInt(c[1],10)+parseInt(c[2],10)+parseInt(c[3],10)/10)};v.preloadImg=function(c,f){var a=[],a="string"===typeof c?[c]:c;b.forEach(a,function(c){(new Image).src=f?f+c:c})};v.getPositionStyle=function(c){var f={};if(!c)return f;c=n.clone(c);if(window.isRTL)if("undefined"!==typeof c.left&&"undefined"!==typeof c.right){var a=c.left;c.left=c.right;c.right=a}else"undefined"!==typeof c.left?
(c.right=c.left,delete c.left):"undefined"!==typeof c.right&&(c.left=c.right,delete c.right);for(var a="left top right bottom width height".split(" "),d=0;d<a.length;d++){var h=a[d];f[h]="number"===typeof c[h]?c[h]+"px":"undefined"!==typeof c[h]?c[h]:"auto"}return f};v.isEqual=function(c,f){function a(c,f){var l;if(isNaN(c)&&isNaN(f)&&"number"===typeof c&&"number"===typeof f||c===f)return!0;if("function"===typeof c&&"function"===typeof f||c instanceof Date&&f instanceof Date||c instanceof RegExp&&
f instanceof RegExp||c instanceof String&&f instanceof String||c instanceof Number&&f instanceof Number)return c.toString()===f.toString();if(-1<d.indexOf(c)||-1<h.indexOf(f))return!1;if(null!==f){for(l in f)if(f.hasOwnProperty(l)!==c.hasOwnProperty(l)||typeof f[l]!==typeof c[l])return!1;for(l in c){if(f.hasOwnProperty(l)!==c.hasOwnProperty(l)||typeof f[l]!==typeof c[l])return!1;switch(typeof c[l]){case "object":case "function":d.push(c);h.push(f);if(!a(c[l],f[l]))return!1;d.pop();h.pop();break;default:if(c[l]!==
f[l])return!1}}}return!0}var d,h;d=[];h=[];return!a(c,f)?!1:!0};v.file={supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return e("safari")&&6>e("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var c=null;if(document.all)try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(f){c=null}else navigator.plugins&&0<navigator.plugins.length&&(c=navigator.plugins["Shockwave Flash"]);
return!!c},containSeparator:function(c){return 0<=c.indexOf("/")?!0:0<=c.indexOf("\\")?!0:!1},getNameFromPath:function(c){var f="",f=0<=c.indexOf("/")?"/":"\\";c=c.split(f);return 0<c.length?c[c.length-1]:null},getFolderFromPath:function(c){return c.substr(0,c.length-v.file.getNameFromPath(c).length)},readFile:function(c,f,a,d){if(this.supportHTML5()){var h=c.target.files[0];h&&(h.type.match(f)?h.size>=a?d({errCode:"exceed"}):(c=new FileReader,c.onload=function(c){d(null,h.name,c.target.result)},
c.readAsDataURL(h)):d({errCode:"invalidType"}))}else if(this.supportFileAPI()){var l=window.FileAPI.getFiles(c);l[0].type.match(f)?l[0].size>=a?d({errCode:"exceed"}):window.FileAPI.readAsDataURL(l[0],function(c){c&&c.result?d(null,l[0].name,c.result):d({errCode:"readError"})}):d({errCode:"invalidType"})}}};v.processWidgetSetting=function(c){if(!c.uri)return c;n.mixin(c,y(c.uri));c.icon||(c.icon=c.amdFolder+"images/icon.png");c.thumbnail||(c.thumbnail=c.amdFolder+"images/thumbnail.png");return c};
v.getRequireConfig=function(){if(jimuConfig){var c=[];jimuConfig.widgetsPackage&&(c=c.concat(jimuConfig.widgetsPackage));jimuConfig.themesPackage&&(c=c.concat(jimuConfig.themesPackage));jimuConfig.configsPackage&&(c=c.concat(jimuConfig.configsPackage));return{packages:c}}return{}};v.getTypeByGeometryType=function(c){var f=null,a="esriGeometryLine esriGeometryCircularArc esriGeometryEllipticArc esriGeometryBezier3Curve esriGeometryPath esriGeometryPolyline".split(" "),d=["esriGeometryRing","esriGeometryPolygon",
"esriGeometryEnvelope"];0<=["esriGeometryPoint","esriGeometryMultipoint"].indexOf(c)?f="point":0<=a.indexOf(c)?f="polyline":0<=d.indexOf(c)&&(f="polygon");return f};v.getSymbolTypeByGeometryType=function(c){var f=null;c=v.getTypeByGeometryType(c);"point"===c?f="marker":"polyline"===c?f="line":"polygon"===c&&(f="fill");return f};v.getServices=function(){return H};v.getArcGISDefaultGeometryService=function(){return new w(H.geometryService)};v.restoreToDefaultWebMapExtent=function(a,h,l){var p=new d;
if(!(a&&"esri.Map"===a.declaredClass))return setTimeout(function(){p.reject("Invalid map.")},0),p;h=h&&h.itemInfo;if(!h)return setTimeout(function(){p.reject("Invalid itemInfo")},0),p;h=h.item&&h.item.extent;if(!h)return setTimeout(function(){p.reject("Invalid itemInfo.item.extent")}),p;var r=new f({wkid:4326}),r=new c(h[0][0],h[0][1],h[1][0],h[1][1],r);if(4326===parseInt(a.spatialReference.wkid,10))return a.setExtent(r);if(a.spatialReference.isWebMercator())return r=u.geographicToWebMercator(r),
a.setExtent(r);h=new A;h.geometries=[r];h.outSR=a.spatialReference;r=esriConfig&&esriConfig.defaults&&esriConfig.defaults.geometryService;r&&"esri.tasks.GeometryService"===r.declaredClass||(l&&"string"===typeof l&&n.trim(l)?(l=n.trim(l),r=new w(l)):r=v.getArcGISDefaultGeometryService());r.project(h).then(function(c){if(c=c&&c[0])return a.setExtent(c);p.reject("Invalid projected geometry.");return p},function(c){console.error(c);p.reject(c);return p});return p};v.getAncestorWindow=function(){for(var c=
window;c&&c.parent&&c!==c.parent;)c=c.parent;return c};v.getAncestorDom=function(c,f,a){if(c&&1===c.nodeType&&f&&"function"===typeof f){var d=100,h=document.body;a&&("number"===typeof a?(a=parseInt(a,10),0<a&&(d=a)):1===a.nodeType&&(h=a));for(a=0;c.parentNode&&a<d&&g.isDescendant(c.parentNode,h);){if(f(c.parentNode))return c.parentNode;c=c.parentNode;a++}}return null};v.bindClickAndDblclickEvents=function(c,f,a,d){var h=null;if(c&&1===c.nodeType&&f&&"function"===typeof f&&a&&"function"===typeof a){var p=
200;d&&"number"===typeof d&&(d=parseInt(d,10),0<d&&(p=d));var r=0,h=l(c,"click",function(c){r++;1===r?setTimeout(function(){1===r&&(r=0,f(c))},p):2===r&&(r=0,a(c))})}return h};v.isScrollToBottom=function(c){var f=g.getContentBox(c);return 0===c.scrollHeight-(c.scrollTop+f.h)};v.getAllItemTypes=function(){var c=[],c=c.concat(["Web Map","Web Scene","CityEngine Web Scene"]).concat("Feature Service;Map Service;Image Service;KML;WMS;Feature Collection;Feature Collection Template;Geodata Service;Globe Service".split(";")).concat(["Geometry Service",
"Geocoding Service","Network Analysis Service","Geoprocessing Service"]).concat(["Web Mapping Application","Mobile Application","Code Attachment","Operations Dashboard Add In","Operation View"]).concat("Symbol Set;Color Set;Shapefile;CSV;Service Definition;Document Link;Microsoft Word;Microsoft PowerPoint;Microsoft Excel;PDF;Image;Visio Document".split(";"));return c=c.concat("Map Document;Map Package;Tile Package;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package".split(";")).concat(["Layer",
"Layer Package","Explorer Layer"]).concat(["Geoprocessing Package","Geoprocessing Sample","Locator Package","Rule Package"]).concat("Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In".split(";"))};v.getItemQueryStringByTypes=function(c){var f="",a=v.getAllItemTypes();if(c&&0<c.length&&0<c.length){var d="";b.forEach(c,function(f,a){d+=' type:"'+f+'" ';a!==c.length-1&&(d+=" OR ")});f=" ( "+d+" ) ";a=c.concat(a);a=b.filter(a,function(f){return b.every(c,
function(c){return 0>c.toLowerCase().indexOf(f.toLowerCase())})});b.forEach(a,function(c){f+=' -type:"'+c+'" '})}return f};v.getItemQueryStringByTypeKeywords=function(c){var f="";c&&0<c.length&&(f=' typekeywords:"'+c.join(",")+'" ');return f};v.isNotEmptyString=function(c,f){var a=c&&"string"===typeof c;return a?f?a&&n.trim(c):!0:!1};v.isObject=function(c){return c&&"object"===typeof c};v.createWebMap=function(c,f,a,d){c=x.getStandardPortalUrl(c);c=x.getBaseItemUrl(c);t.arcgisUrl=c;return t.createMap(f,
a,d)};v.getRandomString=function(){var c=Math.random().toString();return c=c.slice(2,c.length)};v._getDomainsByServerName=function(c){var f=c.split("."),a=f.length;return b.map(f,n.hitch(this,function(c,d){var h=f.slice(d,a),l="",p=h.length-1;b.forEach(h,n.hitch(this,function(c,f){l+=c;f!==p&&(l+=".")}));return l}))};v.removeCookie=function(c,f){var a=this._getDomainsByServerName(window.location.hostname);b.forEach(a,n.hitch(this,function(a){h(c,null,{expires:-1,path:f});h(c,null,{expires:-1,path:f,
domain:a});h(c,null,{expires:-1,path:f,domain:"."+a})}))};v.isLocaleChanged=function(c,f){return!c.startWith(f)};v.hashToObject=function(c){c=c.replace("#","");c=m.queryToObject(c);for(var f in c)if(c.hasOwnProperty(f))try{c[f]=p.parse(c[f])}catch(a){}return c};v.reCreateObject=function(c){function f(c){var d=[];c.forEach(function(c){Array.isArray(c)?d.push(f(c)):"object"===typeof c?d.push(a(c)):d.push(c)});return d}function a(c){var d={},h;for(h in c)c.hasOwnProperty(h)&&(null===c[h]?d[h]=null:Array.isArray(c[h])?
d[h]=f(c[h]):d[h]="object"===typeof c[h]?a(c[h]):c[h]);return d}return Array.isArray(c)?f(c):a(c)};v.setVerticalCenter=function(c){setTimeout(function(){var f=a(".jimu-vcenter-text",c),d,h;b.forEach(f,function(c){d=g.getContentBox(c).h;g.setStyle(c,{lineHeight:d+"px"})},this);f=a(".jimu-vcenter",c);b.forEach(f,function(c){d=g.getContentBox(c).h;h=g.getContentBox(a(c).parent()[0]).h;g.setStyle(c,{marginTop:(h-d)/2+"px"})},this)},10)};v.merge=z;v.loadStyleLink=function(c,f,a){var h=new d,p,r=require(v.getRequireConfig()).toUrl(f);
if(require.cache["url:"+r]){p=require.cache["url:"+r];var q=r.split("/").pop(),r=r.substr(0,r.length-q.length);p=G(p,r);c=a?g.create("style",{id:c,type:"text/css"},g.byId(a),"before"):g.create("style",{id:c,type:"text/css"},document.getElementsByTagName("head")[0]);c.styleSheet&&!c.sheet?c.styleSheet.cssText=p:c.appendChild(g.toDom(p));h.resolve("load");return h}p=a?g.create("link",{id:c,rel:"stylesheet",type:"text/css",href:r},g.byId(a),"before"):g.create("link",{id:c,rel:"stylesheet",type:"text/css",
href:r},document.getElementsByTagName("head")[0]);l(p,"load",function(){h.resolve("load")});var t=setInterval(function(){var c;if(b.some(document.styleSheets,function(a){if(a.href&&a.href.substr(a.href.indexOf(f),a.href.length)===f)return c=a,!0}))try{!h.isFulfilled()&&(c.cssRules&&c.cssRules.length||c.rules&&c.rules.length)&&h.resolve("load"),clearInterval(t)}catch(a){}},50);return h};v.changeLocation=function(c){window.history.pushState&&window.history.pushState({path:c},"",c)};v.urlToObject=function(c){var f=
null;-1===c.indexOf("#")?(f=B.urlToObject(c),f.hash=null):(c=c.split("#"),f=B.urlToObject(c[0]),f.hash=c[1]?-1<c[1].indexOf("\x3d")?m.queryToObject(c[1]):c[1]:null);return f};v.setConfigByTemplate=function(c,f,a){f=function(c){var f=[];c.split("_").forEach(function(c){var a=!1,d;"--"===c.slice(c.length-2)&&(a=!0,c=c.slice(0,c.length-2));d=c.search(/\[[0-9]+\]/);-1===d&&(d=c.length);f.push({key:c.slice(0,d),index:Number(c.slice(d+1,-1)),deleteFlag:a})});return f}(f);for(var d=1;d<f.length-1;d++)if(c=
n.isArray(c[f[d].key])?c[f[d].key][f[d].index]:c[f[d].key],!c)return;f[f.length-1].deleteFlag?!0===a&&(n.isArray(c[f[f.length-1].key])?delete c[f[f.length-1].key][f[f.length-1].index]:delete c[f[f.length-1].key]):n.isArray(c[f[f.length-1].key])?c[f[f.length-1].key][f[f.length-1].index]=a:c[f[f.length-1].key]=a};v.setConfigByTemplateWithId=function(c,f,a){function d(a){var h;h=f;var l=-1;a=h.search(RegExp(a));0<=a&&(h=h.slice(a,h.length),h=h.indexOf("]"),l=a+h+1);h=l;l=f.slice(a,h);return-1!==a?(a=
f.slice(a+l.indexOf("[")+1,h-1),h=f.slice(h+1),(a=c.getConfigElementById(a))?{object:a,key:"section_"+h,state:"isSection"}:{state:"deleted"}):{state:"isNotSection"}}var h=c,l=f;if(!(0<=f.search("widgets\\[.+\\]_config"))){var p=d("groups\\[.+\\]");"deleted"!==p.state&&("isSection"===p.state&&(h=p.object,l=p.key),p=d("widgets\\[.+\\]"),"delete"!==p.state&&("isSection"===p.state&&(h=p.object,l=p.key),v.setConfigByTemplate(h,l,a)))}};v.addManifestProperies=function(c){c.icon=c.url+"images/icon.png";
"theme"===c.category?J(c):("undefined"!==typeof c["2D"]&&(c.support2D=c["2D"]),"undefined"!==typeof c["3D"]&&(c.support3D=c["3D"]),"undefined"===typeof c["2D"]&&"undefined"===typeof c["3D"]&&(c.support2D=!0),delete c["2D"],delete c["3D"],"undefined"===typeof c.properties&&(c.properties={}),F.processWidgetProperties(c))};v.getUniqueValues=function(c,f){var a=new d,h=c.replace(/\/*$/g,"")+"/generateRenderer",l=p.stringify({type:"uniqueValueDef",uniqueValueFields:[f]});C({url:h,content:{classificationDef:l,
f:"json"},handleAs:"json",callbackParamName:"callback"}).then(n.hitch(this,function(c){var f=[];(c=c&&c.uniqueValueInfos)&&0<c.length&&(f=b.map(c,n.hitch(this,function(c){return c.value})));a.resolve(f)}),n.hitch(this,function(c){a.reject(c)}));return a};v.combineRadioCheckBoxWithLabel=function(c,f){var a=!1;if(c&&1===c.nodeType&&"input"===c.tagName.toLowerCase()){var d=c.getAttribute("type")||"",d=d.toLowerCase();if("radio"===d||"checkbox"===d)a=!0}d=!1;f&&(1===f.nodeType&&"label"===f.tagName.toLowerCase())&&
(d=!0);a&&d&&(a=c.getAttribute("id"),a||(a="input_"+v.getRandomString(),c.setAttribute("id",a)),f.setAttribute("for",a),g.setStyle(f,"cursor","pointer"))};v.processManifestLabel=function(c,f){c.label=c.i18nLabels&&(c.i18nLabels[f]||c.i18nLabels.defaultLabel)||c.label||c.name;c.layouts&&b.forEach(c.layouts,function(a){var d="i18nLabels_layout_"+a.name;a.label=c[d]&&(c[d][f]||c[d].defaultLabel)||a.label||a.name});c.styles&&b.forEach(c.styles,function(a){var d="i18nLabels_style_"+a.name;a.label=c[d]&&
(c[d][f]||c[d].defaultLabel)||a.label||a.name})};v.addManifest2WidgetJson=function(c,f){n.mixin(c,f.properties);c.name=f.name;c.label||(c.label=f.label);c.manifest=f};v.addI18NLabel=function(c){var f=new d;if(c.i18nLabels)return f.resolve(c),f;c.i18nLabels={};if(c.properties&&!1===c.properties.hasLocale)return f.resolve(c),f;var a="widget"===c.category?"_widgetLabel":"_themeLabel";require(v.getRequireConfig(),["dojo/i18n!"+c.amdFolder+"/nls/strings"],function(d){c.i18nLabels[dojoConfig.locale]=d[a];
"theme"===c.category&&(c.layouts&&c.layouts.forEach(function(f){c["i18nLabels_layout_"+f.name]={};c["i18nLabels_layout_"+f.name][dojoConfig.locale]=d["_layout_"+f.name]}),c.styles&&c.styles.forEach(function(f){c["i18nLabels_style_"+f.name]={};c["i18nLabels_style_"+f.name][dojoConfig.locale]=d["_style_"+f.name]}));f.resolve(c)});return f};v.localizeNumber=function(c,f){var a=(c.toString().split(".")[1]||"").length,d="",d=0<a?"#,###,###,##0.0"+Array.prototype.join.call({length:a},"0"):"#,###,###,##0",
a={locale:k.locale,pattern:d};n.mixin(a,f||{});return s.format(c,a)};v.parseNumber=function(c,f){var a={locale:k.locale};n.mixin(a,f||{});return s.parse(c,a)};v.localizeDate=function(c,f){var a={locale:k.locale,fullYear:!0};n.mixin(a,f||{});return r.format(c,a)};v.addRelativePathInCss=G;v.url={isAbsolute:function(c){return!c?!1:c.startWith("http")||c.startWith("/")},removeQueryParamFromUrl:function(c,f){var a=B.urlToObject(c);a.query&&delete a.query[f];var d=a.path,h;for(h in a.query)d=d===a.path?
d+"?"+h+"\x3d"+a.query[h]:d+"\x26"+h+"\x3d"+a.query[h];return d},addQueryParamToUrl:function(c,f,a){c=B.urlToObject(c);c.query||(c.query={});c.query[f]=a;f=c.path;for(var d in c.query)f=f===c.path?f+"?"+d+"\x3d"+c.query[d]:f+"\x26"+d+"\x3d"+c.query[d];return f}};v.processUrlInWidgetConfig=function(c,f){if(c)return c.startWith("data:")||c.startWith("http")||c.startWith("/")?c:c.startWith("${appPath}")?c.replace("${appPath}",window.appInfo.appPath):f+c};v.processUrlInAppConfig=function(c){if(c)return c.startWith("data:")||
c.startWith("http")||c.startWith("/")?c:window.appInfo.appPath+c};v.getLocationUrlWithoutHashAndQueryParams=function(){var c=window.location,f=c.protocol+"//"+c.host+c.pathname,c=B.urlToObject(c.href);c.query&&c.query.apiurl&&(f=v.url.addQueryParamToUrl(f,"apiurl",c.query.apiurl));return f};v.getDefaultWebMapThumbnail=function(){return require.toUrl("jimu/images/webmap.png")};return v})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(n,b,g){var e=n.NodeList;
b.extend(e,{_buildArrayFromCallback:function(b){for(var e=[],a=0;a<this.length;a++){var q=b.call(this[a],this[a],e);q&&(e=e.concat(q))}return e},_getUniqueAsNodeList:function(b){for(var e=[],a=0,q;q=b[a];a++)1==q.nodeType&&-1==g.indexOf(e,q)&&e.push(q);return this._wrap(e,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(b,e){var a=this._getUniqueAsNodeList(b),a=e?n._filterResult(a,e):a;return a._stash(this)},_getRelatedUniqueNodes:function(b,e){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(e),
b)},children:function(k){return this._getRelatedUniqueNodes(k,function(k,a){return b._toArray(k.childNodes)})},closest:function(b,e){return this._getRelatedUniqueNodes(null,function(a,q){do if(n._filterResult([a],b,e).length)return a;while(a!=e&&(a=a.parentNode)&&1==a.nodeType);return null})},parent:function(b){return this._getRelatedUniqueNodes(b,function(b,a){return b.parentNode})},parents:function(b){return this._getRelatedUniqueNodes(b,function(b,a){for(var q=[];b.parentNode;)b=b.parentNode,q.push(b);
return q})},siblings:function(b){return this._getRelatedUniqueNodes(b,function(b,a){for(var q=[],d=b.parentNode&&b.parentNode.childNodes,l=0;l<d.length;l++)d[l]!=b&&q.push(d[l]);return q})},next:function(b){return this._getRelatedUniqueNodes(b,function(b,a){for(var q=b.nextSibling;q&&1!=q.nodeType;)q=q.nextSibling;return q})},nextAll:function(b){return this._getRelatedUniqueNodes(b,function(b,a){for(var q=[],d=b;d=d.nextSibling;)1==d.nodeType&&q.push(d);return q})},prev:function(b){return this._getRelatedUniqueNodes(b,
function(b,a){for(var q=b.previousSibling;q&&1!=q.nodeType;)q=q.previousSibling;return q})},prevAll:function(b){return this._getRelatedUniqueNodes(b,function(b,a){for(var q=[],d=b;d=d.previousSibling;)1==d.nodeType&&q.push(d);return q})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(b,e){return 0!=e%2})},odd:function(){return this.filter(function(b,
e){return 0==e%2})}});return e})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),function(n,b,g,e,k,m,a,q){return n(null,{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var d=g.map(this.geometries,function(a){return a.toJson()}),l={};l.outSR=this.outSR.wkid||e.toJson(this.outSR.toJson());
l.inSR=this.geometries[0].spatialReference.wkid||e.toJson(this.geometries[0].spatialReference.toJson());l.geometries=e.toJson({geometryType:q.getJsonType(this.geometries[0]),geometries:d});this.transformation&&(l.transformation=this.transformation.wkid||e.toJson(this.transformation));a.isDefined(this.transformForward)&&(l.transformForward=this.transformForward);return l}})})},"jimu/portalUrlUtils":function(){define(["dojo/_base/lang","jimu/shared/basePortalUrlUtils"],function(n,b){var g=n.clone(b);
g.declaredClass="jimu.portalUrlUtils";g.getPortalUrlFromLocation=function(){return g.getPortalServerFromLocation()+g.getDeployContextFromLocation()};g.getPortalSignInUrlFromLocation=function(){return g.getPortalUrlFromLocation()+"home/signin.html"};g.getPortalServerFromLocation=function(){return window.location.protocol+"//"+window.location.host};g.getDeployContextFromLocation=function(){var b=window.location.href.split("?")[0],k=b.indexOf("/home");0>k&&(k=b.indexOf("/apps"));b=b.substring(b.indexOf(window.location.host)+
window.location.host.length+1,k);"/"!==b&&(b="/"+b+"/");return b};g.getRestBaseUrlFromLocation=function(){return window.location.protocol+"//"+window.location.host+g.getDeployContextFromLocation()+"sharing/rest/"};return g})},"jimu/shared/basePortalUrlUtils":function(){define(function(){var n={declaredClass:"jimu.shared.basePortalUrlUtils"};"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s*/gi,"").replace(/\s*$/gi,"")});"function"!==typeof String.prototype.startWith&&
(String.prototype.startWith=function(b){return this.substr(0,b.length)===b});"function"!==typeof String.prototype.endWith&&(String.prototype.endWith=function(b){return this.substr(this.length-b.length,b.length)===b});n.getServerByUrl=function(b){b=(b||"").trim();b=b.replace(/^(http(s?):?)\/\//gi,"");0===b.indexOf("//")&&(b=b.slice(2));return b.split("/")[0]};n.getServerWithProtocol=function(b){var g="";if(b=(b||"").trim()){var e=n.getServerByUrl(b);if(!e)return g;var k=n.getProtocol(b);k?g=k+"://"+
e:0===b.indexOf("//")&&(g="//"+e)}return g};n.isSameServer=function(b,g){b=n.getServerByUrl(b)||"";g=n.getServerByUrl(g)||"";return b.toLowerCase()===g.toLowerCase()};n.isOnline=function(b){return 0<=n.getServerByUrl(b).toLowerCase().indexOf(".arcgis.com")};n.isArcGIScom=function(b){b=n.getServerByUrl(b).toLowerCase();return"www.arcgis.com"===b||"arcgis.com"===b};n.getStandardPortalUrl=function(b){var g=n.getServerByUrl(b);if(""===g)return"";n.isOnline(g)?(n.isArcGIScom(g)&&(g="www.arcgis.com"),b=
n.addProtocol(b),b=n.getProtocol(b)+"://"+g):(b=(b||"").trim().replace(/sharing(.*)/gi,"").replace(/\/*$/g,""),b=n.addProtocol(b),b.replace(RegExp("http(s?)://"+g,"g"),"")||(b+="/arcgis"));return b};n.isSamePortalUrl=function(b,g){var e=/^http(s?):\/\//gi,k=/^\/\//gi;b=n.getStandardPortalUrl(b).toLowerCase().replace(e,"").replace(k,"");g=n.getStandardPortalUrl(g).toLowerCase().replace(e,"").replace(k,"");return b===g};n.addProtocol=function(b){if(-1>=b.toLowerCase().indexOf("http://")&&-1>=b.toLowerCase().indexOf("https://")){var g=
"";"undefined"!==typeof window&&window.location?(g=window.location.protocol,b=b.startWith("//")?g+b:b.startWith("/")?g+"//"+window.location.host+b:g+"//"+b):(g="http:",b.startWith("//")&&(b=g+b))}return b};n.getProtocol=function(b){var g="";b=b.toLowerCase();0===b.indexOf("https://")?g="https":0===b.indexOf("http://")&&(g="http");return g};n.removeProtocol=function(b){return b.replace(/^http(s?):\/\//i,"//")};n.setHttpProtocol=function(b){b=n.addProtocol(b);return b.replace(/^https:\/\//,"http://")};
n.setHttpsProtocol=function(b){b=n.addProtocol(b);return b.replace(/^http:\/\//,"https://")};n.setProtocol=function(b,g){return 0<=g.indexOf("https")?n.setHttpsProtocol(b):0<=g.indexOf("http")?n.setHttpProtocol(b):b};n.getSharingUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/sharing");return g};n.getOAuth2Url=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/sharing/oauth2");return g};n.getAppIdUrl=function(b,g){var e="",k=n.getStandardPortalUrl(b);k&&(e=k+"/sharing/oauth2/apps/"+
g);return e};n.getSignInUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/home/signin.html");return g};n.getBaseSearchUrl=function(b){var g="";b=n.getStandardPortalUrl(b);(b=b.replace(/\/*$/g,""))&&(g=b+"/sharing/rest/search");return g};n.getBaseItemUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/sharing/rest/content/items");return g};n.getItemUrl=function(b,g){var e="",k=n.getBaseItemUrl(b);k&&g&&(e=k+"/"+g);return e};n.getItemDataUrl=function(b,g){var e="",k=n.getItemUrl(b,
g);k&&(e=k+"/data");return e};n.getGenerateTokenUrl=function(b){var g="";b&&(b=n.getStandardPortalUrl(b),g=b+"/sharing/generateToken");return g};n.getItemDetailsPageUrl=function(b,g){var e="";b&&g&&(b=n.getStandardPortalUrl(b),e=b+"/home/item.html?id\x3d"+g);return e};n.getUserProfilePageUrl=function(b,g){var e="";b&&g&&(b=n.getStandardPortalUrl(b),e=b+"/home/user.html?user\x3d"+g);return e};n.getBaseGroupUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/sharing/rest/community/groups");
return g};n.getPortalSelfInfoUrl=function(b){var g="";(b=n.getStandardPortalUrl(b||""))&&(g=b+"/sharing/portals/self");return g};n.getCommunitySelfUrl=function(b){var g="";(b=n.getStandardPortalUrl(b||""))&&(g=b+"/sharing/rest/community/self");return g};n.getBaseUserUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/sharing/rest/community/users");return g};n.getUserUrl=function(b,g){var e="",k=n.getBaseUserUrl(b);b&&g&&(e=k+"/"+g);return e};n.getUserTagsUrl=function(b,g){var e="",k=n.getUserUrl(b,
g);b&&g&&(e=k+"/tags");return e};n.getContentUrl=function(b){var g="";b&&(b=n.getStandardPortalUrl(b),g=b+"/sharing/rest/content");return g};n.getUserContentUrl=function(b,g,e){var k="",k="";b&&g&&(k=n.getContentUrl(b),k=e?k+"/users/"+g+"/"+e:k+"/users/"+g);return k};n.getAddItemUrl=function(b,g,e){var k="",k="";b&&g&&(k=n.getUserContentUrl(b,g,e),k+="/addItem");return k};n.getDeleteItemUrl=function(b,g,e){var k="";(b=n.getUserItemsUrl(b,g))&&(k=b+"/"+e+"/delete");return k};n.getUserItemsUrl=function(b,
g,e){var k="",k="";b&&g&&(k=n.getUserContentUrl(b,g,e),k+="/items");return k};n.getUpdateItemUrl=function(b,g,e,k){var m="",m="";b&&g&&(m=n.getUserItemsUrl(b,g,k),m=m+"/"+e+"/update");return m};n.shareItemUrl=function(b,g,e,k){var m="",m="";b&&g&&(m=n.getUserItemsUrl(b,g,k),m=m+"/"+e+"/share");return m};n.getHomeIndexUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/home/index.html");return g};n.getHomeMapViewerUrl=function(b,g){var e="",k=n.getStandardPortalUrl(b);k&&(e=k+"/home/webmap/viewer.html",
e=g?e+("?webmap\x3d"+g):e+"?useExisting\x3d1");return e};n.getHomeGalleryUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/home/gallery.html");return g};n.getHomeGroupsUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/home/groups.html");return g};n.getHomeMyContentUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/home/content.html");return g};n.getHomeMyOrganizationUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/home/organization.html");return g};
n.getHomeUserUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/home/user.html");return g};n.getPortalHelpUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/portalhelp/en/website/help/");return g};n.getPortalProxyUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/sharing/proxy");return g};n.getOAuth2SignOutUrl=function(b){var g="";(b=n.getStandardPortalUrl(b))&&(g=b+"/sharing/oauth2/signout");return g};n.getNewPrintUrl=function(b){var g="";if(b=n.getStandardPortalUrl(b))b=
n.setHttpProtocol(b),g=b+"/sharing/tools/newPrint";return g};return n})},"jimu/shared/utils":function(){define(["./basePortalUrlUtils"],function(n){function b(b,e){function a(a,d){var l,p,h,s,r="widgetOnScreen"===a;if(b[a]){if(b[a].groups)for(l=0;l<b[a].groups.length;l++){h=b[a].groups[l];d(h,{index:l,isWidget:!1,groupId:h.id,isThemeWidget:!1,isOnScreen:r});for(p=0;p<b[a].groups[l].widgets.length;p++)s=b[a].groups[l].widgets[p],d(s,{index:p,isWidget:!0,groupId:h.id,isThemeWidget:s.uri&&-1<s.uri.indexOf("themes/"+
b.theme.name),isOnScreen:r})}if(b[a].widgets)for(l=0;l<b[a].widgets.length;l++)s=b[a].widgets[l],d(b[a].widgets[l],{index:l,isWidget:!0,groupId:a,isThemeWidget:s.uri&&-1<s.uri.indexOf("themes/"+b.theme.name),isOnScreen:r})}}a("widgetOnScreen",e);a("widgetPool",e)}var g={},e="inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwithched isController hasVersionManager isThemeWidget".split(" ");g.visitElement=b;g.getConfigElementById=
function(k,e){var a;if("map"===e)return k.map;b(k,function(b){if(b.id===e)return a=b,!0});return a};g.getWidgetNameFromUri=function(b){b=b.split("/");b.pop();return b.pop()};g.getAmdFolderFromUri=function(b){b=b.split("/");b.pop();return b.join("/")+"/"};g.widgetProperties=e;g.processWidgetProperties=function(b){"undefined"===typeof b.properties.isController&&(b.properties.isController=!1);"undefined"===typeof b.properties.isThemeWidget&&(b.properties.isThemeWidget=!1);"undefined"===typeof b.properties.hasVersionManager&&
(b.properties.hasVersionManager=!1);e.forEach(function(e){"undefined"===typeof b.properties[e]&&(b.properties[e]=!0)})};g.isHostedService=function(b){var e=n.getServerByUrl(b)+"/[^/]+/[^/]+/rest/services";return RegExp(e,"gi").test(b)};return g})},"jimu/WidgetManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/topic dojo/Evented dojo/aspect dojo/json dojo/request/xhr dojo/promise/all ./utils jimu/tokenUtils ./dijit/Message".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r){var t=null,f=n(a,{constructor:function(){this.loaded=[];this.missedActions=[];window.isBuilder?(m.subscribe("app/mapLoaded",b.hitch(this,this._onMapLoaded)),m.subscribe("app/mapChanged",b.hitch(this,this._onMapChanged))):(m.subscribe("mapLoaded",b.hitch(this,this._onMapLoaded)),m.subscribe("mapChanged",b.hitch(this,this._onMapChanged)));window.isBuilder?(m.subscribe("app/appConfigLoaded",b.hitch(this,this._onAppConfigLoaded)),m.subscribe("app/appConfigChanged",
b.hitch(this,this._onAppConfigChanged))):(m.subscribe("appConfigLoaded",b.hitch(this,this._onAppConfigLoaded)),m.subscribe("appConfigChanged",b.hitch(this,this._onAppConfigChanged)));m.subscribe("userSignIn",b.hitch(this,this._onUserSignIn));m.subscribe("userSignOut",b.hitch(this,this._onUserSignOut));m.subscribe("actionTriggered",b.hitch(this,this._onActionTriggered))},loadWidget:function(c){var f=new k,a;c=b.clone(c);c.folderUrl||h.processWidgetSetting(c);(a=this.getWidgetById(c.id))?f.resolve(a):
p([this.loadWidgetClass(c),this.loadWidgetManifest(c)]).then(b.hitch(this,function(c){var a=c[0],d=c[1];this.loadWidgetResources(d).then(b.hitch(this,function(c){try{var h=this.createWidget(d,a,c);console.log("widget ["+d.uri+"] created.")}catch(l){console.log("create ["+d.uri+"] error:"+l.stack),new r({message:"create widget error: "+d.uri}),f.reject(l)}setTimeout(b.hitch(this,function(){f.resolve(h);this.emit("widget-created",h)}),50)}),function(c){f.reject(c)})}),function(c){f.reject(c)});return f},
loadWidgetClass:function(c){var f=new k;require(h.getRequireConfig(),[c.uri],b.hitch(this,function(c){f.resolve(c)}));h.checkError(c.uri,f);return f},loadWidgetResources:function(c){var f=new k,a,d,h,l=[];h=b.clone(c);c=this.tryLoadWidgetConfig(h);a=this._tryLoadResource(h,"i18n");d=this._tryLoadResource(h,"style");h=this._tryLoadResource(h,"template");l.push(c);l.push(a);l.push(h);l.push(d);p(l).then(b.hitch(this,function(c){var a={};a.config=c[0];a.i18n=c[1];a.template=c[2];a.style=c[3];f.resolve(a)}),
function(c){f.reject(c)});return f},loadWidgetManifest:function(c){var f=new k,a=c.folderUrl+"manifest.json";if(c.manifest)return f.resolve(c),f;l(a,{handleAs:"json"}).then(b.hitch(this,function(a){a.amdFolder=c.amdFolder;a.category="widget";c.label?(this._processManifest(a),h.addManifest2WidgetJson(c,a),f.resolve(c)):h.addI18NLabel(a).then(b.hitch(this,function(){this._processManifest(a);h.addManifest2WidgetJson(c,a);f.resolve(c)}))}),function(c){f.reject(c)});return f},_processManifest:function(c){h.addManifestProperies(c);
h.processManifestLabel(c,window.dojoConfig.locale)},createWidget:function(c,f,a){if(this.getWidgetById(c.id))return this.getWidgetById(c.id);a.config&&a.i18n&&(a.config=h.replacePlaceHolder(a.config,a.i18n));c.rawConfig=c.config;c.config=a.config||{};this.appConfig.agolConfig&&this._mergeAgolConfig(c);c.nls=a.i18n||{};a.template&&(c.templateString=a.template);c["class"]="jimu-widget";c.label||(c.label=c.name);this.map&&(c.map=this.map);c.appConfig=this.appConfig;a={};for(var d in c)c.hasOwnProperty(d)&&
(a[d]=c[d]);a.widgetManager=this;c=new f(a);c.clazz=f;q.after(c,"startup",b.hitch(this,this._postWidgetStartup,c));q.before(c,"destroy",b.hitch(this,this._onDestroyWidget,c));this.loaded.push(c);return c},getAllWidgets:function(){return this.loaded},destroyAllWidgets:function(){var c=g.map(this.loaded,function(c){return c.id});g.forEach(c,function(c){this.destroyWidget(c)},this);this.loaded=[]},loadWidgetSettingPage:function(c){var f=new k;c=b.clone(c);c.id+="_setting";p([this.loadWidgetSettingClass(c)]).then(b.hitch(this,
function(a){var d=a[0];this.loadWidgetSettingPageResources(c).then(b.hitch(this,function(a){var h;a={nls:a.i18n,templateString:a.template,appConfig:this.appConfig,map:this.map,"class":"jimu-widget-setting"};for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l]);try{h=new d(a),q.before(h,"destroy",b.hitch(this,this._onDestroyWidgetSetting,h)),f.resolve(h)}catch(p){new r({message:"Create widget setting page error:"+c.uri}),f.reject(p)}}),function(c){console.log(c)})}),function(c){f.reject(c)});return f},loadWidgetSettingClass:function(c){var f=
new k;require(h.getRequireConfig(),[c.folderUrl+"setting/Setting.js"],b.hitch(this,function(c){f.resolve(c)}));h.checkError(c.folderUrl+"setting/Setting.js",f);return f},loadWidgetSettingPageResources:function(c){var f=new k,a,d,h=[];c=b.clone(c);a=this._tryLoadResource(c,"settingI18n");d=this._tryLoadResource(c,"settingTemplate");c=this._tryLoadResource(c,"settingStyle");h.push(a);h.push(d);h.push(c);p(h).then(b.hitch(this,function(c){var a={};a.i18n=c[0]||{};a.template=c[1];a.style=c[2];f.resolve(a)}),
function(c){console.log(c)});return f},getWidgetById:function(c){var f;g.some(this.loaded,function(a){if(a.id===c)return f=a,!0},this);return f},getWidgetsByName:function(c){var f=[];g.some(this.loaded,function(a){a.name===c&&f.push(a)},this);return f},changeWindowStateTo:function(c,f){"normal"===f?this.normalizeWidget(c):"minimized"===f?this.minimizeWidget(c):"maximized"===f?this.maximizeWidget(c):console.log("error state: "+f)},closeWidget:function(c){if("string"===typeof c&&(c=this.getWidgetById(c),
!c))return;if("closed"!==c.state){c.setState("closed");try{c.onClose()}catch(f){console.log(console.error("fail to close widget "+c.name+". "+f.stack))}}},openWidget:function(c){if("string"===typeof c&&(c=this.getWidgetById(c),!c))return;if("closed"===c.state){c.setState("opened");try{c.onOpen()}catch(f){console.log(console.error("fail to open widget "+c.name+". "+f.stack))}}},maximizeWidget:function(c){if("string"===typeof c&&(c=this.getWidgetById(c),!c))return;"closed"===c.state&&this.openWidget(c);
c.setWindowState("maximized");try{c.onMaximize()}catch(f){console.log(console.error("fail to maximize widget "+c.name+". "+f.stack))}},minimizeWidget:function(c){if("string"===typeof c&&(c=this.getWidgetById(c),!c))return;"closed"===c.state&&this.openWidget(c);c.setWindowState("minimized");try{c.onMinimize()}catch(f){console.log(console.error("fail to minimize widget "+c.name+". "+f.stack))}},normalizeWidget:function(c){if("string"===typeof c&&(c=this.getWidgetById(c),!c))return;"closed"===c.state&&
this.openWidget(c);c.setWindowState("normal");try{c.onNormalize()}catch(f){console.log(console.error("fail to normalize widget "+c.name+". "+f.stack))}},destroyWidget:function(c){if("string"===typeof c&&(c=this.getWidgetById(c),!c))return;this._removeWidget(c);try{c.destroy()}catch(f){console.log(console.error("fail to destroy widget "+c.name+". "+f.stack))}},tryLoadWidgetConfig:function(c){return this._tryLoadWidgetConfig(c).then(b.hitch(this,function(f){return this._upgradeWidgetConfig(c,f)}))},
_tryLoadWidgetConfig:function(c){var f=new k;if(c.config&&b.isObject(c.config))return f.resolve(c.config),f;if(c.config){if(require.cache["url:"+c.config])return f.resolve(d.parse(require.cache["url:"+c.config])),f;c=h.processUrlInAppConfig(c.config);c=c.split("/");c[c.length-1]=encodeURIComponent(c[c.length-1]);c=c.join("/");return l(c,{handleAs:"json"})}return this._tryLoadResource(c,"config")},_upgradeWidgetConfig:function(c,f){var a=new k,d=c.manifest.version,l=c.version,p;if(d===l)return a.resolve(f),
a;if(!1===c.hasVersionManager)return c.version=d,a.resolve(f),a;require(h.getRequireConfig(),[c.amdFolder+"VersionManager"],b.hitch(this,function(h){h=new h;var b=h.getVersionIndex(l),r=h.getVersionIndex(d);if(b>r)a.reject("Bad widget version number, "+c.name+","+l);else try{p=h.upgrade(f,l,d),c.version=d,a.resolve(p)}catch(t){console.log("Read widget ["+c.name+"] old config error,"+t.stack),a.resolve(f)}}));return a},loadWidgetStyle:function(c){var f="widget/style/"+c.uri,a=new k,f=this._replaceId(f);
return e.byId(f)?(a.resolve("load"),a):h.loadStyleLink(f,c.styleFile,"theme_"+this.appConfig.theme.name+"_style_common")},loadWidgetSettingStyle:function(c){var f="widget/style/"+c.uri+"/setting",a=new k,f=this._replaceId(f);return e.byId(f)?(a.resolve("load"),a):h.loadStyleLink(f,c.settingStyleFile)},loadWidgetConfig:function(c){c=require(h.getRequireConfig()).toUrl(c.configFile);if(require.cache["url:"+c]){var f=new k;f.resolve(d.parse(require.cache["url:"+c]));return f}return l(c,{handleAs:"json"})},
loadWidgetI18n:function(c){var f=new k;require(h.getRequireConfig(),["dojo/i18n!"+c.i18nFile],function(c){f.resolve(c)});return f},loadWidgetSettingI18n:function(c){var f=new k;require(h.getRequireConfig(),["dojo/i18n!"+c.settingI18nFile],function(c){f.resolve(c)});return f},loadWidgetTemplate:function(c){var f=new k;require(h.getRequireConfig(),["dojo/text!"+c.templateFile],function(c){f.resolve(c)});h.checkError(c.templateFile,f);return f},loadWidgetSettingTemplate:function(c){var f=new k;require(h.getRequireConfig(),
["dojo/text!"+c.settingTemplateFile],function(c){f.resolve(c)});h.checkError(c.settingTemplateFile,f);return f},removeWidgetStyle:function(c){e.destroy(this._replaceId("widget/style/"+c.uri))},removeWidgetSettingStyle:function(c){e.destroy(this._replaceId("widget/style/"+c.uri+"/setting"))},getControllerWidgets:function(){return g.filter(this.loaded,function(c){return c.isController})},getPreloadPanelessWidgets:function(){return g.filter(this.loaded,function(c){return c.isPreload&&!c.inPanel})},_mergeAgolConfig:function(c){var f=
this.appConfig.agolConfig.values,a="widgets["+c.id+"]",d;for(d in f){var l=d.indexOf(a+"_config");0<=l&&h.setConfigByTemplate(c,d.substr(l,d.length).replace(a,"widget"),f[d])}},_onUserSignIn:function(c){g.forEach(this.loaded,function(f){f.onSignIn(c)},this)},_onUserSignOut:function(){g.forEach(this.loaded,function(c){c.onSignOut()},this)},_onAppConfigLoaded:function(c){this.appConfig=c=b.clone(c);s.setPortalUrl(c.portalUrl)},_onMapLoaded:function(c){this.map=c},_onMapChanged:function(c){this.map=
c},_onAppConfigChanged:function(c,f,a,d){var h=b.clone(c);this.appConfig=h;g.forEach(this.loaded,function(c){c&&(c.onAppConfigChanged(h,f,a,d),"widgetChange"===f&&this._onConfigChanged(a.id,a.config,d),c.appConfig=h)},this)},_onConfigChanged:function(c,f){var a=this.getWidgetById(c);a&&(a.onConfigChanged(f),b.mixin(a.config,f))},_onActionTriggered:function(c){if(!("map"===c.elementId||"app"===c.elementId)){var f=this.getWidgetById(c.elementId);if(f)f.onAction(c.action,c.data);else this.missedActions.push({id:c.elementId,
action:{name:c.action,data:c.data}});g.forEach(this.getControllerWidgets(),function(f){if(f.widgetIsControlled(c.elementId))f.onAction(c.action,{widgetId:c.elementId,data:c.data})},this)}},_postWidgetStartup:function(c){c.started=!0;h.setVerticalCenter(c.domNode);q.after(c,"resize",b.hitch(this,h.setVerticalCenter,c.domNode));this.openWidget(c);var f=s.getPortalCredential(this.appConfig.portalUrl);if(f)c.onSignIn(f);else c.onSignOut();this._triggerMissedAction(c)},_triggerMissedAction:function(c){this.missedActions.forEach(function(f){if(f.id===
c.id)c.onAction(f.action.name,f.action.data)})},_remove:function(c){return g.some(this.loaded,function(f,a){if(f.id===c)return this.loaded.splice(a,1),!0},this)},_tryLoadResource:function(c,f){var a,d=new k;if("config"===f)a=c.amdFolder+"config.json",c.configFile=a,a="hasConfig";else if("style"===f)a=c.amdFolder+"css/style.css",c.styleFile=a,a="hasStyle";else if("i18n"===f)a=c.amdFolder+"nls/strings.js",c.i18nFile=c.amdFolder+"nls/strings",a="hasLocale";else if("template"===f)a=c.amdFolder+"Widget.html",
c.templateFile=a,a="hasUIFile";else if("settingTemplate"===f)a=c.amdFolder+"setting/Setting.html",c.settingTemplateFile=a,a="hasSettingUIFile";else if("settingI18n"===f)a=c.amdFolder+"setting/nls/strings.js",c.settingI18nFile=c.amdFolder+"setting/nls/strings",a="hasSettingLocale";else if("settingStyle"===f)a=c.amdFolder+"setting/css/style.css",c.settingStyleFile=a,a="hasSettingStyle";else return d;c[a]?function(){var a;if("config"===f)a=this.loadWidgetConfig(c);else if("style"===f)a=this.loadWidgetStyle(c);
else if("i18n"===f)a=this.loadWidgetI18n(c);else if("template"===f)a=this.loadWidgetTemplate(c);else if("settingTemplate"===f)a=this.loadWidgetSettingTemplate(c);else if("settingStyle"===f)a=this.loadWidgetSettingStyle(c);else if("settingI18n"===f)a=this.loadWidgetSettingI18n(c);else return d;a.then(function(c){d.resolve(c)},function(f){new r({message:"load widget resouce error: "+c.uri});d.reject(f)})}.apply(this):d.resolve(null);return d},_replaceId:function(c){return c.replace(/\//g,"_").replace(/\./g,
"_")},_onDestroyWidget:function(c){"closed"!==c.state&&this.closeWidget(c);this._removeWidget(c);console.log("destroy widget ["+c.uri+"].")},_onDestroyWidgetSetting:function(c){this.removeWidgetSettingStyle(c)},_removeWidget:function(c){if("string"===typeof c&&(c=this.getWidgetById(c),!c))return;this.removeWidgetStyle(c);this._remove(c.id)}});f.getInstance=function(c){null===t&&(t=new f(c));return t};return f})},"jimu/tokenUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/Deferred dojo/cookie dojo/json dojo/topic dojo/request/script esri/kernel esri/request esri/IdentityManager esri/arcgis/OAuthInfo jimu/portalUrlUtils jimu/utils".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r){"function"!==typeof k.getAll&&(k.getAll=function(a){var f=[];(a=k(a))&&f.push(a);return f});p={portalUrl:null,cookiePath:"/",_started:!1,webTierPortalUrls:[],isInBuilderWindow:function(){return!!window.isBuilder},isInConfigOrPreviewWindow:function(){var a=!1;try{a=!window.isBuilder&&window.parent&&window.parent!==window&&window.parent.isBuilder}catch(f){console.log(f),a=!1}return!!a},isRunInPortal:function(){return window.isRunInPortal},isStringStartWith:function(a,
f){return a.substr(0,f.length)===f},getCookiePath:function(){return this.cookiePath},setPortalUrl:function(a){(a=s.getStandardPortalUrl(a))&&(a+="/");this.portalUrl=a},getPortalUrl:function(){return this.portalUrl},isWebTierPortal:function(a){var f=new e,c=s.getStandardPortalUrl(a);a=c+"/sharing";var h=s.setHttpsProtocol(c+"/sharing/generateToken?f\x3djson"),l=s.setHttpsProtocol(a);q.get(h,{jsonp:"callback"}).then(n.hitch(this,function(a){a.token?(this.webTierPortalUrls.push(c),this.removeWabAuthCookie(),
d.id.getCredential(l).then(n.hitch(this,function(c){c.token||(c.token=a.token);f.resolve(!0)}),n.hitch(this,function(){f.resolve(!0)}))):f.resolve(!1)}),n.hitch(this,function(c){console.error(c);f.reject(c)}));return f},tryRegisterCredential:function(a){return!this.isValidCredential(a)?!1:!b.some(d.id.credentials,n.hitch(this,function(f){return a.token===f.token}))?(d.id.credentials.push(a),!0):!1},_isInvalidPortalUrl:function(a){return a&&"string"===typeof a&&n.trim(a)},signInPortal:function(a){var f=
new e;if(this._isInvalidPortalUrl(a)){a=s.getStandardPortalUrl(a);var c=s.getSharingUrl(a),h=this.getPortalCredential(a);h?setTimeout(n.hitch(this,function(){f.resolve(h)}),0):f=d.id.getCredential(c)}else setTimeout(n.hitch(this,function(){f.reject("Invalid portalurl.")}),0);return f},_loadPortalSelfInfo:function(a){a=s.getPortalSelfInfoUrl(a);return l({url:a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"})},registerOAuthInfo:function(a,f){if(!a||!("string"===typeof a&&f&&"string"===
typeof f))return null;var c=d.id.findOAuthInfo(a);c||(c=window.location.protocol+"//"+window.location.host+require.toUrl("jimu")+"/oauth-callback.html",c=new h({appId:f,expiration:20160,portalUrl:a,authNamespace:"/",popup:!0,popupCallbackUrl:c}),d.id.registerOAuthInfos([c]));c.appId=f;return c},signOutAll:function(){var a=s.getStandardPortalUrl(this.portalUrl),f=!!d.id.findCredential(a+"/sharing/rest");this.isRunInPortal()?this.removeEsriAuthCookieStorage():this.removeWabAuthCookie();d.id.destroyCredentials();
d.id._oAuthHash=null;f&&this._publishCurrentPortalUserSignOut(a)},userHaveSignInPortal:function(a){return!!this.getPortalCredential(n.trim(a||""))},isValidCredential:function(a){var f=!1;if(a){var f=a.token,c=a.server,d=a.scope,f=f&&"string"===typeof f&&n.trim(f),c=c&&"string"===typeof c&&n.trim(c),d="portal"===d||"server"===d,h=!0;a.expires&&(a=parseInt(a.expires,10),h=(new Date).getTime(),h=a>h);f=f&&c&&d&&h}return f},isValidPortalCredentialOfPortalUrl:function(a,f){var c=!1;if(this.isValidCredential(f))var c=
"portal"===f.scope,d=s.isSameServer(a,f.server),c=c&&d;return c},getPortalCredential:function(a){var f=null;a=n.trim(a||"");if(!a)return null;a=s.getStandardPortalUrl(a);return f=this._filterPortalCredential(a,d.id.credentials)},saveAndRegisterCookieToCredential:function(a){a=n.clone(a);a.referer=window.location.host;a.scope="portal";a.isAdmin=!!a.isAdmin;this.saveWabCookie(a);var f=a.server+"/sharing/rest";a.server=f;d.id.registerToken(a);return d.id.findCredential(f,a.userId)},registerAuth2Hash:function(a){a=
n.clone(a);var f=1E3*parseInt(a.expires_in,10),f=(new Date).getTime()+f,c=s.getStandardPortalUrl(a.state.portalUrl);return this.saveAndRegisterCookieToCredential({referer:window.location.host,server:c,token:a.access_token,expires:f,userId:a.username,scope:"portal",isAdmin:!!a.isAdmin})},saveWabCookie:function(a){this.removeCookie("wab_auth");k("wab_auth",JSON.stringify(a),{expires:new Date(a.expires),path:"/"})},removeWabAuthCookie:function(){this.removeCookie("wab_auth")},removeEsriAuthCookieStorage:function(){this.removeCookie("esri_auth");
window.localStorage&&window.localStorage.removeItem("esriJSAPIOAuth");window.sessionStorage&&window.sessionStorage.removeItem("esriJSAPIOAuth")},_filterPortalCredential:function(a,f){var c=null;if(f&&0<f.length){var d=b.filter(f,n.hitch(this,function(c){return this.isValidPortalCredentialOfPortalUrl(a,c)}));0<d.length&&(c=d[d.length-1])}return c},_removePortalCredential:function(a){var f=n.trim(a||"");if(f){f=s.getStandardPortalUrl(f);for(a=b.filter(d.id.credentials,n.hitch(this,function(c){return this.isValidPortalCredentialOfPortalUrl(f,
c)}));0<a.length;)a[0].destroy(),a.splice(0,1);d.id.credentials=b.filter(d.id.credentials,n.hitch(this,function(c){return!this.isValidPortalCredentialOfPortalUrl(f,c)}))}},getUserIdByToken:function(a,f){var c=new e;if(a&&"string"===typeof a&&f&&"string"===typeof f){var h=s.getStandardPortalUrl(f),p=b.filter(d.id.credentials,n.hitch(this,function(c){var f=c.token===a&&c.userId;c=s.isSameServer(h,c.server);return f&&c}));if(0<p.length){var r=p[0];setTimeout(n.hitch(this,function(){c.resolve(r.userId)}),
0);return c}p=s.getCommunitySelfUrl(h);l({url:p,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(n.hitch(this,function(f){c.resolve(f&&f.username||"")}),n.hitch(this,function(f){console.error(f);c.reject("fail to get userId by token")}))}else setTimeout(n.hitch(this,function(){c.reject("invalid parameters")}),0);return c},xtGetCredentialFromCookie:function(a){var f=k("wab_auth"),c=null;if(f)try{c=m.parse(f)}catch(h){console.error(h)}if(!(c&&"object"===typeof c)||!s.isSameServer(a,
c.server)||window.location.host!==c.referer)return null;c.expires=parseInt(c.expires,10);f=(new Date).getTime();if(!(c.expires>f))return this.removeCookie("wab_auth"),null;a+="/sharing/rest";c.server=a;(f=d.id.findCredential(a))||d.id.registerToken(c);return f=d.id.findCredential(a)},removeCookie:function(a){var f=this.getCookiePath();r.removeCookie(a,f)},_getDomainsByServerName:function(a){var f=a.split("."),c=f.length;return b.map(f,n.hitch(this,function(a,d){var h=f.slice(d,c),l="",p=h.length-
1;b.forEach(h,n.hitch(this,function(c,f){l+=c;f!==p&&(l+=".")}));return l}))},_publishCurrentPortalUserSignIn:function(d){if(this.isValidCredential(d))try{a.publish("userSignIn",d)}catch(f){console.error(f)}},_publishAnyUserSignIn:function(d){if(this.isValidCredential(d))try{a.publish("anyUserSignIn",d)}catch(f){console.error(f)}},_publishCurrentPortalUserSignOut:function(d){try{a.publish("userSignOut",d)}catch(f){console.error(f)}},_signInSuccess:function(a){try{this.isValidPortalCredentialOfPortalUrl(this.portalUrl,
a)&&this._publishCurrentPortalUserSignIn(a),this._publishAnyUserSignIn(a)}catch(f){console.error(f)}},_bindEvents:function(){g.after(d.id,"signIn",n.hitch(this,function(a,f){console.log(f[1]);g.after(a,"callback",n.hitch(this,function(c,f){this._signInSuccess(f[0],!1)}));return a}))},isStart:function(){return this._started},startup:function(){if(!this._started){if(this.isInConfigOrPreviewWindow()){var a=window.parent;if(a){var f=a.esri&&a.esri.id;f&&(d.id=f,f=window.esriConfig.defaults.io,a=a.esriConfig.defaults.io,
f.corsEnabledServers=a.corsEnabledServers,f.webTierAuthServers=a.webTierAuthServers,f._processedCorsServers=a._processedCorsServers,f.corsStatus=a.corsStatus)}}this._bindEvents();this._started=!0}}};p.startup();return p})},"jimu/dijit/Message":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/keys dojo/on jimu/dijit/Popup".split(" "),function(n,b,g,e,k,m){return n(m,{baseClass:"jimu-popup jimu-message",declaredClass:"jimu.dijit.Message",type:"message",message:"",autoHeight:!0,
maxWidth:350,maxHeight:180,postMixInProperties:function(){this.content=this.message},_createTitleNode:function(){this.titleLabel&&(this.titleNode=g.create("div",{"class":"title"},this.domNode),this.titleLabeNode=g.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode),this.closeBtnNode=g.create("div",{"class":"close-btn jimu-float-trailing"},this.titleNode),this.own(k(this.closeBtnNode,"click",b.hitch(this,this.close))))},_preProcessing:function(){0===
this.buttons.length&&this.buttons.push({label:"OK",key:e.ENTER,onClick:b.hitch(this,this.close)})},_increaseZIndex:function(){g.setStyle(this.domNode,"zIndex",9999);g.setStyle(this.overlayNode,"zIndex",9998)}})})},"jimu/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/on dojo/sniff dojo/query dojo/dnd/move dijit/_WidgetBase".split(" "),function(n,b,g,e,k,m,a,q,d,l){var p=0;return n(l,{declaredClass:"jimu.dijit.Popup",baseClass:"jimu-popup",
titleLabel:"",content:null,container:null,buttons:[],enabledButtons:[],disabledButtons:[],onClose:null,_fixedHeight:!1,autoHeight:!1,maxHeight:800,maxWidth:1024,constructor:function(){this.buttons=[];this.enabledButtons=[];this.disabledButtons=[];this.pauseKeyHandles=[];this.container=jimuConfig.layoutId},postCreate:function(){this._preProcessing();this.inherited(arguments);this.domNode.tabIndex=1;this._initDomNode();this._positioning();e.place(this.domNode,this.container);this._moveToMiddle();this.own(m(window,
"resize",b.hitch(this,function(){this._fixedHeight||this.autoHeight?(this._calculatePosition(),this._moveToMiddle()):this._positioning()})));this.overlayNode=e.create("div",{"class":"popup-overlay"},this.container);this._increaseZIndex();k.animateProperty({node:this.domNode,properties:{opacity:1},duration:200}).play();this.domNode.focus()},_preProcessing:function(){"number"===typeof this.height&&(this._fixedHeight=!0,this.autoHeight=!1);this.autoHeight&&(this.maxHeight=598)},_createTitleNode:function(){this.titleNode=
e.create("div",{"class":"title"},this.domNode);this.titleLabeNode=e.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode);this.closeBtnNode=e.create("div",{"class":"close-btn jimu-float-trailing"},this.titleNode);this.own(m(this.closeBtnNode,"click",b.hitch(this,this.close)))},_initDomNode:function(){this._createTitleNode();this.contentContainerNode=e.create("div",{"class":"content"},this.domNode);this.content&&("string"===typeof this.content?
this.contentContainerNode.innerHTML=this.content:this.content.domNode?(this.content.placeAt(this.contentContainerNode),this.content.popup=this):1===this.content.nodeType&&e.place(this.content,this.contentContainerNode));this.buttonContainer=e.create("div",{"class":"button-container"},this.domNode);0===this.buttons.length&&e.setStyle(this.buttonContainer,"display","none");for(var a=this.buttons.length-1;-1<a;a--)this._createButton(this.buttons[a]),this.buttons[a].disable&&this.disableButton(a)},_limitButtonsMaxWidth:function(){var d=
this.enabledButtons.length;if(0!==d){var l=e.getContentBox(this.buttonContainer),p=e.getMarginExtents(this.enabledButtons[0]),q=e.getPadBorderExtents(this.enabledButtons[0]),f=0,q=8===a("ie")?q.l+q.r:0,f=(l.w-(p.l+p.r+q)*d)/d;0<f&&(g.forEach(this.enabledButtons,b.hitch(this,function(c){e.setStyle(c,"maxWidth",f+"px")})),g.forEach(this.disabledButtons,b.hitch(this,function(c){e.setStyle(c,"maxWidth",f+"px")})))}},_moveableNode:function(a,l){this.moveable&&(this.moveable.destroy(),this.moveable=null);
var p=e.getMarginBox(this.container);p.l=p.l-a+l;p.w+=2*(a-l);this.moveable=new d.boxConstrainedMoveable(this.domNode,{box:p,handle:this.titleNode,within:!0});this.own(m(this.moveable,"Moving",b.hitch(this,this.onMoving)));this.own(m(this.moveable,"MoveStop",b.hitch(this,this.onMoveStop)))},_getHeaderBox:function(){return 0===q("#header").length?{t:0,l:0,w:0,h:0}:e.getMarginBox("header")},_getFooterBox:function(){return 0===q(".footer",this.container).length?{t:0,l:0,w:0,h:0}:e.getMarginBox(q(".footer",
this.container)[0])},_calculatePosition:function(){var a=e.getContentBox(this.container),d=this._getHeaderBox(),l=this._getFooterBox(),l=a.h-d.h-l.h-40,p=0;p=this._fixedHeight?this.height:this.autoHeight?l-200:this.height=l>this.maxHeight?this.maxHeight:l;l=(l-p)/2+d.h+20;l=l<d.h?d.h:l;this.width=this.width||this.maxWidth;e.setStyle(this.domNode,{left:(a.w-this.width)/2+"px",top:l+"px",width:this.width+"px"})},_calculateHeight:function(){this.autoHeight?(e.setStyle(this.domNode,"height","auto"),e.addClass(this.contentContainerNode,
"content-static"),0===this.buttons.length&&e.setStyle(this.contentContainerNode,{marginBottom:"15px"})):(e.setStyle(this.domNode,"height",this.height+"px"),e.addClass(this.contentContainerNode,"content-absolute"),e.addClass(this.buttonContainer,"button-container-absolute"),0===this.buttons.length&&e.setStyle(this.contentContainerNode,{bottom:"15px"}));this._moveableNode(this.width,100)},_moveToMiddle:function(){if(this.autoHeight){var a=e.getMarginBox(this.domNode),d=e.getContentBox(this.container),
l=this._getHeaderBox(),p=this._getFooterBox(),p=d.h-l.h-p.h-40,f=0,f=a.h||p-200,a=(p-f)/2+l.h+20,a=a<l.h?l.h:a;e.setStyle(this.domNode,{left:(d.w-this.width)/2+"px",top:a+"px",width:this.width+"px"})}},_positioning:function(){this._calculatePosition();this._calculateHeight()},_increaseZIndex:function(){e.setStyle(this.domNode,"zIndex",p+501);e.setStyle(this.overlayNode,"zIndex",p+500);p++},onMoving:function(a){e.setStyle(a.node,"opacity",0.9)},onMoveStop:function(a){e.setStyle(a.node,"opacity",1)},
close:function(){if(!(this.onClose&&!1===this.onClose())){var a=this.domNode.parentNode,d=b.clone(this.domNode);e.setStyle(this.domNode,"display","none");e.destroy(this.overlayNode);this.destroy();this.moveable.destroy();e.place(d,a);k.animateProperty({node:d,properties:{opacity:0},duration:200,onEnd:function(){e.destroy(d)}}).play()}},addButton:function(a){this._createButton(a)},_createButton:function(a){var d=e.create("div",{"class":"jimu-popup-btn jimu-float-trailing jimu-leading-margin1",innerHTML:a.label},
this.buttonContainer);this.enabledButtons.unshift(d);var l=e.create("div",{"class":"jimu-popup-btn jimu-state-disabled jimu-float-trailing jimu-leading-margin1",innerHTML:a.label,style:{display:"none"}},this.buttonContainer);this.disabledButtons.unshift(l);l="click";"ontouchend"in d&&(l="touchend");this.own(m(d,l,b.hitch(this,function(d){if(a.onClick)a.onClick(d);else this.close()})))},enableButton:function(a){"number"===typeof a?(e.setStyle(this.enabledButtons[a],"display","inline-block"),e.setStyle(this.disabledButtons[a],
"display","none")):(g.forEach(this.enabledButtons[a],b.hitch(this,function(a){e.setStyle(a,"display","inline-block")})),g.forEach(this.disabledButtons[a],b.hitch(this,function(a){e.setStyle(a,"display","none")})))},disableButton:function(a){"number"===typeof a?(e.setStyle(this.disabledButtons[a],"display","inline-block"),e.setStyle(this.enabledButtons[a],"display","none")):(g.forEach(this.disabledButtons,b.hitch(this,function(a){e.setStyle(a,"display","inline-block")})),g.forEach(this.enabledButtons,
b.hitch(this,function(a){e.setStyle(a,"display","none")})))}})})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),function(n,b,g,e,k,m){e=n("dojo.dnd.move.constrainedMoveable",m,{constraints:function(){},within:!1,constructor:function(a,b){b||(b={});this.constraints=b.constraints;this.within=b.within},onFirstMove:function(a){var q=this.constraintBox=this.constraints.call(this,a);q.r=q.l+q.w;q.b=q.t+q.h;this.within&&(a=b.getMarginSize(a.node),
q.r-=a.w,q.b-=a.h)},onMove:function(a,b){var d=this.constraintBox,l=a.node.style;this.onMoving(a,b);b.l=b.l<d.l?d.l:d.r<b.l?d.r:b.l;b.t=b.t<d.t?d.t:d.b<b.t?d.b:b.t;l.left=b.l+"px";l.top=b.t+"px";this.onMoved(a,b)}});k=n("dojo.dnd.move.boxConstrainedMoveable",e,{box:{},constructor:function(a,b){var d=b&&b.box;this.constraints=function(){return d}}});n=n("dojo.dnd.move.parentConstrainedMoveable",e,{area:"content",constructor:function(a,q){var d=q&&q.area;this.constraints=function(){var a=this.node.parentNode,
p=g.getComputedStyle(a),h=b.getMarginBox(a,p);if("margin"==d)return h;var q=b.getMarginExtents(a,p);h.l+=q.l;h.t+=q.t;h.w-=q.w;h.h-=q.h;if("border"==d)return h;q=b.getBorderExtents(a,p);h.l+=q.l;h.t+=q.t;h.w-=q.w;h.h-=q.h;if("padding"==d)return h;q=b.getPadExtents(a,p);h.l+=q.l;h.t+=q.t;h.w-=q.w;h.h-=q.h;return h}}});return{constrainedMoveable:e,boxConstrainedMoveable:k,parentConstrainedMoveable:n}})},"jimu/shared/AppVersionManager":function(){define(["./BaseVersionManager"],function(n){function b(){this.versions=
[{version:"1.0",description:"The version embedded in portal 10.3 final.",upgrader:function(b){return b},compatible:!0},{version:"1.1",description:"The version embedded in online3.6, and used in developer edition 1.0.",upgrader:function(b){b.widgetOnScreen&&(b.widgetOnScreen.panel&&"themes/FoldableTheme/panels/TitlePanel/Panel"===b.widgetOnScreen.panel.uri)&&(b.widgetOnScreen.panel.uri="jimu/PreloadWidgetIconPanel");return b},compatible:!0},{version:"1.2",description:"The version embedded in online3.7.",
upgrader:function(b){var e=0;if(b.widgetOnScreen&&b.widgetOnScreen.widgets){for(var k=!1,e=0;e<b.widgetOnScreen.widgets.length;e++)"widgets/Splash/Widget"===b.widgetOnScreen.widgets[e].uri&&(k=!0);k||b.widgetOnScreen.widgets.push({uri:"widgets/Splash/Widget",visible:!1,positionRelativeTo:"browser",version:"1.2"});k=!1;for(e=0;e<b.widgetOnScreen.widgets.length;e++)"widgets/TimeSlider/Widget"===b.widgetOnScreen.widgets[e].uri&&(k=!0);k||b.widgetOnScreen.widgets.push({uri:"widgets/TimeSlider/Widget",
visible:!1,position:{bottom:55,left:7},version:"1.2"});k=!1;for(e=0;e<b.widgetOnScreen.widgets.length;e++)"widgets/Swipe/Widget"===b.widgetOnScreen.widgets[e].uri&&(k=!0);k||b.widgetOnScreen.widgets.push({uri:"widgets/Swipe/Widget",visible:!1,position:{top:145,left:7},version:"1.2"})}return b},compatible:!0}];this.isCompatible=function(b,e){for(var k=this.getVersionIndex(b),m=this.getVersionIndex(e),k=k+1;k<=m;k++)if(!1===this.versions[k].compatible)return!1;return!0}}b.prototype=new n;return b.prototype.constructor=
b})},"jimu/shared/BaseVersionManager":function(){define(function(){return function(){this.versions=[];this.upgrade=function(n,b,g){b=this.getVersionIndex(b);g=this.getVersionIndex(g);if(b>=g)throw Error("New version should higher than old version.");for(b+=1;b<=g;b++)this.versions[b].upgrader&&(n=this.versions[b].upgrader(n));return n};this.getVersionIndex=function(n){n=this.fixVersion(n);var b,g;for(g=0;g<this.versions.length;g++)this.versions[g].version===n&&(b=g);null===n&&(b=-1);void 0===b&&(b=
-1);return b};this.fixVersion=function(n){return!n?null:n}}})},"jimu/ConfigLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/cookie dojo/Deferred dojo/promise/all dojo/request/xhr ./utils ./WidgetManager ./shared/utils ./tokenUtils ./portalUtils ./portalUrlUtils esri/IdentityManager esri/config esri/urlUtils esri/geometry/Point esri/SpatialReference esri/request".split(" "),function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c,u,w){var A=null,x;x=n(null,{urlParams:null,
appConfig:null,rawAppConfig:null,configFile:null,_configLoaded:!1,portalSelf:null,constructor:function(c,a){this._removeHash(c);this.urlParams=c||{};this.isRunInPortal=!1;this.widgetManager=l.getInstance();b.mixin(this,a)},loadConfig:function(){console.time("Load Config");return this._tryLoadConfig().then(b.hitch(this,function(c){var a=this.checkConfig(c);if(a)throw a;this.rawAppConfig=b.clone(c);c=this._upgradeAppConfig(c);this._processAfterTryLoad(c);this.appConfig=c;if(this.urlParams.id)return this.loadWidgetsManifest(c).then(b.hitch(this,
function(){return this._upgradeAllWidgetsConfig(c)})).then(b.hitch(this,function(){this._configLoaded=!0;c.title&&(document.title=c.title);return this.getConfig()}));h.setPortalUrl(c.portalUrl);return this._proesssWebTierAndSignin(c).then(b.hitch(this,function(){return this.urlParams.appid?this.isRunInPortal?this._getAppConfigFromTemplateAppId(c.portalUrl,this.urlParams.appid).then(b.hitch(this,function(c){return this._processInPortalAppProtocol(c)})):this._processNotInPortalAppProtocol(c).then(b.hitch(this,
function(c){return this._getAppDataFromTemplateAppId(c.portalUrl,this.urlParams.appid).then(b.hitch(this,function(a){c._itemData=a;return c}))})):this._processNotInPortalAppProtocol(c)})).then(b.hitch(this,function(c){this._processAfterTryLoad(c);this.appConfig=c;return c.map.itemId?c:s.getDefaultWebMap(c.portalUrl).then(function(a){c.map.itemId=a;return c})})).then(b.hitch(this,function(c){return this.loadWidgetsManifest(c)})).then(b.hitch(this,function(c){return c._itemData?(c.getConfigElementById=
function(a){return p.getConfigElementById(c,a)},this._mergeTemplateAppConfigToAppConfig(c._itemData,c)):c})).then(b.hitch(this,function(){return this._upgradeAllWidgetsConfig(c)})).then(b.hitch(this,function(){this._configLoaded=!0;c.title&&(document.title=c.title);return this.getConfig()}))}))},getConfig:function(){this.appConfig.rawAppConfig=this.rawAppConfig;return this.appConfig},checkConfig:function(c){return(c=this._getRepeatedId(c))?"repeated id:"+c:null},processProxy:function(a){f.defaults.io.alwaysUseProxy=
a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.alwaysUseProxy;f.defaults.io.proxyUrl="";f.defaults.io.proxyRules=[];a.httpProxy&&(a.httpProxy.useProxy&&a.httpProxy.url)&&(f.defaults.io.proxyUrl=a.httpProxy.url);a.httpProxy&&(a.httpProxy.useProxy&&a.httpProxy.rules)&&g.forEach(a.httpProxy.rules,function(a){c.addProxyRule(a)})},addNeedValues:function(c){this._processNoUriWidgets(c);this._addElementId(c);this._processWidgetJsons(c)},showError:function(c){document.body.innerHTML='\x3cdiv class\x3d"jimu-error-code"\x3e\x3cspan\x3e'+
this.nls.errorCode+":\x3c/span\x3e\x3cspan\x3e"+c.response.status+'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-error-message"\x3e\x3cspan\x3e'+this.nls.errorMessage+":\x3c/span\x3e\x3cspan\x3e"+c.message+'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-error-detail"\x3e\x3cspan\x3e'+this.nls.errorDetail+":\x3c/span\x3e\x3cspan\x3e"+c.response.text+"\x3cspan\x3e\x3c/div\x3e"},_tryLoadConfig:function(){if(this.urlParams.config)return this.configFile=this.urlParams.config,q(this.configFile,{handleAs:"json"});
if(this.urlParams.id){this.isRunInPortal=!0;var c=r.getPortalUrlFromLocation(),a=new m;h.setPortalUrl(c);s.getPortal(c).loadSelfInfo().then(b.hitch(this,function(f){this.portalSelf=f;f.allSSL&&"http:"===window.location.protocol?(window.location.href=r.setHttpsProtocol(window.location.href),a.reject()):this._processSignIn(c).then(b.hitch(this,function(){this._getAppConfigFromAppId(c,this.urlParams.id).then(b.hitch(this,function(c){return this._processInPortalAppProtocol(c)})).then(function(c){a.resolve(c)},
function(c){a.reject(c)})}))}));return a}this.configFile="config.json";return q(this.configFile,{handleAs:"json"})},_upgradeAppConfig:function(c){var a=window.wabVersion,f=c.wabVersion;if(a===f)return c;var d=this.versionManager.getVersionIndex(f),h=this.versionManager.getVersionIndex(a);if(d>h)throw Error("Bad version number, "+f);c=this.versionManager.upgrade(c,f,a);c.wabVersion=a;c.isUpgraded=!0;return c},_upgradeAllWidgetsConfig:function(c){var f=new m,d=[];if(!c.isUpgraded)return f.resolve(c),
f;delete c.isUpgraded;p.visitElement(c,b.hitch(this,function(c){if(c.uri)if(c.config){var a=this.widgetManager.tryLoadWidgetConfig(c).then(b.hitch(this,function(a){c.config=a}));d.push(a)}else c.version=c.manifest.version}));a(d).then(b.hitch(this,function(){f.resolve(c)}),function(c){f.reject(c)});return f},_processAfterTryLoad:function(c){this._setPortalUrl(c);this._processUrlParams(c);this.addNeedValues(c);this.processProxy(c);t.tokenValidity=10080;return c},_processWidgetJsons:function(c){p.visitElement(c,
function(c,a){a.isWidget&&c.uri&&d.processWidgetSetting(c)})},_processNoUriWidgets:function(c){var a=0;p.visitElement(c,function(c,f){f.isWidget&&!c.uri&&(a++,c.placeholderIndex=a)})},_addElementId:function(c){var a=0,f;p.visitElement(c,function(c){if(c.id){var d=c.id.lastIndexOf("_");-1<d&&(f=c.id.substr(d+1),a=Math.max(a,f))}});p.visitElement(c,function(c){c.id||(a++,c.id=c.uri?c.uri+"_"+a:"_"+a)})},_setPortalUrl:function(c){c.portalUrl||(k("wab_portalurl")?c.portalUrl=k("wab_portalurl"):(this.isRunInPortal=
!0,c.portalUrl=r.getPortalUrlFromLocation()))},_changePortalUrlProtocol:function(c,a){c.portalUrl=r.setProtocol(c.portalUrl,a);c.map.portalUrl&&(c.map.portalUrl=r.setProtocol(c.map.portalUrl,a));c.httpProxy&&(c.httpProxy.url=r.setProtocol(c.httpProxy.url,a),c.httpProxy&&c.httpProxy.rules&&g.forEach(c.httpProxy.rules,b.hitch(this,function(c){c.proxyUrl=r.setProtocol(c.proxyUrl,a)})))},_processInPortalAppProtocol:function(c){var a=new m,f=s.getPortal(c.portalUrl),d=b.hitch(this,function(f){if("https:"===
window.location.protocol)this._changePortalUrlProtocol(c,"https");else{if(f){window.location.href=r.setHttpsProtocol(window.location.href);a.reject();return}this._changePortalUrlProtocol(c,"http")}this._checkLocale();a.resolve(c)});f.loadSelfInfo().then(b.hitch(this,function(a){"private"===a.access?(a=0===c.portalUrl.toLowerCase().indexOf("https://"),d(a)):d(a.allSSL)}),b.hitch(this,function(c){a.reject(c)}));return a},_processNotInPortalAppProtocol:function(c){var a=new m;c.portalUrl?s.getPortal(c.portalUrl).loadSelfInfo().then(b.hitch(this,
function(f){var d="https:"===window.location.protocol;(f.allSSL||d)&&this._changePortalUrlProtocol(c,"https");0===c.portalUrl.toLowerCase().indexOf("https://")&&!d&&!h.isInConfigOrPreviewWindow()?(window.location.href=r.setHttpsProtocol(window.location.href),a.reject()):a.resolve(c)}),b.hitch(this,function(c){a.reject(c)})):a.resolve(c);return a},_proesssWebTierAndSignin:function(c){var a=new m,f=!1,d=c.portalUrl;this._processWebTier(c).then(b.hitch(this,function(c){f=c;return s.getPortal(d).loadSelfInfo()})).then(b.hitch(this,
function(c){this.portalSelf=c;return this._processSignIn(d,f)})).then(b.hitch(this,function(){a.resolve()}),function(c){a.reject(c)});return a},_processWebTier:function(c){var a=new m,f=c.portalUrl;c.isWebTier?h.isWebTierPortal(f).then(b.hitch(this,function(c){h.getPortalCredential(f).ssl&&"http:"===window.location.protocol&&!h.isInConfigOrPreviewWindow()?window.location.href=r.setHttpsProtocol(window.location.href):a.resolve(c)}),b.hitch(this,function(c){a.reject(c)})):a.resolve(!1);return a},_processSignIn:function(c,
a){var f=new m,d=s.getPortal(c),l=r.getSharingUrl(c);this.isRunInPortal?(l=t.checkSignInStatus(l),l.promise.always(b.hitch(this,function(){f.resolve()}))):(!h.isInBuilderWindow()&&(!h.isInConfigOrPreviewWindow()&&this.portalSelf.supportsOAuth&&this.rawAppConfig.appId&&!a)&&h.registerOAuthInfo(c,this.rawAppConfig.appId),l=t.checkSignInStatus(l),l.promise.always(b.hitch(this,function(){h.xtGetCredentialFromCookie(c);d.loadSelfInfo().then(b.hitch(this,function(c){this.portalSelf=c;this._checkLocale();
f.resolve()}))})));return f},_checkLocale:function(){if(!h.isInConfigOrPreviewWindow()){var c=this.portalSelf.user&&this.portalSelf.user.culture||e.locale,c=c.toLowerCase();d.isLocaleChanged(e.locale,c)&&(k("wab_app_locale",c),window.location.reload())}},_getAppConfigFromTemplateAppId:function(c,a){var f=new m;this._getWabAppIdAndDataFromTemplateAppId(c,a).then(b.hitch(this,function(a){var d=a.itemData;this._getAppConfigFromAppId(c,a.appId).then(function(c){c._itemData=d;f.resolve(c)})}));return f},
_getAppDataFromTemplateAppId:function(c,a){return s.getPortal(c).getItemData(a)},_getWabAppIdAndDataFromTemplateAppId:function(a,f){var d=new m,h=s.getPortal(a);h.getItemData(f).then(b.hitch(this,function(a){h.getItemById(a.source).then(b.hitch(this,function(f){f=c.urlToObject(f.url);d.resolve({appId:f.query.id,itemData:a})}))}),function(c){d.reject(c)});return d},_getAppConfigFromAppId:function(c,a){return s.getPortal(c).getItemData(a)},_mergeTemplateAppConfigToAppConfig:function(c,a){function f(c){var a=
[];g.forEach(c,function(c){c&&a.push(c)},this);return a}function h(){a.widgetPool.widgets=f(a.widgetPool.widgets);p.widgets=f(p.widgets);if(a.widgetPool.groups)for(l=0;l<a.widgetPool.groups.length;l++)a.widgetPool.groups[l].widgets=f(a.widgetPool.groups[l].widgets);if(p.groups)for(l=0;l<p.groups.length;l++)p.groups[l].widgets=f(p.groups[l].widgets)}var l,p=a.widgetOnScreen,r=a.portalUrl;a.agolConfig=c;a.map.itemId=c.values.webmap;a.map.portalUrl=r;delete a.map.mapOptions;var q=null,k=null,t;for(t in c.values)"webmap"!==
t&&d.setConfigByTemplateWithId(a,t,c.values[t]),"app_title"===t&&(q=c.values[t]),"app_subtitle"===t&&(k=c.values[t]);var e=new m;!q||!k?s.getPortal(r).getItemById(c.values.webmap).then(b.hitch(this,function(c){q||(a.title=c.title);k||(a.subtitle=c.snippet);h();e.resolve()})):(h(),e.resolve());return e},_removeHash:function(c){for(var a in c)c[a]&&(c[a]=c[a].replace("#",""))},loadWidgetsManifest:function(c){var f=[],h=new m;c._buildInfo&&c._buildInfo.widgetManifestsMerged?this._loadMergedWidgetManifests().then(b.hitch(this,
function(l){p.visitElement(c,b.hitch(this,function(c){!c.widgets&&c.uri&&(l[c.uri]?(this._addNeedValuesForManifest(l[c.uri]),d.addManifest2WidgetJson(c,l[c.uri])):f.push(this.widgetManager.loadWidgetManifest(c)))}));a(f).then(function(){h.resolve(c)})})):(p.visitElement(c,b.hitch(this,function(c){!c.widgets&&c.uri&&f.push(this.widgetManager.loadWidgetManifest(c))})),a(f).then(function(){h.resolve(c)}));setTimeout(function(){h.isResolved()||h.resolve(c)},jimuConfig.timeout);return h},_addNeedValuesForManifest:function(c){d.addManifestProperies(c);
d.processManifestLabel(c,e.locale)},_loadMergedWidgetManifests:function(){return q(window.appInfo.appPath+"widgets/widgets-manifest.json",{handleAs:"json"})},_getRepeatedId:function(c){var a=[],f;p.visitElement(c,function(c){if(0<a.indexOf(c.id))return f=c.id,!0;a.push(c.id)});return f},_processUrlParams:function(c){if(this.urlParams.itemid||this.urlParams.webmap)c.map.itemId=this.urlParams.itemid||this.urlParams.webmap;this.urlParams.mode&&(c.mode=this.urlParams.mode);c.map.mapOptions||(c.map.mapOptions=
{});var a;this.urlParams.extent&&(a=-1<this.urlParams.extent.indexOf(";")?";":",",a=this.urlParams.extent.split(a),4===a.length?c.map.mapOptions.extent={xmin:parseFloat(a[0]),ymin:parseFloat(a[1]),xmax:parseFloat(a[2]),ymax:parseFloat(a[3])}:5===a.length&&(c.map.mapOptions.extent={xmin:parseFloat(a[0]),ymin:parseFloat(a[1]),xmax:parseFloat(a[2]),ymax:parseFloat(a[3]),spatialReference:{wkid:parseInt(a[4],10)}}));this.urlParams.center&&(a=-1<this.urlParams.center.indexOf(";")?";":",",a=this.urlParams.center.split(a),
2===a.length?c.map.mapOptions.center=a:3===a.length&&(a=new u(parseInt(a[0],10),parseInt(a[1],10),new w(parseInt(a[2],10))),c.map.mapOptions.center=a.toJson()));this.urlParams.scale&&(c.map.mapOptions.scale=this.urlParams.scale);if(this.urlParams.level||this.urlParams.zoom)c.map.mapOptions.zoom=this.urlParams.level||this.urlParams.zoom}});x.getInstance=function(c,a){null===A?A=new x(c,a):(A.urlParams=c,A.options=a);return A};return x})},"jimu/portalUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/Deferred dojo/topic esri/request ./utils ./portalUrlUtils ./tokenUtils".split(" "),
function(n,b,g,e,k,m,a,q,d,l){var p=n([],{declaredClass:"jimu.Portal",selfUrl:null,user:null,selfInfo:null,portalUrl:null,credential:null,constructor:function(a){this.portalUrl=d.getStandardPortalUrl(a);this.selfUrl=d.getPortalSelfInfoUrl(a)},loadSelfInfo:function(){var f=new k,c={url:this.selfUrl,content:{f:"json"},handleAs:"json",callbackParamName:"callback",preventCache:!0};this.isValidCredential()&&(c.content.token=this.credential.token);a(c).then(b.hitch(this,function(c){var a=c.user;delete c.user;
b.mixin(this,c);c.user=a;f.resolve(c)}),b.hitch(this,function(c){console.error(c);f.reject(c)}));return f},_checkCredential:function(){var a=l.isValidCredential(this.credential);a||this.clearCredentialAndUser();return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.credential=l.getPortalCredential(this.portalUrl))},signIn:function(){var a=new k;this.updateCredential();this.isValidCredential()?setTimeout(b.hitch(this,
function(){a.resolve(this.credential)}),0):a=l.signInPortal(this.portalUrl);return a},haveSignIn:function(){return l.userHaveSignInPortal(this.portalUrl)},clearCredentialAndUser:function(){this.user=this.credential=null},getUser:function(){this.updateCredential();var a=new k;this.user&&"jimu.PortalUser"===this.user.declaredClass?setTimeout(b.hitch(this,function(){this.user.updateCredential();a.resolve(this.user)}),0):this.isValidCredential()?this.credential.userId?this._getUser(this.credential.userId).then(b.hitch(this,
function(c){this.user=c;a.resolve(this.user)}),b.hitch(this,function(c){console.error(c);a.reject(c)})):l.getUserIdByToken(this.credential.token,this.portalUrl).then(b.hitch(this,function(c){this.credential.userId=c;this._getUser(this.credential.userId).then(b.hitch(this,function(c){this.user=c;a.resolve(this.user)}),b.hitch(this,function(c){console.error(c);a.reject(c)}))}),b.hitch(this,function(c){console.error(c);a.reject(c)})):setTimeout(b.hitch(this,function(){a.reject("credential is null.")}),
0);return a},queryItems:function(f){this.updateCredential();var c=new k,h=d.getBaseSearchUrl(this.portalUrl),l={f:"json"};f&&(l=b.mixin(l,f));this.isValidCredential()&&(l.token=this.credential.token);!l.sortField&&!l.sortOrder&&(l.sortField="title",l.sortOrder="asc");a({url:h,handleAs:"json",content:l,callbackParamName:"callback"}).then(b.hitch(this,function(a){a.results=g.map(a.results,b.hitch(this,function(c){c.portalUrl=this.portalUrl;c.credential=this.credential;c.portal=this;return new r(c)}));
c.resolve(a)}),b.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getItemData:function(f){this.updateCredential();f={url:d.getItemDataUrl(this.portalUrl,f),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(f.content.token=this.credential.token);return a(f)},getItemById:function(f){var c=new k;this.updateCredential();f={url:d.getItemUrl(this.portalUrl,f),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&
(f.content.token=this.credential.token);a(f).then(b.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;a=new r(a);c.resolve(a)}),b.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getAppById:function(f){var c=new k;this.updateCredential();this.isValidCredential()?(f=d.getAppIdUrl(this.portalUrl,f),c=a({url:f,handleAs:"json",content:{f:"json",token:this.credential.token}})):setTimeout(b.hitch(this,function(){c.reject("token is null.")}),0);
return c},queryGroups:function(f){this.updateCredential();var c=new k,h=d.getBaseGroupUrl(this.portalUrl),l={f:"json"};f&&(l=b.mixin(l,f));this.isValidCredential()&&(l.token=this.credential.token);a({url:h,handleAs:"json",content:l,callbackParamName:"callback"}).then(b.hitch(this,function(a){a.results=g.map(a.results,b.hitch(this,function(c){c.portalUrl=this.portalUrl;c.credential=this.credential;c.portal=this;return new s(c)}));c.resolve(a)}),b.hitch(this,function(a){console.error(a);c.reject(a)}));
return c},registerApp:function(f,c,h){var l=new k;this.updateCredential();if(this.isValidCredential())var p=this.credential&&this.credential.token,r=d.getOAuth2Url(this.portalUrl),l=a({url:r+"/registerApp",content:{itemId:f,appType:c,redirect_uris:JSON.stringify(h),token:p,f:"json"},handleAs:"json"},{usePost:!0});else setTimeout(b.hitch(this,function(){l.reject("token is null.")}),0);return l},createAndRegisterApp:function(a){var c=new k;this.updateCredential();this.isValidCredential()?this.getUser().then(b.hitch(this,
function(d){d.addItem({title:"Web AppBuilder for ArcGIS",type:"Web Mapping Application",text:"",snippet:"",tags:"Registered App for OAuth"},"").then(b.hitch(this,function(d){d.success?this.registerApp(d.id,"browser",a).then(b.hitch(this,function(a){c.resolve(a)}),b.hitch(this,function(a){console.error(a);c.reject(a)})):c.reject("create app failed")}),b.hitch(this,function(a){console.error(a);c.reject(a)}))}),b.hitch(this,function(a){console.error(a);c.reject(a)})):setTimeout(b.hitch(this,function(){c.reject("token is null.")}),
0);return c},_getUser:function(f){this.updateCredential();var c=new k;f={url:d.getUserUrl(this.portalUrl,f),content:{f:"json"},handleAs:"json",callbackParamName:"callback"};this.isValidCredential()&&(f.content.token=this.credential&&this.credential.token);a(f).then(b.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;this.user=new h(a);c.resolve(this.user)}),b.hitch(this,function(a){console.error(a);c.reject(a)}));return c}}),h=n([],{declaredClass:"jimu.PortalUser",
portalUrl:null,credential:null,portal:null,constructor:function(a){a&&b.mixin(this,a)},_checkCredential:function(){var a=l.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getGroups:function(){var a=[];this.groups&&(a=g.map(this.groups,b.hitch(this,function(c){c.portalUrl=
this.portalUrl;c.credential=this.credential;c.portal=this.portal;return new s(c)})));return a},getItemsByKeywords:function(a,c){return this.portal.queryItems({start:c||1,num:100,q:"owner:"+this.username+' AND typekeywords:"'+a+'"'})},getContent:function(){this.updateCredential();var f={url:d.getUserContentUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential&&(f.content.token=this.credential.token);return a(f)},getTags:function(){this.updateCredential();
var f={url:d.getUserTagsUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(f.content.token=this.credential.token);return a(f)},addItem:function(f,c){this.updateCredential();var h=new k;if(this.isValidCredential()){var l={f:"json",token:this.credential.token};f&&(l=b.mixin(l,f));a({url:d.getAddItemUrl(this.portalUrl,this.username,c),handleAs:"json",callbackParamName:"callback",content:l},{usePost:!0}).then(b.hitch(this,function(c){h.resolve(c)}),
b.hitch(this,function(c){console.error(c);h.reject(c)}))}else setTimeout(b.hitch(this,function(){h.reject("token is null.")}),0);return h},deleteItem:function(f){this.updateCredential();var c=new k;this.isValidCredential()?(f=d.getDeleteItemUrl(this.portalUrl,this.username,f),c=a({url:f,content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})):setTimeout(b.hitch(this,function(){c.reject("token is null.")}),0);return c},getItemById:function(f,c){this.updateCredential();var h=new k,
l={url:d.getUserItemsUrl(this.portalUrl,this.username,c)+"/"+f,handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(l.content.token=this.credential.token);a(l).then(b.hitch(this,function(c){c.portalUrl=this.portalUrl;c.credential=this.credential;c.portal=this;c=new r(c);h.resolve(c)}),b.hitch(this,function(c){console.error(c);h.reject(c)}));return h},shareItem:function(f,c,h){this.updateCredential();var l=new k;this.isValidCredential()?(c={url:d.shareItemUrl(this.portalUrl,
this.username,c,h),handleAs:"json",callbackParamName:"callback",content:{f:"json",token:this.credential.token}},f&&(c.content=b.mixin(c.content,f)),a(c,{usePost:!0}).then(b.hitch(this,function(c){l.resolve(c)}),b.hitch(this,function(c){console.error(c);l.reject(c)}))):setTimeout(b.hitch(this,function(){l.reject("token is null.")}),0);return l},updateItem:function(f,c){this.updateCredential();var h=new k;this.isValidCredential()?this.portal.getItemById(f).then(b.hitch(this,function(l){var p={f:"json",
token:this.credential.token};c&&(p=b.mixin(p,c));a({url:d.getUpdateItemUrl(this.portalUrl,this.username,f,l.ownerFolder),handleAs:"json",callbackParamName:"callback",timeout:1E5,content:p},{usePost:!0}).then(b.hitch(this,function(c){h.resolve(c)}),b.hitch(this,function(c){console.error(c);h.reject(c)}))}),b.hitch(this,function(c){console.error(c);h.reject(c)})):setTimeout(b.hitch(this,function(){h.reject("token is null.")}),0);return h}}),s=n([],{declaredClass:"jimu.PortalGroup",portalUrl:null,credential:null,
portal:null,constructor:function(a){a&&b.mixin(this,a)},_checkCredential:function(){var a=l.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},queryItems:function(a){a.q="group:"+this.id+" AND "+a.q;return this.portal.queryItems(a)}}),r=n([],{declaredClass:"jimu.PortalItem",
itemUrl:null,detailsPageUrl:null,ownerPageUrl:null,portalUrl:null,credential:null,portal:null,token:null,constructor:function(a){a&&b.mixin(this,a);this.itemUrl=d.getItemUrl(this.portalUrl,this.id);!this.thumbnailUrl&&(this.thumbnail&&this.itemUrl)&&(this.thumbnailUrl=this.itemUrl+"/info/"+this.thumbnail);this.token=this.credential&&this.credential.token;this.thumbnailUrl&&this.token&&(this.thumbnailUrl+="?token\x3d"+this.token);this.portalUrl&&this.id&&(this.detailsPageUrl=d.getItemDetailsPageUrl(this.portalUrl,
this.id));this.portalUrl&&this.owner&&(this.ownerPageUrl=d.getUserProfilePageUrl(this.portalUrl,this.owner))},_checkCredential:function(){var a=l.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getItemData:function(){return this.portal.getItemData(this.id)}}),t={portals:[],
webMapQueryStr:" "+q.getItemQueryStringByTypes(["Web Map"])+" ",webSceneQueryStr:" "+q.getItemQueryStringByTypes(["Web Scene"])+" ",_findPortal:function(a){for(var c=0;c<this.portals.length;c++){var h=this.portals[c];if(d.isSamePortalUrl(a,h.portalUrl))return h.updateCredential(),h}return null},getPortal:function(a){if(!a||!("string"===typeof a&&b.trim(a)))return null;a=d.getStandardPortalUrl(a);var c=this._findPortal(a);c||(c=new p(a),c.credential=l.getPortalCredential(c.portalUrl),c.updateCredential(),
this.portals.push(c));return c},getPortalSelfInfo:function(a){return this.getPortal(a).loadSelfInfo()},getBasemapGalleryGroup:function(a){return this._getPortalSelfGroup(a,"basemapGalleryGroupQuery")},getTemplatesGroup:function(a){return this._getPortalSelfGroup(a,"templatesGroupQuery")},getUnits:function(a){var c="english",d="",h=new k;this.getPortal(a).getUser().then(b.hitch(this,function(a){a&&a.units?c=a.units:(d=e.locale,c=d.startWith("en")?"english":"metric");h.resolve(c)}),b.hitch(this,function(l){console.warn(l);
this.getPortalSelfInfo(a).then(b.hitch(this,function(c){d=c&&c.culture||e.locale}),b.hitch(this,function(c){console.warn(c);d=e.locale})).always(b.hitch(this,function(){c=d.startWith("en")?"english":"metric";h.resolve(c)}))}));return h.promise},_getPortalSelfGroup:function(a,c){var d=new k,h=this.getPortal(a);h||setTimeout(b.hitch(this,function(){d.reject()}),0);this.getPortalSelfInfo(a).then(b.hitch(this,function(a){h.queryGroups({f:"json",q:a[c]}).then(b.hitch(this,function(c){0<c.results.length?
(c=c.results[0],c.portalUrl=h.portalUrl,c.credential=h.credential,c.portal=h,c=new s(c),d.resolve(c)):d.reject("Can't find portal self group.")}),b.hitch(this,function(c){console.error(c);d.reject(c)}))}),b.hitch(this,function(c){console.error(c);d.reject(c)}));return d},getWebMapsFromBasemapGalleryGroup:function(a){var c=new k;this.getBasemapGalleryGroup(a).then(b.hitch(this,function(a){a?a.queryItems({start:1,num:100,f:"json",q:this.webMapQueryStr}).then(b.hitch(this,function(a){c.resolve(a)}),
b.hitch(this,function(a){console.error(a);c.reject(a)})):c.reject()}),b.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getDefaultWebScene:function(a){var c=new k,d=this.getPortal(a);d.getUser().then(b.hitch(this,function(a){d.queryItems({start:1,num:1,f:"json",q:this.webSceneQueryStr+' AND owner:"'+a.username+'" ',sortField:"numViews",sortOrder:"desc"}).then(b.hitch(this,function(a){a=a.results;a=g.filter(a,b.hitch(this,function(c){return c.type&&"web scene"===c.type.toLowerCase()}));
0<a.length?c.resolve(a[0].id):c.resolve(null)}),b.hitch(this,function(a){c.reject(a)}))}),b.hitch(this,function(){c.reject("not sign in")}));return c},getDefaultWebMap:function(a){var c=new k;this.getPortalSelfInfo(a).then(b.hitch(this,function(d){var h=d.defaultBasemap&&d.defaultBasemap.id;h?c.resolve(h):this._getDefaultWebMapByBasemapGallery(a,d).then(b.hitch(this,function(d){d?c.resolve(d):this._getMostNumViewsWebMap(a).then(b.hitch(this,function(a){a?c.resolve(a):c.reject()}),b.hitch(this,function(a){console.error(a);
c.reject(a)}))}),b.hitch(this,function(a){console.error(a);c.reject(a)}))}),b.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_getDefaultWebMapByBasemapGallery:function(a,c){var d=new k,h=this.getPortal(a),l=c.defaultBasemap&&c.defaultBasemap.title;h.queryGroups({f:"json",q:c.basemapGalleryGroupQuery}).then(b.hitch(this,function(c){c=c.results;0<c.length?h.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND group:"+c[0].id+" AND title:"+l}).then(b.hitch(this,function(c){c=
c.results;c=g.filter(c,b.hitch(this,function(c){return c.type&&"web map"===c.type.toLowerCase()}));0<c.length?d.resolve(c[0].id):(console.log("Can't find web map under basemapGalleryGroupQuery."),h.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND title:"+l}).then(b.hitch(this,function(c){c=c.results;c=g.filter(c,b.hitch(this,function(c){return c.type&&"web map"===c.type.toLowerCase()}));if(0<c.length){var a=c[0];h.getItemData(a.id).then(b.hitch(this,function(c){c&&(c.operationalLayers||
c.baseMap||c.version)?d.resolve(a.id):d.resolve(null)}),b.hitch(this,function(){d.resolve(null)}))}else console.log("Can't find web map by defaultBasemap.title."),d.resolve(null)}),b.hitch(this,function(c){console.error(c);d.reject(c)})))}),b.hitch(this,function(c){console.error(c);d.reject(c)})):(console.log("Can't find group by basemapGalleryGroupQuery."),d.resolve(null))}),b.hitch(this,function(c){console.error(c);d.reject(c)}));return d},_getMostNumViewsWebMap:function(a){var c=new k;this.getPortal(a).queryItems({start:1,
num:1,f:"json",q:this.webMapQueryStr+" AND access:public AND owner:esri_en",sortField:"numViews",sortOrder:"desc"}).then(b.hitch(this,function(a){a=a.results;a=g.filter(a,b.hitch(this,function(c){return c.type&&"web map"===c.type.toLowerCase()}));0<a.length?c.resolve(a[0].id):c.reject("Can't find most-num-views web map.")}),b.hitch(this,function(a){console.error(a);c.reject(a)}));return c}};m.subscribe("userSignOut",function(a){(a=t._findPortal(a))&&a.clearCredentialAndUser()});return t})},"jimu/LayoutManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dijit/_WidgetBase dojo/topic dojo/on dojo/dom-construct dojo/dom-geometry dojo/Deferred dojo/promise/all require ./WidgetManager ./PanelManager ./MapManager ./utils ./PreloadWidgetIcon ./WidgetPlaceholder ./dijit/LoadingShelter".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c,u,w){var A=null,x;x=n([k],{constructor:function(c,f){this.widgetManager=s.getInstance();this.panelManager=r.getInstance();this.own(m.subscribe("appConfigLoaded",b.hitch(this,this.onAppConfigLoaded)));this.own(m.subscribe("appConfigChanged",b.hitch(this,this.onAppConfigChanged)));this.own(m.subscribe("mapLoaded",b.hitch(this,this.onMapLoaded)));this.own(m.subscribe("mapChanged",b.hitch(this,this.onMapChanged)));this.own(m.subscribe("beforeMapDestory",b.hitch(this,
this.onBeforeMapDestory)));this.own(m.subscribe("builder/actionTriggered",b.hitch(this,this.onActionTriggered)));this.widgetPlaceholders=[];this.preloadWidgetIcons=[];this.preloadGroupPanels=[];this.invisibleWidgetIds=[];this.own(a(window,"resize",b.hitch(this,this.resize)));this.id=f},postCreate:function(){this.containerNode=this.domNode},map:null,mapId:"map",hlDiv:null,animTime:500,resize:function(){g.forEach(this.widgetManager.getAllWidgets(),function(c){!1===c.inPanel&&c.resize()},this)},onAppConfigLoaded:function(c){this.appConfig=
b.clone(c);this.appConfig.theme&&this._loadTheme(this.appConfig.theme);this._loadMap()},onAppConfigChanged:function(c,a,f){c=b.clone(c);switch(a){case "themeChange":this._onThemeChange(c);break;case "styleChange":this._onStyleChange(c);break;case "layoutChange":this._onLayoutChange(c);break;case "widgetChange":this._onWidgetChange(c,f);break;case "groupChange":this._onGroupChange(c,f);break;case "widgetPoolChange":this._onWidgetPoolChange(c);break;case "resetConfig":this._onResetConfig(c)}this.appConfig=
c},onMapLoaded:function(c){this.map=c;this.panelManager.setMap(c);this._loadPreloadWidgets(this.appConfig)},onMapChanged:function(c){this.map=c;this.panelManager.map=c;this._loadPreloadWidgets(this.appConfig)},onBeforeMapDestory:function(){this.panelManager.destroyAllPanels();this._destroyPreloadPanelessWidgets();this._destroyWidgetPlaceholders();this._destroyPreloadWidgetIcons()},onActionTriggered:function(c){"highLight"===c.action&&(g.forEach(this.widgetPlaceholders,function(a){a.configId===c.elementId&&
this._highLight(a)},this),g.forEach(this.preloadWidgetIcons,function(a){a.configId===c.elementId&&this._highLight(a)},this),g.forEach(this.widgetManager.getPreloadPanelessWidgets(),function(a){a.configId===c.elementId&&this._highLight(a)},this));"removeHighLight"===c.action&&this._removeHighLight()},_highLight:function(c){if(c.domNode){this.hlDiv&&this._removeHighLight(c);var a=d.getMarginBox(c.domNode);this.hlDiv=q.create("div",{style:{position:"absolute",left:a.l+"px",top:a.t+"px",width:a.w+"px",
height:a.h+"px"},"class":"icon-highlight"},c.domNode,"before")}},_removeHighLight:function(){this.hlDiv&&(q.destroy(this.hlDiv),this.hlDiv=null)},_onWidgetChange:function(c,a){a=c.getConfigElementById(a.id);a.isController?this._reloadControllerWidget(c):(g.forEach(this.widgetPlaceholders,function(c){c.configId===a.id&&(c.destroy(),this._loadPreloadWidget(a))},this),this._removeDestroyed(this.widgetPlaceholders),g.forEach(this.preloadWidgetIcons,function(c){if(c.configId===a.id){var f=c.state;c.destroy();
this._loadPreloadWidget(a).then(function(c){if("opened"===f)c.onClick()})}},this),this._removeDestroyed(this.preloadWidgetIcons),g.forEach(this.widgetManager.getPreloadPanelessWidgets(),function(c){c.configId===a.id&&(c.destroy(),!1===a.visible?0>this.invisibleWidgetIds.indexOf(a.id)&&this.invisibleWidgetIds.push(a.id):this._loadPreloadWidget(a))},this),g.forEach(this.preloadGroupPanels,function(c){c.reloadWidget(a)},this),this._updatePlaceholder(c),g.forEach(this.invisibleWidgetIds,function(c){c===
a.id&&!1!==a.visible&&(this._loadPreloadWidget(a),c=this.invisibleWidgetIds.indexOf(a.id),this.invisibleWidgetIds.splice(c,1))},this),a.isPreload||this._reloadControllerWidget(c))},_onGroupChange:function(c,a){a=c.getConfigElementById(a.id);g.forEach(this.panelManager.panels,function(c){c.config.id===a.id&&c.updateConfig(a)},this);a.isPreload||this._reloadControllerWidget(c)},_updatePlaceholder:function(c){g.forEach(this.widgetPlaceholders,function(a){a.setIndex(c.getConfigElementById(a.configId).placeholderIndex)},
this)},_onWidgetPoolChange:function(c){this._reloadControllerWidget(c)},_reloadControllerWidget:function(c){var a=0<this.widgetManager.getControllerWidgets().length?this.widgetManager.getControllerWidgets()[0]:null;if(a){var f=a.getOpenedIds(),d=a.windowState;this.appConfig.getConfigElementById(a.id);this.appConfig.visitElement(b.hitch(this,function(c,a){a.isOnScreen||this.panelManager.destroyPanel(c.id+"_panel")}));this.widgetManager.destroyWidget(a)}var h;c.visitElement(b.hitch(this,function(c,
a){c.isController&&(h=c)}));!1!==h.visible&&this._loadPreloadWidget(h).then(b.hitch(this,function(c){this.widgetManager.changeWindowStateTo(c,d);f&&c.setOpenedIds(f)}))},_removeDestroyed:function(c){var a=[];g.forEach(c,function(c){c._destroyed&&a.push(c)});g.forEach(a,function(a){a=c.indexOf(a);c.splice(a,1)})},_destroyPreloadWidgetIcons:function(){g.forEach(this.preloadWidgetIcons,function(c){c.destroy()},this);this.preloadWidgetIcons=[]},_destroyPreloadPanelessWidgets:function(){g.forEach(this.widgetManager.getPreloadPanelessWidgets(),
function(c){this.widgetManager.destroyWidget(c)},this)},_destroyWidgetPlaceholders:function(){g.forEach(this.widgetPlaceholders,function(c){c.destroy()},this);this.widgetPlaceholders=[]},_destroyPreloadGroupPanels:function(){g.forEach(this.preloadGroupPanels,function(c){this.panelManager.destroyPanel(c)},this);this.preloadGroupPanels=[]},_changeMapPosition:function(c){this.map&&(c=f.getPositionStyle(c.map.position),e.setStyle(this.mapId,c),this.map.resize())},_onThemeChange:function(c){this._destroyPreloadWidgetIcons();
this._destroyWidgetPlaceholders();this._destroyPreloadPanelessWidgets();this.panelManager.destroyAllPanels();this._updateCommonStyle(c);this._onStyleChange(c);this._changeMapPosition(c);this._loadPreloadWidgets(c)},_onResetConfig:function(c){c.map.itemId!==this.appConfig.map.itemId?(m.publish("appConfigChanged",c,"mapChange",c),this._updateCommonStyle(c),this._onStyleChange(c),this._changeMapPosition(c)):this._onThemeChange(c)},_updateCommonStyle:function(c){var a=this.appConfig.theme;e.removeClass(this.domNode,
a.name);e.destroy(this._getThemeCommonStyleId(a));this._loadThemeCommonStyle(c.theme)},_onStyleChange:function(c){var a=this.appConfig.theme;a.styles!==c.theme.styles&&(a.styles[0]!==c.theme.styles[0]&&e.removeClass(this.domNode,a.styles[0]),e.destroy(this._getThemeCurrentStyleId(a)),this._loadThemeCurrentStyle(c.theme))},_onLayoutChange:function(c){var a=f.getPositionStyle(c.map.position);e.setStyle(this.mapId,a);this.map.resize();g.forEach(this.widgetPlaceholders,function(a){a.moveTo(c.getConfigElementById(a.configId).panel.position)},
this);g.forEach(this.preloadWidgetIcons,function(a){a.moveTo(c.getConfigElementById(a.configId).panel.position)},this);g.forEach(this.widgetManager.getPreloadPanelessWidgets(),function(d){var h=c.getConfigElementById(d.id).panel.position;a=f.getPositionStyle(h);e.setStyle(d.domNode,a);d.onPositionChange(h)},this);g.forEach(this.preloadGroupPanels,function(d){a=f.getPositionStyle(c.getConfigElementById(d.config.id).panel.position);e.setStyle(d.domNode,a);d.resize()},this)},_loadTheme:function(c){h(["themes/"+
c.name+"/main"],b.hitch(this,function(){this._loadThemeCommonStyle(c);this._loadThemeCurrentStyle(c)}))},_loadThemeCommonStyle:function(c){f.loadStyleLink(this._getThemeCommonStyleId(c),"themes/"+c.name+"/common.css");e.addClass(this.domNode,c.name)},_loadThemeCurrentStyle:function(c){f.loadStyleLink(this._getThemeCurrentStyleId(c),"themes/"+c.name+"/styles/"+c.styles[0]+"/style.css");e.addClass(this.domNode,c.styles[0])},_getThemeCommonStyleId:function(c){return"theme_"+c.name+"_style_common"},_getThemeCurrentStyleId:function(c){return"theme_"+
c.name+"_style_"+c.styles[0]},_loadMap:function(){var c=e.create("div",{id:this.mapId,style:b.mixin({position:"absolute",backgroundColor:"#EEEEEE",overflow:"hidden",minWidth:"1px",minHeight:"1px"},f.getPositionStyle(this.appConfig.map.position))});e.place(c,this.id);t.getInstance(this.appConfig,this.mapId).showMap()},_createPreloadWidgetPlaceHolder:function(c){var a;a="map"===c.panel.positionRelativeTo?this.mapId:this.id;var d=b.clone(c);d.position.width=40;d.position.height=40;var h=f.getPositionStyle(d.position);
c=new u({index:d.placeholderIndex,configId:c.id});e.setStyle(c.domNode,h);e.place(c.domNode,a);this.widgetPlaceholders.push(c);return c},_createPreloadWidgetIcon:function(a){var d=new c({panelManager:this.panelManager,widgetConfig:a,configId:a.id,map:this.map});"map"===a.panel.positionRelativeTo?e.place(d.domNode,this.mapId):e.place(d.domNode,this.id);e.setStyle(d.domNode,f.getPositionStyle({top:a.position.top,left:a.position.left,right:a.position.right,bottom:a.position.bottom,width:40,height:40}));
d.startup();!this.openAtStartWidget&&a.openAtStart&&(d.switchToOpen(),this.openAtStartWidget=a.name);this.preloadWidgetIcons.push(d);return d},_loadPreloadWidgets:function(c){console.time("Load widgetOnScreen");var a=new w,f=[];a.placeAt(this.id);a.startup();g.forEach(c.widgetOnScreen.widgets,function(c){!1===c.visible?this.invisibleWidgetIds.push(c.id):f.push(this._loadPreloadWidget(c))},this);g.forEach(c.widgetOnScreen.groups,function(c){f.push(this._loadPreloadGroup(c))},this);p(f).then(b.hitch(this,
function(){a&&(a.destroy(),a=null);console.timeEnd("Load widgetOnScreen");m.publish("preloadWidgetsLoaded");this._doPostLoad()}),b.hitch(this,function(){a&&(a.destroy(),a=null);console.timeEnd("Load widgetOnScreen");m.publish("preloadWidgetsLoaded");this._doPostLoad()}))},_doPostLoad:function(){h(["dynamic-modules/postload"])},_loadPreloadWidget:function(c){var a=new l;if("config"===this.appConfig.mode&&!c.uri){var d=this._createPreloadWidgetPlaceHolder(c);a.resolve(d);return a}if(!c.uri)return a.resolve(null),
a;c.inPanel?(d=this._createPreloadWidgetIcon(c),a.resolve(d)):this.widgetManager.loadWidget(c).then(b.hitch(this,function(d){"map"===d.panel.positionRelativeTo?e.place(d.domNode,this.mapId):e.place(d.domNode,this.id);e.setStyle(d.domNode,f.getPositionStyle(d.position));e.setStyle(d.domNode,"position","absolute");try{d.startup()}catch(h){console.log(console.error("fail to startup widget "+d.name+". "+h.stack))}d.configId=c.id;a.resolve(d)}),function(c){a.reject(c)});return a},_loadPreloadGroup:function(c){var a=
new l;this.panelManager.showPanel(c).then(b.hitch(this,function(c){this.preloadGroupPanels.push(c);a.resolve(c)}),function(c){a.reject(c)});return a}});x.getInstance=function(c,a){null===A&&(A=new x(c,a));return A};return x})},"jimu/PanelManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/Deferred dojo/on dojo/aspect require ./utils ./WidgetManager".split(" "),function(n,b,g,e,k,m,a,q,d,l,p){var h,s=null;h=n(null,{constructor:function(){this.panels=
[];this.widgetManager=p.getInstance();a(window,"resize",b.hitch(this,this.onWindowResize))},showPanel:function(a){var h=new m;d([a.panel.uri],b.hitch(this,function(f){var c=a.id+"_panel",d=this.getPanelById(c);if(d)"closed"===d.state&&this.openPanel(d,a.panel.position);else{var p;p="map"===a.panel.positionRelativeTo?jimuConfig.mapId:jimuConfig.layoutId;var s={label:a.label,config:a,uri:a.panel.uri,position:a.panel.position,positionRelativeTo:a.panel.positionRelativeTo,map:this.map,widgetManager:this.widgetManager,
panelManager:this,containerId:p,id:c,gid:a.gid};b.mixin(s,a.panel.options);try{d=new f(s),console.log("panel ["+c+"] created.")}catch(k){console.log("create panel error: "+k+", panelId: "+c);h.reject(k);return}e.setStyle(d.domNode,"opacity",0);q.before(d,"destroy",b.hitch(this,this.onDestroyPanel,d));e.place(d.domNode,p);try{d.startup()}catch(g){console.log(console.error("fail to startup panel "+d.id+". "+g.stack));h.reject(g);return}this.openPanel(d);l.setVerticalCenter(d.domNode);this.panels.push(d)}h.resolve(d)}));
return h},setMap:function(d){this.map=d;a(this.map,"resize",b.hitch(this,this.onMapResize))},closeOtherPanelsInTheSameGroup:function(a){for(var d=0;d<this.panels.length;d++)this.panels[d].gid===a.gid&&this.panels[d].id!==a.id&&this.closePanel(this.panels[d],!1)},openPanel:function(a){var d=new m;if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if("opened"===a.state)d.resolve();else{try{this.closeOtherPanelsInTheSameGroup(a),e.setStyle(a.domNode,"display","block"),k.animateProperty({node:a.domNode,
properties:{opacity:1},duration:200,onEnd:b.hitch(this,function(){a.setState("opened");a.onOpen();d.resolve()})}).play()}catch(f){console.log(console.error("fail to open panel "+a.id+". "+f.stack))}return d}},closePanel:function(a,d){var f=new m;if("string"===typeof a&&(a=this.getPanelById(a),!a))return f.resolve(),f;void 0===d&&(d=!0);if("closed"===a.state)return f.resolve(),f;try{d?k.animateProperty({node:a.domNode,properties:{opacity:0},duration:200,onEnd:function(){a.setState("closed");a.onClose();
e.setStyle(a.domNode,"display","none");f.resolve()}}).play():(a.setState("closed"),a.onClose(),e.setStyle(a.domNode,"display","none"),f.resolve())}catch(c){console.log(console.error("fail to close panel "+a.id+". "+c.stack))}return f},minimizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("minimized");try{a.onMinimize()}catch(d){console.log(console.error("fail to minimize panel "+a.id+". "+d.stack))}},maximizePanel:function(a){if("string"===
typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("maximized");try{a.onMaximize()}catch(d){console.log(console.error("fail to maximize panel "+a.id+". "+d.stack))}},normalizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("normal");try{a.onNormalize()}catch(d){console.log(console.error("fail to noralize panel "+a.id+". "+d.stack))}},changeWindowStateTo:function(a,d){if("string"===
typeof a&&(a=this.getPanelById(a),!a))return;"normal"===d?this.normalizePanel(a):"minimized"===d?this.minimizePanel(a):"maximized"===d?this.maximizePanel(a):console.log("error state: "+d)},getPanelById:function(a){for(var d=0;d<this.panels.length;d++)if(this.panels[d].id===a)return this.panels[d]},onWindowResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"!==this.panels[a].positionRelativeTo&&this.panels[a].resize()},onMapResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==
this.panels[a].state&&"map"===this.panels[a].positionRelativeTo&&this.panels[a].resize()},destroyPanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if(a.domNode){"closed"!==a.state&&this.closePanel(a,!1);this._removePanel(a);try{a.destroy()}catch(d){console.log(console.error("fail to destroy panel "+a.id+". "+d.stack))}}},onDestroyPanel:function(a){"closed"!==a.state&&this.closePanel(a,!1);this._removePanel(a);console.log("destroy panel "+a.id)},destroyAllPanels:function(){var a=
g.map(this.panels,function(a){return a.id});g.forEach(a,function(a){this.destroyPanel(a)},this);this.panels=[]},reloadWidgetInPanel:function(a){this.panels.forEach(function(d){d.reloadWidget(a)},this)},_removePanel:function(a){a=this.panels.indexOf(a);-1<a&&this.panels.splice(a,1)}});h.getInstance=function(){null===s&&(s=new h);return s};return h})},"jimu/MapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/topic dojo/on dojo/aspect dojo/keys esri/dijit/InfoWindow esri/dijit/PopupMobile esri/InfoTemplate esri/request esri/geometry/Extent esri/geometry/Point require ./utils ./dijit/LoadingShelter".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c){var u=null,w=n(null,{appConfig:null,mapDivId:"",map:null,previousInfoWindow:null,mobileInfoWindow:null,isMobileInfoWindow:!1,constructor:function(c,a){this.appConfig=c;this.id=this.mapDivId=a;k.subscribe("appConfigChanged",b.hitch(this,this.onAppConfigChanged));k.subscribe("changeMapPosition",b.hitch(this,this.onChangeMapPosition));k.subscribe("syncExtent",b.hitch(this,this.onSyncExtent));m(window,"resize",b.hitch(this,this.onWindowResize))},showMap:function(){this._showMap(this.appConfig)},
_showMap:function(a){console.time("Load Map");this.loading=new c;this.loading.placeAt(this.mapDivId);this.loading.startup();a.map["3D"]?a.map.itemId?this._show3DWebScene(a):this._show3DLayersMap(a):a.map.itemId?this._show2DWebMap(a):console.log("No webmap found. Please set map.itemId in config.json.")},onWindowResize:function(){this.map&&this.map.resize&&(this.map.resize(),this.resetInfoWindow(!1))},getMapInfoWindow:function(){return{mobile:this._mapMobileInfoWindow,bigScreen:this._mapInfoWindow}},
resetInfoWindow:function(c){c&&(this._mapInfoWindow=this.map.infoWindow,this._mapMobileInfoWindow&&this._mapMobileInfoWindow.destroy(),this._mapMobileInfoWindow=new l(null,e.create("div",null,null,this.map.root)),this.isMobileInfoWindow=!1);c=jimuConfig.widthBreaks[0];e.getContentBox(jimuConfig.layoutId).w<c&&!this.isMobileInfoWindow?(this.map.infoWindow.hide(),this.map.setInfoWindow(this._mapMobileInfoWindow),this.isMobileInfoWindow=!0):e.getContentBox(jimuConfig.layoutId).w>=c&&this.isMobileInfoWindow&&
(this.map.infoWindow.hide(),this.map.setInfoWindow(this._mapInfoWindow),this.isMobileInfoWindow=!1)},onChangeMapPosition:function(c){var a=e.getComputedStyle(e.byId(this.map.id)),d={top:a.top,bottom:a.bottom};window.isRTL?(d.left=a.right,d.right=a.left):(d.left=a.left,d.right=a.right);c=b.mixin(d,c);c=f.getPositionStyle(c);e.setStyle(this.mapDivId,c);this.map&&this.map.resize&&this.map.resize()},onSyncExtent:function(c){this.map&&(c=new s(c.extent),this.map.setExtent(c))},_visitConfigMapLayers:function(c,
a){g.forEach(c.map.basemaps,function(c,f){c.isOperationalLayer=!1;a(c,f)},this);g.forEach(c.map.operationallayers,function(c,f){c.isOperationalLayer=!0;a(c,f)},this)},_show3DLayersMap:function(c){t(["esri3d/Map"],b.hitch(this,function(a){var f;f=new a(this.mapDivId,{camera:c.map.mapOptions.camera});this._visitConfigMapLayers(c,b.hitch(this,function(c){this.createLayer(f,"3D",c)}));f.usePlugin=a.usePlugin;this._publishMapEvent(f)}))},_show3DWebScene:function(c){this._getWebsceneData(c.map.itemId).then(b.hitch(this,
function(a){t(["esri3d/Map"],b.hitch(this,function(f){var d=new f(this.mapDivId,c.map.mapOptions);g.forEach(a.itemData.operationalLayers,function(c){this.createLayer(d,"3D",c)},this);g.forEach(a.itemData.baseMap.baseMapLayers,function(c){c.type="tile";this.createLayer(d,"3D",c)},this);g.forEach(a.itemData.baseMap.elevationLayers,function(c){c.type="elevation";this.createLayer(d,"3D",c)},this);d.toc=a.itemData.toc;d.bookmarks=a.itemData.bookmarks;d.tours=a.itemData.tours}))}))},_publishMapEvent:function(c){window._viewerMap=
c;this.loading&&this.loading.destroy();console.timeEnd("Load Map");this.map?(this.map=c,this.resetInfoWindow(!0),console.log("map changed."),k.publish("mapChanged",this.map)):(this.map=c,this.resetInfoWindow(!0),k.publish("mapLoaded",this.map))},_getWebsceneData:function(c){return h({url:"http://184.169.133.166/sharing/rest/content/items/"+c+"/data",handleAs:"json"})},_show2DWebMap:function(c){c.map.mapOptions||(c.map.mapOptions={});var a=this._processMapOptions(c.map.mapOptions);f.createWebMap(c.map.portalUrl,
c.map.itemId,this.mapDivId,{mapOptions:a,bingMapsKey:c.bingMapsKey,usePopupManager:!0}).then(b.hitch(this,function(a){var f=a.map;f.infoWindow.resize(270,316);f.itemId=c.map.itemId;f.itemInfo=a.itemInfo;f.webMapResponse=a;f.enableSnapping({snapKey:q.copyKey});this._publishMapEvent(f)}),b.hitch(this,function(){this.loading&&this.loading.destroy();k.publish("mapCreatedFailed")}))},_processMapOptions:function(c){if(c)return c.lods||delete c.lods,c.lods&&0===c.lods.length&&delete c.lods,c=b.clone(c),
c.extent&&(c.extent=new s(c.extent)),c.center&&!b.isArrayLike(c.center)&&(c.center=new r(c.center)),c.infoWindow&&(c.infoWindow=new d(c.infoWindow,e.create("div",{},this.mapDivId))),c},createLayer:function(c,f,d){t([{"2D_tiled":"esri/layers/ArcGISTiledMapServiceLayer","2D_dynamic":"esri/layers/ArcGISDynamicMapServiceLayer","2D_image":"esri/layers/ArcGISImageServiceLayer","2D_feature":"esri/layers/FeatureLayer","2D_rss":"esri/layers/GeoRSSLayer","2D_kml":"esri/layers/KMLLayer","2D_webTiled":"esri/layers/WebTiledLayer",
"2D_wms":"esri/layers/WMSLayer","2D_wmts":"esri/layers/WMTSLayer","3D_tiled":"esri3d/layers/ArcGISTiledMapServiceLayer","3D_dynamic":"esri3d/layers/ArcGISDynamicMapServiceLayer","3D_image":"esri3d/layers/ArcGISImageServiceLayer","3D_feature":"esri3d/layers/FeatureLayer","3D_elevation":"esri3d/layers/ArcGISElevationServiceLayer","3D_3dmodle":"esri3d/layers/SceneLayer"}[f+"_"+d.type]],b.hitch(this,function(f){var h,l={};h="label url type icon infoTemplate isOperationalLayer".split(" ");for(var q in d)0>
h.indexOf(q)&&(l[q]=d[q]);d.infoTemplate?(h=new p(d.infoTemplate.title,d.infoTemplate.content),l.infoTemplate=h,f=new f(d.url,l),d.infoTemplate.width&&d.infoTemplate.height&&a.after(f,"onClick",b.hitch(this,function(){c.infoWindow.resize(d.infoTemplate.width,d.infoTemplate.height)}),!0)):f=new f(d.url,l);f.isOperationalLayer=d.isOperationalLayer;f.label=d.label;f.icon=d.icon;c.addLayer(f)}))},onAppConfigChanged:function(c,a,f){this.appConfig=c;"mapChange"===a?this._recreateMap(c):"mapOptionsChange"===
a&&f.lods&&this._recreateMap(c)},_recreateMap:function(c){this.map&&(k.publish("beforeMapDestory",this.map),this.map.destroy());this._showMap(c)},disableWebMapPopup:function(){this.map.setInfoWindowOnClick(!1)},enableWebMapPopup:function(){this.map.setInfoWindowOnClick(!0)}});w.getInstance=function(c,a){null===u&&(u=new w(c,a));return u};return w})},"esri/dijit/InfoWindow":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/sniff dojo/dom-class dojo/dom-construct dojo/dom-style dijit/_Widget dijit/_Templated dijit/_Container ../kernel ../domUtils ../InfoWindowBase ./_EventedWidget dojo/text!./templates/InfoWindow.html".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c,u,w){var A=n([u,h,s,r,c],{declaredClass:"esri.dijit.InfoWindow",isContainer:!0,templateString:w,anchor:"upperright",fixedAnchor:null,coords:null,isShowing:!0,isContentShowing:!0,isTitleBarShowing:!0,width:250,height:150,title:"Info Window",setMap:function(c){this.inherited(arguments);l.place(this.domNode,c.root)},startup:function(){if(!this._started){this.inherited(arguments);this._ANCHORS=[A.ANCHOR_UPPERRIGHT,A.ANCHOR_LOWERRIGHT,A.ANCHOR_LOWERLEFT,A.ANCHOR_UPPERLEFT];
if(7>m("ie")){var c="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+p.getComputedStyle(this._sprite).backgroundImage.replace(/url\(\"/i,"").replace(/\"\)/,"")+"')",a=l.create("div",null,e.body());p.set(a,{width:"1px",height:"1px",display:"none",backgroundImage:"none",filter:c});var f=setTimeout(function(){l.destroy(a);clearTimeout(f);f=a=null},100);k.query(".sprite",this.domNode).forEach(function(a){a.style.backgroundImage="none";a.style.filter=
c})}this.resize(this.width,this.height);this.hide()}},destroy:function(){this._destroyed||(this.__unregisterMapListeners(),this.destroyDijits(this._title),this.destroyDijits(this._content),this._title.innerHTML=this._content.innerHTML="",this.inherited(arguments))},resize:function(c,a){if(c&&a){var f=p.set;f(this._topleft,{height:a+"px",marginLeft:c+"px"});f(this._topright,{width:c+"px",height:a+"px"});f(this._user,"width",c-8+"px");f(this._hide,"marginLeft",c-22+"px");f(this._title,"width",c-25+
"px");f(this._content,"height",a-37+"px");f(this._bottomleft,{marginLeft:c+"px",marginTop:a+"px"});f(this._bottomright,{width:c-5+"px",marginTop:a+"px"});this.width=c;this.height=a;this.coords&&this._adjustPosition(this.coords,this.anchor);this.onResize(c,a)}},_adjustPosition:function(c,a){var f=p.set;f(this._infowindow,{left:Math.round(c.x)+"px",top:Math.round(c.y)+"px"});a===A.ANCHOR_UPPERLEFT?f(this._window,{left:null,right:this.width+18+"px",top:null,bottom:this.height+50+"px"}):a===A.ANCHOR_UPPERRIGHT?
f(this._window,{left:"6px",right:null,top:null,bottom:this.height+50+"px"}):a===A.ANCHOR_LOWERRIGHT?f(this._window,{left:"6px",right:null,top:"43px",bottom:null}):a===A.ANCHOR_LOWERLEFT&&f(this._window,{left:null,right:this.width+18+"px",top:"43px",bottom:null})},_getAnchor:function(c){var a=this.map;return a&&c?(c.y<a.height/2?"lower":"upper")+(c.x<a.width/2?"right":"left"):"upperright"},show:function(c,a,h){if(c){c.spatialReference?(this.mapCoords=c,c=this.coords=this.map.toScreen(c,!0)):(this.mapCoords=
null,this.coords=c);var l=this.map._getFrameWidth();if(-1!==l&&(c.x%=l,0>c.x&&(c.x+=l),this.map.width>l))for(var b=(this.map.width-l)/2;c.x<b;)c.x+=l;if(!a||-1===g.indexOf(this._ANCHORS,a))a=this._getAnchor(c);d.remove(this._pointer,this.anchor);a=this.anchor=this.fixedAnchor||a;this._adjustPosition(c,a);d.add(this._pointer,a);f.show(this.domNode);this.isShowing=!0;if(!h)this.onShow()}},hide:function(c,a){f.hide(this.domNode);this.isShowing=!1;if(!a)this.onHide()},showTitleBar:function(){f.show(this._titlebar);
f.show(this._border);this.isTitleBarShowing=!0},hideTitleBar:function(){f.hide(this._titlebar);f.hide(this._border);this.isTitleBarShowing=!1},showContent:function(){f.show(this._content);f.show(this._border);this.isContentShowing=!0},hideContent:function(){f.hide(this._content);f.hide(this._border);this.isContentShowing=!1},move:function(c,a){a?c=this.coords.offset(c.x,c.y):(this.coords=c,this.mapCoords&&(this.mapCoords=this.map.toMap(c)));p.set(this._infowindow,{left:Math.round(c.x)+"px",top:Math.round(c.y)+
"px"})},setFixedAnchor:function(c){c&&-1===g.indexOf(this._ANCHORS,c)||(this.fixedAnchor=c,this.isShowing&&this.show(this.mapCoords||this.coords,c),this.onAnchorChange(c))},setTitle:function(c){this.destroyDijits(this._title);this.__setValue("_title",c);return this},setContent:function(c){this.destroyDijits(this._content);this.__setValue("_content",c);return this},onShow:function(){this.__registerMapListeners();this.startupDijits(this._title);this.startupDijits(this._content)},onHide:function(){this.__unregisterMapListeners()},
onResize:function(){},onAnchorChange:function(){}});b.mixin(A,{ANCHOR_UPPERRIGHT:"upperright",ANCHOR_LOWERRIGHT:"lowerright",ANCHOR_LOWERLEFT:"lowerleft",ANCHOR_UPPERLEFT:"upperleft"});return A})},"esri/dijit/PopupMobile":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style ../InfoWindowBase ../PopupBase ./InfoView ./NavigationBar ../kernel ../domUtils dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c,u,w,A,x,B){return b([f,c],{declaredClass:"esri.dijit.PopupMobile",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:10,marginTop:10,highlight:!0,popupNavigationBar:null,popupInfoView:null,location:null,xIcon:n.toUrl("./images/whitex.png"),dArrowIcon:n.toUrl("./images/whitedown.png"),lArrowIcon:n.toUrl("./images/whitel.png"),rArrowIcon:n.toUrl("./images/whiter.png"),constructor:function(c,f){this.initialize();g.mixin(this,c);this.domNode=l.byId(f);this._nls=g.mixin({},
B.widgets.popup);var d=this.domNode;h.add(d,"esriPopupMobile");p.set(d,"innerHTML","\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv style\x3d'text-align:center'\x3e\x3cdiv class\x3d'titleButton prev hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'footer' style\x3d'display:inline-block;width:60px;height:15px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton arrow hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer top hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer bottom hidden'\x3e\x3c/div\x3e");
var b=a.query(".titlePane",d)[0];this._arrowButton=a.query(".arrow",b)[0];this._pointerTop=a.query(".top",d)[0];this._pointerBottom=a.query(".bottom",d)[0];this._title=a.query(".title",b)[0];this._footer=a.query(".footer",b)[0];this._prev=a.query(".prev",b)[0];this._next=a.query(".next",b)[0];this._spinner=a.query(".spinner",b)[0];this._eventConnections=[e.connect(a.query(".close",b)[0],"onclick",this,this.hide),e.connect(this._arrowButton,"onclick",this,this._toggleView),e.connect(this._prev,"onclick",
this,function(){this.selectPrevious();this._updateUI()}),e.connect(this._next,"onclick",this,function(){this.selectNext();this._updateUI()})];this._initPopupNavigationBar();this._initPopupInfoView();x.hide(d);this.isShowing=!1},setMap:function(c){this.inherited(arguments);s.place(this.domNode,c.root);this.highlight&&this.enableHighlight(c)},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(c,a){this.destroyDijits(this._title);this.place(c,this._title);
this.destroyDijits(this._footer);this.place(a,this._footer);this.isShowing&&(this.startupDijits(this._title),this.startupDijits(this._footer))},setContent:function(c){this.destroyDijits(this._contentPane);this.place(c,this._contentPane);this.startupDijits(this._contentPane)},show:function(c){if(c){var a=this.map;c.spatialReference?(this.location=c,c=a.toScreen(c)):this.location=a.toMap(c);this._maximized?this.restore():this._setPosition(c);this.isShowing||(x.show(this.domNode),this.isShowing=!0,this.onShow())}else x.show(this.domNode),
this.isShowing=!0},hide:function(){this.isShowing&&(x.hide(this.domNode),this.isShowing=!1,this.onHide())},onShow:function(){this._followMap();this.startupDijits(this._title);this.showHighlight()},onHide:function(){this._unfollowMap();this.hideHighlight()},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._footer);k.forEach(this._eventConnections,e.disconnect);s.destroy(this.domNode)},selectNext:function(){this.select(this.selectedIndex+
1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},onSetFeatures:function(){},onClearFeatures:function(){this.setTitle("\x26nbsp;","\x26nbsp;");h.add(this._arrowButton,"hidden");this._updateUI();this.hideHighlight()},onSelectionChange:function(){var c=this.selectedIndex;this._updateUI();0<=c&&(this.setContent(this.features[c].getContent()),this.updateHighlight(this.map,this.features[c]),this.isShowing&&this.showHighlight())},
onDfdComplete:function(){this._updateUI()},_followMap:function(){this._unfollowMap();var c=this.map;this._handles=[e.connect(c,"onPanStart",this,this._onPanStart),e.connect(c,"onPan",this,this._onPan),e.connect(c,"onZoomStart",this,this._onZoomStart),e.connect(c,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var c=this._handles;c&&(k.forEach(c,e.disconnect),this._handles=null)},_onPanStart:function(){var c=this.domNode.style;this._panOrigin={left:c.left,top:c.top,right:c.right,
bottom:c.bottom}},_onPan:function(c,a){var f=this._panOrigin,d=a.x,h=a.y,l=f.left,b=f.top,p=f.right,f=f.bottom;l&&(l=parseFloat(l)+d+"px");b&&(b=parseFloat(b)+h+"px");p&&(p=parseFloat(p)-d+"px");f&&(f=parseFloat(f)-h+"px");t.set(this.domNode,{left:l,top:b,right:p,bottom:f})},_onZoomStart:function(){x.hide(this.domNode)},_onExtentChange:function(c,a,f){f&&(x.show(this.domNode),this.show(this._targetLocation||this.location),this._targetLocation=null)},_setPosition:function(c){var a=c.x;c=c.y;var f=
r.getContentBox(this.map.container),d=f.w,f=f.h,l=0,b=c+10,p=118,q=d-18;18<a&&a<q?(l=a-130,0>l?l=0:l>d-260&&(l=d-260)):18>=a?l=a-18:a>=q&&(l=d-260+(a-q));118<a&&a<d-130?p=118:118>=a?18<a?p=a-12:18>=a&&(p=6):a>=d-130&&(a<q?p=118+a-(d-130):a>=q&&(p=118+q-(d-130)));c<=f/2?(t.set(this.domNode,{left:l+"px",top:b+"px",bottom:null}),t.set(this._pointerTop,{left:p+"px"}),h.add(this._pointerBottom,"hidden"),h.remove(this._pointerTop,"hidden")):(t.set(this.domNode,{left:l+"px",top:b-64+"px",bottom:null}),t.set(this._pointerBottom,
{left:p+"px"}),h.add(this._pointerTop,"hidden"),h.remove(this._pointerBottom,"hidden"))},_showPointer:function(c){k.forEach(["topLeft","topRight","bottomRight","bottomLeft"],function(f){f===c?a.query(".pointer."+f,this.domNode).removeClass("hidden"):a.query(".pointer."+f,this.domNode).addClass("hidden")},this)},_toggleView:function(){this.popupNavigationBar||this._initPopupNavigationBar();this.popupInfoView||this._initPopupInfoView();this.hide();x.show(this.popupNavigationBar.container);x.show(this.popupInfoView.container);
0<=this.selectedIndex&&this.setContent(this.features[this.selectedIndex].getContent())},_handleNavigationBar:function(c){this.popupInfoView.animateTo(0);switch(c.name){case "CloseButton":x.hide(this.popupNavigationBar.container);x.hide(this.popupInfoView.container);this.hide();break;case "ToggleButton":x.hide(this.popupNavigationBar.container);x.hide(this.popupInfoView.container);this.show(this.location);break;case "PreviousButton":this.selectPrevious();this._updateUI();break;case "NextButton":this.selectNext(),
this._updateUI()}},_initPopupNavigationBar:function(){var c={};c.items=[{name:"CloseButton",type:"img",src:this.xIcon,srcAlt:this.xIcon,position:"left"},{name:"Title",type:"span",text:"",position:"center"},{name:"ToggleButton",type:"img",src:this.dArrowIcon,srcAlt:this.dArrowIcon,position:"right",toggleGroup:"toggle"},{name:"PreviousButton",type:"img",src:this.lArrowIcon,srcAlt:this.lArrowIcon,position:"right2",toggleGroup:"previous"},{name:"NextButton",type:"img",src:this.rArrowIcon,srcAlt:this.rArrowIcon,
position:"right1",toggleGroup:"next"}];this.popupNavigationBar=new w(c,s.create("div",{},m.body()));e.connect(this.popupNavigationBar,"onCreate",this,function(c){this._prevFeatureButton=c[3]._node;this._nextFeatureButton=c[4]._node});e.connect(this.popupNavigationBar,"onSelect",this,this._handleNavigationBar);e.connect(this.popupNavigationBar,"onUnSelect",this,this._handleNavigationBar);this.popupNavigationBar.startup();x.hide(this.popupNavigationBar.container)},_initPopupInfoView:function(){this.popupInfoView=
new u({items:[{name:"Navigator",type:"div",text:""},{name:"content",type:"div",text:""},{name:"attachment",type:"div",text:""}]},s.create("div",{},m.body()));h.add(this.popupInfoView.container,"esriMobilePopupInfoView");this.popupInfoView.enableTouchScroll();e.connect(this.popupInfoView,"onCreate",this,function(c){this._contentPane=c[1]._node;0<=this.selectedIndex&&this.setContent(this.features[this.selectedIndex].getContent())});e.connect(this.popupInfoView,"onSwipeLeft",this,function(){});e.connect(this.popupInfoView,
"onSwipeRight",this,function(){});this.popupInfoView.startup()},_updateUI:function(){var c="\x26nbsp;",a="\x26nbsp;",f=this.selectedIndex,d=this.features,l=this.deferreds,b=this._prevFeatureButton.parentNode,p=this._nextFeatureButton.parentNode,q=this._spinner,s=this._nls;d&&1<=d.length?(c=d[f].getTitle(),a=f+1+" of "+d.length,h.remove(this._arrowButton,"hidden"),0===f?(h.add(b,"hidden"),h.add(this._prev,"hidden")):(h.remove(b,"hidden"),h.remove(this._prev,"hidden")),f===d.length-1?(h.add(p,"hidden"),
h.add(this._next,"hidden")):(h.remove(p,"hidden"),h.remove(this._next,"hidden"))):(h.add(this._arrowButton,"hidden"),h.add(b,"hidden"),h.add(p,"hidden"),h.add(this._prev,"hidden"),h.add(this._next,"hidden"));this.setTitle(c,a);this.popupNavigationBar.getItems()[1]._node.innerHTML=a;l&&l.length?(h.remove(q,"hidden"),this.setTitle(s.NLS_searching+"...","\x26nbsp;")):(h.add(q,"hidden"),(!d||!d.length)&&this.setTitle("No Information","\x26nbsp;"))}})})},"esri/dijit/InfoView":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry ../kernel ./_TouchBase".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s){return n(null,{declaredClass:"esri.dijit.InfoView",_items:[],_top:null,_sections:[],_isDecelerate:!1,constructor:function(a,h){var f;this.container=q.byId(h);this._touchBase=s(this.container,null);this._slideDiv=l.create("div",null,this.container,"first");this.events=[];this._items=a.items;a.sections&&(this._sections=a.sections);d.add(this.container,"esriMobileInfoView");if(0===this._sections.length)l.create("div",{},this._slideDiv);else for(f=0;f<this._sections.length;f++){var c=
l.create("div",{"class":"esriMobileInfoViewSection"},this._slideDiv);l.create("div",{innerHTML:this._sections[f].title},c)}for(f=0;f<this._items.length;f++){var b,c=0;this._items[f].section&&(c=this._items[f].section);switch(this._items[f].type){case "div":b=l.create("div",{"class":"esriMobileInfoViewItem",style:this._items[f].style},this._slideDiv.childNodes[c]),b=l.create("div",{innerHTML:this._items[f].text},b)}this._items[f].className&&d.add(b,this._items[f].className);b._index=f;b._item=this._items[f];
this._items[f]._node=b}this.startTouchY=0},startup:function(){this.onCreate(this._items);this._animateTo(0)},destroy:function(){g.forEach(this.events,e.disconnect);this._touchBase=null;k.query("img",this.container).forEach(function(a){a._index=null;a._item=null;l.destroy(a)});this._items=null;l.destroy(this._slideDiv);l.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},setPreventDefault:function(a){this._touchBase.setPreventDefault(a)},enableTouchScroll:function(){this._touchBase.setPreventDefault(!0);
this.events.push(e.connect(this._touchBase,"onTouchStart",this,this._onTouchStartHandler));this.events.push(e.connect(this._touchBase,"onTouchMove",this,this._onTouchMoveHandler));this.events.push(e.connect(this._touchBase,"onTouchEnd",this,this._onTouchEndHandler));this._slideDiv.style.webkitTransform="translate3d(0,"+this._top+"px, 0)"},disableTouchScroll:function(){e.disconnect(this.events.pop());e.disconnect(this.events.pop());e.disconnect(this.events.pop());this._touchBase.setPreventDefault(!1);
this._slideDiv.style.webkitTransform="translate3d(0, 0px, 0)"},animateTo:function(){this._slideDiv.style.WebkitTransitionDuration="0s";this._animateTo(0)},onSelect:function(a){},onUnSelect:function(a){},onCreate:function(a){},onClick:function(a){},onSwipeLeft:function(){},onSwipeRight:function(){},_onTouchStartHandler:function(a){this._slideDiv.style.WebkitTransitionDuration="0s";this._moveDirection=null;this._startTime=new Date;this.startTouchY=a.touches[0].clientY;this.contentStartOffsetY=this.contentOffsetY},
_onTouchMoveHandler:function(a){this._moveDirection||(Math.abs(a.curY)>Math.abs(a.curX)?this._moveDirection="vertical":this._moveDirection="horizontal");"horizontal"!==this._moveDirection&&"vertical"===this._moveDirection&&this._animateTo(a.touches[0].clientY-this.startTouchY+this.contentStartOffsetY)},_onTouchEndHandler:function(a){this._endTime=new Date;this._deltaMovement=a.curY;if("vertical"===this._moveDirection)this._shouldStartMomentum()?this._doMomentum():this._snapToBounds();else if("horizontal"===
this._moveDirection)if("left"===a.swipeDirection)this.onSwipeLeft();else if("right"===a.swipeDirection)this.onSwipeRight()},_shouldStartMomentum:function(){this._diff=this._endTime-this._startTime;this._velocity=this._deltaMovement/this._diff;return 0.2<Math.abs(this._velocity)&&200>this._diff?!0:!1},_doMomentum:function(){var a,d;a=p.getContentBox(this.container);var f=0>this._velocity?0.0010:-0.0010;d=-(this._velocity*this._velocity)/(2*f);var c=-this._velocity/f,f=3*0.6-0,h=1-f,l=0,b=0;if(a.h>
this._slideDiv.scrollHeight)this.contentOffsetY=0,b=300;else if(0<this.contentOffsetY+d){a=0;for(d=Math.floor(c/20);a<d;a++)if(l=(h*20*a^3)+(f*20*a^2)+0*20*a+0,l=0>this._velocity?-l:l,0<this.contentOffsetY+l){b=20*a;break}0===b&&(b=300);this.contentOffsetY=0}else if(Math.abs(this.contentOffsetY+d)+a.h>this._slideDiv.scrollHeight){this.contentOffsetY=a.h-this._slideDiv.scrollHeight;a=0;for(d=Math.floor(c/20);a<d;a++)if(l=(h*20*a^3)+(f*20*a^2)+0*20*a+0,l=0>this._velocity?-l:l,Math.abs(this.contentOffsetY+
l)>this._slideDiv.scrollHeight){b=20*a;break}}else b=c,this.contentOffsetY+=d;this._slideDiv.style.webkitTransition="-webkit-transform "+b+"ms cubic-bezier(0, 0.3, 0.6, 1)";this._animateTo(this.contentOffsetY)},_snapToBounds:function(){var a=p.getContentBox(this.container);a.h>this._slideDiv.scrollHeight?this.contentOffsetY=0:0<this.contentOffsetY?this.contentOffsetY=0:Math.abs(this.contentOffsetY)+a.h>this._slideDiv.scrollHeight&&(this.contentOffsetY=a.h-this._slideDiv.scrollHeight);this._slideDiv.style.WebkitTransitionDuration=
"0.5s";this._animateTo(this.contentOffsetY)},_animateTo:function(a){this.contentOffsetY=a;this._slideDiv.style.webkitTransform="translate3d(0, "+a+"px, 0)"},_stopMomentum:function(){if(this._isDecelerating()){var a=document.defaultView.getComputedStyle(this._slideDiv,null),a=new WebKitCSSMatrix(a.webkitTransform);this._slideDiv.style.webkitTransition="";this.animateTo(a.m42)}},_isDecelerating:function(){return this.isDecelerate?!0:!1},_toggleNode:function(a,d){"ON"===d.toggleState?(d.toggleState=
"OFF",d.src&&(a.src=d.src.toString()),this.onUnSelect(d)):(d.toggleState="ON",d.srcAlt&&(a.src=d.srcAlt),this.onSelect(d))}})})},"esri/dijit/_TouchBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/dom dojo/has ../kernel".split(" "),function(n,b,g,e,k,m){return n(null,{declaredClass:"esri.dijit._TouchBase",_preventDefault:!0,_swipeThreshold:20,constructor:function(a,b){this.domNode=e.byId(a);this.events=[g.connect(this.domNode,"touchstart",this,this._touchStartHandler),
g.connect(this.domNode,"touchmove",this,this._touchMoveHandler),g.connect(this.domNode,"touchend",this,this._touchEndHandler),g.connect(this.domNode,"onclick",this,this._clickHandler)]},setPreventDefault:function(a){this._preventDefault=a},disableOnClick:function(){g.disconnect(this.events.pop())},_clickHandler:function(a){if(this._moved)a.preventDefault();else this.onclick(a)},_touchStartHandler:function(a){this._moved=!1;this.client_x=a.targetTouches[0].clientX;this.client_y=a.targetTouches[0].clientY;
this.down_x=a.targetTouches[0].pageX;this.down_y=a.targetTouches[0].pageY;a.downX=this.down_x;a.downY=this.down_y;this.onTouchStart(a)},_touchMoveHandler:function(a){this._preventDefault&&a.preventDefault();this._moved=!0;this.up_x=a.targetTouches[0].pageX;this.cur_x=a.targetTouches[0].pageX-this.down_x;this.cur_y=a.targetTouches[0].pageY-this.down_y;a.curX=this.cur_x;a.curY=this.cur_y;this.onTouchMove(a)},_touchEndHandler:function(a){this._moved?(a.curX=this.cur_x,a.curY=this.cur_y,this.down_x-this.up_x>
this._swipeThreshold?a.swipeDirection="left":this.up_x-this.down_x>this._swipeThreshold&&(a.swipeDirection="right")):(a.clientX=this.client_x,a.clientY=this.client_y);this.onTouchEnd(a)},onTouchStart:function(a){},onTouchMove:function(a){},onTouchEnd:function(a){},onclick:function(a){}})})},"esri/dijit/NavigationBar":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct ./_TouchBase ../kernel".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h){return n(null,{declaredClass:"esri.dijit.NavigationBar",_items:[],constructor:function(a,h){var b;this.container=q.byId(h);this._touchBase=p(this.container,null);this._slideDiv=l.create("div",{},this.container,"first");this.events=[g.connect(this._touchBase,"onclick",this,this._onClickHandler)];this._items=a.items;d.add(this.container,"esriMobileNavigationBar");var f=l.create("div",{},this._slideDiv);for(b=0;b<this._items.length;b++){var c,k;switch(this._items[b].type){case "img":k=
l.create("div",{"class":"esriMobileNavigationItem"},f);c=l.create("img",{src:this._items[b].src.toString(),style:{width:"100%",height:"100%"}},k);break;case "span":k=l.create("div",{"class":"esriMobileNavigationItem"},f);c=l.create("span",{innerHTML:this._items[b].text},k);break;case "div":k=l.create("div",{"class":"esriMobileNavigationInfoPanel"},f),c=l.create("div",{innerHTML:this._items[b].text},k)}d.add(k,this._items[b].position);this._items[b].className&&d.add(c,this._items[b].className);c._index=
b;c._item=this._items[b];this._items[b]._node=c}},startup:function(){this.onCreate(this._items)},destroy:function(){e.forEach(this.events,g.disconnect);this._touchBase=null;k.query("img",this.container).forEach(function(a){a._index=null;a._item=null;l.destroy(a)});this._items=null;l.destroy(this._slideDiv);l.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},select:function(a){this._markSelected(a._node,a)},onSelect:function(a){},onUnSelect:function(a){},
onCreate:function(a){},_onClickHandler:function(a){if("img"===a.target.tagName.toLowerCase()){var d=a.target,h=d._item;k.query("img",this.container).forEach(function(a){a!==d&&a._item.toggleGroup===h.toggleGroup&&this._markUnSelected(a,a._item)},this);this._toggleNode(d,h)}},_toggleNode:function(a,d){"ON"===d.toggleState?(d.toggleState="OFF",d.src&&(a.src=d.src.toString()),this.onUnSelect(d)):(d.toggleState="ON",d.srcAlt&&(a.src=d.srcAlt),this.onSelect(d))},_markSelected:function(a,d){d.toggleState=
"ON";d.srcAlt&&(a.src=d.srcAlt);this.onSelect(d)},_markUnSelected:function(a,d){"ON"===d.toggleState&&(d.toggleState="OFF",d.src&&(a.src=d.src.toString()),this.onUnSelect(d))}})})},"jimu/dijit/LoadingShelter":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/LoadingShelter.html","dojo/_base/html"],function(n,b,g,e,k){return n([b,g],{baseClass:"jimu-loading-shelter",declaredClass:"jimu.dijit.LoadingShelter",templateString:e,loadingText:null,
hidden:!1,postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&k.setStyle(this.domNode,"display","none");k.setStyle(this.domNode,{width:"100%",height:"100%"});this.loadingImg.src=require.toUrl("jimu")+"/images/loading.gif";"string"===typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(b){this.domNode&&this.hidden&&("string"===typeof b&&(this.textNode.innerHTML=b),k.setStyle(this.domNode,"display",
"block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(k.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"jimu/PreloadWidgetIcon":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dijit/_WidgetBase ./utils".split(" "),function(n,b,g,e,k,m){return n(k,{"class":"jimu-preload-widget-icon",postCreate:function(){this.inherited(arguments);this.iconNode=g.create("img",{src:this.widgetConfig.icon},this.domNode);g.setAttr(this.domNode,"title",this.widgetConfig.label);
this.own(e(this.domNode,"click",b.hitch(this,function(){this.onClick()})));this.position=b.clone(this.widgetConfig.position);"map"===this.widgetConfig.panel.positionRelativeTo&&this.own(e(this.map,"resize",b.hitch(this,function(){var a=b.clone(this.position);delete a.width;delete a.height;if(this.panel)this.panel.onPositionChange(a)})));this.state="closed"},startup:function(){this.inherited(arguments)},onClick:function(){"closed"===this.state?this.switchToOpen():this.switchToClose()},moveTo:function(a){var q=
{left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"},q=b.mixin(q,m.getPositionStyle(a));delete q.width;delete q.height;g.setStyle(this.domNode,q);this.position=b.clone(a);this.widgetConfig&&this.widgetConfig.panel&&(this.widgetConfig.panel.position=b.clone(a),this.widgetConfig.position=b.clone(a));if(this.panel)this.panel.onPositionChange(b.clone(a))},destroy:function(){this.panel&&this.panelManager.destroyPanel(this.panel);this.inherited(arguments)},switchToOpen:function(){this.state=
"opened";g.addClass(this.domNode,"jimu-state-selected");this.panelManager.showPanel(b.clone(this.widgetConfig)).then(b.hitch(this,function(a){this.panel=a;this.own(e(a,"close",b.hitch(this,function(){this.switchToClose()})))}))},switchToClose:function(){this.state="closed";g.removeClass(this.domNode,"jimu-state-selected");this.panelManager.closePanel(this.panel)},getIconPanelPosition:function(){var a={},b,d;b="map"===this.widgetConfig.panel.positionRelativeTo?jimuConfig.mapId:jimuConfig.layoutId;
d=g.getMarginBox(this.domNode);a.width=this.widgetConfig.panel.position.width?this.widgetConfig.panel.position.width:400;a.height=this.widgetConfig.panel.position.height?this.widgetConfig.panel.position.height:400;b=g.getContentBox(b);var l,p;a.top=d.t+d.h+2;a.top+a.height>b.h&&(l=d.t,p=b.h-d.t-d.h,p=Math.max(l,p),p===l&&(a.top=d.t-a.height-2));l=d.l;d=b.w-l-d.w;if(l>=a.width||d>=a.width)window.isRTL?a.right=b.w-d-a.width:a.left=l;return a}})})},"jimu/WidgetPlaceholder":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/html","dijit/_WidgetBase","./utils"],function(n,b,g,e,k){return n(e,{"class":"jimu-widget-placeholder",postCreate:function(){this.inherited(arguments);this.indexNode=g.create("div",{"class":"inner",innerHTML:this.index},this.domNode);g.setAttr(this.domNode,"title",window.jimuNls.widgetPlaceholderTooltip)},moveTo:function(e){var a={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"},a=b.mixin(a,k.getPositionStyle(e));delete a.width;delete a.height;
g.setStyle(this.domNode,a)},setIndex:function(b){this.index=b;this.indexNode.innerHTML=b}})})},"jimu/DataManager":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","./WidgetManager"],function(n,b,g,e){var k=null,m;m=n(null,{constructor:function(){g.subscribe("publishData",b.hitch(this,this.onDataPublished));g.subscribe("fetchData",b.hitch(this,this.onFetchData));g.subscribe("clearAllData",b.hitch(this,this.onClearAllData));g.subscribe("removeData",b.hitch(this,this.onRemoveData));
g.subscribe("clearDataHistory",b.hitch(this,this.onClearDataHistory));this.widgetManager=e.getInstance()},_dataStore:{},onDataPublished:function(a,b,d,l){"undefined"===typeof l&&(l=!1);this._dataStore[b]?(this._dataStore[b].current=d,l&&(this._dataStore[b].history?this._dataStore[b].history.push(d):this._dataStore[b].history=[d])):(this._dataStore[b]={current:d},l&&(this._dataStore[b].history=[d]))},onFetchData:function(a){var b;if(a)(b=this.widgetManager.getWidgetById(a))?this._dataStore[a]?g.publish("dataFetched",
b.name,a,this._dataStore[a].current,this._dataStore[a].history):g.publish("noData",b.name,a):g.publish("noData",void 0,a);else for(var d in this._dataStore)b=this.widgetManager.getWidgetById(d),g.publish("dataFetched",b.name,d,this._dataStore[d].current,this._dataStore[d].history)},onClearAllData:function(){this._dataStore={};g.publish("allDataCleared")},onRemoveData:function(a){delete this._dataStore[a];g.publish("dataRemoved",a)},onClearDataHistory:function(a){this._dataStore[a]&&(this._dataStore[a].history=
[]);g.publish("dataHistoryCleared",a)}});m.getInstance=function(){null===k&&(k=new m);return k};return m})},"jimu/BaseWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(n,b,g,e,k,m){return n([k,m],{type:"widget",id:void 0,label:void 0,icon:void 0,uri:void 0,position:{},config:void 0,openAtStart:!1,map:null,appConfig:null,folderUrl:null,state:"closed",windowState:"normal",started:!1,name:"",baseClass:null,
templateString:"\x3cdiv\x3e\x3c/div\x3e",constructor:function(){this.listenWidgetNames=[];this.listenWidgetIds=[];this.own(e.subscribe("publishData",b.hitch(this,this._onReceiveData)));this.own(e.subscribe("dataFetched",b.hitch(this,this._onReceiveData)));this.own(e.subscribe("noData",b.hitch(this,this._onNoData)))},onOpen:function(){},onClose:function(){},onNormalize:function(){},onMinimize:function(){},onMaximize:function(){},onSignIn:function(a){},onSignOut:function(){},onPositionChange:function(a){this.position=
a},setMap:function(a){this.map=a},setState:function(a){this.state=a},setWindowState:function(a){this.windowState=a},resize:function(){},onConfigChanged:function(a){},onAppConfigChanged:function(a,b,d){},onAction:function(a,b){},publishData:function(a,b){"undefined"===typeof b&&(b=!1);e.publish("publishData",this.name,this.id,a,b)},fetchData:function(a){a?e.publish("fetchData",a):0!==this.listenWidgetIds.length?g.forEach(this.listenWidgetIds,function(a){e.publish("fetchData",a)},this):e.publish("fetchData")},
fetchDataByName:function(a){a=this.widgetManager.getWidgetsByName(a);g.forEach(a,function(a){this.fetchData(a.id)},this)},_onReceiveData:function(a,b,d,l){if(b!==this.id&&!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(b)))this.onReceiveData(a,b,d,l)},onReceiveData:function(a,b,d,l){},_onNoData:function(a,b){if(!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(b)))this.onNoData(a,b)},onNoData:function(a,b){}})})},"jimu/BaseWidgetFrame":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/html","dijit/_WidgetBase"],function(n,b,g,e){return n([e],{widget:null,baseClass:"jimu-widget-frame jimu-container",postCreate:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.widget&&this.setWidget(this.widget)},startup:function(){this.inherited(arguments);this.widget&&this.widget.startup()},resize:function(){this.widget&&("opened"===this.widget.state&&b.isFunction(this.widget.resize))&&this.widget.resize()},setLoading:function(b){this.loading=
b;this.loading.placeAt(this.containerNode)},getWidget:function(){return this.widget},setWidget:function(b){this.widget=b;this.loading&&this.loading.destroy();g.place(b.domNode,this.containerNode);this.resize()},destroy:function(){if(this.widget&&this.widget.domNode)try{this.widget.destroy()}catch(b){console.error("destroy widget error. widget: ["+this.widget.uri+"], "+b.stack)}this.loading&&this.loading.domNode&&this.loading.destroy()}})})},"jimu/BaseWidgetPanel":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dijit/_Container ./dijit/LoadingIndicator ./BaseWidgetFrame".split(" "),
function(n,b,g,e,k,m,a){return n([e,k],{baseClass:"jimu-widget-panel jimu-container",started:!1,state:"closed",windowState:"normal",defaultState:"normal",type:"panel",constructor:function(){},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this.loadAllWidgetsInOrder();this.started=!0},loadAllWidgetsInOrder:function(){var a=this.getAllWidgetConfigs(),a=Array.isArray(this.config.widgets)?this.config.widgets:[this.config];g.forEach(a,function(a){var l,p;
!1!==a.visible&&(p=new m,l=this.createFrame(a),this.addChild(l),l.setLoading(p),this.widgetManager.loadWidget(a).then(b.hitch(this,function(a){l.setWidget(a);a.startup()})))},this)},getAllWidgetConfigs:function(){var a=[];return a=Array.isArray(this.config.widgets)?this.config.widgets:[this.config]},getWidgetById:function(a){for(var d=this.getChildren(),l=0;l<d.length;l++)if(d[l].getWidget()&&d[l].getWidget().id===a)return d[l].getWidget()},createFrame:function(b){return new a},setState:function(a){this.state=
a},setWindowState:function(a){this.windowState=a},resize:function(){this.getChildren().forEach(function(a){a.resize()})},onPositionChange:function(a){this.position=a},onOpen:function(){g.forEach(this.getChildren(),function(a){a.getWidget()&&this.widgetManager.openWidget(a.getWidget())},this)},onClose:function(){g.forEach(this.getChildren(),function(a){a.getWidget()&&this.widgetManager.closeWidget(a.getWidget())},this)},onMaximize:function(){g.forEach(this.getChildren(),function(a){a.getWidget()&&
this.widgetManager.maximizeWidget(a.getWidget())},this)},onMinimize:function(){g.forEach(this.getChildren(),function(a){a.getWidget()&&this.widgetManager.minimizeWidget(a.getWidget())},this)},onNormalize:function(){g.forEach(this.getChildren(),function(a){a.getWidget()&&this.widgetManager.normalizeWidget(a.getWidget())},this)},updateConfig:function(a){this._updateConfig(a)},reloadWidget:function(a){this.isWidgetInPanel(a)&&(this._updateConfig(a),this.getChildren().forEach(function(d){d.getWidget()&&
d.getWidget().id===a.id&&(d.getWidget().destroy(),d.setLoading(new m),this.widgetManager.loadWidget(a).then(b.hitch(this,function(a){d.setWidget(a);a.startup();"closed"===this.state&&this.widgetManager.closeWidget(a)})))},this))},isWidgetInPanel:function(a){return g.some(this.getAllWidgetConfigs(),function(d){if(a.id===d.id)return!0})?!0:!1},_updateConfig:function(a){if(Array.isArray(this.config.widgets)){for(var d=-1,l=0;l<this.config.widgets.length;l++)this.config.widgets[l].id===a.id&&(d=l);0<
d&&(this.config.widgets[d]=a)}else this.config=a},destroy:function(){this.getChildren().forEach(function(a){try{a.domNode&&a.destroy()}catch(d){console.error("destroy widget frame error."+d.stack)}});this.inherited(arguments)}})})},"jimu/dijit/LoadingIndicator":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/dom-style","dojo/dom-construct"],function(n,b,g,e){return n(b,{baseClass:"jimu-loading-indicator",declaredClass:"jimu.dijit.LoadingIndicator",hidden:!1,postCreate:function(){this.inherited(arguments);
(this.hidden=!0===this.hidden)&&g.set(this.domNode,{display:"none"});g.set(this.domNode,{width:"100%",height:"100%"});var b='\x3cimg class\x3d"jimu-loading" src\x3d"'+require.toUrl("jimu")+'/images/loading.gif"\x3e';e.place(b,this.domNode)},show:function(){this.domNode&&g.set(this.domNode,"display","block")},hide:function(){this.domNode&&g.set(this.domNode,"display","none")}})})},"jimu/BaseWidgetSetting":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on","dijit/_WidgetBase","dijit/_TemplatedMixin"],
function(n,b,g,e,k){return n([e,k],{templateString:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.own(g(window,"resize",b.hitch(this,this._onWindowResize)))},getConfig:function(){},resize:function(){},_onWindowResize:function(){this.resize()}})})},"jimu/symbolUtils":function(){define(["dojo/_base/lang","dojo/_base/html","dojox/gfx","esri/symbols/jsonUtils"],function(n,b,g,e){return{cloneSymbol:function(b){if(!b)return null;var g=null;try{var a=b.toJson(),g=e.fromJson(a)}catch(q){console.error(q)}return g},
getDefaultMarkerSymbol:function(){return e.fromJson({style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",outline:{color:[0,0,128,255],width:1},type:"esriSMS",size:18})},getDefaultLineSymbol:function(){return e.fromJson({tags:["solid"],title:"Blue Thin",style:"esriSLSSolid",color:[79,129,189,255],width:3,name:"Blue 1",type:"esriSLS"})},getDefaultFillSymbol:function(){return e.fromJson({tags:["opaque"],title:"Blue",style:"esriSFSSolid",color:[79,129,189,255],name:"Blue 6",type:"esriSFS",outline:{style:"esriSLSSolid",
color:[54,93,141,255],width:1.5,type:"esriSLS"}})},getHightlightMarkerSymbol:function(){return e.fromJson({color:[255,255,255,128],size:18,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"}})},getHightlightLineSymbol:function(){return e.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"})},getHightlightFillSymbol:function(){return e.fromJson({color:[255,255,255,128],outline:{color:[0,
255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"})},createSymbolNode:function(k,m){var a=32,q=32,d=b.create("div",{},document.body);b.setStyle(d,"display","inline-block");if(m)a=m.width,q=m.height;else if(a=80,q=30,this.isSimpleMarkerSymbol(k))q=a=Math.min(k.size+12,125);else if(this.isPictureMarkerSymbol(k)){if(!k.url||"http://"===k.url||-1===k.url.indexOf("http://")&&-1===k.url.indexOf("https://")&&-1===k.url.indexOf("data:"))return;q=a=Math.min(Math.max(k.width,
k.height),125)}else if(this.isSimpleLineSymbol(k)||this.isCartographicLineSymbol(k))a=190,q=20;var l=g.createSurface(d,a,q);if("vml"===g.renderer){var p=l.getEventSource();b.setStyle(p,"position","relative");b.setStyle(p.parentNode,"position","relative")}var p=null,p=m?e.getShapeDescriptors(k):this.isSimpleLineSymbol(k)||this.isCartographicLineSymbol(k)?this._getLineShapeDesc(k):e.getShapeDescriptors(k),h;try{h=l.createShape(p.defaultShape),p.fill&&h.setFill(p.fill),p.stroke&&h.setStroke(p.stroke)}catch(s){l.clear();
l.destroy();return}var l=l.getDimensions(),l={dx:l.width/2,dy:l.height/2},r=h.getBoundingBox(),p=r.width,r=r.height;if(p>a||r>q)a=((a<q?a:q)-5)/(p>r?p:r),n.mixin(l,{xx:a,yy:a});h.applyTransform(l);return d},_getLineShapeDesc:function(b){var e=null;if(this.isSimpleLineSymbol(b)||this.isCartographicLineSymbol(b))e={defaultShape:{type:"path",path:"M -90,0 L 90,0 E"},fill:null,stroke:b.getStroke()};return e},isSimpleMarkerSymbol:function(b){return b&&"esri.symbol.SimpleMarkerSymbol"===b.declaredClass},
isPictureMarkerSymbol:function(b){return b&&"esri.symbol.PictureMarkerSymbol"===b.declaredClass},isSimpleLineSymbol:function(b){return b&&"esri.symbol.SimpleLineSymbol"===b.declaredClass},isCartographicLineSymbol:function(b){return b&&"esri.symbol.CartographicLineSymbol"===b.declaredClass},isSimpleFillSymbol:function(b){return b&&"esri.symbol.SimpleFillSymbol"===b.declaredClass},isPictureFillSymbol:function(b){return b&&"esri.symbol.PictureFillSymbol"===b.declaredClass},isTextSymbol:function(b){return b&&
"esri.symbol.TextSymbol"===b.declaredClass}}})},"jimu/filterUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/date/locale esri/lang dojo/data/ItemFileWriteStore".split(" "),function(n,b,g,e,k,m){return n([],{_stringFieldType:"esriFieldTypeString",_dateFieldType:"esriFieldTypeDate",_numberFieldTypes:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],_supportFieldTypes:[],dayInMS:86399E3,fieldsStore:null,isHosted:!1,constructor:function(){String.prototype.startsWith=
function(a){return 0===this.indexOf(a)};String.prototype.endsWith=function(a){return this.substring(this.length-a.length)===a};String.prototype.count=function(a){return this.split(a).length-1};String.prototype.trim||(String.prototype.trim=b.trim);this._supportFieldTypes=[];this._supportFieldTypes.push(this._stringFieldType);this._supportFieldTypes.push(this._dateFieldType);this._supportFieldTypes=this._supportFieldTypes.concat(this._numberFieldTypes)},OPERATORS:{stringOperatorIs:"stringOperatorIs",
stringOperatorIsNot:"stringOperatorIsNot",stringOperatorStartsWith:"stringOperatorStartsWith",stringOperatorEndsWith:"stringOperatorEndsWith",stringOperatorContains:"stringOperatorContains",stringOperatorDoesNotContain:"stringOperatorDoesNotContain",stringOperatorIsBlank:"stringOperatorIsBlank",stringOperatorIsNotBlank:"stringOperatorIsNotBlank",numberOperatorIs:"numberOperatorIs",numberOperatorIsNot:"numberOperatorIsNot",numberOperatorIsAtLeast:"numberOperatorIsAtLeast",numberOperatorIsLessThan:"numberOperatorIsLessThan",
numberOperatorIsAtMost:"numberOperatorIsAtMost",numberOperatorIsGreaterThan:"numberOperatorIsGreaterThan",numberOperatorIsBetween:"numberOperatorIsBetween",numberOperatorIsNotBetween:"numberOperatorIsNotBetween",numberOperatorIsBlank:"numberOperatorIsBlank",numberOperatorIsNotBlank:"numberOperatorIsNotBlank",dateOperatorIsOn:"dateOperatorIsOn",dateOperatorIsNotOn:"dateOperatorIsNotOn",dateOperatorIsBefore:"dateOperatorIsBefore",dateOperatorIsAfter:"dateOperatorIsAfter",dateOperatorIsBetween:"dateOperatorIsBetween",
dateOperatorIsNotBetween:"dateOperatorIsNotBetween",dateOperatorIsBlank:"dateOperatorIsBlank",dateOperatorIsNotBlank:"dateOperatorIsNotBlank",dateOperatorDays:"dateOperatorDays",dateOperatorWeeks:"dateOperatorWeeks",dateOperatorMonths:"dateOperatorMonths",dateOperatorInTheLast:"dateOperatorInTheLast",dateOperatorNotInTheLast:"dateOperatorNotInTheLast"},setFieldsStoreByFieldInfos:function(a){a=g.filter(a,b.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)}));a=g.map(a,function(a,
d){var l;switch(a.type){case "esriFieldTypeString":l="string";break;case "esriFieldTypeDate":l="date";break;default:l="number"}return{id:d,label:a.name,shortType:l,alias:a.alias,editable:a.editable,name:a.name,nullable:a.nullable,type:a.type}},this);this.fieldsStore=new m({data:{identifier:"id",label:"label",items:a}});return a.length},_validatePartsObj:function(a){return a&&"object"===typeof a},_isObject:function(a){return a&&"object"===typeof a},_isString:function(a){return a&&"string"===typeof a},
containsNonLatinCharacter:function(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1},getExprByFilterObj:function(a){var b="";if(0===a.parts.length)b="1\x3d1";else if(1===a.parts.length)b=this.builtFilterString(a.parts[0]);else for(var d="",l=0;l<a.parts.length;l++){var p=this.builtFilterString(a.parts[l]);if(!k.isDefined(p))return null;b+=d+"("+p+")";d=d||" "+a.logicalOperator+" "}return a.expr=b},builtFilterString:function(a){var b="";if(a.parts)for(var d="",l=0;l<a.parts.length;l++){var p=
a.parts[l],h=this.builtSingleFilterString(p);p.expr=h.whereClause;if(!k.isDefined(h.whereClause))return null;b+=d+h.whereClause;d=" "+a.logicalOperator+" "}else b=this.builtSingleFilterString(a).whereClause;return a.expr=b},builtSingleFilterString:function(a,b){this.isHosted&&(a.caseSensitive=!1);if(k.isDefined(a.valueObj.isValid)&&!a.valueObj.isValid)return{whereClause:null};var d=a.valueObj.value,l=a.valueObj.value1,p=a.valueObj.value2,h=!1;if(a.interactiveObj){if(!a.interactiveObj.prompt||!a.interactiveObj.hint)return{whereClause:null};
k.isDefined(b)&&(h=!0,k.isDefined(a.valueObj.value)&&(d="{"+b+"}"),k.isDefined(a.valueObj.value1)&&(l="{"+b+"}"),k.isDefined(a.valueObj.value2)&&(p="{"+(b+1)+"}"))}var s="";if("string"===a.fieldObj.shortType)switch(l="",h&&this.isHosted?l="N":d&&"field"!==a.valueObj.type&&this.isHosted&&this.containsNonLatinCharacter(d)&&(l="N"),a.operator){case this.OPERATORS.stringOperatorIs:s="field"===a.valueObj.type?a.fieldObj.name+" \x3d "+d:a.fieldObj.name+" \x3d "+l+"'"+d.replace(/\'/g,"''")+"'";break;case this.OPERATORS.stringOperatorIsNot:s=
"field"===a.valueObj.type?a.fieldObj.name+" \x3c\x3e "+d:a.fieldObj.name+" \x3c\x3e "+l+"'"+d.replace(/\'/g,"''")+"'";break;case this.OPERATORS.stringOperatorStartsWith:s=a.caseSensitive?a.fieldObj.name+" LIKE "+l+"'"+d.replace(/\'/g,"''")+"%'":"UPPER("+a.fieldObj.name+") LIKE UPPER("+l+"'"+d.replace(/\'/g,"''")+"%')";break;case this.OPERATORS.stringOperatorEndsWith:s=a.caseSensitive?a.fieldObj.name+" LIKE "+l+"'%"+d.replace(/\'/g,"''")+"'":"UPPER("+a.fieldObj.name+") LIKE UPPER("+l+"'%"+d.replace(/\'/g,
"''")+"')";break;case this.OPERATORS.stringOperatorContains:s=a.caseSensitive?a.fieldObj.name+" LIKE "+l+"'%"+d.replace(/\'/g,"''")+"%'":"UPPER("+a.fieldObj.name+") LIKE UPPER("+l+"'%"+d.replace(/\'/g,"''")+"%')";break;case this.OPERATORS.stringOperatorDoesNotContain:s=a.caseSensitive?a.fieldObj.name+" NOT LIKE "+l+"'%"+d.replace(/\'/g,"''")+"%'":"UPPER("+a.fieldObj.name+") NOT LIKE UPPER("+l+"'%"+d.replace(/\'/g,"''")+"%')";break;case this.OPERATORS.stringOperatorIsBlank:s=a.fieldObj.name+" IS NULL";
break;case this.OPERATORS.stringOperatorIsNotBlank:s=a.fieldObj.name+" IS NOT NULL"}else if("number"===a.fieldObj.shortType)switch(a.operator){case this.OPERATORS.numberOperatorIs:s=a.fieldObj.name+" \x3d "+d;break;case this.OPERATORS.numberOperatorIsNot:s=a.fieldObj.name+" \x3c\x3e "+d;break;case this.OPERATORS.numberOperatorIsAtLeast:s=a.fieldObj.name+" \x3e\x3d "+d;break;case this.OPERATORS.numberOperatorIsLessThan:s=a.fieldObj.name+" \x3c "+d;break;case this.OPERATORS.numberOperatorIsAtMost:s=
a.fieldObj.name+" \x3c\x3d "+d;break;case this.OPERATORS.numberOperatorIsGreaterThan:s=a.fieldObj.name+" \x3e "+d;break;case this.OPERATORS.numberOperatorIsBetween:s=a.fieldObj.name+" BETWEEN "+l+" AND "+p;break;case this.OPERATORS.numberOperatorIsNotBetween:s=a.fieldObj.name+" NOT BETWEEN "+l+" AND "+p;break;case this.OPERATORS.numberOperatorIsBlank:s=a.fieldObj.name+" IS NULL";break;case this.OPERATORS.numberOperatorIsNotBlank:s=a.fieldObj.name+" IS NOT NULL"}else switch(k.isDefined(d)&&("field"!==
a.valueObj.type&&"string"===typeof d)&&(d=new Date(d)),"field"!==a.valueObj.type&&(d&&(d=new Date(d)),l&&(l=new Date(l)),p&&(p=new Date(p))),a.operator){case this.OPERATORS.dateOperatorIsOn:s="field"===a.valueObj.type?a.fieldObj.name+" \x3d "+d:h?a.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+b+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(b+1)+"}'":a.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(d)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(d))+
"'";break;case this.OPERATORS.dateOperatorIsNotOn:s="field"===a.valueObj.type?a.fieldObj.name+" \x3c\x3e "+d:h?a.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+b+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(b+1)+"}'":a.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(d)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(d))+"'";break;case this.OPERATORS.dateOperatorIsBefore:s="field"===a.valueObj.type?a.fieldObj.name+" \x3c "+
d:a.fieldObj.name+" \x3c "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(d)+"'";break;case this.OPERATORS.dateOperatorIsAfter:s="field"===a.valueObj.type?a.fieldObj.name+" \x3e "+d:a.fieldObj.name+" \x3e "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(d))+"'";break;case this.OPERATORS.dateOperatorIsBetween:s=h?a.fieldObj.name+" BETWEEN '"+l+"' AND '"+p+"'":a.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(l)+"' AND "+(this.isHosted?"":"timestamp ")+
"'"+this.formatDate(this.addDay(p))+"'";break;case this.OPERATORS.dateOperatorIsNotBetween:s=h?a.fieldObj.name+" NOT BETWEEN '"+l+"' AND '"+p+"'":a.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(l)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(p))+"'";break;case this.OPERATORS.dateOperatorIsBlank:s=a.fieldObj.name+" IS NULL";break;case this.OPERATORS.dateOperatorIsNotBlank:s=a.fieldObj.name+" IS NOT NULL"}return{whereClause:s}},formatDate:function(a){var b=
e.format(a,{datePattern:"yyyy-MM-dd",selector:"date"});a=e.format(a,{selector:"time",timePattern:"HH:mm:ss"});return b+" "+a},addDay:function(a){return new Date(a.getTime()+this.dayInMS)},getFilterObjByExpr:function(a){if(a&&this.fieldsStore){var b=this.replaceStrings(a);a=b.defExpr;var d=this.findParts(a,"AND");1===d.parts.length&&(d=this.findParts(a,"OR"),1===d.parts.length&&(d.logicalOperator="AND"));g.forEach(d.parts,function(a){a.expr=a.expr.trim();if(a.expr.startsWith("(")&&-1<a.expr.search(/\)$/)){var d=
a.expr.substring(1,a.expr.length-1),h=d.indexOf("("),b=d.indexOf(")");if(-1===h&&-1===b||h<b)a.expr=d}d=this.findParts(a.expr,"AND");1===d.parts.length&&(d=this.findParts(a.expr,"OR"));1<d.parts.length&&(a.parts=d.parts,a.logicalOperator=d.logicalOperator)},this);this.parseExpr(d);this.reReplaceStrings(b,d);return d}},replaceStrings:function(a){for(var b=a,d=function(a,f,c){var h=-1,h=a.indexOf("'",c+1);return h===c+1?(h=a.indexOf("'",h+1),d(a,f,h)):c},l=[],p=a.indexOf("'");-1<p;){var h=p,p=a.indexOf("'",
p+1),s=0,p=d(a,h,p);"%"===a[h+1]&&h++;"%"===a[p-1]&&(p-=1,s++);var k=a.substring(h+1,p);"N"===a[h-1]&&(a=a.substring(0,h-1)+a.substring(h),h-=1,p-=1);!this.isDateString(k)&&-1===k.indexOf("{")?(l.push(k),a=a.substring(0,h+1)+"#"+(l.length-1)+"#"+a.substring(p),p=a.indexOf("'",a.lastIndexOf("#")+2+s)):p=a.indexOf("'",p+1+s)}return{origDefExpr:b,defExpr:a,savedStrings:l}},reReplaceStrings:function(a,q){var d=a.savedStrings;if(d.length&&d.length){var l=function(a,d){if("string"!==a.fieldObj.shortType)return!1;
var b=a.valueObj.value.indexOf("#"),l=a.valueObj.value.lastIndexOf("#");return k.isDefined(a.valueObj.value)&&-1<b?(a.valueObj.value=d[parseInt(a.valueObj.value.substring(b+1,l),10)].replace(/\'\'/g,"'"),this.builtSingleFilterString(a),!0):!1},l=b.hitch(this,l),p=!1;g.forEach(q.parts,function(a){if(a.parts){var b=!1;g.forEach(a.parts,function(a){b=l(a,d)||b});b&&(p=b,a.expr=this.builtFilterString(a))}else(p=l(a,d)||p)&&this.builtFilterString(a)},this);p&&(q.expr=null,this.getExprByFilterObj(q))}},
isDateString:function(a){return 19===a.length&&"-"===a.charAt(4)&&"-"===a.charAt(7)&&" "===a.charAt(10)&&":"===a.charAt(13)&&":"===a.charAt(16)?!0:!1},findParts:function(a,b){for(var d=a.toLowerCase(),l=" "+b.toLowerCase()+" ",p=[],h=0,s=d.indexOf(l);0<s;){var k=a.substring(h,s),e=k.toLowerCase(),f=k.count("("),c=k.count(")"),g=k.count("'");f!==c||1===g%2?s=d.indexOf(l,s+1):-1<e.indexOf(" between ")&&-1===e.indexOf(" and ")?s=d.indexOf(l,s+1):(p.push({expr:k}),h=s+l.length,s=d.indexOf(l,h))}p.push({expr:a.substring(h)});
for(d=p.length-1;0<=d;d--)!this.hasOperator(p[d].expr)&&0<d&&(p[d-1].expr+=" "+b+" "+p[d].expr,p.splice(d,1));return{expr:a,parts:p,logicalOperator:b}},hasOperator:function(a){a=a.toLowerCase();return-1<a.indexOf("{")&&-1<a.indexOf("}")||-1<a.indexOf(" \x3d ")||-1<a.indexOf(" \x3c ")||-1<a.indexOf(" \x3e ")||-1<a.indexOf(" \x3c\x3e ")||-1<a.indexOf(" \x3c\x3d ")||-1<a.indexOf(" \x3e\x3d ")||-1<a.indexOf(" like ")||-1<a.indexOf(" between ")||-1<a.indexOf(" date")||-1<a.indexOf(" is null")||-1<a.indexOf(" is not null")?
!0:!1},parseExpr:function(a){g.forEach(a.parts,function(a){a.parts?this.parseExpr(a):this.parseSingleExpr(a)},this)},_preParseSingleExpr:function(a){var k=null;try{if(k=b.clone(a),k.expr=k.expr.trim(),/^UPPER\((.*)\)(\s+|\s+NOT\s+)LIKE\s+UPPER\(N?'(.*)'\)$/i.test(k.expr)){var d=a="",l=k.expr.match(/^UPPER\((.*)\)\s+/i);if(l&&2<=l.length)a=l[1];else return null;var p=k.expr.match(/UPPER\(N?'(.*)'\)$/i);if(p&&2<=p.length)d="'"+p[1]+"'";else return null;k.expr=k.expr.replace(/^UPPER\((.*)\)\s+/i,a+" ");
k.expr=k.expr.replace(/UPPER\(N?'(.*)'\)$/i,d);k.caseSensitive=!1}else/^(.+)(\s+|\s+NOT\s+)LIKE\s+N?'(.*)'$/i.test(k.expr)&&(k.caseSensitive=!0)}catch(h){return console.log(h),null}k&&this.isHosted&&(k.caseSensitive=!1);return k},parseSingleExpr:function(a){var e=this._preParseSingleExpr(a);e&&(a=b.mixin(a,e));var e=a.expr.trim(),d=e.indexOf(" "),l=e.substring(0,d);a.fieldObj={name:l};a.valueObj={};this.getFieldItemByName({name:l},function(d){a.fieldObj.shortType=d.shortType[0];a.fieldObj.label=d.label[0]},
function(){a.error={msg:"unknown field name ("+l+")",code:1}});e=e.substring(d+1).trim();d=e.toLowerCase();d.startsWith("\x3d ")?(e="date"===a.fieldObj.shortType&&!this.isHosted?e.substring(12).trim():e.substring(2).trim(),this.storeValue(e,a),a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsOn:"string"===a.fieldObj.shortType?this.OPERATORS.stringOperatorIs:this.OPERATORS.numberOperatorIs):d.startsWith("\x3c ")?(e="date"===a.fieldObj.shortType&&!this.isHosted?e.substring(12).trim():
e.substring(2).trim(),this.storeValue(e,a),"date"===a.fieldObj.shortType?a.operator=this.OPERATORS.dateOperatorIsBefore:"number"===a.fieldObj.shortType?a.operator=this.OPERATORS.numberOperatorIsLessThan:a.error={msg:"operator ("+d+") not supported for string",code:3}):d.startsWith("\x3e ")?(e="date"===a.fieldObj.shortType&&!this.isHosted?e.substring(12).trim():e.substring(2).trim(),this.storeValue(e,a),"date"===a.fieldObj.shortType?a.operator=this.OPERATORS.dateOperatorIsAfter:"number"===a.fieldObj.shortType?
a.operator=this.OPERATORS.numberOperatorIsGreaterThan:a.error={msg:"operator ("+d+") not supported for string",code:3}):d.startsWith("\x3c\x3e ")?(e="date"===a.fieldObj.shortType&&!this.isHosted?e.substring(13).trim():e.substring(3).trim(),this.storeValue(e,a),a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotOn:"string"===a.fieldObj.shortType?this.OPERATORS.stringOperatorIsNot:this.OPERATORS.numberOperatorIsNot):d.startsWith("\x3c\x3d ")?(this.storeValue(e.substring(3).trim(),
a),a.operator=this.OPERATORS.numberOperatorIsAtMost):d.startsWith("\x3e\x3d ")?(this.storeValue(e.substring(3).trim(),a),a.operator=this.OPERATORS.numberOperatorIsAtLeast):d.startsWith("like ")?(e=e.substring(5).trim(),e.startsWith("N'")&&(e=e.substring(1,e.length)),e.startsWith("'%")&&e.endsWith("%'")?(this.storeValue(e.substring(2,e.length-2),a),a.operator=this.OPERATORS.stringOperatorContains):e.startsWith("'%")&&e.endsWith("'")?(this.storeValue(e.substring(2,e.length-1),a),a.operator=this.OPERATORS.stringOperatorEndsWith):
e.startsWith("'")&&e.endsWith("%'")?(this.storeValue(e.substring(1,e.length-2),a),a.operator=this.OPERATORS.stringOperatorStartsWith):a.error={msg:"value ("+d+") not supported for LIKE",code:3}):d.startsWith("not like ")?(e=e.substring(9).trim(),e.startsWith("N'")&&(e=e.substring(1,e.length)),e.startsWith("'%")&&e.endsWith("%'")?(this.storeValue(e.substring(2,e.length-2),a),a.operator=this.OPERATORS.stringOperatorDoesNotContain):a.error={msg:"value ("+d+") not supported for NOT LIKE",code:3}):d.startsWith("between ")?
(e="date"===a.fieldObj.shortType&&!this.isHosted?e.substring(18).trim():e.substring(8).trim(),d=e.toLowerCase().indexOf(" and "),-1<d?(this.storeValue1(e.substring(0,d).trim(),a),"date"===a.fieldObj.shortType&&!this.isHosted?this.storeValue2(e.substring(d+15).trim(),a):this.storeValue2(e.substring(d+5).trim(),a)):a.error={msg:"missing AND operator for BETWEEN",code:3},"date"===a.fieldObj.shortType?"string"===typeof a.valueObj.value1?a.operator=this.OPERATORS.dateOperatorIsBetween:1E3>Math.abs(this.subtractDay(a.valueObj.value2).getTime()-
a.valueObj.value1.getTime())?(a.valueObj.value=a.valueObj.value1,delete a.valueObj.value1,delete a.valueObj.value2,a.operator=this.OPERATORS.dateOperatorIsOn):a.operator=this.OPERATORS.dateOperatorIsBetween:"number"===a.fieldObj.shortType||"oid"===a.fieldObj.shortType?a.operator=this.OPERATORS.numberOperatorIsBetween:a.error={msg:"string field not supported for BETWEEN",code:3}):d.startsWith("not between ")?(e="date"===a.fieldObj.shortType&&!this.isHosted?e.substring(22).trim():e.substring(12).trim(),
d=e.toLowerCase().indexOf(" and "),-1<d?(this.storeValue1(e.substring(0,d).trim(),a),"date"===a.fieldObj.shortType&&!this.isHosted?this.storeValue2(e.substring(d+15).trim(),a):this.storeValue2(e.substring(d+5).trim(),a)):a.error={msg:"missing AND operator for NOT BETWEEN",code:3},"date"===a.fieldObj.shortType?"string"===typeof a.valueObj.value1?a.operator=this.OPERATORS.dateOperatorIsNotBetween:1E3>Math.abs(this.subtractDay(a.valueObj.value2).getTime()-a.valueObj.value1.getTime())?(a.valueObj.value=
a.valueObj.value1,delete a.valueObj.value1,delete a.valueObj.value2,a.operator=this.OPERATORS.dateOperatorIsNotOn):a.operator=this.OPERATORS.dateOperatorIsNotBetween:"number"===a.fieldObj.shortType||"oid"===a.fieldObj.shortType?a.operator=this.OPERATORS.numberOperatorIsNotBetween:a.error={msg:"string field not supported for NOT BETWEEN",code:3}):"is null"===d?(a.valueObj.value=null,a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsBlank:"string"===a.fieldObj.shortType?this.OPERATORS.stringOperatorIsBlank:
this.OPERATORS.numberOperatorIsBlank):"is not null"===d?(a.valueObj.value=null,a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotBlank:"string"===a.fieldObj.shortType?this.OPERATORS.stringOperatorIsNotBlank:this.OPERATORS.numberOperatorIsNotBlank):a.error={msg:"unknown operator ("+d+")",code:2};if(k.isDefined(a.valueObj.value)&&"string"===typeof a.valueObj.value&&a.valueObj.value.startsWith("{")&&a.valueObj.value.endsWith("}")||k.isDefined(a.valueObj.value1)&&"string"===typeof a.valueObj.value1&&
a.valueObj.value1.startsWith("{")&&a.valueObj.value1.endsWith("}"))a.isInteractive=!0},getFieldItemByName:function(a,e,d){this.fieldsStore.fetch({query:a,onComplete:b.hitch(this,function(a){a&&a.length?e(a[0]):d()})})},subtractDay:function(a){return new Date(a.getTime()-this.dayInMS)},storeValue:function(a,b){if(a.startsWith("{")&&a.endsWith("}"))b.valueObj.value=a;else if(a.startsWith("'{")&&a.endsWith("}'"))b.valueObj.value=a.substring(1,a.length-1);else if("date"===b.fieldObj.shortType)if(a.startsWith("'")&&
a.endsWith("'")){var d=a.substring(1,a.length-1);b.valueObj.value=this.parseDate(d)}else b.valueObj.value=a,b.valueObj.type="field";else"string"===b.fieldObj.shortType?(a.startsWith("#")||a.startsWith("%#"))&&(a.endsWith("#")||a.endsWith("#%"))?b.valueObj.value=a:a.startsWith("'")&&a.endsWith("'")?b.valueObj.value=a.substring(1,a.length-1).replace(/\'\'/g,"'"):(b.valueObj.value=a,b.valueObj.type="field",this.getFieldItemByName({name:a},function(a){b.valueObj.label=a.label[0]},function(){b.error={msg:"unknown field name ("+
a+")",code:1}})):(b.valueObj.value=a,isNaN(a)&&(b.valueObj.type="field",this.getFieldItemByName({name:a},function(a){b.valueObj.label=a.label[0]},function(){b.error={msg:"unknown field name ("+a+")",code:1}})))},storeValue1:function(a,b){if(a.startsWith("{")&&a.endsWith("}"))b.valueObj.value1=a;else if(a.startsWith("'{")&&a.endsWith("}'"))b.valueObj.value1=a.substring(1,a.length-1);else if("date"===b.fieldObj.shortType)if(a.startsWith("'")&&a.endsWith("'")){var d=a.substring(1,a.length-1);b.valueObj.value1=
this.parseDate(d)}else b.valueObj.value1=a,b.valueObj.type="field";else b.valueObj.value1=a,isNaN(a)&&(b.valueObj.type="field")},storeValue2:function(a,b){if(a.startsWith("{")&&a.endsWith("}"))b.valueObj.value2=a;else if(a.startsWith("'{")&&a.endsWith("}'"))b.valueObj.value2=a.substring(1,a.length-1);else if("date"===b.fieldObj.shortType)if(a.startsWith("'")&&a.endsWith("'")){var d=a.substring(1,a.length-1);b.valueObj.value2=this.parseDate(d)}else b.valueObj.value2=a,b.valueObj.type="field";else b.valueObj.value2=
a,isNaN(a)&&(b.valueObj.type="field")},parseDate:function(a){var b=e.parse(a,{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"});b||(b=e.parse(a.replace(" ",", "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}))||(b=e.parse(a.replace(" "," - "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}));return b}})})},"dojo/data/ItemFileWriteStore":function(){define("../_base/lang ../_base/declare ../_base/array ../_base/json ../_base/kernel ./ItemFileReadStore ../date/stamp".split(" "),function(n,b,g,
e,k,m,a){return b("dojo.data.ItemFileWriteStore",m,{constructor:function(b){this._features["dojo.data.api.Write"]=!0;this._features["dojo.data.api.Notification"]=!0;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};this._datatypeMap.Date.serialize||(this._datatypeMap.Date.serialize=function(d){return a.toISOString(d,{zulu:!0})});b&&!1===b.referenceIntegrity&&(this.referenceIntegrity=!1);this._saveInProgress=!1},referenceIntegrity:!0,_assert:function(a){if(!a)throw Error("assertion failed in ItemFileWriteStore");
},_getIdentifierAttribute:function(){return this.getFeatures()["dojo.data.api.Identity"]},newItem:function(a,d){this._assert(!this._saveInProgress);this._loadFinished||this._forceLoad();if("object"!=typeof a&&"undefined"!=typeof a)throw Error("newItem() was passed something other than an object");var b=null,p=this._getIdentifierAttribute();if(p===Number)b=this._arrayOfAllItems.length;else{b=a[p];if("undefined"===typeof b)throw Error("newItem() was not passed an identity for the new item");if(n.isArray(b))throw Error("newItem() was not passed an single-valued identity");
}this._itemsByIdentity&&this._assert("undefined"===typeof this._itemsByIdentity[b]);this._assert("undefined"===typeof this._pending._newItems[b]);this._assert("undefined"===typeof this._pending._deletedItems[b]);var h={};h[this._storeRefPropName]=this;h[this._itemNumPropName]=this._arrayOfAllItems.length;this._itemsByIdentity&&(this._itemsByIdentity[b]=h,h[p]=[b]);this._arrayOfAllItems.push(h);p=null;if(d&&d.parent&&d.attribute){var p={item:d.parent,attribute:d.attribute,oldValue:void 0},e=this.getValues(d.parent,
d.attribute);if(e&&0<e.length){var k=e.slice(0,e.length);p.oldValue=1===e.length?e[0]:e.slice(0,e.length);k.push(h);this._setValueOrValues(d.parent,d.attribute,k,!1);p.newValue=this.getValues(d.parent,d.attribute)}else this._setValueOrValues(d.parent,d.attribute,h,!1),p.newValue=h}else h[this._rootItemPropName]=!0,this._arrayOfTopLevelItems.push(h);this._pending._newItems[b]=h;for(var g in a){if(g===this._storeRefPropName||g===this._itemNumPropName)throw Error("encountered bug in ItemFileWriteStore.newItem");
b=a[g];n.isArray(b)||(b=[b]);h[g]=b;if(this.referenceIntegrity)for(e=0;e<b.length;e++)k=b[e],this.isItem(k)&&this._addReferenceToMap(k,h,g)}this.onNew(h,p);return h},_removeArrayElement:function(a,d){var b=g.indexOf(a,d);return-1!=b?(a.splice(b,1),!0):!1},deleteItem:function(a){this._assert(!this._saveInProgress);this._assertIsItem(a);var d=a[this._itemNumPropName],b=this.getIdentity(a);if(this.referenceIntegrity){var p=this.getAttributes(a);a[this._reverseRefMap]&&(a["backup_"+this._reverseRefMap]=
n.clone(a[this._reverseRefMap]));g.forEach(p,function(c){g.forEach(this.getValues(a,c),function(f){this.isItem(f)&&(a["backupRefs_"+this._reverseRefMap]||(a["backupRefs_"+this._reverseRefMap]=[]),a["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(f),attr:c}),this._removeReferenceFromMap(f,a,c))},this)},this);if(p=a[this._reverseRefMap])for(var h in p){var e=null;if(e=this._itemsByIdentity?this._itemsByIdentity[h]:this._arrayOfAllItems[h])for(var k in p[h]){var t=this.getValues(e,k)||[],
f=g.filter(t,function(c){return!(this.isItem(c)&&this.getIdentity(c)==b)},this);this._removeReferenceFromMap(a,e,k);f.length<t.length&&this._setValueOrValues(e,k,f,!0)}}}this._arrayOfAllItems[d]=null;a[this._storeRefPropName]=null;this._itemsByIdentity&&delete this._itemsByIdentity[b];this._pending._deletedItems[b]=a;a[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,a);this.onDelete(a);return!0},setValue:function(a,d,b){return this._setValueOrValues(a,d,b,!0)},setValues:function(a,
d,b){return this._setValueOrValues(a,d,b,!0)},unsetAttribute:function(a,d){return this._setValueOrValues(a,d,[],!0)},_setValueOrValues:function(a,d,b,p){this._assert(!this._saveInProgress);this._assertIsItem(a);this._assert(n.isString(d));this._assert("undefined"!==typeof b);var h=this._getIdentifierAttribute();if(d==h)throw Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");var h=this._getValueOrValues(a,d),e=this.getIdentity(a);if(!this._pending._modifiedItems[e]){var k=
{},t;for(t in a)k[t]=t===this._storeRefPropName||t===this._itemNumPropName||t===this._rootItemPropName?a[t]:t===this._reverseRefMap?n.clone(a[t]):a[t].slice(0,a[t].length);this._pending._modifiedItems[e]=k}e=!1;if(n.isArray(b)&&0===b.length){if(e=delete a[d],b=void 0,this.referenceIntegrity&&h){t=h;n.isArray(t)||(t=[t]);for(var f=0;f<t.length;f++)k=t[f],this.isItem(k)&&this._removeReferenceFromMap(k,a,d)}}else{e=n.isArray(b)?b.slice(0,b.length):[b];if(this.referenceIntegrity)if(h){t=h;n.isArray(t)||
(t=[t]);var c={};g.forEach(t,function(a){this.isItem(a)&&(a=this.getIdentity(a),c[a.toString()]=!0)},this);g.forEach(e,function(f){if(this.isItem(f)){var b=this.getIdentity(f);c[b.toString()]?delete c[b.toString()]:this._addReferenceToMap(f,a,d)}},this);for(f in c)this._removeReferenceFromMap(this._itemsByIdentity?this._itemsByIdentity[f]:this._arrayOfAllItems[f],a,d)}else for(f=0;f<e.length;f++)k=e[f],this.isItem(k)&&this._addReferenceToMap(k,a,d);a[d]=e;e=!0}if(p)this.onSet(a,d,h,b);return e},_addReferenceToMap:function(a,
d,b){d=this.getIdentity(d);var p=a[this._reverseRefMap];p||(p=a[this._reverseRefMap]={});(a=p[d])||(a=p[d]={});a[b]=!0},_removeReferenceFromMap:function(a,d,b){d=this.getIdentity(d);var p=a[this._reverseRefMap],h;if(p){for(h in p)h==d&&(delete p[h][b],this._isEmpty(p[h])&&delete p[h]);this._isEmpty(p)&&delete a[this._reverseRefMap]}},_dumpReferenceMap:function(){var a;for(a=0;a<this._arrayOfAllItems.length;a++){var d=this._arrayOfAllItems[a];d&&d[this._reverseRefMap]&&console.log("Item: ["+this.getIdentity(d)+
"] is referenced by: "+e.toJson(d[this._reverseRefMap]))}},_getValueOrValues:function(a,d){var b=void 0;this.hasAttribute(a,d)&&(b=this.getValues(a,d),b=1==b.length?b[0]:b);return b},_flatten:function(a){if(this.isItem(a))return{_reference:this.getIdentity(a)};if("object"===typeof a)for(var d in this._datatypeMap){var b=this._datatypeMap[d];if(n.isObject(b)&&!n.isFunction(b)){if(a instanceof b.type){if(!b.serialize)throw Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+d+"]");
return{_type:d,_value:b.serialize(a)}}}else if(a instanceof b)return{_type:d,_value:a.toString()}}return a},_getNewFileContentString:function(){var a={},d=this._getIdentifierAttribute();d!==Number&&(a.identifier=d);this._labelAttr&&(a.label=this._labelAttr);a.items=[];for(d=0;d<this._arrayOfAllItems.length;++d){var b=this._arrayOfAllItems[d];if(null!==b){var p={},h;for(h in b)if(h!==this._storeRefPropName&&h!==this._itemNumPropName&&h!==this._reverseRefMap&&h!==this._rootItemPropName){var k=this.getValues(b,
h);if(1==k.length)p[h]=this._flatten(k[0]);else for(var g=[],t=0;t<k.length;++t)g.push(this._flatten(k[t])),p[h]=g}a.items.push(p)}}return e.toJson(a,!0)},_isEmpty:function(a){var d=!0;if(n.isObject(a))for(var b in a){d=!1;break}else n.isArray(a)&&0<a.length&&(d=!1);return d},save:function(a){this._assert(!this._saveInProgress);this._saveInProgress=!0;var d=this,b=function(){d._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};d._saveInProgress=!1;a&&a.onComplete&&a.onComplete.call(a.scope||
k.global)},p=function(b){d._saveInProgress=!1;a&&a.onError&&a.onError.call(a.scope||k.global,b)};if(this._saveEverything){var h=this._getNewFileContentString();this._saveEverything(b,p,h)}this._saveCustom&&this._saveCustom(b,p);!this._saveEverything&&!this._saveCustom&&b()},revert:function(){this._assert(!this._saveInProgress);for(var a in this._pending._modifiedItems){var d=this._pending._modifiedItems[a],b=null,b=this._itemsByIdentity?this._itemsByIdentity[a]:this._arrayOfAllItems[a];d[this._storeRefPropName]=
this;for(var p in b)delete b[p];n.mixin(b,d)}var h;for(a in this._pending._deletedItems)h=this._pending._deletedItems[a],h[this._storeRefPropName]=this,d=h[this._itemNumPropName],h["backup_"+this._reverseRefMap]&&(h[this._reverseRefMap]=h["backup_"+this._reverseRefMap],delete h["backup_"+this._reverseRefMap]),this._arrayOfAllItems[d]=h,this._itemsByIdentity&&(this._itemsByIdentity[a]=h),h[this._rootItemPropName]&&this._arrayOfTopLevelItems.push(h);for(a in this._pending._deletedItems)h=this._pending._deletedItems[a],
h["backupRefs_"+this._reverseRefMap]&&(g.forEach(h["backupRefs_"+this._reverseRefMap],function(a){this._addReferenceToMap(this._itemsByIdentity?this._itemsByIdentity[a.id]:this._arrayOfAllItems[a.id],h,a.attr)},this),delete h["backupRefs_"+this._reverseRefMap]);for(a in this._pending._newItems)d=this._pending._newItems[a],d[this._storeRefPropName]=null,this._arrayOfAllItems[d[this._itemNumPropName]]=null,d[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,d),this._itemsByIdentity&&
delete this._itemsByIdentity[a];this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return!0},isDirty:function(a){return a?(a=this.getIdentity(a),(new Boolean(this._pending._newItems[a]||this._pending._modifiedItems[a]||this._pending._deletedItems[a])).valueOf()):!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)},onSet:function(a,d,b,p){},onNew:function(a,d){},onDelete:function(a){},close:function(a){if(this.clearOnClose){if(this.isDirty())throw Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");
this.inherited(arguments)}}})})},"dojo/data/ItemFileReadStore":function(){define("../_base/kernel ../_base/lang ../_base/declare ../_base/array ../_base/xhr ../Evented ./util/filter ./util/simpleFetch ../date/stamp".split(" "),function(n,b,g,e,k,m,a,q,d){g=g("dojo.data.ItemFileReadStore",[m],{constructor:function(a){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=!1;this.url=this._ccUrl=this._jsonFileUrl=a.url;this._jsonData=a.data;this.data=null;this._datatypeMap=a.typeMap||
{};this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(a){return d.fromISOString(a)}});this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=!1;this._queuedFetches=[];void 0!==a.urlPreventCache&&(this.urlPreventCache=a.urlPreventCache?!0:!1);void 0!==a.hierarchical&&(this.hierarchical=a.hierarchical?
!0:!1);a.clearOnClose&&(this.clearOnClose=!0);"failOk"in a&&(this.failOk=a.failOk?!0:!1)},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:!1,urlPreventCache:!1,failOk:!1,hierarchical:!0,_assertIsItem:function(a){if(!this.isItem(a))throw Error(this.declaredClass+": Invalid item argument.");},_assertIsAttribute:function(a){if("string"!==typeof a)throw Error(this.declaredClass+": Invalid attribute argument.");},getValue:function(a,d,b){a=this.getValues(a,d);return 0<a.length?a[0]:b},getValues:function(a,
d){this._assertIsItem(a);this._assertIsAttribute(d);return(a[d]||[]).slice(0)},getAttributes:function(a){this._assertIsItem(a);var d=[],b;for(b in a)b!==this._storeRefPropName&&(b!==this._itemNumPropName&&b!==this._rootItemPropName&&b!==this._reverseRefMap)&&d.push(b);return d},hasAttribute:function(a,d){this._assertIsItem(a);this._assertIsAttribute(d);return d in a},containsValue:function(d,b,h){var e=void 0;"string"===typeof h&&(e=a.patternToRegExp(h,!1));return this._containsValue(d,b,h,e)},_containsValue:function(a,
d,h,k){return e.some(this.getValues(a,d),function(a){if(null!==a&&!b.isObject(a)&&k){if(a.toString().match(k))return!0}else if(h===a)return!0})},isItem:function(a){return a&&a[this._storeRefPropName]===this&&this._arrayOfAllItems[a[this._itemNumPropName]]===a?!0:!1},isItemLoaded:function(a){return this.isItem(a)},loadItem:function(a){this._assertIsItem(a.item)},getFeatures:function(){return this._features},getLabel:function(a){if(this._labelAttr&&this.isItem(a))return this.getValue(a,this._labelAttr)},
getLabelAttributes:function(a){return this._labelAttr?[this._labelAttr]:null},filter:function(d,b,h){var e=[],k,g;if(d.query){var f;k=d.queryOptions?d.queryOptions.ignoreCase:!1;var c={};for(g in d.query)f=d.query[g],"string"===typeof f?c[g]=a.patternToRegExp(f,k):f instanceof RegExp&&(c[g]=f);for(k=0;k<b.length;++k){var m=!0,q=b[k];if(null===q)m=!1;else for(g in d.query)f=d.query[g],this._containsValue(q,g,f,c[g])||(m=!1);m&&e.push(q)}}else for(k=0;k<b.length;++k)g=b[k],null!==g&&e.push(g);h(e,d)},
_fetchItems:function(a,d,h){var e=this;if(this._loadFinished)this.filter(a,this._getItemsArray(a.queryOptions),d);else if(this._jsonFileUrl!==this._ccUrl?(n.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url),null!=this.data&&(this._jsonData=this.data,this.data=null),this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:a,
filter:b.hitch(e,"filter"),findCallback:b.hitch(e,d)});else{this._loadInProgress=!0;var g=k.get({url:e._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk});g.addCallback(function(c){try{e._getItemsFromLoadedData(c),e._loadFinished=!0,e._loadInProgress=!1,e.filter(a,e._getItemsArray(a.queryOptions),d),e._handleQueuedFetches()}catch(f){e._loadFinished=!0,e._loadInProgress=!1,h(f,a)}});g.addErrback(function(c){e._loadInProgress=!1;h(c,a)});var t=null;a.abort&&
(t=a.abort);a.abort=function(){g&&-1===g.fired&&g.cancel();t&&t.call(a)}}else if(this._jsonData)try{this._loadFinished=!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,e.filter(a,this._getItemsArray(a.queryOptions),d)}catch(f){h(f,a)}else h(Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),a)},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var a=0;a<this._queuedFetches.length;a++){var d=this._queuedFetches[a],
b=d.args,e=d.filter,d=d.findCallback;e?e(b,this._getItemsArray(b.queryOptions),d):this.fetchItemByIdentity(b)}this._queuedFetches=[]}},_getItemsArray:function(a){return a&&a.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(a){this.clearOnClose&&(this._loadFinished&&!this._loadInProgress)&&((""==this._jsonFileUrl||null==this._jsonFileUrl)&&(""==this.url||null==this.url)&&null==this.data&&console.debug(this.declaredClass+": WARNING!  Data reload  information has not been provided.  Please set 'url' or 'data' to the appropriate value before the next fetch"),
this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._itemsByIdentity=null,this._loadInProgress=!1,this._queuedFetches=[])},_getItemsFromLoadedData:function(a){function d(a){return null!==a&&"object"===typeof a&&(!b.isArray(a)||e)&&!b.isFunction(a)&&(a.constructor==Object||b.isArray(a))&&"undefined"===typeof a._reference&&"undefined"===typeof a._type&&"undefined"===typeof a._value&&k.hierarchical}function h(a){k._arrayOfAllItems.push(a);for(var c in a){var f=a[c];if(f)if(b.isArray(f))for(var l=
0;l<f.length;++l){var e=f[l];d(e)&&h(e)}else d(f)&&h(f)}}var e=!1,k=this;this._labelAttr=a.label;var g,f;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=a.items;for(g=0;g<this._arrayOfTopLevelItems.length;++g)f=this._arrayOfTopLevelItems[g],b.isArray(f)&&(e=!0),h(f),f[this._rootItemPropName]=!0;var c={},m;for(g=0;g<this._arrayOfAllItems.length;++g)for(m in f=this._arrayOfAllItems[g],f){if(m!==this._rootItemPropName){var q=f[m];null!==q?b.isArray(q)||(f[m]=[q]):f[m]=[null]}c[m]=m}for(;c[this._storeRefPropName];)this._storeRefPropName+=
"_";for(;c[this._itemNumPropName];)this._itemNumPropName+="_";for(;c[this._reverseRefMap];)this._reverseRefMap+="_";if(c=a.identifier){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=c;for(g=0;g<this._arrayOfAllItems.length;++g)if(f=this._arrayOfAllItems[g],a=f[c],a=a[0],Object.hasOwnProperty.call(this._itemsByIdentity,a)){if(this._jsonFileUrl)throw Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+
c+"].  Value collided: ["+a+"]");if(this._jsonData)throw Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+c+"].  Value collided: ["+a+"]");}else this._itemsByIdentity[a]=f}else this._features["dojo.data.api.Identity"]=Number;for(g=0;g<this._arrayOfAllItems.length;++g)f=this._arrayOfAllItems[g],f[this._storeRefPropName]=this,f[this._itemNumPropName]=g;for(g=0;g<this._arrayOfAllItems.length;++g)for(m in f=this._arrayOfAllItems[g],
f){a=f[m];for(c=0;c<a.length;++c)if(q=a[c],null!==q&&"object"==typeof q){if("_type"in q&&"_value"in q){var n=q._type,x=this._datatypeMap[n];if(x)if(b.isFunction(x))a[c]=new x(q._value);else if(b.isFunction(x.deserialize))a[c]=x.deserialize(q._value);else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+
n+"'");}if(q._reference){q=q._reference;if(b.isObject(q))for(n=0;n<this._arrayOfAllItems.length;++n){var x=this._arrayOfAllItems[n],B=!0,C;for(C in q)x[C]!=q[C]&&(B=!1);B&&(a[c]=x)}else a[c]=this._getItemByIdentity(q);this.referenceIntegrity&&(q=a[c],this.isItem(q)&&this._addReferenceToMap(q,f,m))}else this.isItem(q)&&this.referenceIntegrity&&this._addReferenceToMap(q,f,m)}}},_addReferenceToMap:function(a,d,b){},getIdentity:function(a){var d=this._features["dojo.data.api.Identity"];return d===Number?
a[this._itemNumPropName]:(a=a[d])?a[0]:null},fetchItemByIdentity:function(a){var d,b;if(this._loadFinished)d=this._getItemByIdentity(a.identity),a.onItem&&(b=a.scope?a.scope:n.global,a.onItem.call(b,d));else{var e=this;this._jsonFileUrl!==this._ccUrl?(n.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=
this.url);null!=this.data&&null==this._jsonData&&(this._jsonData=this.data,this.data=null);this._jsonFileUrl?this._loadInProgress?this._queuedFetches.push({args:a}):(this._loadInProgress=!0,b=k.get({url:e._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk}),b.addCallback(function(b){var h=a.scope?a.scope:n.global;try{e._getItemsFromLoadedData(b),e._loadFinished=!0,e._loadInProgress=!1,d=e._getItemByIdentity(a.identity),a.onItem&&a.onItem.call(h,d),e._handleQueuedFetches()}catch(f){e._loadInProgress=
!1,a.onError&&a.onError.call(h,f)}}),b.addErrback(function(d){e._loadInProgress=!1;a.onError&&a.onError.call(a.scope?a.scope:n.global,d)})):this._jsonData&&(e._getItemsFromLoadedData(e._jsonData),e._jsonData=null,e._loadFinished=!0,d=e._getItemByIdentity(a.identity),a.onItem&&(b=a.scope?a.scope:n.global,a.onItem.call(b,d)))}},_getItemByIdentity:function(a){var d=null;this._itemsByIdentity?Object.hasOwnProperty.call(this._itemsByIdentity,a)&&(d=this._itemsByIdentity[a]):Object.hasOwnProperty.call(this._arrayOfAllItems,
a)&&(d=this._arrayOfAllItems[a]);void 0===d&&(d=null);return d},getIdentityAttributes:function(a){a=this._features["dojo.data.api.Identity"];return a===Number?null:[a]},_forceLoad:function(){var a=this;this._jsonFileUrl!==this._ccUrl?(n.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url);null!=
this.data&&(this._jsonData=this.data,this.data=null);if(this._jsonFileUrl){var d=k.get({url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:!0});d.addCallback(function(d){try{if(!0!==a._loadInProgress&&!a._loadFinished)a._getItemsFromLoadedData(d),a._loadFinished=!0;else if(a._loadInProgress)throw Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}catch(b){throw console.log(b),b;}});d.addErrback(function(a){throw a;
})}else this._jsonData&&(a._getItemsFromLoadedData(a._jsonData),a._jsonData=null,a._loadFinished=!0)}});b.extend(g,q);return g})},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(n){var b={};n.setObject("dojo.data.util.filter",b);b.patternToRegExp=function(b,e){for(var k="^",m=null,a=0;a<b.length;a++)switch(m=b.charAt(a),m){case "\\":k+=m;a++;k+=b.charAt(a);break;case "*":k+=".*";break;case "?":k+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":k+=
"\\";default:k+=m}k+="$";return e?RegExp(k,"mi"):RegExp(k,"m")};return b})},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(n,b,g){var e={};n.setObject("dojo.data.util.simpleFetch",e);e.errorHandler=function(e,g){g.onError&&g.onError.call(g.scope||b.global,e,g)};e.fetchHandler=function(e,m){var a=m.abort||null,q=!1,d=m.start?m.start:0,l=m.count&&Infinity!==m.count?d+m.count:e.length;m.abort=function(){q=!0;a&&a.call(m)};var p=m.scope||b.global;
m.store||(m.store=this);m.onBegin&&m.onBegin.call(p,e.length,m);m.sort&&e.sort(g.createSortFunction(m.sort,this));if(m.onItem)for(var h=d;h<e.length&&h<l;++h){var s=e[h];q||m.onItem.call(p,s,m)}m.onComplete&&!q&&(h=null,m.onItem||(h=e.slice(d,l)),m.onComplete.call(p,h,m))};e.fetch=function(b){b=b||{};b.store||(b.store=this);this._fetchItems(b,n.hitch(this,"fetchHandler"),n.hitch(this,"errorHandler"));return b};return e})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(n){var b=
{};n.setObject("dojo.data.util.sorter",b);b.basicComparator=function(b,e){var k=-1;null===b&&(b=void 0);null===e&&(e=void 0);if(b==e)k=0;else if(b>e||null==b)k=1;return k};b.createSortFunction=function(g,e){function k(a,d,b,f){return function(c,h){var p=f.getValue(c,a),l=f.getValue(h,a);return d*b(p,l)}}for(var m=[],a,q=e.comparatorMap,d=b.basicComparator,l=0;l<g.length;l++){a=g[l];var p=a.attribute;if(p){a=a.descending?-1:1;var h=d;q&&("string"!==typeof p&&"toString"in p&&(p=p.toString()),h=q[p]||
d);m.push(k(p,a,h,e))}}return function(a,d){for(var b=0;b<m.length;){var f=m[b++](a,d);if(0!==f)return f}return 0}};return b})},"jimu/PoolControllerMixin":function(){define(["dojo/_base/declare","dojo/_base/array","jimu/PanelManager"],function(n,b,g){return n(null,{constructor:function(){this.panelManager=g.getInstance()},postCreate:function(){this.controlledWidgets||(this.controlledWidgets="all");this.controlledGroups||(this.controlledGroups="all")},getOpenedIds:function(){},setOpenedIds:function(b){},
getConfigById:function(b){for(var k=this.getAllConfigs(),g=0;g<k.length;g++)if(k[g].id===b)return k[g]},getAllConfigs:function(){var e=[],e=e.concat(this.getWidgetConfigs(),this.getGroupConfigs()),e=b.filter(e,function(b){return b.visible});return e.sort(function(b,e){return b.index-e.index})},isControlled:function(e){return b.some(this.getAllConfigs(),function(b){return b.id===e})},widgetIsControlled:function(e){return b.some(this.getAllConfigs(),function(k){return k.id===e?!0:b.some(k.widgets,function(b){return b.id===
e})})},getGroupConfigs:function(){var e=[];if(!this.appConfig.widgetPool)return e;this.appConfig.widgetPool.groups&&b.forEach(this.appConfig.widgetPool.groups,function(b){this.controlledGroups&&(Array.isArray(this.controlledGroups)?-1<this.controlledGroups.indexOf(b.label)&&e.push(b):"all"===this.controlledGroups&&e.push(b))},this);return e},getWidgetConfigs:function(){var e=[];if(!this.appConfig.widgetPool)return e;this.appConfig.widgetPool.widgets&&b.forEach(this.appConfig.widgetPool.widgets,function(b){this.controlledWidgets&&
(Array.isArray(this.controlledWidgets)?-1<this.controlledWidgets.indexOf(b.label)&&e.push(b):"all"===this.controlledWidgets&&e.push(b))},this);return e}})})},"jimu/SpatialReference/utils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all dojo/request esri/SpatialReference ./unitUtils".split(" "),function(n,b,g,e,k,m,a,q){var d=null,l=null,p=!1;n=n(null,function(){});var h=require.toUrl("jimu"),s=m(h+"/SpatialReference/wkidDetails.json",{handleAs:"json"}),
r=m(h+"/SpatialReference/transform.json",{handleAs:"json"});n.loadResource=function(){var a=new e;if(d&&l)return a.resolve(),a;k([s,r]).then(function(f){d=f[0];l=f[1];p=!0;a.resolve()},function(f){console.error(f);p=!1;a.reject(f)});return a};n.getAllCSUnits=function(){if(p){var a=[];g.forEach(d.wkids,b.hitch(this,function(f){f=this.getCSUnit(f);-1===g.indexOf(a,f)&&a.push(f)}));return a}};n.convertUnit=function(a,f,c){if(p)return q.convertUnit(a,f,c)};n.getUnitRate=function(a,f){if(p)return q.getUnitRate(a,
f)};n.isProjectUnit=function(a){if(p)return q.isProjectUnit(a)};n.isGeographicUnit=function(a){if(p)return q.isGeographicUnit(a)};n.getGeographicUnits=function(){if(p)return q.getGeographicUnits()};n.getProjectUnits=function(){if(p)return q.getProjectUnits()};n.getCSUnit=function(a){if(p){a=this.getCSStr(a);var f=0,c=0,f=a.lastIndexOf("UNIT"),c=a.indexOf(",",f);return a.slice(f+6,c-1)}};n.isSameSR=function(a,f){if(p){var c=this.indexOfWkid(a),b=this.indexOfWkid(f);return d.labels[c]===d.labels[b]}};
n.isValidWkid=function(a){if(p)return-1<this.indexOfWkid(a)};n.getSRLabel=function(a){if(p&&this.isValidWkid(a))return a=this.indexOfWkid(a),d.labels[a]};n.indexOfWkid=function(a){if(p)return g.indexOf(d.wkids,a)};n.isWebMercator=function(d){return a.prototype._isWebMercator?a.prototype._isWebMercator.apply({wkid:parseInt(d,10)},[]):(new a(parseInt(d,10))).isWebMercator()};n.standardizeWkid=function(a){return this.isWebMercator(a)?3857:parseInt(a,10)};n.isValidTfWkid=function(a){if(p)return-1<this.indexOfTfWkid(a)};
n.getTransformationLabel=function(a){if(p)return this.isValidTfWkid(a)?(a=this.indexOfTfWkid(a),l.labels[a]):""};n.indexOfTfWkid=function(a){if(p)return g.indexOf(l.tfWkids,a)};n.isGeographicCS=function(a){if(p)return this.isValidWkid(a)?d.details[this.indexOfWkid(a)].startWith("GEOGCS"):!1};n.isProjectedCS=function(a){if(p)return this.isValidWkid(a)?d.details[this.indexOfWkid(a)].startWith("PROJCS"):!1};n.getGeoCSByProj=function(a){if(p&&this.isProjectedCS(a))return a=this.getSpheroidStr(a),a=g.indexOf(d.details,
a),d.wkids[a]};n.getSpheroidStr=function(a){if(p){if(this.isGeographicCS(a))return d.details[this.indexOfWkid(a)];if(this.isProjectedCS(a)){a=d.details[this.indexOfWkid(a)];var f=a.indexOf("GEOGCS"),c=a.indexOf("PROJECTION")-1;return a.slice(f,c)}return null}};n.getCSStr=function(a){if(p)return d.details[this.indexOfWkid(a)]};n.isSameSpheroid=function(a,f){if(p){var c=this.getSpheroidStr(a),d=this.getSpheroidStr(f);return c&&d&&c===d?!0:!1}};return n})},"jimu/SpatialReference/unitUtils":function(){define(["dojo/_base/declare",
"dojo/_base/array"],function(n,b){var g="INCHES FOOT FOOT_US YARDS MILES NAUTICAL_MILES MILLIMETERS CENTIMETERS METER KILOMETERS DECIMETERS LINK_CLARKE FOOT_GOLD_COAST FOOT_CLARKE CHAIN_SEARS_1992_TRUNCATED YARD_INDIAN CHAIN_BENOIT_1895_B YARD_SEARS CHAIN_SEARS FOOT_SEARS YARD_INDIAN_1937 50_KILOMETERS 150_KILOMETERS".split(" "),e="DECIMAL_DEGREES DEGREE_MINUTE_SECONDS DEGREE GRAD MGRS USNG".split(" "),k={INCHES:0.0254,FOOT:0.3048,FOOT_US:0.3048006096012192,YARDS:0.9144,MILES:1609.344,NAUTICAL_MILES:1852,
MILLIMETERS:0.0010,CENTIMETERS:0.01,METER:1,KILOMETERS:1E3,DECIMETERS:0.1,LINK_CLARKE:0.2011661949,FOOT_GOLD_COAST:0.3047997101815088,FOOT_CLARKE:0.304797265,CHAIN_SEARS_1922_TRUNCATED:20.116756,YARD_INDIAN:0.9143985307444408,CHAIN_BENOIT_1895_B:20.11678249437587,YARD_SEARS:0.9143984146160287,CHAIN_SEARS:20.11676512155263,FOOT_SEARS:0.3047994715386762,YARD_INDIAN_1937:0.91439523,"50_KILOMETERS":5E4,"150_KILOMETERS":15E4,DEGREE:0.0174532925199433,DECIMAL_DEGREES:0.0174532925199433,MGRS:0.0174532925199433,
USNG:0.0174532925199433,DEGREE_MINUTE_SECONDS:0.0174532925199433,GRAD:0.01570796326794897},m=n(null,function(){});m.convertUnit=function(a,b,d){return k[a.toUpperCase()]/k[b.toUpperCase()]*d};m.getUnitRate=function(a,b){return k[a.toUpperCase()]/k[b.toUpperCase()]};m.isProjectUnit=function(a){return-1<b.indexOf(g,a.toUpperCase())};m.isGeographicUnit=function(a){return-1<b.indexOf(e,a.toUpperCase())};m.getGeographicUnits=function(){return e};m.getProjectUnits=function(){return g};return m})},"jimu/LayerInfos/LayerInfos":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/on dojo/topic dojo/_base/unload dojo/Evented dojo/promise/all ./LayerInfoFactory".split(" "),
function(n,b,g,e,k,m,a,q,d,l){var p=n([q],{operLayers:null,map:null,finalLayerInfos:null,tableInfos:null,basemapLayers:null,constructor:function(a,c){this.basemapLayers=c.baseMap.baseMapLayers;this.operLayers=c.operationalLayers;this.tables=c.tables;this.map=a;this.finalLayerInfos=[];this._initLayerInfos();this._initTables();this.update();this._bindEvents()},update:function(){this._extraSetLayerInfos();this._clearAddedFlag(this.layerInfos);this._initFinalLayerInfos(this.layerInfos);this._markFirstOrLastNode()},
getLayerInfoArray:function(){return this.finalLayerInfos},getTableInfoArray:function(){return this.tableInfos},traversal:function(a){for(var c=this.getLayerInfoArray(),d=0;d<c.length;d++)if(c[d].traversal(a))return!0},getLayerInfoById:function(a){return this._findLayerInfoById(a)},moveUpLayer:function(a){var c=null,d;a=this._getTopLayerInfoIndexById(a);0<a&&(c=this.finalLayerInfos[a-1].obtainLayerIndexesInMap().length,this.finalLayerInfos[a].moveRightOfIndex(this.finalLayerInfos[a-1].obtainLayerIndexesInMap()[c-
1].index),c=this.finalLayerInfos[a-1].id,d=this.finalLayerInfos[a],this.finalLayerInfos.splice(a,1),this.finalLayerInfos.splice(a-1,0,d),this._markFirstOrLastNode());return c},moveDownLayer:function(a){var c=null,d=this._getTopLayerInfoIndexById(a);d<this.finalLayerInfos.length-1&&(this.finalLayerInfos[d].moveLeftOfIndex(this.finalLayerInfos[d+1].obtainLayerIndexesInMap()[0].index),c=this.finalLayerInfos[d+1].id,a=this.finalLayerInfos[d+1],this.finalLayerInfos.splice(d+1,1),this.finalLayerInfos.splice(d,
0,a),this._markFirstOrLastNode());return c},getBasemapLayers:function(){var a=[];b.forEach(this.map.layerIds,function(c){c=this.map.getLayer(c);("basemap"===c._basemapGalleryLayerType||"reference"===c._basemapGalleryLayerType)&&a.push(c)},this);0===a.length&&(a=this.basemapLayers);return a},_initLayerInfos:function(){var a,c=[];b.forEach(this.operLayers,function(d){try{a=l.getInstance().create(d),a.init()}catch(b){console.warn(b.message),a=null}a&&c.push(a)},this);this.layerInfos=c},_extraSetLayerInfos:function(){b.forEach(this.layerInfos,
function(a,c){var d;if("esri.layers.GeoRSSLayer"===a.layerObject.declaredClass||"esri.layers.KMLLayer"===a.layerObject.declaredClass){try{d=l.getInstance().create(a.originOperLayer),d.init()}catch(b){console.warn(b.message),d=null}d&&(this.layerInfos[c]=d)}},this)},_initFinalLayerInfos:function(a){var c,d;this.finalLayerInfos.length=0;for(c=this.map.graphicsLayerIds.length-1;0<=c;c--)d=this.map.graphicsLayerIds[c],this._isBasemap(d)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(d,
a),d,!0);for(c=this.map.layerIds.length-1;0<=c;c--)d=this.map.layerIds[c],this._isBasemap(d)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(d,a),d,!1)},_isBasemap:function(a){for(var c=!1,d=this.getBasemapLayers(),b=0;b<d.length;b++)d[b].id===a&&(c=!0);return c},_addToFinalLayerInfos:function(a,c,d){var b;if(a)!a._addedFlag&&a.isGraphicLayer()===d&&(this.finalLayerInfos.push(a),a._addedFlag=!0);else if(a=this.map.getLayer(c),"esri.layers.GraphicsLayer"!==a.declaredClass){try{b=
l.getInstance().create({layerObject:a,title:a.label||a.title||a.name||a.id||" ",id:a.id||" ",url:a.url||""},this.map),b.init()}catch(h){console.warn(h.message),b=null}b&&this.finalLayerInfos.push(b)}},_findLayerInfoByIdAndReturnTopLayer:function(a,c){var d,b=null;c||(c=this.finalLayerInfos);for(d=0;d<c.length;d++)if(b=c[d].findLayerInfoById(a)){b=c[d];break}return b},_findLayerInfoById:function(a,c){var d,b=null;c||(c=this.finalLayerInfos);for(d=0;d<c.length&&!(b=c[d].findLayerInfoById(a));d++);return b},
_findTopLayerInfoById:function(a){var c,d=null,b=this.finalLayerInfos;for(c=0;c<b.length;c++)if(b[c].id===a){d=b[c];break}return d},_getTopLayerInfoIndexById:function(a){var c,d=-1;for(c=0;c<this.finalLayerInfos.length;c++)if(this.finalLayerInfos[c].id===a){d=c;break}return d},_clearAddedFlag:function(a){b.forEach(a,function(a){a._addedFlag=!1})},_markFirstOrLastNode:function(){var a;if(this.finalLayerInfos.length){for(a=0;a<this.finalLayerInfos.length;a++)this.finalLayerInfos[a].isFirst=!1,this.finalLayerInfos[a].isLast=
!1;this.finalLayerInfos[0].isFirst=!0;this.finalLayerInfos[this.finalLayerInfos.length-1].isLast=!0;for(a=0;a<this.finalLayerInfos.length;a++)if(!this.finalLayerInfos[a].isGraphicLayer()){a&&(this.finalLayerInfos[a-1].isLast=!0);this.finalLayerInfos[a].isFirst=!0;break}}},_onReceiveBasemapGalleryeData:function(a,c,d){"BasemapGallery"===a&&(this.basemapLayers.length=0,b.forEach(d,g.hitch(this,function(a){this.basemapLayers.push({layerObject:a,id:a.id})}),this),this.update(),this.emit("layerInfosChanged"))},
_onBasemapChange:function(a){var c;for(c=this.basemapLayers.length=0;c<a.layers.length;c++)this.basemapLayers.push({layerObject:a.layer[c],id:a.layers[c].id})},_bindEvents:function(){var d,c,b,h;d=k(this.map,"layer-add-result",g.hitch(this,this._onLayersChange,"added"));c=k(this.map,"layer-remove",g.hitch(this,this._onLayersChange,"removed"));h=m.subscribe("layerInfos/layerInfo/isShowInMapChanged",g.hitch(this,this._onShowInMapChanged));b=k(this.map,"before-unload",g.hitch(this,function(){d.remove();
c.remove();h.remove()}));a.addOnUnload(function(){d.remove();c.remove();b.remove();h.remove()})},_onLayersChange:function(a,c){var d=null,b;!c.error&&("esri.layers.GraphicsLayer"!==c.layer.declaredClass&&!c.layer._basemapGalleryLayerType)&&("added"===a?(this.update(),d=this._findTopLayerInfoById(c.layer.id),b=this._findLayerInfoById(c.layer.id)):(d=this._findTopLayerInfoById(c.layer.id),b=this._findLayerInfoById(c.layer.id),this.update()),this.emit("layerInfosChanged",d,a,b))},_onShowInMapChanged:function(a){this.emit("layerInfosIsShowInMapChanged",
a)},_initTables:function(){var a,c=[];b.forEach(this.tables,function(d){try{d.empty=!0,a=l.getInstance().create({layerObject:d,title:d.title||d.id||" ",id:d.id||" ",selfType:"table"}),a.init()}catch(b){console.warn(b.message),a=null}a&&c.push(a)},this);this.tableInfos=c}});p.getLayerInfoArrayByType=function(a,c){var h=new e,l=[],k=[];p.getInstance(a,a.iteminfo).then(function(a){a.traversal(function(a){var c=a.getLayerType();c.layerInfo=a;l.push(c)});d(l).then(function(a){b.forEach(a,function(a,d){c===
a&&k.push(l[d].layerInfo)});h.resolve(k)})});return h};var h=!0,s=null,r=null,t=new e;p.getInstance=function(a,c){s&&s!==a&&(h=!0,r=s=null,t=new e);r?t.resolve(r):h&&(h=!1,l.getInstance(a).init().then(g.hitch(this,function(){var d=new p(a,c.itemData);s=a;r=d;t.resolve(d)})));return t};return p})},"jimu/LayerInfos/LayerInfoFactory":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred"],function(n,b,g){var e=null,k=n(null,{constructor:function(){},init:function(){var e=new g;require("jimu/LayerInfos/LayerInfoForCollection jimu/LayerInfos/LayerInfoForMapService jimu/LayerInfos/LayerInfoForKML jimu/LayerInfos/LayerInfoForGeoRSS jimu/LayerInfos/LayerInfoForDefault jimu/LayerInfos/LayerInfoForWMS jimu/LayerInfos/LayerInfoForGroup jimu/LayerInfos/LayerInfoForDefaultDynamic jimu/LayerInfos/LayerInfoForDefaultTile jimu/LayerInfos/LayerInfoForDefaultWMS jimu/LayerInfos/LayerInfoForDefaultTable jimu/LayerInfos/LayerInfoForDefaultImage".split(" "),
b.hitch(this,function(a,b,d,l,p,h,k,g,t,f,c,n){this.LayerInfoForCollection=a;this.LayerInfoForMapService=b;this.LayerInfoForKML=d;this.LayerInfoForGeoRSS=l;this.LayerInfoForDefault=p;this.LayerInfoForWMS=h;this.LayerInfoForGroup=k;this.LayerInfoForDefaultDynamic=g;this.LayerInfoForDefaultTile=t;this.LayerInfoForDefaultWMS=f;this.LayerInfoForDefaultTable=c;this.LayerInfoForDefaultImage=n;e.resolve()}));return e},create:function(b){if(b.featureCollection)return new this.LayerInfoForCollection(b,this.map);
if("esri.layers.KMLLayer"===b.layerObject.declaredClass)return new this.LayerInfoForKML(b,this.map);if("esri.layers.GeoRSSLayer"===b.layerObject.declaredClass)return new this.LayerInfoForGeoRSS(b,this.map);if("esri.layers.WMSLayer"===b.layerObject.declaredClass&&!b.selfType)return new this.LayerInfoForWMS(b,this.map);if("esri.layers.ArcGISDynamicMapServiceLayer"===b.layerObject.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===b.layerObject.declaredClass)return new this.LayerInfoForMapService(b,
this.map);if("esri.layers.ArcGISImageServiceLayer"===b.layerObject.declaredClass)return new this.LayerInfoForDefaultImage(b,this.map);"Table"===b.layerObject.type&&(b.selfType="table");switch(b.selfType){case "mapservice_dynamic_group":return new this.LayerInfoForGroup(b,this.map);case "mapservice_tiled_group":return new this.LayerInfoForGroup(b,this.map,!0);case "mapservice_dynamic":return new this.LayerInfoForDefaultDynamic(b,this.map);case "mapservice_tiled":return new this.LayerInfoForDefaultTile(b,
this.map);case "wms":return new this.LayerInfoForDefaultWMS(b,this.map);case "table":return new this.LayerInfoForDefaultTable(b,this.map);default:return new this.LayerInfoForDefault(b,this.map)}}});k.getInstance=function(b){null===e&&(e=new k);b&&(e.map=b);return e};return k})},"jimu/dijit-all":function(){define([],1)},"jimu/dijit/RadioBtn":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dojo/dom-construct dijit/registry".split(" "),
function(n,b,g,e,k,m,a,q){return n(b,{baseClass:"jimu-radio",declaredClass:"jimu.dijit.RadioBtn",checked:!1,group:null,constructor:function(){},postCreate:function(){a.create("div",{"class":"jimu-radio-inner"},this.domNode);this.checked&&m.add(this.domNode,"jimu-radio-checked");this.own(k(this.domNode,"click",g.hitch(this,function(){this.checked||this.check()})))},check:function(a){void 0===a&&(a=!0);this.checked=!0;m.add(this.domNode,"jimu-radio-checked");a&&this._changeOthersState(!1);this.onStateChange()},
uncheck:function(a){void 0===a&&(a=!0);this.checked=!1;m.remove(this.domNode,"jimu-radio-checked");a&&this._changeOthersState(!1);this.onStateChange()},_changeOthersState:function(a){null!==this.group&&e.forEach(q.toArray(),function(b){b.id!==this.id&&(b["class"]===this["class"]&&b.group===this.group)&&(a?b.check(!1):b.uncheck(!1))},this)},onStateChange:function(){}})})},"jimu/dijit/CheckBox":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/_base/lang","dojo/_base/html","dojo/on"],
function(n,b,g,e,k){return n(b,{baseClass:"jimu-checkbox",declaredClass:"jimu.dijit.CheckBox",checked:!1,status:!0,postCreate:function(){this.checkNode=e.create("div",{"class":"checkbox jimu-float-leading"},this.domNode);this.label&&(this.labelNode=e.create("div",{"class":"label jimu-float-leading",innerHTML:this.label},this.domNode));this.checked&&e.addClass(this.checkNode,"checked");this.own(k(this.checkNode,"click",g.hitch(this,function(){this.status&&(this.checked?this.uncheck():this.check())})));
this.label&&this.own(k(this.labelNode,"click",g.hitch(this,function(){this.checked&&this.status?this.uncheck():this.status&&this.check()})))},setValue:function(b){this.status&&(!0===b?this.check():this.uncheck())},getValue:function(){return this.checked},setStatus:function(b){this.status=b;this.labelNode&&(b?e.setStyle(this.labelNode,"color","#000000"):e.setStyle(this.labelNode,"color","#818181"))},check:function(){this.status&&(this.checked=!0,e.addClass(this.checkNode,"checked"),this.onStateChange())},
uncheck:function(b){if(this.status&&(this.checked=!1,e.removeClass(this.checkNode,"checked"),!b))this.onStateChange()},onStateChange:function(){if(this.onChange&&g.isFunction(this.onChange))this.onChange(this.checked)}})})},"jimu/dijit/SymbolChooser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SymbolChooser.html dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/sniff dojo/query dojo/request/xhr jimu/utils jimu/symbolUtils esri/symbols/jsonUtils esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/symbols/TextSymbol esri/symbols/Font dijit/form/Select dijit/form/NumberSpinner jimu/dijit/ColorPicker jimu/dijit/_Transparency".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c,u,w,A,x){return n([b,g,e,m],{templateString:k,baseClass:"jimu-symbol-chooser",declaredClass:"jimu.dijit.SymbolChooser",nls:null,_pointEventsBinded:!1,_lineEventBinded:!1,_fillEventBinded:!1,_textEventBinded:!1,_invokeSymbolChangeEvent:!0,symbol:null,type:null,postMixInProperties:function(){this.nls=window.jimuNls.symbolChooser},postCreate:function(){this.inherited(arguments);(this._isIE8=8===p("ie"))&&q.addClass(this.domNode,"ie8");this.symbol?this.showBySymbol(this.symbol):
this.type&&this.showByType(this.type)},reset:function(){this.symbol=this.type=null;this._hideAllSections()},showBySymbol:function(a){this.reset();var c=a&&a.declaredClass;c&&("string"===typeof c&&0<=c.indexOf("esri.symbol"))&&(this.symbol=this._cloneSymbol(a),this.isSimpleMarkerSymbol(this.symbol)||this.isPictureMarkerSymbol(this.symbol)?(this.type="marker",this._initPointSection()):this.isSimpleLineSymbol(this.symbol)?(this.type="line",this._initLineSection()):this._isSimpleFillSymbol(this.symbol)?
(this.type="fill",this._initFillSection()):this._isTextSymbol(this.symbol)&&(this.type="text",this._initTextSection()))},showByType:function(a){this.reset();if("marker"===a||"line"===a||"fill"===a||"text"===a)this.type=a,"marker"===this.type?this._initPointSection():"line"===this.type?this._initLineSection():"fill"===this.type?this._initFillSection():"text"===this.type&&this._initTextSection()},getSymbol:function(){var a=null;"marker"===this.type?a=this._getPointSymbolBySetting():"line"===this.type?
a=this._getLineSymbolBySetting():"fill"===this.type?a=this._getFillSymbolBySetting():"text"===this.type&&(a=this._getTextSymbolBySetting());var c=null;a&&(c=this._cloneSymbol(a));return c},_onChange:function(a){a=this._cloneSymbol(a);this.emit("change",a)},_hideAllSections:function(){h(".symbol-section",this.domNode).style("display","none")},_showSection:function(a){this._hideAllSections();h("."+a+"-symbol-section",this.domNode).style("display","block")},_getAncestor:function(a,c,d){return r.getAncestorDom(a,
c,d)},_getAbsoluteUrl:function(a){return window.location.protocol+"//"+window.location.host+require.toUrl(a)},_cloneSymbol:function(a){if(!a)return null;var c=a;try{var d=a.toJson(),c=f.fromJson(d)}catch(b){console.error(b)}return c},_createSymbolIconTable:function(c,b,p){var l=this.type+"-icon-table";c=q.toDom('\x3ctable class\x3d"'+("icon-table "+l+" "+(l+"-"+c))+'"\x3e\x3ctbody\x3e\x3c/tbody\x3e\x3c/table\x3e');for(var l=h("tbody",c)[0],e=Math.ceil(b.length/8),k=0;k<e;k++)q.create("tr",{},l);var g=
h("tr",c);d.forEach(b,a.hitch(this,function(c,d){var b=a.clone(c),h=f.fromJson(c),l=q.create("td",{},g[Math.floor(d/8)]);q.addClass(l,"symbol-td-item");h=this._createSymbolNode(h);q.addClass(h,"symbol-div-item");var e=h.firstChild;q.addClass(e,"svg-node");if(this._isIE8&&"point"===p)if(window.isRTL){if("Cross"===c.name||"X"===c.name)q.setStyle(e,"right","-20px"),q.setStyle(h,"marginTop","20px")}else("Cross"===c.name||"X"===c.name)&&q.setStyle(h,"marginTop","20px");h.symbol=b;q.place(h,l)}));return c},
_updatePreview:function(a){var c=this._cloneSymbol(this.symbol);q.empty(a);(c=t.createSymbolNode(c))||(c=q.create("div"));q.place(c,a)},_createSymbolNode:function(a){(a=t.createSymbolNode(a,{width:36,height:36}))||(a=q.create("div"));q.setStyle(a,{width:"36px",height:"36px"});return a},_getLineShapeDesc:function(a){var c=null;if(this.isSimpleLineSymbol(a)||this.isCartographicLineSymbol(a))c={defaultShape:{type:"path",path:"M -90,0 L 90,0 E"},fill:null,stroke:a.getStroke()};return c},_initPointSection:function(){this._showSection("point");
this._pointEventsBinded||(this._pointEventsBinded=!0,this._bindPointEvents(),this._onPointSymClassSelectChange());this.isPictureMarkerSymbol(this.symbol)?this._showPictureMarkerSymSettings():(this.isSimpleMarkerSymbol(this.symbol)||(this.symbol=new c({style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",outline:{color:[0,0,128,255],width:1},type:"esriSMS",size:18})),this._showSimpleMarkerSymSettings());this._initPointSettings(this.symbol);this._getPointSymbolBySetting()},_bindPointEvents:function(){this.own(l(this.pointIconTables,
".symbol-div-item:click",a.hitch(this,this._onPointSymIconItemClick)));this.own(l(this.pointSymClassSelect,"Change",a.hitch(this,this._onPointSymClassSelectChange)));this.own(l(this.pointSize,"change",a.hitch(this,this._onPointSymbolChange)));this.own(l(this.pointColor,"change",a.hitch(this,this._onPointSymbolChange)));this.own(l(this.pointAlpha,"change",a.hitch(this,this._onPointSymbolChange)));this.own(l(this.pointOutlineColor,"change",a.hitch(this,this._onPointSymbolChange)));this.own(l(this.pointOutlineWidth,
"change",a.hitch(this,this._onPointSymbolChange)))},_onPointSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getPointSymbolBySetting(),this._onChange(this.symbol))},_initPointSettings:function(a){if(a){this._invokeSymbolChangeEvent=!1;if(this.isSimpleMarkerSymbol(a)){if(this.pointSize.set("value",a.size),this.pointColor.setColor(a.color),this.pointAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),a=a.outline)this.pointOutlineColor.setColor(a.color),this.pointOutlineWidth.set("value",parseFloat(a.width.toFixed(0)))}else this.isPictureMarkerSymbol(a)&&
this.pointSize.set("value",a.width);this._invokeSymbolChangeEvent=!0}},isSimpleMarkerSymbol:function(a){return a&&"esri.symbol.SimpleMarkerSymbol"===a.declaredClass},isPictureMarkerSymbol:function(a){return a&&"esri.symbol.PictureMarkerSymbol"===a.declaredClass},_onPointSymClassSelectChange:function(){this._showSelectedPointSymIconTable();var a=this.pointSymClassSelect.get("value");this.pointSymClassSelect["def"+a]||this._requestPointSymJson(a)},_showSelectedPointSymIconTable:function(){var a=this.pointSymClassSelect.get("value");
h(".marker-icon-table",this.pointIconTables).style("display","none");a=h(".marker-icon-table-"+a,this.pointIconTables);0<a.length&&a.style("display","table")},_requestPointSymJson:function(c){var d="def"+c,f=this.pointSymClassSelect[d];f||(f=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+c+".json"),f=s(f,{handleAs:"json"}),this.pointSymClassSelect[d]=f,f.then(a.hitch(this,function(a){a=this._createSymbolIconTable(c,a,"point");q.place(a,this.pointIconTables);this._showSelectedPointSymIconTable()}),
a.hitch(this,function(a){console.error("get point symbol failed",a)})))},_onPointSymIconItemClick:function(a){if(a=this._getAncestor(a.target||a.srcElement,function(a){return q.hasClass(a,"symbol-div-item")},5))if(h(".selected-symbol-div-item",a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),q.addClass(a,"selected-symbol-div-item"),a=a.symbol){this.symbol=f.fromJson(a);a=q.getStyle(this.pointColorTr,"display");this.isSimpleMarkerSymbol(this.symbol)?this._showSimpleMarkerSymSettings():
this._showPictureMarkerSymSettings();this._onPointSymbolChange();var c=q.getStyle(this.pointColorTr,"display");a!==c&&this.emit("resize")}},_showSimpleMarkerSymSettings:function(){q.setStyle(this.pointColorTr,"display","");q.setStyle(this.pointOpacityTr,"display","");q.setStyle(this.pointOutlineColorTr,"display","");q.setStyle(this.pointOulineWidthTr,"display","")},_showPictureMarkerSymSettings:function(){q.setStyle(this.pointColorTr,"display","none");q.setStyle(this.pointOpacityTr,"display","none");
q.setStyle(this.pointOutlineColorTr,"display","none");q.setStyle(this.pointOulineWidthTr,"display","none")},_getPointSymbolBySetting:function(){if(!this.symbol)return null;var a=parseFloat(this.pointSize.get("value"));if(this.isSimpleMarkerSymbol(this.symbol)){this.symbol.setSize(a);var a=this.pointColor.getColor(),c=this.pointAlpha.getAlpha();a.a=c;this.symbol.setColor(a);var a=this.pointOutlineColor.getColor(),c=parseFloat(this.pointOutlineWidth.get("value")),d=new u;d.setStyle(u.STYLE_SOLID);d.setColor(a);
d.setWidth(c);this.symbol.setOutline(d)}else this.isPictureMarkerSymbol(this.symbol)&&(this.symbol.setWidth(a),this.symbol.setHeight(a));this._updatePreview(this.pointSymPreview);return this.symbol},_initLineSection:function(){this._showSection("line");this._lineEventBinded||(this._lineEventBinded=!0,this._bindLineEvents(),this._requestLineSymJson("line"));this._initLineSettings(this.symbol);this._getLineSymbolBySetting()},_bindLineEvents:function(){this.own(l(this.lineIconTables,".symbol-div-item:click",
a.hitch(this,this._onLineSymIconItemClick)));this.own(l(this.lineColor,"change",a.hitch(this,this._onLineSymbolChange)));this.own(l(this.lineStylesSelect,"change",a.hitch(this,this._onLineSymbolChange)));this.own(l(this.lineAlpha,"change",a.hitch(this,this._onLineSymbolChange)));this.own(l(this.lineWidth,"change",a.hitch(this,this._onLineSymbolChange)))},_onLineSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getLineSymbolBySetting(),this._onChange(this.symbol))},_initLineSettings:function(a){a&&
(this._invokeSymbolChangeEvent=!1,this.lineColor.setColor(a.color),this.lineAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),this.lineWidth.set("value",parseFloat(a.width.toFixed(0))),this.lineStylesSelect.set("value",a.style),this._invokeSymbolChangeEvent=!0)},isSimpleLineSymbol:function(a){return a&&"esri.symbol.SimpleLineSymbol"===a.declaredClass},isCartographicLineSymbol:function(a){return a&&"esri.symbol.CartographicLineSymbol"===a.declaredClass},_requestLineSymJson:function(c){var d=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+
c+".json");s(d,{handleAs:"json"}).then(a.hitch(this,function(a){a=this._createSymbolIconTable(c,a,"line");q.place(a,this.lineIconTables)}),a.hitch(this,function(a){console.error("get line symbol failed",a)}))},_onLineSymIconItemClick:function(a){if(a=this._getAncestor(a.target||a.srcElement,function(a){return q.hasClass(a,"symbol-div-item")},5))if(h(".selected-symbol-div-item",a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),q.addClass(a,"selected-symbol-div-item"),a=a.symbol)a=
f.fromJson(a),this._initLineSettings(a),this._onLineSymbolChange()},_getLineSymbolBySetting:function(){this.symbol=new u;var a=this.lineColor.getColor(),c=this.lineStylesSelect.get("value");a.a=this.lineAlpha.getAlpha();var d=parseFloat(this.lineWidth.get("value"));this.symbol.setStyle(c);this.symbol.setColor(a);this.symbol.setWidth(d);this._updatePreview(this.lineSymPreview);return this.symbol},_initFillSection:function(){this._showSection("fill");this._fillEventBinded||(this._fillEventBinded=!0,
this._bindFillEvents(),this._requestFillSymJson("fill"));this._initFillSettings(this.symbol);this._getFillSymbolBySetting()},_bindFillEvents:function(){this.own(l(this.fillIconTables,".symbol-div-item:click",a.hitch(this,this._onFillSymIconItemClick)));this.own(l(this.fillColor,"change",a.hitch(this,this._onFillSymbolChange)));this.own(l(this.fillAlpha,"change",a.hitch(this,this._onFillSymbolChange)));this.own(l(this.fillOutlineColor,"change",a.hitch(this,this._onFillSymbolChange)));this.own(l(this.fillOutlineWidth,
"change",a.hitch(this,this._onFillSymbolChange)))},_onFillSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getFillSymbolBySetting(),this._onChange(this.symbol))},_initFillSettings:function(a){a&&(this._invokeSymbolChangeEvent=!1,this.fillColor.setColor(a.color),this.fillAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),a.outline&&(this.fillOutlineColor.setColor(a.outline.color),this.fillOutlineWidth.set("value",parseInt(a.outline.width,10))),this._invokeSymbolChangeEvent=!0)},_isSimpleFillSymbol:function(a){return a&&
"esri.symbol.SimpleFillSymbol"===a.declaredClass},_requestFillSymJson:function(c){var d=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+c+".json");s(d,{handleAs:"json"}).then(a.hitch(this,function(a){a=this._createSymbolIconTable(c,a,"fill");q.place(a,this.fillIconTables)}),a.hitch(this,function(a){console.error("get fill symbol failed",a)}))},_onFillSymIconItemClick:function(a){if(a=this._getAncestor(a.target||a.srcElement,function(a){return q.hasClass(a,"symbol-div-item")},5))if(h(".selected-symbol-div-item",
a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),q.addClass(a,"selected-symbol-div-item"),a=a.symbol)a=f.fromJson(a),this._initFillSettings(a),this._onFillSymbolChange()},_getFillSymbolBySetting:function(){this.symbol=new w;var a=this.fillColor.getColor();a.a=this.fillAlpha.getAlpha();var c=this.fillOutlineColor.getColor(),d=parseInt(this.fillOutlineWidth.get("value"),10);this.symbol.setColor(a);this.symbol.setStyle(w.STYLE_SOLID);a=new u;a.setStyle(u.STYLE_SOLID);a.setColor(c);
a.setWidth(d);this.symbol.setOutline(a);this._updatePreview(this.fillSymPreview);return this.symbol},_initTextSection:function(){this._showSection("text");this._textEventBinded||(this._textEventBinded=!0,this._bindTextEvents());this._initTextSettings();this._getTextSymbolBySetting()},_bindTextEvents:function(){this.own(l(this.inputText,"change",a.hitch(this,this._onTextSymbolChange)));this.own(l(this.textColor,"change",a.hitch(this,this._onTextSymbolChange)));this.own(l(this.textFontSize,"change",
a.hitch(this,this._onTextSymbolChange)))},_onTextSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getTextSymbolBySetting(),this._onChange(this.symbol))},_initTextSettings:function(a){a&&(this._invokeSymbolChangeEvent=!1,this.inputText.value=a.text,this.textColor.setColor(a.color),a=parseInt(a.font.size,10),this.textFontSize.set("value",a),this._invokeSymbolChangeEvent=!0)},_isTextSymbol:function(a){return a&&"esri.symbol.TextSymbol"===a.declaredClass},_updateTextPreview:function(){var a=
this.textColor.getColor().toHex(),c=parseInt(this.textFontSize.get("value"),10)+"px";q.setStyle(this.textPreview,{color:a,fontSize:c});this.textPreview.innerHTML=this.inputText.value},_getTextSymbolBySetting:function(){this.symbol=new A;var a=this.inputText.value,c=this.textColor.getColor(),d=parseInt(this.textFontSize.get("value"),10),f=new x;f.setSize(d);this.symbol.setText(a);this.symbol.setColor(c);this.symbol.setFont(f);this._updateTextPreview();return this.symbol}})})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c,u,w){function A(a){return function(c){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(q.hitch(this,a,c))}}var x=b("dijit.form._SelectMenu",s,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(d(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,c=this.parentWidget.value;
q.isArray(c)&&(c=c[c.length-1]);c&&n.forEach(this.parentWidget._getChildren(),function(d){d.option&&c===d.option.value&&(a=!0,this.focusChild(d,!1))},this);a||this.inherited(arguments)}});k=b("dijit.form.Select"+(l("dojo-bidi")?"_NoBidi":""),[p,h,c],{baseClass:"dijitSelect dijitValidationTextBox",templateString:w,_buttonInputDisabled:l("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new x({id:this.id+"_menu",parentWidget:this});e.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(a){if(!a.value&&!a.label)return new t({ownerDocument:this.ownerDocument});var c=q.hitch(this,"_setValueAttr",a);a=new r({option:a,label:("text"===this.labelType?(a.label||"").toString().replace(/&/g,
"\x26amp;").replace(/</g,"\x26lt;"):a.label)||this.emptyLabel,onClick:c,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:a.disabled||!1});a.focusNode.setAttribute("role","option");return a},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return!this.dropDown?[]:this.dropDown.getChildren()},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},focusChild:function(a){a&&
this.set("value",a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=u.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,c,d,f){a&&this.focusChild(a)},_loadChildren:function(a){if(!0===a)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{n.forEach(this._getChildren(),
function(a){a.destroyRecursive()});var c=new r({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(c)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(a){this.inherited(arguments);g.set(this.valueNode,"value",this.get("value"));this._refreshState()},
_setNameAttr:"valueNode",_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var c=a?"":this._missingMsg;c&&this.focused&&this._hasBeenBlurred?f.show(c,this.domNode,this.tooltipPosition,!this.isLeftToRight()):f.hide(this.domNode);this._set("message",c);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);f.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=m.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(d(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var c=this._keyNavCodes;delete c[a.LEFT_ARROW];delete c[a.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
e.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);f.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){f.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
l("dojo-bidi")&&(k=b("dijit.form.Select",k,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));k._Menu=x;k.prototype._onContainerKeydown=A("_onContainerKeydown");k.prototype._onContainerKeypress=A("_onContainerKeypress");return k})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s){return k("dijit.form._FormSelectWidget",s,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var b=this.options||[];if(null==a)return b;if(d.isArray(a))return n.map(a,"return this.getOptions(item);",this);d.isString(a)&&(a={value:a});d.isObject(a)&&(n.some(b,function(d,c){for(var b in a)if(!(b in d)||d[b]!=a[b])return!1;a=c;return!0})||(a=-1));return 0<=a&&a<b.length?b[a]:null},addOption:function(a){n.forEach(d.isArray(a)?a:[a],function(a){a&&d.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(d.isArray(a)?
a:[a]);n.forEach(a,function(a){a&&(this.options=n.filter(this.options,function(d){return d.value!==a.value||d.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){n.forEach(d.isArray(a)?a:[a],function(a){var d=this.getOptions({value:a.value}),c;if(d)for(c in a)d[c]=a[c]},this);this._loadChildren()},setStore:function(a,d,f){q.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,d,f)},_deprecatedSetStore:function(a,l,f){var c=this.store;f=f||{};if(c!==a){for(var k;k=this._notifyConnections.pop();)k.remove();a.get||(d.mixin(a,{_oldAPI:!0,get:function(a){var c=new b;this.fetchItemByIdentity({identity:a,onItem:function(a){c.resolve(a)},onError:function(a){c.reject(a)}});return c.promise},query:function(a,c){var f=new b(function(){p.abort&&p.abort()});f.total=new b;var p=this.fetch(d.mixin({query:a,onBegin:function(a){f.total.resolve(a)},
onComplete:function(a){f.resolve(a)},onError:function(a){f.reject(a)}},c));return new h(f)}}),a.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[g.after(a,"onNew",d.hitch(this,"_onNewItem"),!0),g.after(a,"onDelete",d.hitch(this,"_onDeleteItem"),!0),g.after(a,"onSet",d.hitch(this,"_onSetItem"),!0)]));this._set("store",a)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);f.query&&this._set("query",f.query);f.queryOptions&&this._set("queryOptions",f.queryOptions);a&&a.query&&(this._loadingStore=!0,this.onLoadDeferred=new b,this._queryRes=a.query(this.query,this.queryOptions),p(this._queryRes,d.hitch(this,function(c){if(this.sortByLabel&&!f.sort&&c.length)if(a.getValue)c.sort(e.createSortFunction([{attribute:a.getLabelAttributes(c[0])[0]}],a));else{var b=this.labelAttr;c.sort(function(a,c){return a[b]>c[b]?1:c[b]>
a[b]?-1:0})}f.onFetch&&(c=f.onFetch.call(this,c,f));n.forEach(c,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(d.hitch(this,function(a,c,d){c==d?this._onSetItem(a):(-1!=c&&this._onDeleteItem(a),-1!=d&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:l);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(c):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)}));return c},_setValueAttr:function(a,b){this._onChangeActive||(b=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=d.isArray(a)?n.map(a,function(a){return d.isObject(a)?a:{value:a}}):d.isObject(a)?[a]:[{value:a}];a=n.filter(this.getOptions(a),function(a){return a&&a.value});var f=this.getOptions()||[];if(!this.multiple&&(!a[0]||!a[0].value)&&f.length)a[0]=f[0];n.forEach(f,
function(c){c.selected=n.some(a,function(a){return a.value===c.value})});f=n.map(a,function(a){return a.value});if(!("undefined"==typeof f||"undefined"==typeof f[0])){var c=n.map(a,function(a){return a.label});this._setDisplay(this.multiple?c:c[0]);this.inherited(arguments,[this.multiple?f:f[0],b]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=n.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?a:a[0]},
_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(n.forEach(this._getChildren(),function(a){a.destroyRecursive()}),n.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var d=[].concat(this.value);if(d&&d[0]){var b=this;n.forEach(this._getChildren(),function(f){var c=n.some(d,function(a){return f.option&&
a===f.option.value});c&&!b.multiple&&(b.focusedChild=f);a.toggle(f.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),c);f.domNode.setAttribute("aria-selected",c?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var d=n.filter(a,function(a){return a.selected})[0];if(d&&d.value)return d.value;a[0].selected=!0;return a[0].value}return this.multiple?n.map(n.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,d){(!d||!d.parent)&&this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var d=this.store,b=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:d.getLabel(a);return{value:b?d.getIdentity(a):null,label:b,item:a}},_addOptionForItem:function(a){var d=this.store;d.isItemLoaded&&!d.isItemLoaded(a)?d.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);m.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?l("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+q._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);g.after(this,"onChange",d.hitch(this,"_updateSelection"));var a=this.store;if(a&&(a.getIdentity||a.getFeatures()["dojo.data.api.Identity"]))this.store=null,this._deprecatedSetStore(a,this._oValue,
{query:this.query,queryOptions:this.queryOptions});this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(n,b,g){var e=function(k){function m(b){k[b]=function(){var d=arguments,l=g(k,function(a){Array.prototype.unshift.call(d,a);return e(n[b].apply(n,d))});if("forEach"!==b||a)return l}}if(!k)return k;var a=!!k.then;a&&(k=b.delegate(k));m("forEach");m("filter");
m("map");null==k.total&&(k.total=g(k,function(a){return a.length}));return k};b.setObject("dojo.store.util.QueryResults",e);return e})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(n,b,g,e){return n("dijit.DropDownMenu",e,{templateString:g,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(b){this._moveToPopup(b);b.stopPropagation();b.preventDefault()},
_onLeftArrow:function(b){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else b.stopPropagation(),b.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t){return b("dijit._MenuBase",[h,
t,r,s],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){k.toggle(this.domNode,"dijitMenuActive",a);k.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,childSelector:function(a){var c=p.byNode(a);return a.parentNode==this.containerNode&&
c&&c.focus},postCreate:function(){var d=this,c="string"==typeof this.childSelector?this.childSelector:m.hitch(this,"childSelector");this.own(q(this.containerNode,q.selector(c,a.enter),function(){d.onItemHover(p.byNode(this))}),q(this.containerNode,q.selector(c,a.leave),function(){d.onItemUnhover(p.byNode(this))}),q(this.containerNode,q.selector(c,l),function(a){d.onItemClick(p.byNode(this),a);a.stopPropagation()}),q(this.containerNode,q.selector(c,"focusin"),function(){d._onItemFocus(p.byNode(this))}));
this.inherited(arguments)},onKeyboardSearch:function(a,c,d,b){this.inherited(arguments);if(a&&(-1==b||a.popup&&1==b))this.onItemClick(a,c)},_keyboardSearchCompare:function(a,c){return a.shortcutKey?c==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},
_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),a.popup&&(!a.disabled&&!this.hover_timer)&&(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,{type:"click"})},this.passivePopupDelay));this._hoveredChild=
a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",!1)},_stopPopupTimer:function(){this.hover_timer&&
(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,c){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var d=/^key/.test(c._origType||c.type)||0==c.clientX&&0==c.clientY;this._openItemPopup(a,
d)}else this.onExecute(),a._onClick?a._onClick(c):a.onClick(c)},_openItemPopup:function(a,c){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var d=a.popup;d.parentMenu=this;this.own(this._mouseoverHandle=q.once(d.domNode,"mouseover",m.hitch(this,"_onPopupHover")));var b=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){c&&b.focusChild(a);b._cleanUp()},onExecute:m.hitch(this,
"_cleanUp",!0),onClose:function(){b._mouseoverHandle&&(b._mouseoverHandle.remove(),delete b._mouseoverHandle)}},c);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(e.set(this.selected.focusNode,"tabIndex",this.tabIndex),this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),
this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
function(n,b,g,e,k,m,a,q,d,l){return b("dijit._KeyNavContainer",[d,l,q],{connectKeyNavHandlers:function(a,d){var b=this._keyNavCodes={},l=m.hitch(this,"focusPrev"),e=m.hitch(this,"focusNext");n.forEach(a,function(a){b[a]=l});n.forEach(d,function(a){b[a]=e});b[k.HOME]=m.hitch(this,"focusFirstChild");b[k.END]=m.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){e.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);n.forEach(this.getChildren(),
m.hitch(this,"_startupChild"))},addChild:function(a,d){this.inherited(arguments);this._startupChild(a)},_startupChild:function(a){a.set("tabIndex","-1")},_getFirst:function(){var a=this.getChildren();return a.length?a[0]:null},_getLast:function(){var a=this.getChildren();return a.length?a[a.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(d){return(d=
a.byNode(d))&&d.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(n,b,g,e,k,m,a,q){return b("dijit._KeyNavMixin",q,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);g.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var d=this._keyNavCodes={};d[e.HOME]=k.hitch(this,"focusFirstChild");d[e.END]=k.hitch(this,
"focusLastChild");d[this.isLeftToRight()?e.LEFT_ARROW:e.RIGHT_ARROW]=k.hitch(this,"_onLeftArrow");d[this.isLeftToRight()?e.RIGHT_ARROW:e.LEFT_ARROW]=k.hitch(this,"_onRightArrow");d[e.UP_ARROW]=k.hitch(this,"_onUpArrow");d[e.DOWN_ARROW]=k.hitch(this,"_onDownArrow")}var b=this,d="string"==typeof this.childSelector?this.childSelector:k.hitch(this,"childSelector");this.own(m(this.domNode,"keypress",k.hitch(this,"_onContainerKeypress")),m(this.domNode,"keydown",k.hitch(this,"_onContainerKeydown")),m(this.domNode,
"focus",k.hitch(this,"_onContainerFocus")),m(this.containerNode,m.selector(d,"focusin"),function(d){b._onChildFocus(a.getEnclosingWidget(this),d)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(a,b){a&&(this.focusedChild&&a!==this.focusedChild&&this._onChildBlur(this.focusedChild),a.set("tabIndex",this.tabIndex),a.focus(b?"end":"start"))},_onContainerFocus:function(a){a.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){g.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(a){g.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(a){a&&a!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),a.set("tabIndex",this.tabIndex),this.lastFocused=a,this._set("focusedChild",a))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(a,b,p,h){a&&this.focusChild(a)},_keyboardSearchCompare:function(a,b){var p=a.domNode,p=(a.label||(p.focusNode?
p.focusNode.label:"")||p.innerText||p.textContent||"").replace(/^\s+/,"").substr(0,b.length).toLowerCase();return b.length&&p==b?-1:0},_isFormElement:function(a){return"INPUT"===a.tagName||"TEXTAREA"===a.tagName||"SELECT"===a.tagName||"BUTTON"===a.tagName},_onContainerKeydown:function(a){if(!this._isFormElement(document.activeElement)){var b=this._keyNavCodes[a.keyCode];b?(b(a,this.focusedChild),a.stopPropagation(),a.preventDefault(),this._searchString=""):a.keyCode==e.SPACE&&(this._searchTimer&&
!a.ctrlKey&&!a.altKey&&!a.metaKey)&&(a.stopImmediatePropagation(),a.preventDefault(),this._keyboardSearch(a," "))}},_onContainerKeypress:function(a){if(!this._isFormElement(document.activeElement)&&!(a.charCode<=e.SPACE||a.ctrlKey||a.altKey||a.metaKey))a.preventDefault(),a.stopPropagation(),this._keyboardSearch(a,String.fromCharCode(a.charCode).toLowerCase())},_keyboardSearch:function(a,b){var p=null,h,e=0;k.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=b;
var a=/^(.)\1*$/.test(this._searchString)?1:this._searchString.length;h=this._searchString.substr(0,a);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var d=this.focusedChild||null;if(1==a||!d)if(d=this._getNextFocusableChild(d,1),!d)return;a=d;do{var f=this._keyboardSearchCompare(d,h);f&&0==e++&&(p=d);if(-1==f){e=-1;break}d=this._getNextFocusableChild(d,1)}while(d!=a)})();this.onKeyboardSearch(p,a,h,e)},_onChildBlur:function(){},
_getNextFocusableChild:function(a,b){var p=a;do{if(a)a=this._getNext(a,b);else if(a=this[0<b?"_getFirst":"_getLast"](),!a)break;if(null!=a&&a!=p&&a.isFocusable())return a}while(a!=p);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(d,b){if(d)for(d=d.domNode;d;)if((d=d[0>b?"previousSibling":"nextSibling"])&&"getAttribute"in d){var p=a.byNode(d);if(p)return p}return null}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h){a=n("dijit.MenuItem"+(m("dojo-bidi")?"_NoBidi":""),[q,d,l,p],{templateString:h,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(a){this._set("label",a);var d="",b;b=a.search(/{\S}/);if(0<=b){var d=a.charAt(b+1),f=a.substr(0,b);a=a.substr(b+3);b=f+d+a;a=f+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+d+"\x3c/span\x3e"+a}else b=a;this.domNode.setAttribute("aria-label",b+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",d)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){a&&!("label"in this.params)&&this._set("label",a.innerHTML)},buildRendering:function(){this.inherited(arguments);g.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&g.set(this.accelKeyNode,"id",this.id+"_accel");b.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==m("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(a){}},_setSelected:function(a){e.toggle(this.domNode,
"dijitMenuItemSelected",a)},setLabel:function(a){k.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},setDisabled:function(a){k.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(a){this.accelKeyNode&&(this.accelKeyNode.style.display=
a?"":"none",this.accelKeyNode.innerHTML=a,g.set(this.containerNode,"colSpan",a?"1":"2"));this._set("accelKey",a)}});m("dojo-bidi")&&(a=n("dijit.MenuItem",a,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return a})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(n,b){return n("dijit._Contained",null,{_getSibling:function(g){var e=this.domNode;do e=e[g+"Sibling"];while(e&&1!=e.nodeType);return e&&
b.byNode(e)},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var b=this.getParent();return!b||!b.getIndexOfChild?-1:b.getIndexOfChild(this)}})})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(n,b,g,e,k,m){return n("dijit.MenuSeparator",[g,e,k],{templateString:m,buildRendering:function(){this.inherited(arguments);
b.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/NumberSpinner":function(){define(["dojo/_base/declare","dojo/keys","./_Spinner","./NumberTextBox"],function(n,b,g,e){return n("dijit.form.NumberSpinner",[g,e.Mixin],{baseClass:"dijitTextBox dijitSpinner dijitNumberTextBox",adjust:function(b,e){var a=this.constraints,g=isNaN(b),d=!isNaN(a.max),l=!isNaN(a.min);g&&0!=e&&(b=0<e?l?a.min:d?a.max:0:d?this.constraints.max:l?a.min:0);var p=b+e;if(g||isNaN(p))return b;d&&p>
a.max&&(p=a.max);l&&p<a.min&&(p=a.min);return p},_onKeyDown:function(e){if(!this.disabled&&!this.readOnly&&(e.keyCode==b.HOME||e.keyCode==b.END)&&!e.ctrlKey&&(!e.altKey&&!e.metaKey)&&"undefined"!=typeof this.get("value")){var g=this.constraints[e.keyCode==b.HOME?"min":"max"];"number"==typeof g&&this._setValueAttr(g,!1);e.stopPropagation();e.preventDefault()}}})})},"dijit/form/_Spinner":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/sniff dojo/mouse dojo/on ../typematic ./RangeBoundTextBox dojo/text!./templates/Spinner.html ./_TextBoxMixin".split(" "),
function(n,b,g,e,k,m,a,q,d,l){return n("dijit.form._Spinner",q,{defaultTimeout:500,minimumTimeout:10,timeoutChangeRate:0.9,smallDelta:1,largeDelta:10,templateString:d,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{upArrowNode:"dijitUpArrowButton",downArrowNode:"dijitDownArrowButton"},adjust:function(a){return a},_arrowPressed:function(a,d,b){!this.disabled&&!this.readOnly&&(this._setValueAttr(this.adjust(this.get("value"),d*b),!1),l.selectInputText(this.textbox,this.textbox.value.length))},
_arrowReleased:function(){this._wheelTimer=null},_typematicCallback:function(a,d,e){var l=this.smallDelta;d==this.textbox&&(d=e.keyCode,l=d==b.PAGE_UP||d==b.PAGE_DOWN?this.largeDelta:this.smallDelta,d=d==b.UP_ARROW||d==b.PAGE_UP?this.upArrowNode:this.downArrowNode);-1==a?this._arrowReleased(d):this._arrowPressed(d,d==this.upArrowNode?1:-1,l)},_wheelTimer:null,_mouseWheeled:function(a){a.stopPropagation();a.preventDefault();var d=a.wheelDelta/120;Math.floor(d)!=d&&(d=0<a.wheelDelta?1:-1);a=a.detail?
-1*a.detail:d;if(0!==a){var b=this[0<a?"upArrowNode":"downArrowNode"];this._arrowPressed(b,a,this.smallDelta);this._wheelTimer&&this._wheelTimer.remove();this._wheelTimer=this.defer(function(){this._arrowReleased(b)},50)}},_setConstraintsAttr:function(a){this.inherited(arguments);this.focusNode&&(void 0!==this.constraints.min?this.focusNode.setAttribute("aria-valuemin",this.constraints.min):this.focusNode.removeAttribute("aria-valuemin"),void 0!==this.constraints.max?this.focusNode.setAttribute("aria-valuemax",
this.constraints.max):this.focusNode.removeAttribute("aria-valuemax"))},_setValueAttr:function(a,d){this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(m(this.domNode,k.wheel,g.hitch(this,"_mouseWheeled")),a.addListener(this.upArrowNode,this.textbox,{keyCode:b.UP_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),a.addListener(this.downArrowNode,
this.textbox,{keyCode:b.DOWN_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),a.addListener(this.upArrowNode,this.textbox,{keyCode:b.PAGE_UP,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),a.addListener(this.downArrowNode,this.textbox,{keyCode:b.PAGE_DOWN,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",
this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout))}})})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare","dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(n,b,g){return n("dijit.form.RangeBoundTextBox",g,{rangeMessage:"",rangeCheck:function(b,k){return("min"in k?0<=this.compare(b,k.min):!0)&&("max"in k?0>=this.compare(b,k.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var b=
this.get("value");if(null==b)return!1;var k=!1;"min"in this.constraints&&(k=this.constraints.min,k=0>this.compare(b,"number"==typeof k&&0<=k&&0!=b?0:k));!k&&"max"in this.constraints&&(k=this.constraints.max,k=0<this.compare(b,"number"!=typeof k||0<k?k:0));return k},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(b){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(b))},getErrorMessage:function(b){var k=
this.get("value");return null!=k&&""!==k&&("number"!=typeof k||!isNaN(k))&&!this.isInRange(b)?this.rangeMessage:this.inherited(arguments)},postMixInProperties:function(){this.inherited(arguments);this.rangeMessage||(this.messages=b.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(n,b,g,e){return n("dijit.form.MappedTextBox",
e,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(b){return b.toString?b.toString():""},toString:function(){var b=this.filter(this.get("value"));return null!=b?"string"==typeof b?b:this.serialize(b,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=g.place("\x3cinput type\x3d'hidden'"+(this.name&&
!b("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),function(n,b,g,e,k,m){var a=function(a){a=a||{};var b=g.getLocalization("dojo.cldr","number",g.normalizeLocale(a.locale)),e=a.pattern?a.pattern:b[(a.type||"decimal")+"Format"];a="number"==
typeof a.places?a.places:"string"===typeof a.places&&0<a.places.length?a.places.replace(/.*,/,""):-1!=e.indexOf(".")?e.split(".")[1].replace(/[^#0]/g,"").length:0;return{sep:b.decimal,places:a}},q=n("dijit.form.NumberTextBoxMixin",null,{pattern:function(a){return"("+(this.focused&&this.editOptions?this._regExpGenerator(b.delegate(a,this.editOptions))+"|":"")+this._regExpGenerator(a)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:k.format,_regExpGenerator:k.regexp,_decimalInfo:a(),postMixInProperties:function(){this.inherited(arguments);
this._set("type","text")},_setConstraintsAttr:function(d){var b="number"==typeof d.places?d.places:0;b&&b++;"number"!=typeof d.max&&(d.max=9*Math.pow(10,15-b));"number"!=typeof d.min&&(d.min=-9*Math.pow(10,15-b));this.inherited(arguments,[d]);this.focusNode&&(this.focusNode.value&&!isNaN(this.value))&&this.set("value",this.value);this._decimalInfo=a(d)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var a=this.get("value");"number"==typeof a&&!isNaN(a)&&(a=this.format(a,this.constraints),
void 0!==a&&(this.textbox.value=a));this.inherited(arguments)}},format:function(a,e){var p=String(a);if("number"!=typeof a)return p;if(isNaN(a))return"";if(!("rangeCheck"in this&&this.rangeCheck(a,e))&&!1!==e.exponent&&/\de[-+]?\d/i.test(p))return p;this.editOptions&&this.focused&&(e=b.mixin({},e,this.editOptions));return this._formatter(a,e)},_parser:k.parse,parse:function(a,e){var p=this._parser(a,b.mixin({},e,this.editOptions&&this.focused?this.editOptions:{}));this.editOptions&&(this.focused&&
isNaN(p))&&(p=this._parser(a,e));return p},_getDisplayedValueAttr:function(){var a=this.inherited(arguments);return isNaN(a)?this.textbox.value:a},filter:function(a){if(null==a||"string"==typeof a&&""==a)return NaN;"number"==typeof a&&(!isNaN(a)&&0!=a)&&(a=k.round(a,this._decimalInfo.places));return this.inherited(arguments,[a])},serialize:function(a,b){return"number"!=typeof a||isNaN(a)?"":this.inherited(arguments)},_setBlurValue:function(){var a=b.hitch(b.delegate(this,{focused:!0}),"get")("value");
this._setValueAttr(a,!0)},_setValueAttr:function(a,b,e){if(void 0!==a&&void 0===e)if(e=String(a),"number"==typeof a)if(isNaN(a))e="";else{if("rangeCheck"in this&&this.rangeCheck(a,this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(e))e=void 0}else a?a=void 0:(e="",a=NaN);this.inherited(arguments,[a,b,e])},_getValueAttr:function(){var a=this.inherited(arguments);if(isNaN(a)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&RegExp("^"+
k._realNumberRegexp(b.delegate(this.constraints))+"$").test(this.textbox.value))return a=Number(this.textbox.value),isNaN(a)?void 0:a}else return a},isValid:function(a){if(!this.focused||this._isEmpty(this.textbox.value))return this.inherited(arguments);var b=this.get("value");return!isNaN(b)&&this.rangeCheck(b,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var a="number"==typeof this.constraints.min,
b="number"==typeof this.constraints.max,p=this.get("value");if(isNaN(p)||!a&&!b)return this.inherited(arguments);var h=p|0,k=0>p,g=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),m=(this.maxLength||20)-this.textbox.value.length,f=g?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",h=g?h+"."+f:h+"",m=e.rep("9",m),g=p;k?g=Number(h+m):p=Number(h+m);return!(a&&p<this.constraints.min||b&&g>this.constraints.max)}});n=n("dijit.form.NumberTextBox",[m,q],{baseClass:"dijitTextBox dijitNumberTextBox"});
n.Mixin=q;return n})},"jimu/dijit/ColorPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/ColorPalette dijit/popup".split(" "),function(n,b,g,e,k,m,a,q,d,l){return n([b,g],{baseClass:"jimu-color-picker",declaredClass:"jimu.dijit.ColorPicker",templateString:"\x3cdiv\x3e\x3c/div\x3e",color:null,postCreate:function(){this.inherited(arguments);this.color?this.color instanceof a||(this.color=
new a(this.color)):this.color=new a("#ccc");k.setStyle(this.domNode,"backgroundColor",this.color.toHex());this.tooltipDialog=this._createTooltipDialog(this.domNode)},destroy:function(){l.close(this.tooltipDialog);this.palette.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},_createTooltipDialog:function(b){var h=k.create("div"),g=new q({style:"width: 250px;cursor:pointer",content:h}),r=new d({palette:"7x10",cellClass:"cursor:pointer",onChange:e.hitch(this,function(d){k.setStyle(b,
"backgroundColor",d);l.close(g);this.color=new a(d);this.onChange(this.color)})});r.placeAt(h);r.startup();this.own(m(b,"click",e.hitch(this,function(a){a.stopPropagation();a.preventDefault();l.open({parent:this.getParent(),popup:g,around:b})})));this.own(m(document.body,"click",e.hitch(this,function(a){a=a.target||a.srcElement;var d=g.domNode;a===d||k.isDescendant(a,d)||l.close(g)})));this.palette=r;return g},setColor:function(d){if(d instanceof a){var b=this.color,e="";b&&(e=b.toHex());b=d.toHex();
this.color=d;k.setStyle(this.domNode,"backgroundColor",b);if(e!==b)this.onChange(new a(b))}},getColor:function(){return this.color},onChange:function(a){}})})},"dijit/ColorPalette":function(){define("require dojo/text!./templates/ColorPalette.html ./_Widget ./_TemplatedMixin ./_PaletteMixin ./hccss dojo/i18n dojo/_base/Color dojo/_base/declare dojo/dom-construct dojo/string dojo/i18n!dojo/nls/colors dojo/colors".split(" "),function(n,b,g,e,k,m,a,q,d,l,p){var h=d("dijit.ColorPalette",[g,e,k],{palette:"7x10",
_palettes:{"7x10":["white seashell cornsilk lemonchiffon lightyellow palegreen paleturquoise lightcyan lavender plum".split(" "),"lightgray pink bisque moccasin khaki lightgreen lightseagreen lightskyblue cornflowerblue violet".split(" "),"silver lightcoral sandybrown orange palegoldenrod chartreuse mediumturquoise skyblue mediumslateblue orchid".split(" "),"gray red orangered darkorange yellow limegreen darkseagreen royalblue slateblue mediumorchid".split(" "),"dimgray crimson chocolate coral gold forestgreen seagreen blue blueviolet darkorchid".split(" "),
"darkslategray firebrick saddlebrown sienna olive green darkcyan mediumblue darkslateblue darkmagenta".split(" "),"black darkred maroon brown darkolivegreen darkgreen midnightblue navy indigo purple".split(" ")],"3x4":[["white","lime","green","blue"],["silver","yellow","fuchsia","navy"],["gray","red","purple","black"]]},templateString:b,baseClass:"dijitColorPalette",_dyeFactory:function(a,d,b,f){return new this._dyeClass(a,d,b,f)},buildRendering:function(){this.inherited(arguments);this._dyeClass=
d(h._Color,{palette:this.palette});this._preparePalette(this._palettes[this.palette],a.getLocalization("dojo","colors",this.lang))}});h._Color=d("dijit._Color",q,{template:"\x3cspan class\x3d'dijitInline dijitPaletteImg'\x3e\x3cimg src\x3d'${blankGif}' alt\x3d'${alt}' title\x3d'${title}' class\x3d'dijitColorPaletteSwatch' style\x3d'background-color: ${color}'/\x3e\x3c/span\x3e",hcTemplate:"\x3cspan class\x3d'dijitInline dijitPaletteImg' style\x3d'position: relative; overflow: hidden; height: 12px; width: 14px;'\x3e\x3cimg src\x3d'${image}' alt\x3d'${alt}' title\x3d'${title}' style\x3d'position: absolute; left: ${left}px; top: ${top}px; ${size}'/\x3e\x3c/span\x3e",
_imagePaths:{"7x10":n.toUrl("./themes/a11y/colors7x10.png"),"3x4":n.toUrl("./themes/a11y/colors3x4.png")},constructor:function(a,d,b,f){this._title=f;this._row=d;this._col=b;this.setColor(q.named[a])},getValue:function(){return this.toHex()},fillCell:function(a,d){var b=p.substitute(m("highcontrast")?this.hcTemplate:this.template,{color:this.toHex(),blankGif:d,alt:this._title,title:this._title,image:this._imagePaths[this.palette].toString(),left:-20*this._col-5,top:-20*this._row-5,size:"7x10"==this.palette?
"height: 145px; width: 206px":"height: 64px; width: 86px"});l.place(b,a)}});return h})},"dijit/_PaletteMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on ./_CssStateMixin ./a11yclick ./focus ./typematic".split(" "),function(n,b,g,e,k,m,a,q,d,l,p){return n("dijit._PaletteMixin",q,{defaultTimeout:500,timeoutChangeRate:0.9,value:"",_selectedCell:-1,tabIndex:"0",cellClass:"dijitPaletteCell",dyeClass:null,_dyeFactory:function(a){return new ("string"==
typeof this.dyeClass?m.getObject(this.dyeClass):this.dyeClass)(a)},_preparePalette:function(b,l){this._cells=[];var g=this._blankGif;this.own(a(this.gridNode,d,m.hitch(this,"_onCellClick")));for(var q=0;q<b.length;q++)for(var f=e.create("tr",{tabIndex:"-1",role:"row"},this.gridNode),c=0;c<b[q].length;c++){var n=b[q][c];if(n){var w=this._dyeFactory(n,q,c,l[n]),n=e.create("td",{"class":this.cellClass,tabIndex:"-1",title:l[n],role:"gridcell"},f);w.fillCell(n,g);n.idx=this._cells.length;this._cells.push({node:n,
dye:w})}}this._xDim=b[0].length;this._yDim=b.length;var A={UP_ARROW:-this._xDim,DOWN_ARROW:this._xDim,RIGHT_ARROW:this.isLeftToRight()?1:-1,LEFT_ARROW:this.isLeftToRight()?-1:1},x;for(x in A)this.own(p.addKeyListener(this.domNode,{keyCode:k[x],ctrlKey:!1,altKey:!1,shiftKey:!1},this,function(){var a=A[x];return function(c){this._navigateByKey(a,c)}}(),this.timeoutChangeRate,this.defaultTimeout))},postCreate:function(){this.inherited(arguments);this._setCurrent(this._cells[0].node)},focus:function(){l.focus(this._currentFocus)},
_onCellClick:function(a){for(var d=a.target;"TD"!=d.tagName;){if(!d.parentNode||d==this.gridNode)return;d=d.parentNode}var b=this._getDye(d).getValue();this._setCurrent(d);l.focus(d);this._setValueAttr(b,!0);a.stopPropagation();a.preventDefault()},_setCurrent:function(a){"_currentFocus"in this&&b.set(this._currentFocus,"tabIndex","-1");(this._currentFocus=a)&&b.set(a,"tabIndex",this.tabIndex)},_setValueAttr:function(a,d){0<=this._selectedCell&&g.remove(this._cells[this._selectedCell].node,this.cellClass+
"Selected");this._selectedCell=-1;if(a)for(var b=0;b<this._cells.length;b++)if(a==this._cells[b].dye.getValue()){this._selectedCell=b;g.add(this._cells[b].node,this.cellClass+"Selected");break}this._set("value",0<=this._selectedCell?a:null);if(d||void 0===d)this.onChange(a)},onChange:function(){},_navigateByKey:function(a,d){if(-1!=d){var b=this._currentFocus.idx+a;b<this._cells.length&&-1<b&&(b=this._cells[b].node,this._setCurrent(b),this.defer(m.hitch(l,"focus",b)))}},_getDye:function(a){return this._cells[a.idx].dye}})})},
"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(n,b,g,e){var k={};b.setObject("dojo.colors",k);var m=function(a,d,b){0>b&&++b;1<b&&--b;var e=6*b;return 1>e?a+(d-a)*e:1>2*b?d:2>3*b?a+6*(d-a)*(2/3-b):a};n.colorFromRgb=g.fromRgb=function(a,d){var b=a.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(b){var p=b[2].split(/\s*,\s*/),h=p.length,b=b[1];if("rgb"==b&&3==h||"rgba"==b&&4==h)return b=p[0],"%"==b.charAt(b.length-1)?(b=e.map(p,
function(a){return 2.56*parseFloat(a)}),4==h&&(b[3]=p[3]),g.fromArray(b,d)):g.fromArray(p,d);if("hsl"==b&&3==h||"hsla"==b&&4==h){var b=(parseFloat(p[0])%360+360)%360/360,k=parseFloat(p[1])/100,r=parseFloat(p[2])/100,k=0.5>=r?r*(k+1):r+k-r*k,r=2*r-k,b=[256*m(r,k,b+1/3),256*m(r,k,b),256*m(r,k,b-1/3),1];4==h&&(b[3]=p[3]);return g.fromArray(b,d)}}return null};var a=function(a,b,e){a=Number(a);return isNaN(a)?e:a<b?b:a>e?e:a};g.prototype.sanitize=function(){this.r=Math.round(a(this.r,0,255));this.g=Math.round(a(this.g,
0,255));this.b=Math.round(a(this.b,0,255));this.a=a(this.a,0,1);return this};k.makeGrey=g.makeGrey=function(a,b){return g.fromArray([a,a,a,b])};b.mixin(g.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,
149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,
0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],
lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,
0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,
232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,
250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return g})},"jimu/dijit/_Transparency":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!./templates/_Transparency.html dojo/_base/lang dojo/_base/html dojo/on dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dijit/form/HorizontalRule".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h){return n([b,g,e,k],{baseClass:"jimu-transparency",declaredClass:"jimu.dijit.Transparency",templateString:m,nls:null,alpha:1,postMixInProperties:function(){this.nls=window.jimuNls.transparency},postCreate:function(){this.inherited(arguments);"number"===typeof this.alpha&&this.setAlpha(this.alpha)},setAlpha:function(a){a=Math.round(100-100*a);this.opacitySlider.set("value",a)},getAlpha:function(){return Math.round(100-this.opacitySlider.get("value"))/100},_onAlphaChanged:function(){var a=
this.getAlpha();this.emit("change",a)}})})},"dijit/form/HorizontalSlider":function(){define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c,u,w,A,x){var B=b("dijit.form._SliderMover",
p,{onMouseMove:function(a){var c=this.widget,b=c._abspos;b||(b=c._abspos=k.position(c.sliderBarContainer,!0),c._setPixelValue_=q.hitch(c,"_setPixelValue"),c._isReversed_=c._isReversed());a=a[c._mousePixelCoord]-b[c._startingPixelCoord];c._setPixelValue_(c._isReversed_?b[c._pixelCount]-a:a,b[c._pixelCount],!1)},destroy:function(a){p.prototype.destroy.apply(this,arguments);var c=this.widget;c._abspos=null;c._setValueAttr(c.value,!0)}});g=b("dijit.form.HorizontalSlider",[w,A],{templateString:x,value:0,
showButtons:!0,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:!0,slideDuration:t.defaultDuration,_setIdAttr:"",_setNameAttr:"valueNode",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",_onKeyUp:function(a){!this.disabled&&(!this.readOnly&&!a.altKey&&
!a.ctrlKey&&!a.metaKey)&&this._setValueAttr(this.value,!0)},_onKeyDown:function(c){if(!this.disabled&&!this.readOnly&&!c.altKey&&!c.ctrlKey&&!c.metaKey){switch(c.keyCode){case a.HOME:this._setValueAttr(this.minimum,!1);break;case a.END:this._setValueAttr(this.maximum,!1);break;case this._descending||this.isLeftToRight()?a.RIGHT_ARROW:a.LEFT_ARROW:case !1===this._descending?a.DOWN_ARROW:a.UP_ARROW:case !1===this._descending?a.PAGE_DOWN:a.PAGE_UP:this.increment(c);break;case this._descending||this.isLeftToRight()?
a.LEFT_ARROW:a.RIGHT_ARROW:case !1===this._descending?a.UP_ARROW:a.DOWN_ARROW:case !1===this._descending?a.PAGE_UP:a.PAGE_DOWN:this.decrement(c);break;default:return}c.stopPropagation();c.preventDefault()}},_onHandleClick:function(a){!this.disabled&&!this.readOnly&&(d("ie")||f.focus(this.sliderHandle),a.stopPropagation(),a.preventDefault())},_isReversed:function(){return!this.isLeftToRight()},_onBarClick:function(a){if(!this.disabled&&!this.readOnly&&this.clickSelect){f.focus(this.sliderHandle);a.stopPropagation();
a.preventDefault();var c=k.position(this.sliderBarContainer,!0),b=a[this._mousePixelCoord]-c[this._startingPixelCoord];this._setPixelValue(this._isReversed()?c[this._pixelCount]-b:b,c[this._pixelCount],!0);this._movable.onMouseDown(a)}},_setPixelValue:function(a,c,b){if(!this.disabled&&!this.readOnly){var d=this.discreteValues;if(1>=d||Infinity==d)d=c;d--;a=Math.round(a/(c/d));this._setValueAttr(Math.max(Math.min((this.maximum-this.minimum)*a/d+this.minimum,this.maximum),this.minimum),b)}},_setValueAttr:function(a,
c){this._set("value",a);this.valueNode.value=a;this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments);var b=this.maximum>this.minimum?(a-this.minimum)/(this.maximum-this.minimum):0,d=!1===this._descending?this.remainingBar:this.progressBar,f=!1===this._descending?this.progressBar:this.remainingBar;this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);if(c&&0<this.slideDuration&&d.style[this._progressPixelSize]){var h=this,p={},l=parseFloat(d.style[this._progressPixelSize]),
k=this.slideDuration*(b-l/100);0!=k&&(0>k&&(k=0-k),p[this._progressPixelSize]={start:l,end:100*b,units:"%"},this._inProgressAnim=e.animateProperty({node:d,duration:k,onAnimate:function(a){f.style[h._progressPixelSize]=100-parseFloat(a[h._progressPixelSize])+"%"},onEnd:function(){delete h._inProgressAnim},properties:p}),this._inProgressAnim.play())}else d.style[this._progressPixelSize]=100*b+"%",f.style[this._progressPixelSize]=100*(1-b)+"%"},_bumpValue:function(a,c){if(!this.disabled&&!(this.readOnly||
this.maximum<=this.minimum)){var b=m.getComputedStyle(this.sliderBarContainer),d=k.getContentBox(this.sliderBarContainer,b),b=this.discreteValues;if(1>=b||Infinity==b)b=d[this._pixelCount];b--;d=(this.value-this.minimum)*b/(this.maximum-this.minimum)+a;0>d&&(d=0);d>b&&(d=b);d=d*(this.maximum-this.minimum)/b+this.minimum;this._setValueAttr(d,c)}},_onClkBumper:function(a){!this.disabled&&(!this.readOnly&&this.clickSelect)&&this._setValueAttr(a,!0)},_onClkIncBumper:function(){this._onClkBumper(!1===
this._descending?this.minimum:this.maximum)},_onClkDecBumper:function(){this._onClkBumper(!1===this._descending?this.maximum:this.minimum)},decrement:function(c){this._bumpValue(c.keyCode==a.PAGE_DOWN?-this.pageIncrement:-1)},increment:function(c){this._bumpValue(c.keyCode==a.PAGE_UP?this.pageIncrement:1)},_mouseWheeled:function(a){a.stopPropagation();a.preventDefault();this._bumpValue(0>a.wheelDelta?-1:1,!0)},startup:function(){this._started||(n.forEach(this.getChildren(),function(a){this[a.container]!=
this.containerNode&&this[a.container].appendChild(a.domNode)},this),this.inherited(arguments))},_typematicCallback:function(a,c,b){if(-1==a)this._setValueAttr(this.value,!0);else this[c==(this._descending?this.incrementButton:this.decrementButton)?"decrement":"increment"](b)},buildRendering:function(){this.inherited(arguments);this.showButtons&&(this.incrementButton.style.display="",this.decrementButton.style.display="");var a=h('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+
"_label"),this.focusNode.setAttribute("aria-labelledby",a[0].id));this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum)},postCreate:function(){this.inherited(arguments);this.showButtons&&this.own(c.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),c.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));this.own(r(this.domNode,s.wheel,q.hitch(this,"_mouseWheeled")));var a=b(B,{widget:this});this._movable=
new l(this.sliderHandle,{mover:a});this._layoutHackIE7()},destroy:function(){this._movable.destroy();this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);this.inherited(arguments)}});g._Mover=B;return g})},"dijit/form/HorizontalRuleLabels":function(){define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "),function(n,b,g,e,k,m){n=n("dijit.form.HorizontalRuleLabels",m,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e',
labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:',_labelPrefix:'"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e',_suffix:"\x3c/div\x3e\x3c/div\x3e",_calcPosition:function(a){return a},_genHTML:function(a,b){var d=this.labels[b];return this._positionPrefix+this._calcPosition(a)+this._positionSuffix+this.labelStyle+this._genDirectionHTML(d)+this._labelPrefix+
d+this._suffix},_genDirectionHTML:function(a){return""},getLabels:function(){var a=this.labels;!a.length&&this.srcNodeRef&&(a=e("\x3e li",this.srcNodeRef).map(function(a){return String(a.innerHTML)}));if(!a.length&&1<this.count)for(var b=this.minimum,d=(this.maximum-b)/(this.count-1),l=0;l<this.count;l++)a.push(l<this.numericMargin||l>=this.count-this.numericMargin?"":g.format(b,this.constraints)),b+=d;return a},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();
this.count=this.labels.length}});b("dojo-bidi")&&n.extend({_setTextDirAttr:function(a){this.textDir!=a&&(this._set("textDir",a),e(".dijitRuleLabelContainer",this.domNode).forEach(k.hitch(this,function(a){a.style.direction=this.getTextDir(a.innerText||a.textContent||"")})))},_genDirectionHTML:function(a){return this.textDir?"direction:"+this.getTextDir(a)+";":""}});return n})},"dijit/form/HorizontalRule":function(){define(["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(n,b,g){return n("dijit.form.HorizontalRule",
[b,g],{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e',count:3,container:"containerNode",ruleStyle:"",_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:',_positionSuffix:"%;",_suffix:'"\x3e\x3c/div\x3e',_genHTML:function(b){return this._positionPrefix+b+this._positionSuffix+this.ruleStyle+this._suffix},_isHorizontal:!0,buildRendering:function(){this.inherited(arguments);var b;if(1==this.count)b=this._genHTML(50,0);else{var k,
g=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){b=this._genHTML(0,0);for(k=1;k<this.count-1;k++)b+=this._genHTML(g*k,k);b+=this._genHTML(100,this.count-1)}else{b=this._genHTML(100,0);for(k=1;k<this.count-1;k++)b+=this._genHTML(100-g*k,k);b+=this._genHTML(0,this.count-1)}}this.domNode.innerHTML=b}})})},"jimu/dijit/Search":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/string","dijit/_WidgetBase","dijit/_TemplatedMixin"],function(n,b,g,e,k){return n([e,k],{baseClass:"jimu-search",
declaredClass:"jimu.dijit.Search",templateString:'\x3cdiv\x3e\x3cspan class\x3d"jimu-input-wrapper" style\x3d"left:0;right:0;"\x3e\x3cinput class\x3d"jimu-input" style\x3d"background:#fafafc;" data-dojo-attach-point\x3d"inputSearch" data-dojo-attach-event\x3d"onKeydown: _onKeyDown, onKeyUp: _onKeyUp"/\x3e\x3c/span\x3e\x3cdiv class\x3d"search-btn" data-dojo-attach-point\x3d"searchBtn" data-dojo-attach-event\x3d"onClick: _onBtnClick"\x3e\x3c/div\x3e\x3c/div\x3e',placeholder:"",onSearch:null,searchWhenInput:!1,
postCreate:function(){this.inherited(arguments);this.placeholder&&b.setAttr(this.inputSearch,"placeholder",this.placeholder)},doSearch:function(){if(this.onSearch)this.onSearch(g.trim(this.inputSearch.value))},_onKeyDown:function(b){13===(void 0!==b.keyCode?b.keyCode:b.which)&&this.doSearch();b.stopPropagation()},_onKeyUp:function(){this.searchWhenInput&&this.doSearch()},_onBtnClick:function(){this.doSearch()}})})},"jimu/dijit/Selectionbox":function(){define(["dojo/_base/declare","dijit/_WidgetBase",
"dojo/_base/lang","dojo/on","dojo/dom-class"],function(n,b,g,e,k){return n(b,{baseClass:"jimu-selection-box",declaredClass:"jimu.dijit.Selectionbox",selected:!1,postCreate:function(){this.selected&&k.add(this.domNode,"jimu-selection-box-selected");this.own(e(this.domNode,"click",g.hitch(this,function(){this.selected?this.unSelect():this.select()})))},select:function(){this.selected=!0;k.add(this.domNode,"jimu-selection-box-selected");this.onStateChange()},unSelect:function(){this.selected=!1;k.remove(this.domNode,
"jimu-selection-box-selected");this.onStateChange()},onStateChange:function(){}})})},"jimu/dijit/ServiceURLInput":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/Deferred dojo/aspect esri/request dijit/form/ValidationTextBox".split(" "),function(n,b,g,e,k,m,a,q){return n([q],{_validatingNode:null,_validNode:null,_inValidNode:null,_fetchHandle:null,_fetchErrHandle:null,declaredClass:"jimu.dijit.ServiceURLInput",verify:!0,postCreate:function(){this.inherited(arguments);
this._validatingNode=b.create("div",{"class":"jimu-service-validating"},this.domNode);this._validNode=b.create("div",{"class":"jimu-service-valid"},this.domNode);this._inValidNode=b.create("div",{"class":"jimu-service-invalid"},this.domNode);b.addClass(this.domNode,"jimu-serviceurl-input");this.verify&&this.own(e(this,"Change",g.hitch(this,"_onServiceUrlChange")))},setProcessFunction:function(a,b){this._fetchHandle&&this._fetchErrHandle&&this._removeProcessFunction();"function"===typeof a&&(this._fetchHandle=
m.after(this,"onFetch",a),this.own(this._fetchHandle));"function"===typeof b&&(this._fetchErrHandle=m.after(this,"onFetchError",b),this.own(this._fetchErrHandle))},_removeProcessFunction:function(){this._fetchHandle&&this._fetchHandle.remove&&(this._fetchHandle.remove(),this._fetchHandle=null);this._fetchErrHandle&&this._fetchErrHandle.remove&&(this._fetchErrHandle.remove(),this._fetchErrHandle=null)},onFetch:function(a){return a},onFetchError:function(a){},_onServiceUrlChange:function(b){var e=new k;
e.then(g.hitch(this,function(){this._valid()}),g.hitch(this,function(){this._inValid();this.onFetchError()}));this._validating();a({url:g.trim(b||""),handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(g.hitch(this,function(a){this.onFetch({url:this.getValue(),data:a})?e.resolve("success"):e.reject("error")}),g.hitch(this,function(a){e.reject(a)}))},_hideStatus:function(){b.setStyle(this._validNode,{display:"none"});b.setStyle(this._inValidNode,{display:"none"});b.setStyle(this._validatingNode,
{display:"none"})},_validating:function(){b.setStyle(this._validNode,{display:"none"});b.setStyle(this._inValidNode,{display:"none"});b.setStyle(this._validatingNode,{display:"inline-block"});b.removeClass(this.domNode,"jimu-serviceurl-input-invalid")},_valid:function(){b.setStyle(this._validNode,{display:"inline-block"});b.setStyle(this._inValidNode,{display:"none"});b.setStyle(this._validatingNode,{display:"none"});b.removeClass(this.domNode,"jimu-serviceurl-input-invalid")},_inValid:function(){b.setStyle(this._validNode,
{display:"none"});b.setStyle(this._inValidNode,{display:"inline-block"});b.setStyle(this._validatingNode,{display:"none"});b.addClass(this.domNode,"jimu-serviceurl-input-invalid")}})})},"jimu/dijit/SimpleTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query jimu/utils".split(" "),function(n,b,g,e,k,m,a,q,d,l){return n([b,g,e],{baseClass:"jimu-simple-table",declaredClass:"jimu.dijit.SimpleTable",
templateString:'\x3cdiv\x3e\x3cdiv class\x3d"head-section" data-dojo-attach-point\x3d"headDiv"\x3e\x3c/div\x3e\x3cdiv class\x3d"body-section" data-dojo-attach-point\x3d"bodyDiv"\x3e\x3cdiv class\x3d"table-div" data-dojo-attach-point\x3d"tableDiv"\x3e\x3ctable class\x3d"table" cellspacing\x3d"0" onselectstart\x3d"return false;"\x3e\x3ccolgroup\x3e\x3c/colgroup\x3e\x3cthead class\x3d"simple-table-thead"\x3e\x3c/thead\x3e\x3ctbody class\x3d"simple-table-tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
_name:null,_rowIndex:0,REPEATING_ERROR:"REPEATING_ERROR",autoHeight:!0,selectable:!1,fields:null,postMixInProperties:function(){this.nls=window.jimuNls.simpleTable},postCreate:function(){this.inherited(arguments);this._initSelf()},startup:function(){this.inherited(arguments);this._updateUI()},_updateUI:function(){if(this.autoHeight){var a=this.getRows();m.setStyle(this.domNode,"height",40*((0<a.length?a.length:1)+1)+1+"px")}this._updateHeadDiv()},_updateHeadDiv:function(){m.empty(this.headDiv);var b=
k.clone(this.tableDiv),h=d("input[type\x3dradio]",b);a.forEach(h,function(a){a.name="0"});m.place(b,this.headDiv)},_initSelf:function(){this._initAttachPoints();this.own(l.bindClickAndDblclickEvents(this.table,k.hitch(this,function(a){if(a=l.getAncestorDom(a.target||a.srcElement,function(a){return m.hasClass(a,"simple-table-tr")&&m.hasClass(a,"not-empty")},this.tbody))this.selectRow(a),this._onClickRow(a)}),k.hitch(this,function(a){if(a=l.getAncestorDom(a.target||a.srcElement,function(a){return m.hasClass(a,
"simple-table-tr")&&m.hasClass(a,"not-empty")},this.tbody))this.selectRow(a),this._onDblClickRow(a)})));var b=Math.random().toString();this._name="jimu_table_"+b.slice(2,b.length);this.thead=d("thead",this.domNode)[0];this.tbody=d("tbody",this.domNode)[0];if(this.fields&&0<this.fields.length){var h=m.create("tr",{},this.thead);a.forEach(this.fields,k.hitch(this,function(a){var b="auto";"actions"===a.type&&(a.name="actions");a.hidden?b=1:void 0!==a.width&&null!==a.width?b=a.width:"actions"===a.type&&
!a.name&&(a.width=this._calculateActionsWidth(a)+20,b=a.width);m.create("col",{width:b},this.colgroup);b=m.create("th",{innerHTML:a.title,title:a.title},h);a.hidden&&m.addClass(b,"hidden-column");a["class"]&&m.addClass(b,a["class"]);m.addClass(b,a.name)}))}else this.fields=null},_initAttachPoints:function(){this.table=d("table",this.bodyDiv)[0];this.colgroup=d("colgroup",this.bodyDiv)[0];this.head=d("thead",this.bodyDiv)[0];this.tbody=d("tbody",this.bodyDiv)[0]},clear:function(){var b=this._getNotEmptyRows();
m.empty(this.tbody);a.forEach(b,k.hitch(this,function(a){this._onDeleteRow(a)}));this._updateUI();this._rowIndex=0;this._onClearRows(b)},addRows:function(b){var d=[];this.fields&&b instanceof Array&&a.forEach(b,k.hitch(this,function(a){d.push(this.addRow(a,!0))}));this._updateUI();return d},addRow:function(b,d){this._rowIndex++;var e={success:!1,tr:null,errorCode:null,errorMessage:null,repeatFields:null};if(!this.fields||"object"!==typeof b)return e;var l=a.filter(this.fields,k.hitch(this,function(a){return"text"===
a.type&&!0===a.unique})),l=a.filter(l,k.hitch(this,function(a){return 0<this.getRowDataArrayByFieldValue(a.name,b[a.name]).length}));if(0<l.length)return e.errorCode=this.REPEATING_ERROR,e.errorMessage="repeating data",e.repeatFields=l,e;var g=m.create("tr",{"class":"simple-table-tr not-empty"},this.tbody);m.setAttr(g,"rowId","row"+this._rowIndex);a.forEach(this.fields,k.hitch(this,function(a){var c=b[a.name],d=a.type,h=null;"actions"===d?this._createActionsTd(g,a):("text"===d?h=this._createTextTd(g,
a,c):"radio"===d?h=this._createRadioTd(g,a,c):"checkbox"===d?h=this._createCheckboxTd(g,a,c):"empty"===d?h=this._createEmptyTd(g,a):"extension"===d&&(h=this._createExtensionTd(g,a,c)),a.hidden&&m.addClass(h,"hidden-column"))}));d||(this._setRowOdevity(),this._updateUI());e.success=!0;e.tr=g;e.errorMessage=null;this._onAddRow(g);return e},deleteRow:function(a){a&&(m.destroy(a),this._setRowOdevity(),this._updateUI(),this._onDeleteRow(a))},selectRow:function(a){this.selectable&&(d(".simple-table-tr",
this.tbody).removeClass("selected"),m.addClass(a,"selected"),this._onSelectRow(a))},_setRowOdevity:function(){var b=d(".simple-table-tr",this.tbody);b.removeClass("odd");b.removeClass("even");a.forEach(b,k.hitch(this,function(a,b){0===b%2?m.addClass(a,"odd"):m.addClass(a,"even")}))},_createTextTd:function(a,b,d){var e=null;return e=b.editable?this._createEditableTextTd(a,b,d):this._createNormalTextTd(a,b,d)},_createNormalTextTd:function(a,b,e){var l=m.toDom('\x3ctd class\x3d"simple-table-td normal-text-td"\x3e\x3cdiv class\x3d"normal-text-div"\x3e\x3c/div\x3e\x3c/td\x3e');
m.addClass(l,b.name);d("div",l)[0].innerHTML=e||"";b["class"]&&m.addClass(l,b["class"]);m.place(l,a);return l},_createEditableTextTd:function(a,b,e){var l=m.toDom('\x3ctd class\x3d"editable-text-td '+b.name+'"\x3e\x3cdiv class\x3d"editable-div"\x3e\x3c/div\x3e\x3cinput class\x3d"editable-input" type\x3d"text" style\x3d"display:none;" /\x3e\x3c/td\x3e');m.addClass(l,"simple-table-td");m.place(l,a);b["class"]&&m.addClass(l,b["class"]);var g=d("div",l)[0],f=d("input",l)[0];g.innerHTML=e||"";""!==g.innerHTML&&
(g.title=g.innerHTML);f.value=g.innerHTML;this.own(q(g,"dblclick",k.hitch(this,function(a){a.stopPropagation();f.value=g.innerHTML;m.setStyle(g,"display","none");m.setStyle(f,"display","inline");f.focus();this._updateUI()})));this.own(q(f,"blur",k.hitch(this,function(){f.value=k.trim(f.value);var c=g.innerHTML,d=f.value;""!==d?b.unique?0<this.getRowDataArrayByFieldValue(b.name,d,a).length?f.value=c:g.innerHTML=d:g.innerHTML=d:f.value=c;m.setStyle(f,"display","none");m.setStyle(g,"display","block");
this._updateUI()})));return l},_createRadioTd:function(a,b,e){var l=m.toDom('\x3ctd class\x3d"radio-td '+b.name+'"\x3e\x3cinput type\x3d"radio" /\x3e\x3c/td\x3e');m.addClass(l,"simple-table-td");m.place(l,a);b["class"]&&m.addClass(l,b["class"]);a=d("input",l)[0];a.name=b.radio&&"row"===b.radio?this._name+this._rowIndex:this._name+b.name;a.checked=!0===e;return l},_createCheckboxTd:function(a,b,e){var l=m.toDom('\x3ctd class\x3d"checkbox-td '+b.name+'"\x3e\x3cinput type\x3d"checkbox" /\x3e\x3c/td\x3e');
m.addClass(l,"simple-table-td");m.place(l,a);b["class"]&&m.addClass(l,b["class"]);d("input",l)[0].checked=!0===e;return l},_createActionsTd:function(b,h){var e=m.toDom('\x3ctd class\x3d"actions-td"\x3e\x3cdiv class\x3d"action-item-parent"\x3e\x3c/div\x3e\x3c/td\x3e');m.addClass(e,"simple-table-td");var l=d(".action-item-parent",e)[0];m.place(e,b);h["class"]&&m.addClass(e,h["class"]);a.forEach(h.actions,k.hitch(this,function(f){"up"===f?(f=m.create("div",{"class":"action-item jimu-float-leading row-up-div"},
l),f.title=this.nls.moveUp,this.own(q(f,"click",k.hitch(this,function(c){c.stopPropagation();if(this.onBeforeRowUp(b)){c=d(".simple-table-tr",this.tbody);var f=a.indexOf(c,b);0<f&&(c=c[f-1])&&m.place(b,c,"before");this._setRowOdevity();this._updateUI()}})))):"down"===f?(f=m.create("div",{"class":"action-item jimu-float-leading row-down-div"},l),f.title=this.nls.moveDown,this.own(q(f,"click",k.hitch(this,function(c){c.stopPropagation();if(this.onBeforeRowDown(b)){c=d(".simple-table-tr",this.tbody);
var f=a.indexOf(c,b);f<c.length-1&&(c=c[f+1])&&m.place(b,c,"after");this._setRowOdevity();this._updateUI()}})))):"edit"===f?(f=m.create("div",{"class":"action-item jimu-float-leading row-edit-div"},l),f.title=this.nls.edit,this.own(q(f,"click",k.hitch(this,function(a){a.stopPropagation();this.onBeforeRowEdit(b)&&(this._updateUI(),this._onActionsEdit(b))})))):"delete"===f&&(f=m.create("div",{"class":"action-item jimu-float-leading row-delete-div"},l),f.title=this.nls.deleteRow,this.own(q(f,"click",
k.hitch(this,function(a){a.stopPropagation();this.onBeforeRowDelete(b)&&this.deleteRow(b)}))))}));var g=this._calculateActionsWidth(h)+"px";m.setStyle(l,"width",g);return e},_calculateActionsWidth:function(b){return 20*a.map(b.actions,function(a){return"up"===a||"down"===a||"edit"===a||"delete"===a}).length},_createEmptyTd:function(a,b){var d=m.create("td",{"class":b.name},a);m.addClass(d,"simple-table-td");m.addClass(d,"empty-text-td");b["class"]&&m.addClass(d,b["class"]);return d},_createExtensionTd:function(a,
b,d){a=m.create("td",{"class":b.name},a);m.addClass(a,"simple-table-td");m.addClass(a,"extension-td");b["class"]&&m.addClass(a,b["class"]);b.create&&"function"===typeof b.create&&b.create(a);b.setValue&&"function"===typeof b.setValue&&b.setValue(a,d);return a},editRow:function(b,h){var e={success:!1,tr:null,errorCode:null,errorMessage:null,repeatFields:null};if(!this.fields||"object"!==typeof h||!m.isDescendant(b,this.tbody))return e;var l=k.mixin([],this.fields),l=a.filter(l,k.hitch(this,function(a){return"text"===
a.type&&!0===a.unique})),l=a.filter(l,k.hitch(this,function(a){return 0<this.getRowDataArrayByFieldValue(a.name,h[a.name],b).length}));if(0<l.length)return e.errorCode=this.REPEATING_ERROR,e.errorMessage="repeating data",e.repeatFields=l,e;var g=d(".simple-table-td",b);a.forEach(this.fields,k.hitch(this,function(a,c){if(h.hasOwnProperty(a.name)){var b=g[c],d=h[a.name],e=a.type;"text"===e?a.editable?this._editEditableText(b,a,d):this._editNormalText(b,a,d):"radio"===e?this._editRadio(b,a,d):"checkbox"===
e?this._editCheckbox(b,a,d):"extension"===e&&this._editExtension(b,a,d)}}));e.success=!0;e.tr=b;e.errorMessage=null;this._onEditRow(b);return e},_editNormalText:function(a,b,e){a=d("div",a)[0];a.innerHTML=e||"";a.title=a.innerHTML},_editEditableText:function(a,b,e){b=d("div",a)[0];b.innerHTML=e||"";d("input",a)[0].value=b.innerHTML},_editRadio:function(a,b,e){d("input",a)[0].checked=!0===e},_editCheckbox:function(a,b,e){d("input",a)[0].checked=!0===e},_editExtension:function(a,b,d){b.setValue&&"function"===
typeof b.setValue&&b.setValue(a,d)},_getAllRows:function(){return d(".simple-table-tr",this.tbody)},_getNotEmptyRows:function(){var b=this._getAllRows();return a.filter(b,k.hitch(this,function(a){return!m.hasClass(a,"empty")}))},_getEmptyRows:function(){var b=this._getAllRows();return a.filter(b,k.hitch(this,function(a){return m.hasClass(a,"empty")}))},getRows:function(){return this._getNotEmptyRows()},getSelectedRow:function(){var b=null,h=d(".simple-table-tr",this.tbody),h=a.filter(h,k.hitch(this,
function(a){return!m.hasClass(a,"empty")&&m.hasClass(a,"selected")}));0<h.length&&(b=h[0]);return b},getSelectedRowData:function(){var a=null,b=this.getSelectedRow();b&&(a=this._getRowDataByTr(b));return a},getData:function(b){var d=this._getNotEmptyRows();b&&(d=a.filter(d,k.hitch(this,function(a){return a!==b})));return a.map(d,k.hitch(this,function(a){return this._getRowDataByTr(a)}))},getRowData:function(a){return this._getRowDataByTr(a)},_getRowDataByTr:function(b){var h=null;if(b)h={};else return null;
a.forEach(this.fields,k.hitch(this,function(a){var e=a.type;if("actions"!==e){var l=a.name;h[l]=null;var f=d("."+l,b)[0];f&&("text"===e?(a=d("div",f)[0],h[l]=a.innerHTML):"radio"===e?(a=d("input",f)[0],h[l]=a.checked):"checkbox"===e?(a=d("input",f)[0],h[l]=a.checked):"extension"===e&&a.getValue&&"function"===typeof a.getValue&&(h[l]=a.getValue(f,a)))}}));return h},getRowDataArrayByFieldValue:function(b,d,e){var l=[];if(!this.fields||!a.some(this.fields,k.hitch(this,function(a){return a.name===b})))return[];
e=this.getData(e);return l=a.filter(e,k.hitch(this,function(a){return a[b]==d}))},_onClickRow:function(a){this.emit("row-click",a)},_onDblClickRow:function(a){this.emit("row-dblclick",a)},_onSelectRow:function(a){this.emit("row-select",a)},_onAddRow:function(a){this.emit("row-add",a)},_onEditRow:function(a){this.emit("row-edit",a)},_onDeleteRow:function(a){this.emit("row-delete",a)},_onEnterRow:function(a){this.emit("row-enter",a)},_onClearRows:function(a){this.emit("rows-clear",a)},_onActionsEdit:function(a){this.emit("actions-edit",
a)},onBeforeRowUp:function(a){return!0},onBeforeRowDown:function(a){return!0},onBeforeRowEdit:function(a){return!0},onBeforeRowDelete:function(a){return!0}})})},"jimu/dijit/TabContainer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin ./ViewStack ../utils".split(" "),function(n,b,g,e,k,m,a,q,d,l){return n([a,q,m],{baseClass:"jimu-tab",declaredClass:"jimu.dijit.TabContainer",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"control" data-dojo-attach-point\x3d"controlNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\x3c/div\x3e',
postCreate:function(){this.inherited(arguments);if(0!==this.tabs.length){this.controlNodes=[];this.viewStack=new d(null,this.containerNode);var a=100*(1/this.tabs.length);this.isNested&&e.addClass(this.domNode,"nested");g.forEach(this.tabs,function(b){this._createTab(b,a)},this)}},startup:function(){this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title);l.setVerticalCenter(this.domNode)},_createTab:function(a,d){var l;l=e.create("div",{innerHTML:a.title,
"class":"tab jimu-vcenter-text",style:{width:this.isNested?"auto":d+"%"},label:a.title},this.controlNode);this.viewStack.viewType=a.content.domNode?"dijit":"dom";a.content.label=a.title;this.viewStack.addView(a.content);this.own(k(l,"click",b.hitch(this,this.onSelect,a.title)));l.label=a.title;this.controlNodes.push(l)},onSelect:function(a){this.selectTab(a)},selectTab:function(a){this._selectControl(a);this.viewStack.switchView(a);this.emit("tabChanged",a)},_selectControl:function(a){g.forEach(this.controlNodes,
function(b){e.removeClass(b,"jimu-state-selected");b.label===a&&e.addClass(b,"jimu-state-selected")})}})})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(n,b,g,e,k){return n(k,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);e.forEach(this.views,b.hitch(this,function(b){1===b.nodeType?(g.place(b,
this.domNode),g.addClass(b,"view")):b.domNode&&(g.place(b.domNode,this.domNode),g.addClass(b.domNode,"view"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var b="",a=this.getSelectedView();a&&(b=a.label);return b},getViewByLabel:function(b){for(var a=0;a<this.views.length;a++)if(b===this.views[a].label)return this.views[a];return null},addView:function(b){this.views.push(b);
1===b.nodeType?(g.place(b,this.domNode),g.addClass(b,"view")):b.domNode&&(g.place(b.domNode,this.domNode),g.addClass(b.domNode,"view"))},removeView:function(b){var a=this.views.length;this.views=e.filter(this.views,function(a){return b!==a});a!==this.views.length&&(1===b.nodeType?g.destroy(b):b.domNode&&b.destroyRecursive())},switchView:function(e){var a,k;a="number"===typeof e?this.views[e]:"string"===typeof e?this.getViewByLabel(e):e;this.views.forEach(b.hitch(this,function(b){b&&(1===b.nodeType?
k=b:b.domNode&&(k=b.domNode),b===a?(g.setStyle(k,"display","block"),b.domNode&&!b._started&&(b.startup(),b._started=!0)):g.setStyle(k,"display","none"))}));this._currentView=a;this.onViewSwitch(a)},onViewSwitch:function(){}})})},"jimu/dijit/TabContainer3":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer3.html jimu/dijit/ViewStack".split(" "),function(n,b,
g,e,k,m,a,q,d,l,p){return n([q,d,m],{templateString:l,selected:"",tabs:null,average:!1,baseClass:"jimu-tab3",declaredClass:"jimu.dijit.TabContainer3",_currentIndex:-1,postCreate:function(){this.inherited(arguments);this._initSelf();this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},selectTab:function(d){var l=a("td",this.tabTr);g.forEach(l,b.hitch(this,function(a,b){e.removeClass(a,"selected");a.label===d?(e.addClass(a,"selected"),a.style.borderLeft=
"1px solid #ccc",a.style.borderRight="1px solid #ccc",a.style.borderTop="2px solid #15a4fa",a.style.borderBottom="0",this._currentIndex=b):(a.style.borderLeft="0",a.style.borderRight="0",a.style.borderTop="0",a.style.borderBottom="1px solid #ccc")}));this.controlNode.removeChild(this.controlTable);e.place(this.controlTable,this.controlNode);this.viewStack.switchView(d);this.emit("tabChanged",d)},addTab:function(b){if(!this.average){var d=a("td:last-child",this.tabTr);0<d.length&&e.destroy(d[0])}0<
g.filter(this.tabs,function(a){return a.title===b.title}).length?console.error("tab title conflict: "+b.title):(this.tabs.push(b),this._createTab(b),this.average||(d=e.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e'),e.place(d,this.tabTr)))},removeTab:function(b){var d=-1;if(g.some(this.tabs,function(a,f){if(a.title===b)return d=f,!0})){var l=this.tabs.splice(d,1)[0],k=a("td",this.tabTr),f;g.some(k,
function(a){if(a.label===b)return f=a,!0})&&e.destroy(f);this.viewStack.removeView(l.content)}},showShelter:function(){e.setStyle(this.shelter,"display","block")},hideShelter:function(){e.setStyle(this.shelter,"display","none")},getSelectedIndex:function(){return this._currentIndex},getSelectedTitle:function(){return this.viewStack.getSelectedLabel()},_initSelf:function(){this.viewStack=new p(null,this.containerNode);g.forEach(this.tabs,function(a){this._createTab(a)},this);if(this.average)this.controlTable.style.tableLayout=
"fixed";else{var a=e.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');e.place(a,this.tabTr)}},startup:function(){this.inherited(arguments);this._started=!0},_createTab:function(d){var l=e.toDom('\x3ctd nowrap class\x3d"tab-item-td"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');l.label=d.title||"";e.place(l,this.tabTr);var g=a(".tab-item-div",l)[0];g.innerHTML=l.label;g.label=l.label;
d.content.label=l.label;this.viewStack.addView(d.content);this.own(k(l,"click",b.hitch(this,this._onSelect,d.title)))},_onSelect:function(a){this.selectTab(a)}})})},"jimu/dijit/TileLayoutContainer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dijit/_WidgetBase"],function(n,b,g,e){return n([e],{baseClass:"jimu-tile-container",declaredClass:"jimu.dijit.TileLayoutContainer",constructor:function(){this.items=[];this.vmargin=this.hmargin=15},startup:function(){this.inherited(arguments);
this.items.forEach(b.hitch(this,function(b){this._placeItem(b)}));this.resize()},_placeItem:function(b){b.domNode?g.place(b.domNode,this.domNode):g.place(b,this.domNode)},addItem:function(b){this.items.push(b);this._placeItem(b);this.resize()},addItems:function(e){this.items=this.items.concat(e);this.items.forEach(b.hitch(this,function(b){this._placeItem(b)}));this.resize()},removeItem:function(b){var e;for(e=0;e<this.items.length;e++)if(this.items[e].label===b){this.items[e].domNode?this.items[e].destroy():
g.destroy(this.items[e]);this.items.splice(e,1);this.resize();break}},empty:function(){var b;for(b=0;b<this.items.length;b++)this.items[b].domNode?this.items[b].destroy():g.destroy(this.items[b]);this.items=[]},resize:function(){var e,m,a;e=g.getMarginBox(this.domNode);m=this.getItemSize(e);a=Math.floor((e.w+this.hmargin)/(m.width+this.hmargin));this.items.forEach(b.hitch(this,function(b,d){this.setItemPosition(b,d,m,a)}))},getItemSize:function(b){var e={},a;if("fixWidth"===this.strategy)e.width=
this.itemSize.width,e.height=this.itemSize.height;else if("breakWidth"===this.strategy)for(a=0;a<this.itemSize.length;a++){if(b.w<=this.itemSize[a].screenWidth){e.width=this.itemSize[a].width;e.height=this.itemSize[a].height;break}}else"fixCols"===this.strategy&&(e.width=(b.w-this.hmargin*(this.maxCols-1))/this.maxCols,e.height="number"===typeof this.itemSize.height?this.itemSize.height:e.width*parseFloat(this.itemSize.height.substring(0,this.itemSize.height.length-1))/100);return e},setItemPosition:function(b,
e,a,q){e++;var d=e%q;e=Math.ceil(e/q);0===d&&(d=q);q={position:"absolute",top:(this.vmargin+a.height)*(e-1)+"px"};q[window.isRTL?"right":"left"]=(this.hmargin+a.width)*(d-1)+"px";0<=a.width&&(q.width=a.width+"px");0<=a.height&&(q.height=a.height+"px");g.setStyle(b.domNode?b.domNode:b,q)}})})},"jimu/dijit/DrawBox":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/DrawBox.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query esri/layers/GraphicsLayer esri/graphic esri/toolbars/draw esri/symbols/jsonUtils".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r){return n([b,g,e],{templateString:k,baseClass:"jimu-draw-box",declaredClass:"jimu.dijit.DrawBox",nls:null,types:null,pointSymbol:null,polylineSymbol:null,polygonSymbol:null,textSymbol:null,map:null,drawLayer:null,drawLayerId:null,drawToolBar:null,showClear:!1,keepOneGraphic:!1,postMixInProperties:function(){this.nls=window.jimuNls.drawBox},postCreate:function(){this.inherited(arguments);var b={};this.drawLayerId&&(b.id=this.drawLayerId);this.drawLayer=new p(b);
this._initDefaultSymbols();this._initTypes();b=l(".draw-item",this.domNode);this.own(b.on("click",m.hitch(this,this._onItemClick)));this.own(d(this.btnClear,"click",m.hitch(this,this.clear)));this.map&&this.setMap(this.map);a.setStyle(this.btnClear,"display",!0===this.showClear?"block":"none")},disableWebMapPopup:function(){this.map&&this.map.setInfoWindowOnClick(!1)},enableWebMapPopup:function(){this.map&&this.map.setInfoWindowOnClick(!0)},destroy:function(){this.drawToolBar&&this.drawToolBar.deactivate();
this.drawLayer&&this.map&&this.map.removeLayer(this.drawLayer);this.drawLayer=this.map=this.drawToolBar=null;this.inherited(arguments)},setMap:function(a){a&&(this.map=a,this.map.addLayer(this.drawLayer),this.drawToolBar=new s(this.map),this.drawToolBar.setMarkerSymbol(this.pointSymbol),this.drawToolBar.setLineSymbol(this.polylineSymbol),this.drawToolBar.setFillSymbol(this.polygonSymbol),this.own(d(this.drawToolBar,"draw-end",m.hitch(this,this._onDrawEnd))))},setPointSymbol:function(a){this.pointSymbol=
a;this.drawToolBar.setMarkerSymbol(this.pointSymbol)},setLineSymbol:function(a){this.polylineSymbol=a;this.drawToolBar.setLineSymbol(a)},setPolygonSymbol:function(a){this.polygonSymbol=a;this.drawToolBar.setFillSymbol(a)},setTextSymbol:function(a){this.textSymbol=a},clear:function(){this.drawLayer.clear();this.onClear()},deactivate:function(){this.enableWebMapPopup();this.drawToolBar&&this.drawToolBar.deactivate();l(".draw-item",this.domNode).removeClass("selected")},onIconSelected:function(a,b,c){},
onDrawEnd:function(a,b,c){},onClear:function(){},addGraphic:function(a){this.keepOneGraphic&&this.drawLayer.clear();this.drawLayer.add(a)},removeGraphic:function(a){this.drawLayer.remove(a)},_initDefaultSymbols:function(){var a={style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",outline:{color:[0,0,128,255],width:1},type:"esriSMS",size:18},b={style:"esriSLSSolid",color:[79,129,189,255],width:3,name:"Blue 1",type:"esriSLS"},c={style:"esriSFSSolid",color:[79,129,189,128],type:"esriSFS",outline:{style:"esriSLSSolid",
color:[54,93,141,255],width:1.5,type:"esriSLS"}};this.pointSymbol||(this.pointSymbol=r.fromJson(a));this.polylineSymbol||(this.polylineSymbol=r.fromJson(b));this.polygonSymbol||(this.polygonSymbol=r.fromJson(c))},_initTypes:function(){this.types instanceof Array||(this.types=["point","polyline","polygon"]);var b=l(".draw-item",this.domNode);b.style("display","none");q.forEach(b,m.hitch(this,function(b){var c=b.getAttribute("data-commontype"),c=0<=q.indexOf(this.types,c)?"block":"none";a.setStyle(b,
"display",c)}))},_onItemClick:function(b){b=b.target||b.srcElement;l(".draw-item",this.domNode).removeClass("selected");a.addClass(b,"selected");var d=b.getAttribute("data-geotype"),c=b.getAttribute("data-commontype"),e=s[d];this.disableWebMapPopup();this.drawToolBar.activate(e);this.onIconSelected(b,d,c)},_onDrawEnd:function(b){var d=l(".draw-item.selected",this.domNode)[0],c=d.getAttribute("data-geotype"),d=d.getAttribute("data-commontype");b=b.geometry;var e=b.type,g=null,g="point"===e||"multipoint"===
e?a.hasClass(this.textIcon,"selected")?this.textSymbol:this.pointSymbol:"line"===e||"polyline"===e?this.polylineSymbol:this.polygonSymbol;b=new h(b,g,null,null);this.keepOneGraphic&&this.drawLayer.clear();this.drawLayer.add(b);this.deactivate();this.onDrawEnd(b,c,d)}})})},"esri/toolbars/draw":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/_base/window dojo/has dojo/sniff dojo/keys dojo/dom-construct dojo/dom-style dojo/dom-geometry ../kernel ../sniff ./_toolbar ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../graphic ../geometry/jsonUtils ../geometry/webMercatorUtils ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/Rect dojo/i18n!../nls/jsapi".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c,u,w,A,x,B,C,F,G,z){var y=n(t,{declaredClass:"esri.toolbars.Draw",_eventMap:{"draw-complete":!0,"draw-end":["geometry"]},constructor:function(d,e){this.markerSymbol=new f(f.STYLE_SOLID,10,new c(c.STYLE_SOLID,new k([255,0,0]),2),new k([0,0,0,0.25]));this.lineSymbol=new c(c.STYLE_SOLID,new k([255,0,0]),2);this.fillSymbol=new u(u.STYLE_SOLID,new c(c.STYLE_SOLID,new k([255,0,0]),2),new k([0,0,0,0.25]));this._points=[];this._mouse=!a("esri-touch")&&!a("esri-pointer");
this._defaultOptions={showTooltips:!0,drawTime:75,tolerance:8,tooltipOffset:15};this._options=b.mixin(b.mixin({},this._defaultOptions),e||{});if(q("ios")||q("android"))this._options.showTooltips=!1;this._onKeyDownHandler=b.hitch(this,this._onKeyDownHandler);this._onMouseDownHandler=b.hitch(this,this._onMouseDownHandler);this._onMouseUpHandler=b.hitch(this,this._onMouseUpHandler);this._onClickHandler=b.hitch(this,this._onClickHandler);this._onMouseMoveHandler=b.hitch(this,this._onMouseMoveHandler);
this._onMouseDragHandler=b.hitch(this,this._onMouseDragHandler);this._onDblClickHandler=b.hitch(this,this._onDblClickHandler);this._updateTooltip=b.hitch(this,this._updateTooltip);this._hideTooltip=b.hitch(this,this._hideTooltip);this._redrawGraphic=b.hitch(this,this._redrawGraphic)},_geometryType:null,respectDrawingVertexOrder:!1,setRespectDrawingVertexOrder:function(a){this.respectDrawingVertexOrder=a},setMarkerSymbol:function(a){this.markerSymbol=a},setLineSymbol:function(a){this.lineSymbol=a},
setFillSymbol:function(a){this.fillSymbol=a},activate:function(c,d){this._geometryType&&this.deactivate();var f=this.map,h=e.connect,l=y;this._options=b.mixin(b.mixin({},this._options),d||{});f.navigationManager.setImmediateClick(!1);switch(c){case l.ARROW:case l.LEFT_ARROW:case l.RIGHT_ARROW:case l.UP_ARROW:case l.DOWN_ARROW:case l.TRIANGLE:case l.CIRCLE:case l.ELLIPSE:case l.RECTANGLE:this._deactivateMapTools(!0,!1,!1,!0);this._onClickHandler_connect=h(f,"onClick",this._onClickHandler);this._onMouseDownHandler_connect=
h(f,this._mouse?"onMouseDown":"onSwipeStart",this._onMouseDownHandler);this._onMouseDragHandler_connect=h(f,this._mouse?"onMouseDrag":"onSwipeMove",this._onMouseDragHandler);this._onMouseUpHandler_connect=h(f,this._mouse?"onMouseUp":"onSwipeEnd",this._onMouseUpHandler);a("esri-touch")&&!a("esri-pointer")&&(this._onMouseDownHandler2_connect=h(f,"onMouseDown",this._onMouseDownHandler),this._onMouseDragHandler2_connect=h(f,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler2_connect=h(f,"onMouseUp",
this._onMouseUpHandler));break;case l.POINT:this._onClickHandler_connect=h(f,"onClick",this._onClickHandler);break;case l.LINE:case l.EXTENT:case l.FREEHAND_POLYLINE:case l.FREEHAND_POLYGON:this._deactivateMapTools(!0,!1,!1,!0);this._onMouseDownHandler_connect=h(f,this._mouse?"onMouseDown":"onSwipeStart",this._onMouseDownHandler);this._onMouseDragHandler_connect=h(f,this._mouse?"onMouseDrag":"onSwipeMove",this._onMouseDragHandler);this._onMouseUpHandler_connect=h(f,this._mouse?"onMouseUp":"onSwipeEnd",
this._onMouseUpHandler);a("esri-touch")&&!a("esri-pointer")&&(this._onMouseDownHandler2_connect=h(f,"onMouseDown",this._onMouseDownHandler),this._onMouseDragHandler2_connect=h(f,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler2_connect=h(f,"onMouseUp",this._onMouseUpHandler));break;case l.POLYLINE:case l.POLYGON:case l.MULTI_POINT:f.navigationManager.setImmediateClick(!0);this._onClickHandler_connect=h(f,"onClick",this._onClickHandler);this._onDblClickHandler_connect=h(f,"onDblClick",
this._onDblClickHandler);this._dblClickZoom=f.isDoubleClickZoom;f.disableDoubleClickZoom();break;default:console.error("Unsupported geometry type: "+c);return}this._onKeyDown_connect=h(f,"onKeyDown",this._onKeyDownHandler);this._redrawConnect=h(f,"onExtentChange",this._redrawGraphic);this._geometryType=c;this._toggleTooltip(!0);f.snappingManager&&("freehandpolyline"!==this._geometryType&&"freehandpolygon"!==this._geometryType)&&(f.snappingManager._startSelectionLayerQuery(),f.snappingManager._setUpSnapping());
this.onActivate(this._geometryType)},deactivate:function(){var a=this.map;this._clear();var c=e.disconnect;c(this._onMouseMoveHandler_connect);c(this._onMouseDownHandler_connect);c(this._onMouseDragHandler_connect);c(this._onMouseUpHandler_connect);c(this._onMouseDownHandler2_connect);c(this._onMouseDragHandler2_connect);c(this._onMouseUpHandler2_connect);c(this._onClickHandler_connect);c(this._onDblClickHandler_connect);c(this._onKeyDown_connect);c(this._redrawConnect);this._onMouseDownHandler_connect=
this._onMouseMoveHandler_connect=this._onMouseDragHandler_connect=this._onMouseUpHandler_connect=this._onMouseDownHandler2_connect=this._onMouseDragHandler2_connect=this._onMouseUpHandler2_connect=this._onClickHandler_connect=this._onDblClickHandler_connect=this._onKeyDown_connect=this._redrawConnect=null;a.snappingManager&&(a.snappingManager._stopSelectionLayerQuery(),a.snappingManager._killOffSnapping());switch(this._geometryType){case y.CIRCLE:case y.ELLIPSE:case y.TRIANGLE:case y.ARROW:case y.LEFT_ARROW:case y.RIGHT_ARROW:case y.UP_ARROW:case y.DOWN_ARROW:case y.RECTANGLE:case y.LINE:case y.EXTENT:case y.FREEHAND_POLYLINE:case y.FREEHAND_POLYGON:this._activateMapTools(!0,
!1,!1,!0);break;case y.POLYLINE:case y.POLYGON:case y.MULTI_POINT:this._dblClickZoom&&a.enableDoubleClickZoom()}c=this._geometryType;this._geometryType=null;a.navigationManager.setImmediateClick(!1);this._toggleTooltip(!1);this.onDeactivate(c)},_clear:function(){this._graphic&&this.map.graphics.remove(this._graphic,!0);this._tGraphic&&this.map.graphics.remove(this._tGraphic,!0);this._graphic=this._tGraphic=null;this.map.snappingManager&&this.map.snappingManager._setGraphic(null);this._points=[]},
finishDrawing:function(){var a,c=this._points,b=this.map.spatialReference,d=y,c=c.slice(0,c.length);switch(this._geometryType){case d.POLYLINE:if(!this._graphic||2>c.length)return;a=new B(b);a.addPath([].concat(c));break;case d.POLYGON:if(!this._graphic||3>c.length)return;a=new C(b);c=[].concat(c,[c[0].offset(0,0)]);!C.prototype.isClockwise(c)&&!this.respectDrawingVertexOrder&&(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),c.reverse());
a.addRing(c);break;case d.MULTI_POINT:a=new F(b),g.forEach(c,function(c){a.addPoint(c)})}e.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(a)},_drawEnd:function(a){if(a){var c=this.map.spatialReference,b;this.onDrawEnd(a);c&&(c.isWebMercator()?b=x.webMercatorToGeographic(a,!0):4326===c.wkid&&(b=A.fromJson(a.toJson())));this.onDrawComplete({geometry:a,geographicGeometry:b})}},_normalizeRect:function(a,c,b){var d=a.x;a=a.y;var f=c.x;c=c.y;var h=Math.abs(d-
f),e=Math.abs(a-c);return{x:Math.min(d,f),y:Math.max(a,c),width:h,height:e,spatialReference:b}},_onMouseDownHandler:function(c){this._dragged=!1;var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var d=b||c.mapPoint,f=y;b=this.map;var h=b.spatialReference;this._points.push(d.offset(0,0));switch(this._geometryType){case f.LINE:this._graphic=b.graphics.add(new w(new B({paths:[[[d.x,d.y],[d.x,d.y]]],spatialReference:h}),this.lineSymbol),!0);b.snappingManager&&b.snappingManager._setGraphic(this._graphic);
break;case f.FREEHAND_POLYLINE:this._oldPoint=c.screenPoint;d=new B(h);d.addPath(this._points);this._graphic=b.graphics.add(new w(d,this.lineSymbol),!0);b.snappingManager&&b.snappingManager._setGraphic(this._graphic);break;case f.CIRCLE:case f.ELLIPSE:case f.TRIANGLE:case f.ARROW:case f.LEFT_ARROW:case f.RIGHT_ARROW:case f.UP_ARROW:case f.DOWN_ARROW:case f.RECTANGLE:case f.FREEHAND_POLYGON:this._oldPoint=c.screenPoint,d=new C(h),d.addRing(this._points),this._graphic=b.graphics.add(new w(d,this.fillSymbol),
!0),b.snappingManager&&b.snappingManager._setGraphic(this._graphic)}a("esri-touch")&&c.preventDefault()},_onMouseMoveHandler:function(a){var c;this.map.snappingManager&&(c=this.map.snappingManager._snappingPoint);var b=this._points[this._points.length-1];a=c||a.mapPoint;c=this._tGraphic;var d=c.geometry;switch(this._geometryType){case y.POLYLINE:case y.POLYGON:d.setPoint(0,0,{x:b.x,y:b.y}),d.setPoint(0,1,{x:a.x,y:a.y}),c.setGeometry(d)}},_onMouseDragHandler:function(c){if(a("esri-touch")&&!this._points.length)c.preventDefault();
else{this._dragged=!0;var d;this.map.snappingManager&&(d=this.map.snappingManager._snappingPoint);var f=this._points[0],h=d||c.mapPoint,e=this.map,l=e.spatialReference;d=this._graphic;var g=y,k=e.toScreen(f),p=e.toScreen(h),m=[],m=p.x-k.x,p=p.y-k.y,q=Math.sqrt(m*m+p*p);switch(this._geometryType){case g.CIRCLE:this._hideTooltip();d.geometry=C.createCircle({center:k,r:q,numberOfPoints:60,map:e});d.setGeometry(d.geometry);break;case g.ELLIPSE:this._hideTooltip();d.geometry=C.createEllipse({center:k,
longAxis:m,shortAxis:p,numberOfPoints:60,map:e});d.setGeometry(d.geometry);break;case g.TRIANGLE:this._hideTooltip();m=[[0,-q],[0.8660254037844386*q,0.5*q],[-0.8660254037844386*q,0.5*q],[0,-q]];d.geometry=this._toPolygon(m,k.x,k.y);d.setGeometry(d.geometry);break;case g.ARROW:this._hideTooltip();f=p/q;e=m/q;h=0.25*e*q;l=0.25*q/(p/m);q*=0.25*f;m=[[m,p],[m-h*(1+24/l),p+24*e-q],[m-h*(1+12/l),p+12*e-q],[-12*f,12*e],[12*f,-12*e],[m-h*(1-12/l),p-12*e-q],[m-h*(1-24/l),p-24*e-q],[m,p]];d.geometry=this._toPolygon(m,
k.x,k.y);d.setGeometry(d.geometry);break;case g.LEFT_ARROW:this._hideTooltip();m=0>=m?[[m,0],[0.75*m,p],[0.75*m,0.5*p],[0,0.5*p],[0,-0.5*p],[0.75*m,-0.5*p],[0.75*m,-p],[m,0]]:[[0,0],[0.25*m,p],[0.25*m,0.5*p],[m,0.5*p],[m,-0.5*p],[0.25*m,-0.5*p],[0.25*m,-p],[0,0]];d.geometry=this._toPolygon(m,k.x,k.y);d.setGeometry(d.geometry);break;case g.RIGHT_ARROW:this._hideTooltip();m=0<=m?[[m,0],[0.75*m,p],[0.75*m,0.5*p],[0,0.5*p],[0,-0.5*p],[0.75*m,-0.5*p],[0.75*m,-p],[m,0]]:[[0,0],[0.25*m,p],[0.25*m,0.5*p],
[m,0.5*p],[m,-0.5*p],[0.25*m,-0.5*p],[0.25*m,-p],[0,0]];d.geometry=this._toPolygon(m,k.x,k.y);d.setGeometry(d.geometry);break;case g.UP_ARROW:this._hideTooltip();m=0>=p?[[0,p],[-m,0.75*p],[-0.5*m,0.75*p],[-0.5*m,0],[0.5*m,0],[0.5*m,0.75*p],[m,0.75*p],[0,p]]:[[0,0],[-m,0.25*p],[-0.5*m,0.25*p],[-0.5*m,p],[0.5*m,p],[0.5*m,0.25*p],[m,0.25*p],[0,0]];d.geometry=this._toPolygon(m,k.x,k.y);d.setGeometry(d.geometry);break;case g.DOWN_ARROW:this._hideTooltip();m=0<=p?[[0,p],[-m,0.75*p],[-0.5*m,0.75*p],[-0.5*
m,0],[0.5*m,0],[0.5*m,0.75*p],[m,0.75*p],[0,p]]:[[0,0],[-m,0.25*p],[-0.5*m,0.25*p],[-0.5*m,p],[0.5*m,p],[0.5*m,0.25*p],[m,0.25*p],[0,0]];d.geometry=this._toPolygon(m,k.x,k.y);d.setGeometry(d.geometry);break;case g.RECTANGLE:this._hideTooltip();m=[[0,0],[m,0],[m,p],[0,p],[0,0]];d.geometry=this._toPolygon(m,k.x,k.y);d.setGeometry(d.geometry);break;case g.LINE:d.setGeometry(b.mixin(d.geometry,{paths:[[[f.x,f.y],[h.x,h.y]]]}));break;case g.EXTENT:d&&e.graphics.remove(d,!0);d=new G(this._normalizeRect(f,
h,l));d._originOnly=!0;this._graphic=e.graphics.add(new w(d,this.fillSymbol),!0);e.snappingManager&&e.snappingManager._setGraphic(this._graphic);break;case g.FREEHAND_POLYLINE:this._hideTooltip();if(!1===this._canDrawFreehandPoint(c)){a("esri-touch")&&c.preventDefault();return}this._points.push(c.mapPoint.offset(0,0));d.geometry._insertPoints([h.offset(0,0)],0);d.setGeometry(d.geometry);break;case g.FREEHAND_POLYGON:this._hideTooltip();if(!1===this._canDrawFreehandPoint(c)){a("esri-touch")&&c.preventDefault();
return}this._points.push(c.mapPoint.offset(0,0));d.geometry._insertPoints([h.offset(0,0)],0);d.setGeometry(d.geometry)}a("esri-touch")&&c.preventDefault()}},_canDrawFreehandPoint:function(a){if(!this._oldPoint)return!1;var c=this._oldPoint.x-a.screenPoint.x,b=this._oldPoint.y-a.screenPoint.y,d=this._options.tolerance;if((0>c?-1*c:c)<d&&(0>b?-1*b:b)<d)return!1;c=new Date;if(c-this._startTime<this._options.drawTime)return!1;this._startTime=c;this._oldPoint=a.screenPoint;return!0},_onMouseUpHandler:function(c){if(this._dragged){0===
this._points.length&&this._points.push(c.mapPoint.offset(0,0));var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var d=this._points[0];b=b||c.mapPoint;var f=this.map.spatialReference,h=y,e;switch(this._geometryType){case h.CIRCLE:case h.ELLIPSE:case h.TRIANGLE:case h.ARROW:case h.LEFT_ARROW:case h.RIGHT_ARROW:case h.UP_ARROW:case h.DOWN_ARROW:case h.RECTANGLE:e=this._graphic.geometry;break;case h.LINE:e=new B({paths:[[[d.x,d.y],[b.x,b.y]]],spatialReference:f});break;case h.EXTENT:e=
(new G(this._normalizeRect(d,b,f))).getExtent();break;case h.FREEHAND_POLYLINE:e=new B(f);e.addPath([].concat(this._points,[b.offset(0,0)]));break;case h.FREEHAND_POLYGON:e=new C(f),d=[].concat(this._points,[b.offset(0,0),this._points[0].offset(0,0)]),!C.prototype.isClockwise(d)&&!this.respectDrawingVertexOrder&&(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),d.reverse()),e.addRing(d)}a("esri-touch")&&c.preventDefault();this._clear();
this._drawEnd(e)}else this._clear()},_onClickHandler:function(a){var c;this.map.snappingManager&&(c=this.map.snappingManager._snappingPoint);a=c||a.mapPoint;c=this.map;var b=c.toScreen(a),d=y;this._points.push(a.offset(0,0));switch(this._geometryType){case d.POINT:this._drawEnd(a.offset(0,0));this._setTooltipMessage(0);break;case d.POLYLINE:1===this._points.length?(b=new B(c.spatialReference),b.addPath(this._points),this._graphic=c.graphics.add(new w(b,this.lineSymbol),!0),c.snappingManager&&c.snappingManager._setGraphic(this._graphic),
this._onMouseMoveHandler_connect=e.connect(c,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=c.graphics.add(new w(new B({paths:[[[a.x,a.y],[a.x,a.y]]],spatialReference:c.spatialReference}),this.lineSymbol),!0)):(this._graphic.geometry._insertPoints([a.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.lineSymbol),c=this._tGraphic,b=c.geometry,b.setPoint(0,0,a.offset(0,0)),b.setPoint(0,1,a.offset(0,0)),c.setGeometry(b));break;case d.POLYGON:1===this._points.length?
(b=new C(c.spatialReference),b.addRing(this._points),this._graphic=c.graphics.add(new w(b,this.fillSymbol),!0),c.snappingManager&&c.snappingManager._setGraphic(this._graphic),this._onMouseMoveHandler_connect=e.connect(c,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=c.graphics.add(new w(new B({paths:[[[a.x,a.y],[a.x,a.y]]],spatialReference:c.spatialReference}),this.fillSymbol),!0)):(this._graphic.geometry._insertPoints([a.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.fillSymbol),
c=this._tGraphic,b=c.geometry,b.setPoint(0,0,a.offset(0,0)),b.setPoint(0,1,a.offset(0,0)),c.setGeometry(b));break;case d.MULTI_POINT:a=this._points;1===a.length?(b=new F(c.spatialReference),b.addPoint(a[a.length-1]),this._graphic=c.graphics.add(new w(b,this.markerSymbol),!0),c.snappingManager&&c.snappingManager._setGraphic(this._graphic)):(this._graphic.geometry.addPoint(a[a.length-1]),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.markerSymbol));break;case d.ARROW:this._addShape([[0,
0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]],b.x,b.y);break;case d.LEFT_ARROW:this._addShape([[0,0],[24,24],[24,12],[96,12],[96,-12],[24,-12],[24,-24],[0,0]],b.x,b.y);break;case d.RIGHT_ARROW:this._addShape([[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]],b.x,b.y);break;case d.UP_ARROW:this._addShape([[0,0],[-24,24],[-12,24],[-12,96],[12,96],[12,24],[24,24],[0,0]],b.x,b.y);break;case d.DOWN_ARROW:this._addShape([[0,0],[-24,-24],[-12,-24],[-12,-96],[12,-96],
[12,-24],[24,-24],[0,0]],b.x,b.y);break;case d.TRIANGLE:this._addShape([[0,-48],[41.56921938165306,24],[-41.56921938165306,24],[0,-48]],b.x,b.y);break;case d.RECTANGLE:this._addShape([[0,-96],[96,-96],[96,0],[0,0],[0,-96]],b.x-48,b.y+48);break;case d.CIRCLE:this._clear();this._drawEnd(C.createCircle({center:b,r:48,numberOfPoints:60,map:c}));break;case d.ELLIPSE:this._clear(),this._drawEnd(C.createEllipse({center:b,longAxis:48,shortAxis:24,numberOfPoints:60,map:c}))}this._setTooltipMessage(this._points.length)},
_addShape:function(a,c,b){this._setTooltipMessage(0);this._clear();this._drawEnd(this._toPolygon(a,c,b))},_toPolygon:function(a,c,b){var d=this.map,f=new C(d.spatialReference);f.addRing(g.map(a,function(a){return d.toMap({x:a[0]+c,y:a[1]+b})}));return f},_onDblClickHandler:function(c){var b,d=this._points,f=this.map.spatialReference,h=y;a("esri-touch")&&d.push(c.mapPoint);d=d.slice(0,d.length);switch(this._geometryType){case h.POLYLINE:if(!this._graphic||2>d.length){e.disconnect(this._onMouseMoveHandler_connect);
this._clear();this._onClickHandler(c);return}b=new B(f);b.addPath([].concat(d));break;case h.POLYGON:if(!this._graphic||2>d.length){e.disconnect(this._onMouseMoveHandler_connect);this._clear();this._onClickHandler(c);return}b=new C(f);c=[].concat(d,[d[0].offset(0,0)]);!C.prototype.isClockwise(c)&&!this.respectDrawingVertexOrder&&(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),c.reverse());b.addRing(c);break;case h.MULTI_POINT:b=
new F(f),g.forEach(d,function(a){b.addPoint(a)})}e.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(b)},_onKeyDownHandler:function(a){a.keyCode===d.ESCAPE&&(e.disconnect(this._onMouseMoveHandler_connect),this._clear(),this._setTooltipMessage(0))},_toggleTooltip:function(a){this._options.showTooltips&&(a?this._tooltip||(this._tooltip=l.create("div",{"class":"tooltip"},this.map.container),h.isBodyLtr()||p.set(this._tooltip,"direction","rtl"),this._tooltip.style.display=
"none",this._tooltip.style.position="fixed",this._setTooltipMessage(0),this._onTooltipMouseEnterHandler_connect=e.connect(this.map,"onMouseOver",this._updateTooltip),this._onTooltipMouseLeaveHandler_connect=e.connect(this.map,"onMouseOut",this._hideTooltip),this._onTooltipMouseMoveHandler_connect=e.connect(this.map,"onMouseMove",this._updateTooltip)):this._tooltip&&(e.disconnect(this._onTooltipMouseEnterHandler_connect),e.disconnect(this._onTooltipMouseLeaveHandler_connect),e.disconnect(this._onTooltipMouseMoveHandler_connect),
l.destroy(this._tooltip),this._tooltip=null))},_hideTooltip:function(){var a=this._tooltip;a&&(a.style.display="none")},_setTooltipMessage:function(a){var c=this._tooltip;if(c){var b="";switch(this._geometryType){case y.POINT:b=z.toolbars.draw.addPoint;break;case y.ARROW:case y.LEFT_ARROW:case y.RIGHT_ARROW:case y.UP_ARROW:case y.DOWN_ARROW:case y.TRIANGLE:case y.RECTANGLE:case y.CIRCLE:case y.ELLIPSE:b=z.toolbars.draw.addShape;break;case y.LINE:case y.EXTENT:case y.FREEHAND_POLYLINE:case y.FREEHAND_POLYGON:b=
z.toolbars.draw.freehand;break;case y.POLYLINE:case y.POLYGON:b=z.toolbars.draw.start;1===a?b=z.toolbars.draw.resume:2<=a&&(b=z.toolbars.draw.complete);break;case y.MULTI_POINT:b=z.toolbars.draw.addMultipoint,1<=a&&(b=z.toolbars.draw.finish)}c.innerHTML=b}},_updateTooltip:function(a){var c=this._tooltip;if(c){var b;a.clientX||a.pageY?(b=a.clientX,a=a.clientY):(b=a.clientX+m.body().scrollLeft-m.body().clientLeft,a=a.clientY+m.body().scrollTop-m.body().clientTop);c.style.display="none";p.set(c,{left:b+
this._options.tooltipOffset+"px",top:a+"px"});c.style.display=""}},_redrawGraphic:function(a,c,b,d){if(b||this.map.wrapAround180)(a=this._graphic)&&a.setGeometry(a.geometry),(a=this._tGraphic)&&a.setGeometry(a.geometry)},onActivate:function(){},onDeactivate:function(){},onDrawComplete:function(){},onDrawEnd:function(){}});b.mixin(y,{POINT:"point",MULTI_POINT:"multipoint",LINE:"line",EXTENT:"extent",POLYLINE:"polyline",POLYGON:"polygon",FREEHAND_POLYLINE:"freehandpolyline",FREEHAND_POLYGON:"freehandpolygon",
ARROW:"arrow",LEFT_ARROW:"leftarrow",RIGHT_ARROW:"rightarrow",UP_ARROW:"uparrow",DOWN_ARROW:"downarrow",TRIANGLE:"triangle",CIRCLE:"circle",ELLIPSE:"ellipse",RECTANGLE:"rectangle"});return y})},"esri/toolbars/_toolbar":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../Evented"],function(n,b,g,e,k){return n([k],{declaredClass:"esri.toolbars._Toolbar",constructor:function(b){this.map=b},_cursors:{move:"pointer","move-v":"pointer","move-gv":"pointer",box0:"nw-resize",
box1:"n-resize",box2:"ne-resize",box3:"e-resize",box4:"se-resize",box5:"s-resize",box6:"sw-resize",box7:"w-resize",box8:"pointer"},_deactivateMapTools:function(b,a,e,d){var l=this.map;b&&(this._mapNavState={isDoubleClickZoom:l.isDoubleClickZoom,isClickRecenter:l.isClickRecenter,isPan:l.isPan,isRubberBandZoom:l.isRubberBandZoom,isKeyboardNavigation:l.isKeyboardNavigation,isScrollWheelZoom:l.isScrollWheelZoom},l.disableDoubleClickZoom(),l.disableClickRecenter(),l.disablePan(),l.disableRubberBandZoom(),
l.disableKeyboardNavigation());a&&l.hideZoomSlider();e&&l.hidePanArrows();d&&l.graphics.disableMouseEvents()},_activateMapTools:function(b,a,e,d){var l=this.map,g=this._mapNavState;b&&g&&(g.isDoubleClickZoom&&l.enableDoubleClickZoom(),g.isClickRecenter&&l.enableClickRecenter(),g.isPan&&l.enablePan(),g.isRubberBandZoom&&l.enableRubberBandZoom(),g.isKeyboardNavigation&&l.enableKeyboardNavigation(),g.isScrollWheelZoom&&l.enableScrollWheelZoom());a&&l.showZoomSlider();e&&l.showPanArrows();d&&l.graphics.enableMouseEvents()}})})},
"jimu/dijit/URLInput":function(){define(["dojo/_base/declare","dojo/_base/html","dijit/form/ValidationTextBox","dojox/validate/regexp"],function(n,b,g,e){return n([g],{required:!0,invalidMessage:"Invalid url.",trim:!0,rest:!0,allowNamed:!0,allLocal:!1,declaredClass:"jimu.dijit.URLInput",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.urlInput;this.invalidMessage=this.nls.invalidUrl},postCreate:function(){this.inherited(arguments);b.addClass(this.domNode,"jimu-url-input")},
validator:function(b){var g="^"+e.url({allowNamed:this.allowNamed,allLocal:this.allLocal}),g=RegExp(g,"g").test(b);return this.rest?(b=/\/rest\/services/gi.test(b),g&&b):g}})})},"dojox/validate/regexp":function(){define(["dojo/_base/lang","dojo/regexp","dojox/main"],function(n,b,g){var e=n.getObject("validate.regexp",!0,g);return e=g.validate.regexp={ipAddress:function(b){b="object"==typeof b?b:{};"boolean"!=typeof b.allowDottedDecimal&&(b.allowDottedDecimal=!0);"boolean"!=typeof b.allowDottedHex&&
(b.allowDottedHex=!0);"boolean"!=typeof b.allowDottedOctal&&(b.allowDottedOctal=!0);"boolean"!=typeof b.allowDecimal&&(b.allowDecimal=!0);"boolean"!=typeof b.allowHex&&(b.allowHex=!0);"boolean"!=typeof b.allowIPv6&&(b.allowIPv6=!0);"boolean"!=typeof b.allowHybrid&&(b.allowHybrid=!0);var e=[];b.allowDottedDecimal&&e.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");b.allowDottedHex&&e.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]");
b.allowDottedOctal&&e.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]");b.allowDecimal&&e.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");b.allowHex&&e.push("0[xX]0*[\\da-fA-F]{1,8}");b.allowIPv6&&e.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}");b.allowHybrid&&e.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");
b="";0<e.length&&(b="("+e.join("|")+")");return b},host:function(b){b="object"==typeof b?b:{};"boolean"!=typeof b.allowIP&&(b.allowIP=!0);"boolean"!=typeof b.allowLocal&&(b.allowLocal=!1);"boolean"!=typeof b.allowPort&&(b.allowPort=!0);"boolean"!=typeof b.allowNamed&&(b.allowNamed=!1);var g=b.allowPort?"(\\:\\d+)?":"",a="((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)";b.allowIP&&(a+="|"+e.ipAddress(b));b.allowLocal&&(a+="|localhost");b.allowNamed&&
(a+="|^[^-][a-zA-Z0-9_-]*");return"("+a+")"+g},url:function(g){g="object"==typeof g?g:{};"scheme"in g||(g.scheme=[!0,!1]);return b.buildGroupRE(g.scheme,function(b){return b?"(https?|ftps?)\\://":""})+e.host(g)+"(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?"},emailAddress:function(b){b="object"==typeof b?b:{};"boolean"!=typeof b.allowCruft&&(b.allowCruft=!1);b.allowPort=!1;var g="([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@"+e.host(b);b.allowCruft&&
(g="\x3c?(mailto\\:)?"+g+"\x3e?");return g},emailAddressList:function(b){b="object"==typeof b?b:{};"string"!=typeof b.listSeparator&&(b.listSeparator="\\s;,");var g=e.emailAddress(b);return"("+g+"\\s*["+b.listSeparator+"]\\s*)*"+g+"\\s*["+b.listSeparator+"]?\\s*"},numberFormat:function(e){e="object"==typeof e?e:{};"undefined"==typeof e.format&&(e.format="###-###-####");return b.buildGroupRE(e.format,function(e){return b.escapeString(e,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d")})},ca:{postalCode:function(){return"([A-Z][0-9][A-Z] [0-9][A-Z][0-9])"},
province:function(){return"(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)"}},us:{state:function(b){b="object"==typeof b?b:{};"boolean"!=typeof b.allowTerritories&&(b.allowTerritories=!0);"boolean"!=typeof b.allowMilitary&&(b.allowMilitary=!0);var e="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";b.allowTerritories&&(e+="|AS|FM|GU|MH|MP|PW|PR|VI");b.allowMilitary&&(e+="|AA|AE|AP");return"("+e+")"}}}})},
"jimu/PreloadWidgetIconPanel":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/dnd/move dijit/_TemplatedMixin jimu/BaseWidgetPanel dojox/layout/ResizeHandle".split(" "),function(n,b,g,e,k,m,a,q){return n([a,m],{baseClass:"jimu-widget-panel jimu-preload-widget-icon-panel",_positionInfoBox:null,_originalBox:null,widgetIcon:null,_resizeOnOpen:!0,templateString:'\x3cdiv data-dojo-attach-point\x3d"boxNode"\x3e\x3cdiv class\x3d"title" data-dojo-attach-point\x3d"titleNode"\x3e\x3cdiv class\x3d"title-label jimu-vcenter-text jimu-float-leading jimu-leading-margin1"data-dojo-attach-point\x3d"titleLabelNode"\x3e${label}\x3c/div\x3e\x3cdiv class\x3d"close-btn jimu-vcenter jimu-float-trailing" data-dojo-attach-point\x3d"closeNode"data-dojo-attach-event\x3d"onclick:_onCloseBtnClicked"\x3e\x3c/div\x3e\x3cdiv class\x3d"foldable-btn jimu-vcenter jimu-float-trailing" data-dojo-attach-point\x3d"foldableNode"data-dojo-attach-event\x3d"onclick:_onFoldableBtnClicked"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\x3c/div\x3e',
_onFoldableBtnClicked:function(){this._getPositionInfo().isFull&&("block"===g.getStyle(this.containerNode,"display")?(g.setStyle(this.containerNode,"display","none"),g.removeClass(this.foldableNode,"fold-down"),g.addClass(this.foldableNode,"fold-up"),g.setStyle(this.domNode,{position:"absolute",top:"auto",bottom:0,left:0,right:0,height:"auto"}),this.panelManager.minimizePanel(this)):(g.setStyle(this.containerNode,"display","block"),g.removeClass(this.foldableNode,"fold-up"),g.addClass(this.foldableNode,
"fold-down"),g.setStyle(this.domNode,{position:"absolute",right:0,left:0,top:0,width:"100%",height:"100%"})),this.panelManager.maximizePanel(this))},_onCloseBtnClicked:function(){g.setStyle(this.domNode,"display","none");this.panelManager.closePanel(this)},_normalizePositionObj:function(a){var e=this._getLayoutBox();a.left=a.left||e.w-a.right;a.top=a.top||e.h-a.bottom;delete a.right;delete a.bottom;this.position=b.mixin(b.clone(this.position),a)},makePositionInfoBox:function(){this._positionInfoBox=
{w:this.position.width||400,h:this.position.height||400,l:this.position.left||0,t:this.position.top||0}},_makeOriginalBox:function(){this._originalBox={w:this.position.width||400,h:this.position.height||410,l:this.position.left||0,t:this.position.top||0}},makeResizable:function(){this.disableResizable();this.resizeHandle=(new q({targetId:this,minWidth:this._originalBox.w,minHeight:this._originalBox.h,activeResize:!1})).placeAt(this.domNode);this.resizeHandle.startup()},disableResizable:function(){this.resizeHandle&&
(this.resizeHandle.destroy(),this.resizeHandle=null)},makeMoveable:function(a,l,p){this.disableMoveable();var h=g.getMarginBox(jimuConfig.layoutId);h.l=h.l-l+p;h.w+=2*(l-p);this.moveable=new k.boxConstrainedMoveable(this.domNode,{box:h,handle:a||this.titleNode,within:!0});this.own(e(this.moveable,"Moving",b.hitch(this,this.onMoving)));this.own(e(this.moveable,"MoveStop",b.hitch(this,this.onMoveStop)))},disableMoveable:function(){this.moveable&&(this.moveable.destroy(),this.moveable=null)},createHandleNode:function(){return this.titleNode},
startup:function(){this.inherited(arguments);this._normalizePositionObj(this.position);this._makeOriginalBox();this.makePositionInfoBox();var a=this.createHandleNode();this.makeMoveable(a,this._positionInfoBox.w,0.25*this._positionInfoBox.w)},onOpen:function(){this._resizeOnOpen&&(this.resize(),this._resizeOnOpen=!1);this.inherited(arguments)},_switchToFullUI:function(){this.closeNode.style.marginTop="0px";g.removeClass(this.titleNode,"title-normal");g.addClass(this.titleNode,"title-full");g.setStyle(this.foldableNode,
"display","block");"block"===g.getStyle(this.containerNode,"display")&&(g.removeClass(this.foldableNode,"fold-up"),g.addClass(this.foldableNode,"fold-down"))},_switchToNormalUI:function(){this.closeNode.style.marginTop="0px";g.removeClass(this.titleNode,"title-full");g.addClass(this.titleNode,"title-normal");g.setStyle(this.foldableNode,"display","none")},resize:function(a){var e=this._getPositionInfo(),g={left:e.position.left,top:e.position.top,width:this._positionInfoBox.w,height:this._positionInfoBox.h};
a&&(a.t=this.domNode.offsetTop,g.left=a.l?a.l:g.left,g.top=a.t?a.t:g.top,g.width=a.w?a.w:g.width,g.height=a.h?a.h:g.height,this._normalizePositionObj(b.clone(g)),this.makePositionInfoBox(),g.width=this._positionInfoBox.w,g.height=this._positionInfoBox.h);e.position=g;this._onResponsible(e);this.inherited(arguments)},_onResponsible:function(a){a.isFull?(this._fullPosition(),this.disableMoveable(),this.disableResizable(),this._switchToFullUI()):(this._normalPosition(a.position),this.makeResizable(),
this.makeMoveable(),this._switchToNormalUI())},onPositionChange:function(a){this._normalizePositionObj(a);this.makePositionInfoBox();a=this._getPositionInfo();this._onResponsible(a)},destroy:function(){this.widgetIcon=null;this.inherited(arguments)},_getLayoutBox:function(){var a=jimuConfig.layoutId,a="map"===this.positionRelativeTo?jimuConfig.mapId:jimuConfig.layoutId;return g.getMarginBox(a)},_getPositionInfo:function(){var a={isFull:!1,position:{left:0,top:5}},b=this._getLayoutBox(),e=this._positionInfoBox.l;
if(b.w>jimuConfig.widthBreaks[0])a.position.left=window.isRTL?b.w-e:e;else return a.isFull=!0,a;var e=this._positionInfoBox.t,h=b.h-e;e>=h?e>=this._positionInfoBox.h&&(a.position.top=this._positionInfoBox.t-this._positionInfoBox.h-40-3):h>=this._positionInfoBox.h&&(a.position.top=this._positionInfoBox.t+40+3);!a.isFull&&a.position.left+this._positionInfoBox.w>b.w&&(a.position.left-=this._positionInfoBox.w);return a},_fullPosition:function(){g.place(this.domNode,jimuConfig.layoutId);"block"!==g.getStyle(this.containerNode,
"display")&&g.setStyle(this.containerNode,"display","block");g.setStyle(this.domNode,{left:0,width:"100%",top:0,bottom:0,height:"100%"})},_normalPosition:function(a){g.place(this.domNode,jimuConfig.mapId);g.setStyle(this.containerNode,"display","block");g.setStyle(this.domNode,{left:a.left+"px",right:"auto",top:a.top+"px",width:a.width+"px",height:a.height+"px"})},onMoving:function(a){g.setStyle(a.node,"opacity",0.9)},onMoveStop:function(a){g.setStyle(a.node,"opacity",1);a=g.getMarginBox(a.node);
this._normalizePositionObj(b.clone({left:a.l,top:a.t,width:a.w,height:a.h}));this.makePositionInfoBox()}})})},"dojox/layout/ResizeHandle":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/event dojo/_base/fx dojo/_base/window dojo/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/declare dojo/touch dijit/_base/manager dijit/_Widget dijit/_TemplatedMixin".split(" "),function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c){n.experimental("dojox.layout.ResizeHandle");
var u=s("dojox.layout._ResizeHelper",f,{show:function(){h.set(this.domNode,"display","")},hide:function(){h.set(this.domNode,"display","none")},resize:function(a){p.setMarginBox(this.domNode,a)}});return s("dojox.layout.ResizeHandle",[f,c],{targetId:"",targetContainer:null,resizeAxis:"xy",activeResize:!1,activeResizeClass:"dojoxResizeHandleClone",animateSizing:!0,animateMethod:"chain",animateDuration:225,minHeight:100,minWidth:100,constrainMax:!1,maxHeight:0,maxWidth:0,fixedAspect:!1,intermediateChanges:!1,
startTopic:"/dojo/resize/start",endTopic:"/dojo/resize/stop",templateString:'\x3cdiv dojoAttachPoint\x3d"resizeHandle" class\x3d"dojoxResizeHandle"\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/div\x3e',postCreate:function(){this.connect(this.resizeHandle,r.press,"_beginSizing");this.activeResize?this.animateSizing=!1:(this._resizeHelper=t.byId("dojoxGlobalResizeHelper"),this._resizeHelper||(this._resizeHelper=(new u({id:"dojoxGlobalResizeHelper"})).placeAt(a.body()),l.add(this._resizeHelper.domNode,this.activeResizeClass)));
this.minSize||(this.minSize={w:this.minWidth,h:this.minHeight});this.constrainMax&&(this.maxSize={w:this.maxWidth,h:this.maxHeight});this._resizeX=this._resizeY=!1;var c=b.partial(l.add,this.resizeHandle);switch(this.resizeAxis.toLowerCase()){case "xy":this._resizeX=this._resizeY=!0;c("dojoxResizeNW");break;case "x":this._resizeX=!0;c("dojoxResizeW");break;case "y":this._resizeY=!0,c("dojoxResizeN")}},_beginSizing:function(c){if(!this._isSizing&&(g.publish(this.startTopic,[this]),this.targetDomNode=
(this.targetWidget=t.byId(this.targetId))?this.targetWidget.domNode:d.byId(this.targetId),this.targetContainer&&(this.targetDomNode=this.targetContainer),this.targetDomNode)){if(!this.activeResize){var b=p.position(this.targetDomNode,!0);this._resizeHelper.resize({l:b.x,t:b.y,w:b.w,h:b.h});this._resizeHelper.show();this.isLeftToRight()||(this._resizeHelper.startPosition={l:b.x,t:b.y})}this._isSizing=!0;this.startPoint={x:c.clientX,y:c.clientY};var b=h.getComputedStyle(this.targetDomNode),f="border-model"===
p.boxModel?{w:0,h:0}:p.getPadBorderExtents(this.targetDomNode,b),e=p.getMarginExtents(this.targetDomNode,b);this.startSize={w:h.get(this.targetDomNode,"width",b),h:h.get(this.targetDomNode,"height",b),pbw:f.w,pbh:f.h,mw:e.w,mh:e.h};!this.isLeftToRight()&&"absolute"==h.get(this.targetDomNode,"position")&&(b=p.position(this.targetDomNode,!0),this.startPosition={l:b.x,t:b.y});this._pconnects=[g.connect(a.doc,r.move,this,"_updateSizing"),g.connect(a.doc,r.release,this,"_endSizing")];k.stop(c)}},_updateSizing:function(a){if(this.activeResize)this._changeSizing(a);
else{var c=this._getNewCoords(a,"border",this._resizeHelper.startPosition);if(!1===c)return;this._resizeHelper.resize(c)}a.preventDefault()},_getNewCoords:function(a,c,b){try{if(!a.clientX||!a.clientY)return!1}catch(d){return!1}this._activeResizeLastEvent=a;var f=(this.isLeftToRight()?1:-1)*(this.startPoint.x-a.clientX),e=this.startPoint.y-a.clientY;a=this.startSize.w-(this._resizeX?f:0);e=this._checkConstraints(a,this.startSize.h-(this._resizeY?e:0));if((b=b||this.startPosition)&&this._resizeX)e.l=
b.l+f,e.w!=a&&(e.l+=a-e.w),e.t=b.t;switch(c){case "margin":e.w+=this.startSize.mw,e.h+=this.startSize.mh;case "border":e.w+=this.startSize.pbw,e.h+=this.startSize.pbh}return e},_checkConstraints:function(a,c){if(this.minSize){var b=this.minSize;a<b.w&&(a=b.w);c<b.h&&(c=b.h)}this.constrainMax&&this.maxSize&&(b=this.maxSize,a>b.w&&(a=b.w),c>b.h&&(c=b.h));if(this.fixedAspect){var b=this.startSize.w,d=this.startSize.h,f=b*c-d*a;0>f?a=c*b/d:0<f&&(c=a*d/b)}return{w:a,h:c}},_changeSizing:function(a){var c=
this.targetWidget&&b.isFunction(this.targetWidget.resize),d=this._getNewCoords(a,c&&"margin");if(!1!==d&&(c?this.targetWidget.resize(d):this.animateSizing?q[this.animateMethod]([m.animateProperty({node:this.targetDomNode,properties:{width:{start:this.startSize.w,end:d.w}},duration:this.animateDuration}),m.animateProperty({node:this.targetDomNode,properties:{height:{start:this.startSize.h,end:d.h}},duration:this.animateDuration})]).play():h.set(this.targetDomNode,{width:d.w+"px",height:d.h+"px"}),
this.intermediateChanges))this.onResize(a)},_endSizing:function(a){e.forEach(this._pconnects,g.disconnect);var c=b.partial(g.publish,this.endTopic,[this]);this.activeResize?c():(this._resizeHelper.hide(),this._changeSizing(a),setTimeout(c,this.animateDuration+15));this._isSizing=!1;this.onResize(a)},onResize:function(a){}})})},"jimu/LayerInfos/LayerInfoForCollection":function(){define(["dojo/_base/declare","dojo/_base/array","esri/graphicsUtils","./LayerInfo","./LayerInfoFactory"],function(n,b,g,
e,k){return n(e,{constructor:function(){this.layerObject={declaredClass:"esri.layers.FeatureCollection",type:"FeatureCollection"}},getExtent:function(){var e=[],a;b.forEach(this.originOperLayer.featureCollection.layers,function(a){e=e.concat(a.layerObject.graphics)});0===e.length?a=null:(a=1===e.length?e[0].getLayer().fullExtent:g.graphicsExtent(e),a=this._convertGeometryToMapSpatialRef(a));return a},initVisible:function(){var b=!1,a;if(this.newSubLayers.length)for(a=0;a<this.newSubLayers.length;a++)b=
b||this.newSubLayers[a].layerObject.visible;else b=!1;this._visible=b},_setTopLayerVisible:function(e){this._visible=e?!0:!1;b.forEach(this.newSubLayers,function(a){a.setLayerVisiblefromTopLayer()},this)},obtainNewSubLayers:function(){var e=[];b.forEach(this.originOperLayer.featureCollection.layers,function(a){this._getLayerIndexesInMapByLayerId(a.layerObject.id)&&(a=k.getInstance().create({layerObject:a.layerObject,title:a.layerObject.label||a.layerObject.title||a.layerObject.name||a.layerObject.id||
" ",id:a.id||" ",collection:{layerInfo:this},selfType:"collection",parentLayerInfo:this}),e.push(a),a.init())},this);e.reverse();return e},_obtainLayerIndexesInMap:function(){var b=[],a,e;for(e=0;e<this.newSubLayers.length;e++)(a=this._getLayerIndexesInMapByLayerId(this.newSubLayers[e].layerObject.id))&&b.push(a);return b},moveLeftOfIndex:function(b){var a;for(a=this.newSubLayers.length-1;0<=a;a--)this.map.reorderLayer(this.newSubLayers[a].layerObject,b)},moveRightOfIndex:function(b){var a;for(a=
0;a<this.newSubLayers.length;a++)this.map.reorderLayer(this.newSubLayers[a].layerObject,b)}})})},"jimu/LayerInfos/LayerInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/dom-construct dojo/topic esri/config esri/tasks/ProjectParameters esri/SpatialReference esri/geometry/webMercatorUtils".split(" "),function(n,b,g,e,k,m,a,q,d,l,p){return n(null,{originOperLayer:null,layerObject:null,map:null,title:null,id:null,newSubLayers:null,parentLayerInfo:null,
constructor:function(a,b){this.originOperLayer=a;this.layerObject=a.layerObject;this.map=b;this.title=this.originOperLayer.title;this.id=this.originOperLayer.id;this.parentLayerInfo=a.parentLayerInfo?a.parentLayerInfo:null;this.nls=window.jimuNls.layerInfosMenu},init:function(){this.newSubLayers=this.obtainNewSubLayers();this.initVisible();this.originOperLayer.popupInfo&&(this.popupVisible=!0)},isGraphicLayer:function(){var a=this._obtainLayerIndexesInMap();return a.length?a[0].isGraphicLayer:!1},
obtainLayerIndexesInMap:function(){return this._obtainLayerIndexesInMap()},getExtent:function(){},getOpacity:function(){var a,b=0;for(a=0;a<this.newSubLayers.length;a++)if(this.newSubLayers[a].layerObject.opacity)b=this.newSubLayers[a].layerObject.opacity>b?this.newSubLayers[a].layerObject.opacity:b;else return 1;return b},setOpacity:function(a){b.forEach(this.newSubLayers,function(b){b.layerObject.setOpacity&&b.layerObject.setOpacity(a)})},moveLeftOfIndex:function(a){this.map.reorderLayer(this.layerObject,
a)},moveRightOfIndex:function(a){this.map.reorderLayer(this.layerObject,a)},traversal:function(a){if(a(this))return!0;for(var b=this.getSubLayers(),d=0;d<b.length;d++)if(b[d].traversal(a))return!0},findLayerInfoById:function(a){var b=null,d=0;if(this.id&&this.id===a)return this;for(d=0;d<this.newSubLayers.length&&!(b=this.newSubLayers[d].findLayerInfoById(a));d++);return b},setTopLayerVisible:function(a){var b=this.isShowInMap();this._setTopLayerVisible(a);this._isShowInMapChanged(b)},_setTopLayerVisible:function(a){},
setSubLayerVisible:function(a,b){},setLayerVisiblefromTopLayer:function(){},initVisible:function(){},isVisible:function(){return this._visible},_obtainLayerIndexesInMap:function(){var a=[],b;(b=this._getLayerIndexesInMapByLayerId(this.id))&&a.push(b);return a},_getLayerIndexesInMapByLayerId:function(a){var b;for(b=0;b<this.map.graphicsLayerIds.length;b++)if(this.map.graphicsLayerIds[b]===a)return{isGraphicLayer:!0,index:b};for(b=0;b<this.map.layerIds.length;b++)if(this.map.layerIds[b]===a)return{isGraphicLayer:!1,
index:b};return null},_convertGeometryToMapSpatialRef:function(a){var b=new e;if(this.map.spatialReference.equals(a.spatialReference))return b.resolve([a]),b;if(this.map.spatialReference.isWebMercator()&&a.spatialReference.equals(new l(4326)))return b.resolve([p.geographicToWebMercator(a)]),b;if(this.map.spatialReference.equals(new l(4326))&&a.spatialReference.isWebMercator())return b.resolve([p.webMercatorToGeographic(a)]),b;b=new d;b.geometries=[a];b.outSR=this.map.spatialReference;return q.defaults.geometryService.project(b)},
_isShowInMapChanged:function(b){var d=this.isShowInMap();if(b!==d){!1===d&&this.map.infoWindow.hide();var e=[];this.traversal(function(a){e.push(a)});a.publish("layerInfos/layerInfo/isShowInMapChanged",e)}},obtainNewSubLayers:function(){return[]},createLegendsNode:function(){return m.create("div",{"class":"legends-div"})},drawLegends:function(a,b){},initLegendsNode:function(a){},_getLayerTypesOfSupportTable:function(){return"FeatureLayer,CSVLayer,Table"},_isItemLayer:function(){return this.originOperLayer.itemId||
this.layerObject._itemId},getLayerObject:function(){var a=new e;this.layerObject?a.resolve(this.layerObject):a.reject("layerObject is null");return a},getSubLayers:function(){return this.newSubLayers},isLeaf:function(){return 0===this.getSubLayers().length?!0:!1},isRootLayer:function(){return this.parentLayerInfo?!1:!0},isShowInMap:function(){for(var a=!0,b=this;b;)a=a&&b.isVisible(),b=b.parentLayerInfo;return a},getLayerType:function(){var a=[null],b=new e;this.layerObject.declaredClass&&(a=this.layerObject.declaredClass.split("."));
b.resolve(a[a.length-1]);return b},getPopupInfo:function(){return this.originOperLayer.popupInfo},loadInfoTemplate:function(){var a=new e;a.resolve(null);return a},getUrl:function(){return this.originOperLayer.url},hasLayerTypes:function(a){},getSupportTableInfo:function(){var a=new e,b={isSupportedLayer:!1,isSupportQuery:!1,layerType:null},d=this.getLayerType(),l=this.getLayerObject();k({type:d,layerObject:l}).then(g.hitch(this,function(d){var c=d.type;d=d.layerObject;b.layerType=c;0<=this._getLayerTypesOfSupportTable().indexOf(c)&&
(b.isSupportedLayer=!0);if(!d.url||d.capabilities&&0<=d.capabilities.indexOf("Query"))b.isSupportQuery=!0;a.resolve(b)}),function(){a.resolve(b)});return a}})})},"jimu/LayerInfos/LayerInfoForMapService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/json dojo/aspect ./LayerInfo esri/request ./LayerInfoFactory".split(" "),function(n,b,g,e,k,m,a,q,d){return n(a,{_legendInfo:null,_sublayerIdent:null,controlPopupInfo:null,constructor:function(a,b){this.initSubLayerVisible();
this._sublayerIdent={definitions:[],empty:!0,defLoad:new e};this._sublayerIdent.definitions[this.layerObject.layerInfos.length-1]=null;this._initControlPopup()},_initControlPopup:function(){this.controlPopupInfo={enablePopup:void 0,infoTemplates:g.clone(this.layerObject.infoTemplates)};this.layerObject._infoTemplates=g.clone(this.layerObject.infoTemplates);m.after(this.layerObject,"setInfoTemplates",g.hitch(this,function(){this.layerObject._infoTemplates=g.clone(this.layerObject.infoTemplates);this.controlPopupInfo.infoTemplates=
g.clone(this.layerObject.infoTemplates);this.traversal(function(a){a._afterSetInfoTemplates&&a._afterSetInfoTemplates()})}))},initSubLayerVisible:function(){this.subLayerVisible=[];for(var a=this.subLayerVisible[this.layerObject.layerInfos.length-1]=0;a<this.subLayerVisible.length;a++)this.subLayerVisible[a]=0;this.originOperLayer.visibleLayers?b.forEach(this.originOperLayer.visibleLayers,function(a){this.subLayerVisible[a]++},this):b.forEach(this.layerObject.layerInfos,function(a,b){a.defaultVisibility&&
this.subLayerVisible[b]++},this)},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.fullExtent||this.originOperLayer.layerObject.initialExtent)},initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},_setTopLayerVisible:function(a){this.originOperLayer.layerObject.setVisibility(a);this._visible=a},setSubLayerVisible:function(a,d){var e=[],k;null!==a&&(d?(e=g.clone(this.originOperLayer.layerObject.visibleLayers),k=b.indexOf(e,
a),0>k&&(e.push(a),this.originOperLayer.layerObject.setVisibleLayers(e))):(e=g.clone(this.originOperLayer.layerObject.visibleLayers),k=b.indexOf(e,a),0<=k&&e.splice(k,1),0===e.length&&e.push(-1),this.originOperLayer.layerObject.setVisibleLayers(e)))},obtainNewSubLayers:function(){var a=[],e=this.originOperLayer.layerObject,h=null,h="esri.layers.ArcGISDynamicMapServiceLayer"===e.declaredClass?"dynamic":"tiled";b.forEach(e.layerInfos,function(b){var d=null,d=e.url+"/"+b.id,f=e.id+"_"+b.id;b.subLayerIds&&
0<b.subLayerIds.length?(d={url:d,empty:!0},this._addNewSubLayer(a,d,f,b,h+"_group")):(d={url:d,empty:!0},this._addNewSubLayer(a,d,f,b,h))},this);var g=[];b.forEach(e.layerInfos,function(b,d){var f=b.parentLayerId;-1!==f&&a[f].subLayers.push(a[d])});b.forEach(e.layerInfos,function(b,e){var f;-1===b.parentLayerId&&(f=d.getInstance().create(a[e]),g.push(f),f.init())},this);return g},_addNewSubLayer:function(a,b,d,e,g){a.push({layerObject:b,title:e.name||e.id||" ",id:d||" ",subLayers:[],mapService:{layerInfo:this,
subId:e.id},selfType:"mapservice_"+g,url:b.url,parentLayerInfo:this})},_handleErrorSubLayer:function(a,b,d,e,g,k){a[b]={layerObject:null,title:k.name||k.id||" ",id:d||" ",subLayers:[],mapService:{layerInfo:this,subId:e}}},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(a){this.layerObject.setOpacity&&this.layerObject.setOpacity(a)},getLegendInfo:function(a){var b=new e;this._legendInfo?b.resolve(this._legendInfo):this._legendRequest(a).then(g.hitch(this,
function(a){this._legendInfo=a.layers;b.resolve(this._legendInfo)}),function(){b.reject()});return b},_legendRequest:function(a){return 10.01<=this.layerObject.version?this._legendRequestServer():this._legendRequestTools(a)},_legendRequestServer:function(){var a=this.layerObject.url+"/legend",b={f:"json"};this.layerObject._params.dynamicLayers&&(b.dynamicLayers=k.stringify(this._createDynamicLayers(this.layerObject)),"[{}]"===b.dynamicLayers&&(b.dynamicLayers="[]"));return q({url:a,content:b,handleAs:"json",
callbackParamName:"callback"})},_legendRequestTools:function(a){return q({url:a+"sharing/tools/legend?soapUrl\x3d"+this.layerObject.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"})},_createDynamicLayers:function(a){var d=[],e;b.forEach(a.dynamicLayerInfos||a.layerInfos,function(b){e={id:b.id};e.source=b.source&&b.source.toJson();var g;a.layerDefinitions&&a.layerDefinitions[b.id]&&(g=a.layerDefinitions[b.id]);g&&(e.definitionExpression=g);var k;a.layerDrawingOptions&&a.layerDrawingOptions[b.id]&&
(k=a.layerDrawingOptions[b.id]);k&&(e.drawingInfo=k.toJson());e.minScale=b.minScale||0;e.maxScale=b.maxScale||0;d.push(e)});return d},_getSublayerDefinition:function(a){var b;this._sublayerIdent.definitions[a]?(b=new e,b.resolve(this._sublayerIdent.definitions[a])):b=this._layerAndTableRequest(a);return b},_layerAndTableRequest:function(a){return 10.11<=this.layerObject.version?this._allLayerAndTableServer(a):this._allLayerAndTable(a)},_allLayerAndTableServer:function(a){var b=new e,d=this.originOperLayer.url+
"/layers";this._sublayerIdent.empty?(this._sublayerIdent.empty=!1,this._request(d).then(g.hitch(this,function(d){this._sublayerIdent.definitions=d.layers;this._sublayerIdent.defLoad.resolve();b.resolve(this._sublayerIdent.definitions[a])}),g.hitch(this,function(a){console.error(a.message||a);this._sublayerIdent.defLoad.reject();this._sublayerIdent.defLoad=new e;this._sublayerIdent.empty=!0;b.resolve(null)}))):this._sublayerIdent.defLoad.then(g.hitch(this,function(){b.resolve(this._sublayerIdent.definitions[a])}),
function(a){console.error(a.message||a);b.resolve(null)});return b},_allLayerAndTable:function(a){var b=new e;this._request(this.originOperLayer.url+"/"+a).then(g.hitch(this,function(d){this._sublayerIdent.definitions[a]=d;b.resolve(d)}),function(a){console.error(a.message||a);b.resolve(null)});return b},_request:function(a){return q({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"})}})})},"jimu/LayerInfos/LayerInfoForKML":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefault dojo/Deferred".split(" "),
function(n,b,g,e,k,m,a,q){return n(m,{constructor:function(a,b){},getExtent:function(){var a=this.originOperLayer.layerObject.getLayers(),e=null,g;b.forEach(a,function(a){g=this._convertGeometryToMapSpatialRef(a.initialExtent);e=e?e.union(g):g},this);return e},initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},_setTopLayerVisible:function(a){a?this.originOperLayer.layerObject.show():this.originOperLayer.layerObject.hide();this._visible=a},obtainNewSubLayers:function(){var d=
[],e=this.originOperLayer.layerObject.getLayers();b.forEach(e,function(b){this._getLayerIndexesInMapByLayerId(b.id)&&(b=new a({layerObject:b,title:b.label||b.title||b.name||b.id||" ",id:b.id||" ",selfType:"kml",url:b.url,parentLayerInfo:this},this.map),d.push(b),b.init())},this);return d}})})},"jimu/LayerInfos/LayerInfoForDefault":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred ./LayerInfo dojox/gfx dojo/dom-construct dojo/dom-attr dojo/aspect esri/symbols/jsonUtils esri/dijit/PopupTemplate".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p){var h=n(k,{_legendsNode:null,controlPopupInfo:null,constructor:function(){this._initControlPopup()},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.fullExtent)||this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.initialExtent)},initVisible:function(){var a=!1;this._visible=a=this.originOperLayer.layerObject.visible},_initControlPopup:function(){this.controlPopupInfo={enablePopup:this.layerObject.infoTemplate?
!0:!1,infoTemplate:this.layerObject.infoTemplate};this.layerObject._infoTemplate=this.layerObject.infoTemplate;d.after(this.layerObject,"setInfoTemplate",g.hitch(this,function(){this.layerObject._infoTemplate=this.layerObject.infoTemplate;this.controlPopupInfo.infoTemplate=this.layerObject.infoTemplate;this.controlPopupInfo.enablePopup||(this.layerObject.infoTemplate=null)}))},_setTopLayerVisible:function(a){this.originOperLayer.collection?this.originOperLayer.collection.layerInfo._visible?a?(this.layerObject.show(),
this._visible=!0):(this.layerObject.hide(),this._visible=!1):a?(this.layerObject.hide(),this._visible=!0):(this.layerObject.hide(),this._visible=!1):(a?this.layerObject.show():this.layerObject.hide(),this._visible=a)},setLayerVisiblefromTopLayer:function(){this.originOperLayer.collection.layerInfo._visible?this._visible&&this.layerObject.show():this.layerObject.hide()},createLegendsNode:function(){var b=a.create("div",{"class":"legends-div jimu-leading-margin1"},document.body);a.create("img",{"class":"legends-loading-img",
src:require.toUrl("jimu")+"/images/loading.gif"},b);return b},drawLegends:function(a){this.initLegendsNode(a)},initLegendsNode:function(d){var e=[],h=this.layerObject;if(this.layerObject&&!this.layerObject.empty&&(!this.originOperLayer.subLayer||0===this.originOperLayer.subLayers.length))a.empty(d),h.renderer&&(h.renderer.infos?e=g.clone(h.renderer.infos):e.push({label:h.renderer.label,symbol:h.renderer.symbol}),h.renderer&&(h.renderer.defaultSymbol&&0<e.length)&&e.push({label:h.renderer.defaultLabel||
"others",symbol:h.renderer.defaultSymbol}),b.forEach(e,function(b){b.legendDiv=a.create("div",{"class":"legend-div"},d);b.symbolDiv=a.create("div",{"class":"legend-symbol jimu-float-leading"},b.legendDiv);b.labelDiv=a.create("div",{"class":"legend-label jimu-float-leading",innerHTML:b.label||" "},b.legendDiv);if("textsymbol"===b.symbol.type)q.set(b.symbolDiv,"innerHTML",b.symbol.text);else{var c=m.createSurface(b.symbolDiv,50,50);b=l.getShapeDescriptors(b.symbol);c.createShape(b.defaultShape).setFill(b.fill).setStroke(b.stroke).setTransform(m.matrix.translate(25,
25))}},this))},obtainNewSubLayers:function(){var a=[];this.originOperLayer.subLayers&&0!==this.originOperLayer.subLayers.length&&b.forEach(this.originOperLayer.subLayers,function(b){b=new h(b,this.map);a.push(b);b.init()},this);return a},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(a){this.layerObject.setOpacity&&this.layerObject.setOpacity(a)},_getDefaultPopupTemplate:function(a){var d=null;if(a&&a.fields){var e={title:a.name,fieldInfos:[],
description:null,showAttachments:!0,mediaInfos:[]};b.forEach(a.fields,function(b){b.name!==a.objectIdField&&e.fieldInfos.push({fieldName:b.name,visible:!0,label:b.alias,isEditable:!1})});d=new p(e)}return d},enablePopup:function(){this.controlPopupInfo.enablePopup=!0;this.layerObject.infoTemplate=this.controlPopupInfo.infoTemplate},disablePopup:function(){this.controlPopupInfo.enablePopup=!1;this.layerObject.infoTemplate=null},loadInfoTemplate:function(){var a=new e;this.controlPopupInfo.infoTemplate||
(this.controlPopupInfo.infoTemplate=this._getDefaultPopupTemplate(this.layerObject));a.resolve(this.controlPopupInfo.infoTemplate);return a}});return h})},"jimu/LayerInfos/LayerInfoForGeoRSS":function(){define(["dojo/_base/declare","dojo/_base/array","esri/graphicsUtils","./LayerInfo","./LayerInfoFactory"],function(n,b,g,e,k){return n(e,{constructor:function(){},getExtent:function(){var b=this.layerObject.items;if(0===b.length)return null;b=g.graphicsExtent(b);return this._convertGeometryToMapSpatialRef(b)},
initVisible:function(){var b=!1,a;if(this.newSubLayers.length)for(a=0;a<this.newSubLayers.length;a++)b=b||this.newSubLayers[a].layerObject.visible;else b=!1;this._visible=b},_setTopLayerVisible:function(e){this._visible=e?!0:!1;b.forEach(this.newSubLayers,function(a){a.setLayerVisiblefromTopLayer()},this)},obtainNewSubLayers:function(){var e=[],a=this.layerObject.getFeatureLayers();b.forEach(a,function(a){a=k.getInstance().create({layerObject:a,title:a.label||a.title||a.name||a.id||" ",id:a.id||" ",
collection:{layerInfo:this},selfType:"geo_rss",url:a.url,parentLayerInfo:this});e.push(a);a.init()},this);return e},_obtainLayerIndexesInMap:function(){var b=[],a,e;for(e=0;e<this.newSubLayers.length;e++)(a=this._getLayerIndexesInMapByLayerId(this.newSubLayers[e].layerObject.id))&&b.push(a);return b},moveLeftOfIndex:function(b){var a;for(a=this.newSubLayers.length-1;0<=a;a--)this.map.reorderLayer(this.newSubLayers[a].layerObject,b)},moveRightOfIndex:function(b){var a;for(a=0;a<this.newSubLayers.length;a++)this.map.reorderLayer(this.newSubLayers[a].layerObject,
b)}})})},"jimu/LayerInfos/LayerInfoForWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefaultWMS ./LayerInfoFactory esri/layers/FeatureLayer".split(" "),function(n,b,g,e,k,m,a,q,d,l){return n(a,{constructor:function(a,b){this.layerObject=a.layerObject},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.extent)},initVisible:function(){this._visible=this.layerObject.visible},
_setTopLayerVisible:function(a){a?this.layerObject.setVisibility(!0):this.layerObject.setVisibility(!1);this._visible=a;b.forEach(this.newSubLayers,function(a){a.setLayerVisiblefromTopLayer()},this)},obtainNewSubLayers:function(){var a=[];b.forEach(this.layerObject.layerInfos,function(b){b=d.getInstance().create({layerObject:this.layerObject,title:b.label||b.title||b.name||" ",id:b.name||" ",wms:{layerInfo:this,subId:b.name,wmsLayerInfo:b},selfType:"wms",url:this.layerObject.url,parentLayerInfo:this});
a.push(b);b.init()},this);return a}})})},"jimu/LayerInfos/LayerInfoForDefaultWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/html dojo/dom-construct dojo/on ./LayerInfoForDefault".split(" "),function(n,b,g,e,k,m,a){return n(a,{constructor:function(a,b){this.layerObject=a.layerObject},getExtent:function(){},initVisible:function(){var a=[],a=!1,a=g.clone(this.originOperLayer.layerObject.visibleLayers);this._visible=a=0<=b.indexOf(a,this.originOperLayer.id)?!0:
!1},_setTopLayerVisible:function(a){this.originOperLayer.layerObject.visible?a?(this._show(),this._visible=!0):(this._hide(),this._visible=!1):a?(this._hide(),this._visible=!0):(this._hide(),this._visible=!1)},_show:function(){var a=[],a=g.clone(this.originOperLayer.layerObject.visibleLayers);0>b.indexOf(a,this.id)&&(a.push(this.id),this.originOperLayer.layerObject.setVisibleLayers(a))},_hide:function(){var a=[],d,a=g.clone(this.originOperLayer.layerObject.visibleLayers);d=b.indexOf(a,this.id);0<=
d&&a.splice(d,1);this.originOperLayer.layerObject.setVisibleLayers(a)},setLayerVisiblefromTopLayer:function(){this.originOperLayer.layerObject.visible?this._visible&&this._show():this._hide()},drawLegends:function(a){this.initLegendsNode(a)},initLegendsNode:function(a){if(this.originOperLayer.wms.wmsLayerInfo.legendURL){var b=k.create("img",{"class":"legend-div-image",src:this.originOperLayer.wms.wmsLayerInfo.legendURL});m(b,"load",function(){k.empty(a);var l=k.create("div",{"class":"legend-div"},
a);e.place(b,l)})}else k.empty(a)},obtainNewSubLayers:function(){return[]},getOpacity:function(){},setOpacity:function(a){}})})},"jimu/LayerInfos/LayerInfoForGroup":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred esri/request ./LayerInfo ./LayerInfoFactory".split(" "),function(n,b,g,e,k,m,a){return n(m,{constructor:function(a,b,e){this.noLegend=e},getExtent:function(){},initVisible:function(){var a=!1,b=this.originOperLayer.mapService;this.originOperLayer.mapService&&
0<b.layerInfo.subLayerVisible[b.subId]&&(a=!0);this._visible=a},_setTopLayerVisible:function(a){var b;this.originOperLayer.mapService&&(b=this.originOperLayer.mapService,0<this.originOperLayer.subLayers.length&&(a?b.layerInfo.subLayerVisible[b.subId]++:b.layerInfo.subLayerVisible[b.subId]--,this._visible=a,this.traversal(function(a){0===a.getSubLayers().length&&a.visbleOrInvisilbe()})))},setLayerVisiblefromTopLayer:function(){},obtainNewSubLayers:function(){var e=[];b.forEach(this.originOperLayer.subLayers,
function(b){b.parentLayerInfo=this;b=a.getInstance().create(b);e.push(b);b.init()},this);return e},getOpacity:function(){},setOpacity:function(a){},getLayerObject:function(){var a=new e;this.layerObject.empty?k({url:this.layerObject.url,handleAs:"json",callbackParamName:"callback",timeout:1E5,content:{f:"json"}}).then(g.hitch(this,function(b){var e=this.layerObject.url;this.layerObject=b;this.layerObject.url=e;a.resolve(this.layerObject)}),function(b){a.reject(b)}):a.resolve(this.layerObject);return a},
getLayerType:function(){var a=new e;a.resolve("GroupLayer");return a}})})},"jimu/LayerInfos/LayerInfoForDefaultDynamic":function(){define(["dojo/_base/declare","./LayerInfoForDefaultService"],function(n,b){return n(b,{constructor:function(b,e){},initVisible:function(){var b=!1,e=this.originOperLayer.mapService;this.originOperLayer.mapService&&0<e.layerInfo.subLayerVisible[e.subId]&&(b=!0);this._visible=b},_setTopLayerVisible:function(b){var e;this.originOperLayer.mapService&&(e=this.originOperLayer.mapService,
b?e.layerInfo.subLayerVisible[e.subId]++:e.layerInfo.subLayerVisible[e.subId]--,this._visible=b,this.visbleOrInvisilbe())},visbleOrInvisilbe:function(){var b=this.originOperLayer.mapService;b.layerInfo.setSubLayerVisible(b.subId,this.isVisbleOrInvisilbe())},isVisbleOrInvisilbe:function(){for(var b=this.originOperLayer.mapService,e=-1,k=b.subId,m=0,a=b.layerInfo.layerObject.layerInfos;;){e++;m+=b.layerInfo.subLayerVisible[k];if(-1===a[k].parentLayerId)return m>e?!0:!1;k=a[k].parentLayerId}}})})},"jimu/LayerInfos/LayerInfoForDefaultService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/dom-construct ./LayerInfoForDefault esri/layers/FeatureLayer".split(" "),
function(n,b,g,e,k,m,a){return n(m,{_legendsNode:null,_loadLegends:function(a){var b=new e;this.originOperLayer.mapService.layerInfo.getLegendInfo(a).then(g.hitch(this,function(a){b.resolve(a)}));return b},drawLegends:function(a,b){this._loadLegends(b).then(g.hitch(this,function(b){this.initLegendsNode(b,a)}))},initLegendsNode:function(a,d){var e=this.originOperLayer.mapService;if(a){k.empty(d);for(var g=null,h=0;h<a.length;h++)if(a[h].layerId===e.subId){g=a[h];break}g&&b.forEach(g.legend,function(a){if("\x3call other values\x3e"!==
a.label){var b=k.create("div",{"class":"legend-div"},d),e=k.create("div",{"class":"legend-symbol jimu-float-leading",style:"width:50px;height:50px;position:relative"},b),f=null,f=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;k.create("img",{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;position:absolute;top:0;left:0;bottom:0;right:0",src:f},e);k.create("div",{"class":"legend-label jimu-float-leading",innerHTML:a.label||" "},b)}},this)}},_initControlPopup:function(){var a=
this.originOperLayer.mapService.layerInfo.layerObject,b=this.originOperLayer.mapService.subId;this.controlPopupInfo={enablePopup:a.infoTemplates&&a.infoTemplates[b]?!0:!1,infoTemplates:void 0}},_afterSetInfoTemplates:function(){var a=this.originOperLayer.mapService.layerInfo.layerObject,b=this.originOperLayer.mapService.subId;!this.controlPopupInfo.enablePopup&&a.infoTemplates&&delete a.infoTemplates[b]},getLayerObject:function(){var b=new e;this.layerObject.empty?(this.layerObject=new a(this.layerObject.url),
this.layerObject.on("load",g.hitch(this,function(){b.resolve(this.layerObject)})),this.layerObject.on("error",g.hitch(this,function(){b.resolve(null)}))):b.resolve(this.layerObject);return b},getPopupInfo:function(){var a=null,b=this.originOperLayer.mapService.layerInfo.originOperLayer.layers;if(b)for(var e=0;e<b.length;e++)if(b[e].id===this.originOperLayer.mapService.subId){a=b[e].popupInfo;break}return a},getLayerType:function(){var a=new e,b=this.originOperLayer.mapService;b.layerInfo._getSublayerDefinition(b.subId).then(g.hitch(this,
function(b){b?a.resolve(b.type.replace(/\ /g,"")):a.resolve(null)}),function(){a.resolve(null)});return a},getSupportTableInfo:function(){var a=new e,b={isSupportedLayer:!1,isSupportQuery:!1,layerType:null};this.getLayerType().then(g.hitch(this,function(e){b.layerType=e;0<=this._getLayerTypesOfSupportTable().indexOf(e)&&(b.isSupportedLayer=!0);e=this.originOperLayer.mapService;e.layerInfo._getSublayerDefinition(e.subId).then(g.hitch(this,function(e){e&&0<=e.capabilities.indexOf("Data")&&(b.isSupportQuery=
!0);a.resolve(b)}),function(){a.resolve(b)})}),function(){a.resolve(b)});return a},enablePopup:function(){var a=this.originOperLayer.mapService.layerInfo,b=a.layerObject,e=this.originOperLayer.mapService.subId;this.controlPopupInfo.enablePopup=!0;a.controlPopupInfo.infoTemplates&&(b.infoTemplates||(b.infoTemplates={}),b.infoTemplates[e]=a.controlPopupInfo.infoTemplates[e])},disablePopup:function(){var a=this.originOperLayer.mapService.layerInfo.layerObject,b=this.originOperLayer.mapService.subId;
this.controlPopupInfo.enablePopup=!1;a.infoTemplates&&delete a.infoTemplates[b]},loadInfoTemplate:function(){var a=new e,b=this.originOperLayer.mapService.layerInfo,l=this.originOperLayer.mapService.subId;b.controlPopupInfo.infoTemplates&&b.controlPopupInfo.infoTemplates[l]?a.resolve(b.controlPopupInfo.infoTemplates[l]):(b.controlPopupInfo.infoTemplates||(b.controlPopupInfo.infoTemplates={}),b._getSublayerDefinition(l).then(g.hitch(this,function(e){e=this._getDefaultPopupTemplate(e);b.controlPopupInfo.infoTemplates[l]=
{infoTemplate:e,layerUrl:null};a.resolve(e)}),g.hitch(this,function(){a.resolve(null)})));return a}})})},"jimu/LayerInfos/LayerInfoForDefaultTile":function(){define(["dojo/_base/declare","./LayerInfoForDefaultService"],function(n,b){return n(b,{constructor:function(b,e){this.noLegend=!0},getExtent:function(){},initVisible:function(){},_setTopLayerVisible:function(b){},setLayerVisiblefromTopLayer:function(){},getOpacity:function(){},setOpacity:function(b){},isShowInMap:function(){return this.originOperLayer.mapService.layerInfo.layerObject.visible}})})},
"jimu/LayerInfos/LayerInfoForDefaultTable":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Deferred ./LayerInfoForDefault esri/layers/FeatureLayer".split(" "),function(n,b,g,e,k,m){return n(k,{isTable:null,constructor:function(){this.newSubLayers=[];this.isTable=!0},init:function(){},getUrl:function(){return this.layerObject.url},getLayerObject:function(){var a=new e;this.layerObject.empty?(this.layerObject=new m(this.layerObject.url),this.layerObject.on("load",b.hitch(this,
function(){a.resolve(this.layerObject)})),this.layerObject.on("error",b.hitch(this,function(){a.resolve(null)}))):a.resolve(this.layerObject);return a},getLayerType:function(){var a=new e;a.resolve("Table");return a},isVisible:function(){return!1},isLeaf:function(){return!0},isRootLayer:function(){return!1},createLegendsNode:function(){return g.create("div",{"class":"legends-div"})},_initControlPopup:function(){this.controlPopupInfo={enablePopup:void 0,infoTemplate:void 0}}})})},"jimu/LayerInfos/LayerInfoForDefaultImage":function(){define("dojo/_base/declare dojo/dom-construct dojo/_base/array dojo/_base/lang esri/request ./LayerInfoForDefault".split(" "),
function(n,b,g,e,k,m){return n(m,{initLegendsNode:function(a){10.2<=this.layerObject.version?this._legendRequestServer().then(e.hitch(this,function(e){b.empty(a);g.forEach(e.layers,function(d){g.forEach(d.legend,function(d){if("\x3call other values\x3e"!==d.label){var e=b.create("div",{"class":"legend-div"},a),h=b.create("div",{"class":"legend-symbol jimu-float-leading",style:"width:50px;height:50px;position:relative"},e),g=null,g=d.imageData?"data:"+d.contentType+";base64,"+d.imageData:d.url;b.create("img",
{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;position:absolute;top:0;left:0;bottom:0;right:0",src:g},h);b.create("div",{"class":"legend-label jimu-float-leading",innerHTML:d.label||" "},e)}},this)},this)}),e.hitch(this,function(){b.empty(a)})):b.empty(a)},_legendRequestServer:function(){var a=this.layerObject.url+"/legend",b={f:"json"};this.layerObject._params.bandIds&&(b.bandIds=this.layerObject._params.bandIds);this.layerObject._params.renderingRule&&(b.renderingRule=this.layerObject._params.renderingRule);
return k({url:a,content:b,handleAs:"json",callbackParamName:"callback"})}})})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),function(n,b,g,e,k,m,a,q,d){return m("dijit.layout._LayoutWidget",[b,g,e],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);a.add(this.domNode,"dijitContainer")},
startup:function(){if(!this._started){this.inherited(arguments);var a=this.getParent&&this.getParent();if(!a||!a.isLayoutContainer)this.resize(),this.own(k.on("resize",n.hitch(this,"resize")))}},resize:function(a,b){var e=this.domNode;a&&q.setMarginBox(e,a);var g=b||{};n.mixin(g,a||{});if(!("h"in g)||!("w"in g))g=n.mixin(q.getMarginBox(e),g);var k=d.getComputedStyle(e),m=q.getMarginExtents(e,k),f=q.getBorderExtents(e,k),g=this._borderBox={w:g.w-(m.w+f.w),h:g.h-(m.h+f.h)},m=q.getPadExtents(e,k);this._contentBox=
{l:d.toPixelValue(e,k.paddingLeft),t:d.toPixelValue(e,k.paddingTop),w:g.w-m.w,h:g.h-m.h};this.layout()},layout:function(){},_setupChild:function(b){a.add(b.domNode,this.baseClass+"-child "+(b.baseClass?this.baseClass+"-"+b.baseClass:""))},addChild:function(a,b){this.inherited(arguments);this._started&&this._setupChild(a)},removeChild:function(b){a.remove(b.domNode,this.baseClass+"-child"+(b.baseClass?" "+this.baseClass+"-"+b.baseClass:""));this.inherited(arguments)}})})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f){p("dijit-legacy-requires")&&f(0,function(){n(["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"])});return g("dijit.Menu",t,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):b.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(a){return s.get(this._iframeContentDocument(a))||
this._iframeContentDocument(a).__parent__||a.name&&document.frames[a.name]||null},_iframeContentDocument:function(a){return a.contentDocument||a.contentWindow&&a.contentWindow.document||a.name&&document.frames[a.name]&&document.frames[a.name].document||null},bindDomNode:function(a){a=e.byId(a,this.ownerDocument);var b;if("iframe"==a.tagName.toLowerCase()){var f=a;b=this._iframeContentWindow(f);b=h.body(b.document)}else b=a==h.body(this.ownerDocument)?this.ownerDocument.documentElement:a;var g={node:a,
iframe:f};k.set(a,"_dijitMenu"+this.id,this._bindings.push(g));var p=d.hitch(this,function(a){var c=this.selector,b=c?function(a){return l.selector(c,a)}:function(a){return a},d=this;return[l(a,b(this.leftClickToOpen?"click":"contextmenu"),function(a){a.stopPropagation();a.preventDefault();(new Date).getTime()<this._lastKeyDown+500||d._scheduleOpen(this,f,{x:a.pageX,y:a.pageY},a.target)}),l(a,b("keydown"),function(a){if(93==a.keyCode||a.shiftKey&&a.keyCode==q.F10||this.leftClickToOpen&&a.keyCode==
q.SPACE)a.stopPropagation(),a.preventDefault(),d._scheduleOpen(this,f,null,a.target),this._lastKeyDown=(new Date).getTime()})]});g.connects=b?p(b):[];f&&(g.onloadHandler=d.hitch(this,function(){var a=this._iframeContentWindow(f),a=h.body(a.document);g.connects=p(a)}),f.addEventListener?f.addEventListener("load",g.onloadHandler,!1):f.attachEvent("onload",g.onloadHandler))},unBindDomNode:function(a){var b;try{b=e.byId(a,this.ownerDocument)}catch(d){return}a="_dijitMenu"+this.id;if(b&&k.has(b,a)){for(var f=
k.get(b,a)-1,h=this._bindings[f],g;g=h.connects.pop();)g.remove();(g=h.iframe)&&(g.removeEventListener?g.removeEventListener("load",h.onloadHandler,!1):g.detachEvent("onload",h.onloadHandler));k.remove(b,a);delete this._bindings[f]}},_scheduleOpen:function(a,b,d,f){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:f,delegatedTarget:a,iframe:b,coords:d})},1))},_openMyself:function(c){function b(){q.refocus&&s&&s.focus();r.close(q)}var d=c.target,
f=c.iframe,h=c.coords,g=!h;this.currentTarget=c.delegatedTarget;if(h){if(f){c=m.position(f,!0);var d=this._iframeContentWindow(f),d=m.docScroll(d.document),l=a.getComputedStyle(f),k=a.toPixelValue,n=(p("ie")&&p("quirks")?0:k(f,l.paddingLeft))+(p("ie")&&p("quirks")?k(f,l.borderLeftWidth):0),f=(p("ie")&&p("quirks")?0:k(f,l.paddingTop))+(p("ie")&&p("quirks")?k(f,l.borderTopWidth):0);h.x+=c.x+n-d.x;h.y+=c.y+f-d.y}}else h=m.position(d,!0),h.x+=10,h.y+=10;var q=this,f=this._focusManager.get("prevNode");
c=this._focusManager.get("curNode");var s=!c||e.isDescendant(c,this.domNode)?f:c;r.open({popup:this,x:h.x,y:h.y,onExecute:b,onCancel:b,orient:this.isLeftToRight()?"L":"R"});this.focus();g||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);r.close(this)}},destroy:function(){b.forEach(this._bindings,function(a){a&&this.unBindDomNode(a.node)},this);this.inherited(arguments)}})})},"dgrid/main":function(){define([],1)},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare",
"./Grid","./OnDemandList"],function(n,b,g){return n("dgrid.OnDemandGrid",[b,g],{})})},"dgrid/Grid":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),function(n,b,g,e,k,m,a){function q(a,b){b&&b.nodeType&&a.appendChild(b)}function d(a,b,d,e){if(this.formatter){e=this.formatter;var g=this.grid.formatterScope;d.innerHTML="string"===typeof e&&g?g[e](b,a):this.formatter(b,a)}else null!=b&&d.appendChild(document.createTextNode(b))}
var l=8>e("ie")&&!e("quirks");b=b("dgrid.Grid",m,{columns:null,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!=typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,b){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var d;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var e=a.columnId;if(e){b=e;d=a;break}a=a.parentNode}while(a&&a!=this.domNode)}if(!d&&"undefined"!=typeof b){var g=this.row(a);if(e=g&&g.element)for(var e=
e.getElementsByTagName("td"),f=0;f<e.length;f++)if(e[f].columnId==b){d=e[f];break}}if(null!=a)return{row:g||this.row(a),column:b&&this.column(b),element:d}},createRowCells:function(b,d,g,m){var n=k("table.dgrid-row-table[role\x3dpresentation]"),f=9>e("ie")||e("quirks")?k(n,"tbody"):n,c,q,w,A,x,B,C,F,G,z;g=g||this.subRows;q=0;for(w=g.length;q<w;q++){B=g[q];c=k(f,"tr");B.className&&k(c,"."+B.className);A=0;for(x=B.length;A<x;A++){C=B[A];F=C.id;G=C.field?".field-"+a.escapeCssIdentifier(C.field,"-"):
"";(z="function"===typeof C.className?C.className(m):C.className)&&(G+="."+z);G=k(b+(".dgrid-cell.dgrid-cell-padding"+(F?".dgrid-column-"+a.escapeCssIdentifier(F,"-"):"")+G.replace(/ +/g,"."))+"[role\x3d"+("th"===b?"columnheader":"gridcell")+"]");G.columnId=F;l?(F=k(G,"!dgrid-cell-padding div.dgrid-cell-padding"),G.contents=F):F=G;if(z=C.colSpan)G.colSpan=z;if(z=C.rowSpan)G.rowSpan=z;d(F,C);c.appendChild(G)}}return n},left:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,-(b||
1),"dgrid-cell"))},right:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,b||1,"dgrid-cell"))},renderRow:function(a,b){var e=this.createRowCells("td",function(e,g){var f=a;g.get?f=g.get(a):"field"in g&&"_item"!=g.field&&(f=f[g.field]);g.renderCell?q(e,g.renderCell(a,f,e,b)):d.call(g,a,f,e,b)},b&&b.subRows,a);return k("div[role\x3drow]\x3e",e)},renderHeader:function(){var a=this,b=this.headerNode,d=b.childNodes.length;for(b.setAttribute("role","row");d--;)k(b.childNodes[d],"!");
d=this.createRowCells("th",function(a,b){var d=b.headerNode=a;l&&(a=a.parentNode);var c=b.field;c&&(a.field=c);if(b.renderHeaderCell)q(d,b.renderHeaderCell(d));else if("label"in b||b.field)d.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&(c&&"_item"!=c)&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[d.id=this.id+"-header"]=this.columns;b.appendChild(d);this._sortListener&&this._sortListener.remove();this._sortListener=
g(d,"click,keydown",function(d){if("click"==d.type||32==d.keyCode||!e("opera")&&13==d.keyCode){var l=d.target,f,c,k;do if(l.sortable){k=[{attribute:f=l.field||l.columnId,descending:(c=a._sort[0])&&c.attribute==f&&!c.descending}];f={bubbles:!0,cancelable:!0,grid:a,parentType:d.type,sort:k};g.emit(d.target,"dgrid-sort",f)&&(a._sortNode=l,a.set("sort",k));break}while((l=l.parentNode)&&l!=b)}})},resize:function(){var a=this.headerNode.firstChild,b=this.contentNode,d;this.inherited(arguments);if(!e("ie")||
7<e("ie")&&!e("quirks"))if(b.style.width="",b&&a&&(d=a.offsetWidth)!=b.offsetWidth)b.style.width=d+"px"},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();this.inherited(arguments)},_setSort:function(a,b){this.inherited(arguments);this.updateSortArrow(this._sort)},_findSortArrowParent:function(a){var b=this.columns,d;for(d in b){var e=b[d];if(e.field==a)return e.headerNode}},updateSortArrow:function(a,b){this._lastSortedArrow&&(k(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),
k(this._lastSortedArrow,"!"),delete this._lastSortedArrow);b&&(this._sort=a);if(a[0]){var d=a[0].attribute,e=a[0].descending,d=this._sortNode||this._findSortArrowParent(d),g;delete this._sortNode;d&&(d=d.contents||d,g=this._lastSortedArrow=k("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),g.innerHTML="\x26nbsp;",d.insertBefore(g,d.firstChild),k(d,e?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(b,d){return this.addCssRule("#"+a.escapeCssIdentifier(this.domNode.id)+
" .dgrid-column-"+a.escapeCssIdentifier(b,"-"),d)},_configColumns:function(b,d){var e=[],g=d instanceof Array;a.each(d,function(a,f){"string"==typeof a&&(d[f]=a={label:a});!g&&!a.field&&(a.field=f);f=a.id=a.id||(isNaN(f)?f:b+f);this._configColumn&&(this._configColumn(a,f,d,b),f=a.id);g&&(this.columns[f]=a);a.grid=this;"function"===typeof a.init&&a.init();e.push(a)},this);return g?d:e},_destroyColumns:function(){var a=this.subRows,b=a&&a.length,d,e,g,f;this.cleanup();for(d=0;d<b;d++){e=0;for(f=a[d].length;e<
f;e++)g=a[d][e],"function"===typeof g.destroy&&g.destroy()}},configStructure:function(){var a=this.subRows,b=this._columns=this.columns;this.columns=!b||b instanceof Array?{}:b;if(a)for(b=0;b<a.length;b++)a[b]=this._configColumns(b+"-",a[b]);else this.subRows=[this._configColumns("",b)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(a){this._destroyColumns();this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=
a;this._updateColumns()},setColumns:function(a){n.deprecated("setColumns(...)",'use set("columns", ...) instead',"dgrid 0.4");this.set("columns",a)},setSubRows:function(a){n.deprecated("setSubRows(...)",'use set("subRows", ...) instead',"dgrid 0.4");this.set("subRows",a)},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this._sort&&this._sort.length?this.updateSortArrow(this._sort):this.resize())}});
b.appendIfNode=q;b.defaultRenderCell=d;return b})},"put-selector/put":function(){(function(n){var b,g=/[-+,> ]/;n([],b=function(e,k){function m(b){function h(){c&&(f&&c!=f)&&(f==b&&(k||(k=g.test(x)&&e.createDocumentFragment()))?k:f).insertBefore(c,t||null)}for(var k,r,t,f,c,u=arguments,w=u[0],A=0;A<u.length;A++){var x=u[A];if("object"==typeof x){r=!1;if(x instanceof Array){c=e.createDocumentFragment();for(var B=0;B<x.length;B++)c.appendChild(m(x[B]));x=c}if(x.nodeType)c=x,h(),f=x,t=0;else for(B in x)c[B]=
x[B]}else if(r)r=!1,c.appendChild(e.createTextNode(x));else{1>A&&(b=null);r=!0;if(w=x.replace(a,function(a,g,k,r,s,B){g&&(h(),"-"==g||"+"==g?(f=(t=c||f).parentNode,c=null,"+"==g&&(t=t.nextSibling)):("\x3c"==g?f=c=(c||f).parentNode:(","==g?f=b:c&&(f=c),c=null),t=0),c&&(f=c));if((a=!k&&r)||!c&&(k||s))"$"==a?(a=u[++A],f.appendChild(e.createTextNode(a))):(a=a||m.defaultTag,(g=l&&u[A+1]&&u[A+1].name)&&(a="\x3c"+a+' name\x3d"'+g+'"\x3e'),c=d&&~(n=a.indexOf("|"))?e.createElementNS(d[a.slice(0,n)],a.slice(n+
1)):e.createElement(a));if(k)if("$"==r&&(r=u[++A]),"#"==k)c.id=r;else if(g=(a=c.className)&&(" "+a+" ").replace(" "+r+" "," "),"."==k)c.className=a?(g+r).substring(1):r;else if("!"==x){var w;l?m("div",c,"\x3c").innerHTML="":(w=c.parentNode)&&w.removeChild(c)}else g=g.substring(1,g.length-1),g!=a&&(c.className=g);s&&("$"==B&&(B=u[++A]),"style"==s?c.style.cssText=B:(k="!"==s.charAt(0)?(s=s.substring(1))&&"removeAttribute":"setAttribute",B=""===B?s:B,d&&~(n=s.indexOf("|"))?c[k+"NS"](d[s.slice(0,n)],
s.slice(n+1),B):c[k](s,B)));return""}))throw new SyntaxError("Unexpected char "+w+" in "+x);h();f=w=c||f}}b&&k&&b.appendChild(k);return w}g=k||g;var a=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w\u00A0-\uFFFF%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,n,d=!1;e=e||document;var l="object"==typeof e.createElement;m.addNamespace=function(a,b){e.createElementNS?(d||(d={}))[a]=b:e.namespaces.add(a,b)};m.defaultTag="div";m.forDocument=b;return m})})(function(n,b,g){g=g||b;"function"===typeof define?define([],
function(){return g()}):"undefined"==typeof window?require("./node-html")(module,g):put=g()})},"dgrid/List":function(){define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),function(n,b,g,e,k,m,a,q,d){function l(a,c){d(document.body,a,".dgrid-scrollbar-measure");var b=a["offset"+c]-a["client"+c];a.className="";document.body.removeChild(a);return b}function p(a){var c=
a?"."+a.replace(u,"."):"";this._class&&(c="!"+this._class.replace(u,"!")+c);d(this.domNode,c);this._class=a}function h(){return this._class}function s(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}}function r(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&(this.bodyNode.scrollTop=a.y)}q("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var t,f;k.add("dom-scrollbar-width",function(a,c,b){return l(b,"Width")});k.add("dom-scrollbar-height",
function(a,c,b){return l(b,"Height")});k.add("dom-rtl-scrollbar-left",function(a,c,b){a=d("div");d(document.body,b,".dgrid-scrollbar-measure[dir\x3drtl]");d(b,a);c=!!k("ie")||!!k("trident")||a.offsetLeft>=k("dom-scrollbar-width");b.className="";document.body.removeChild(b);d(a,"!");b.removeAttribute("dir");return c});var c=0,u=/ +/g,w=7>k("ie")&&!k("quirks")?function(){var a,c,b;if(this._started&&(a=document.documentElement,c=a.clientWidth,a=a.clientHeight,b=this._prevWinDims||[],b[0]!==c||b[1]!==
a))this.resize(),this._prevWinDims=[c,a]}:function(){this._started&&this.resize()};return b("dgrid.List",k("touch")?a:null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,useTouchScroll:null,addUiClasses:!0,shouldObserveStore:!0,cleanEmptyObservers:!0,highlightDuration:250,postscript:function(a,c){var b=this;(this._Row=function(a,c,b){this.id=a;this.data=c;this.element=b}).prototype.remove=function(){b.removeRow(this.element)};c&&(this.srcNodeRef=c=c.nodeType?c:
document.getElementById(c));this.create(a,c)},listType:"list",create:function(a,f){var e=this.domNode=f||d("div"),g;a?(this.params=a,b.safeMixin(this,a),g=a["class"]||a.className||e.className,this._sort=a.sort||[],delete this.sort):this._sort=[];this.observers=[];this._numObservers=0;this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=e.id=e.id||this.id||"dgrid_"+c++;null===this.useTouchScroll&&(this.useTouchScroll=!k("dom-scrollbar-width"));this.buildRendering();
g&&p.call(this,g);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&this.startup()},buildRendering:function(){var a=this.domNode,c=this.addUiClasses,b=this,f,g,h,l;l=this.isRTL="rtl"==(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className="";d(a,"[role\x3dgrid].dgrid.dgrid-"+this.listType+(c?".ui-widget":""));f=this.headerNode=d(a,"div.dgrid-header.dgrid-header-row"+(c?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));
(k("quirks")||8>k("ie"))&&d(a,"div.dgrid-spacer");g=this.bodyNode=d(a,"div.dgrid-scroller");k("ff")&&(g.tabIndex=-1);this.headerScrollNode=d(a,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(c?".ui-widget-header":""));h=this.footerNode=d("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));d(a,h);l&&(a.className+=" dgrid-rtl"+(k("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));e(g,"scroll",function(c){b.showHeader&&(f.scrollLeft=c.scrollLeft||g.scrollLeft);c.stopPropagation();
e.emit(a,"scroll",{scrollTarget:g})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=d(this.bodyNode,"div.dgrid-content"+(c?".ui-widget-content":""));this._listeners.push(this._resizeHandle=e(window,"resize",m.throttleDelayed(w,this)))},postCreate:k("touch")?function(){this.useTouchScroll&&this.inherited(arguments)}:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this._sort))},configStructure:function(){},
resize:function(){var a=this.bodyNode,c=this.headerNode,b=this.footerNode,d=c.offsetHeight,e=this.showFooter?b.offsetHeight:0,g=k("quirks")||7>k("ie");this.headerScrollNode.style.height=a.style.marginTop=d+"px";a.style.marginBottom=e+"px";g&&(a.style.height="",a.style.height=Math.max(this.domNode.offsetHeight-d-e,0)+"px",e&&(b.style.bottom="1px",setTimeout(function(){b.style.bottom=""},0)));t||(t=k("dom-scrollbar-width"),f=k("dom-scrollbar-height"),k("ie")&&(t++,f++),m.addCssRule(".dgrid-scrollbar-width",
"width: "+t+"px"),m.addCssRule(".dgrid-scrollbar-height","height: "+f+"px"),17!=t&&!g&&(m.addCssRule(".dgrid-header-row","right: "+t+"px"),m.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+t+"px")));g&&(c.style.width=a.clientWidth+"px",setTimeout(function(){c.scrollLeft=a.scrollLeft},0))},addCssRule:function(a,c){var b=m.addCssRule(a,c);this.cleanAddedRules&&this._listeners.push(b);return b},on:function(a,c){var b=e(this.domNode,a,c);k("dom-addeventlistener")||this._listeners.push(b);return b},
cleanup:function(){var a=this.observers,c;for(c in this._rowIdToObject)if(this._rowIdToObject[c]!=this.columns){var b=document.getElementById(c);b&&this.removeRow(b,!0)}for(c=0;c<a.length;c++)(b=a[c])&&b.cancel();this.observers=[];this._numObservers=0;this.preload=null},destroy:function(){if(this._listeners){for(var a=this._listeners.length;a--;)this._listeners[a].remove();delete this._listeners}this._started=!1;this.cleanup();d(this.domNode,"!");this.useTouchScroll&&this.inherited(arguments)},refresh:function(){this.cleanup();
this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";this.scrollTo({x:0,y:0})},newRow:function(a,c,b,f,e){if(c){var g=this.insertRow(a,c,b,f,e);d(g,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){d(g,"!dgrid-highlight!ui-state-highlight")},this.highlightDuration);return g}},adjustRowIndices:function(a){var c=a.rowIndex;if(-1<c){do-1<a.rowIndex&&(this.maintainOddEven&&-1<(a.className+" ").indexOf("dgrid-row ")&&d(a,"."+(1==c%2?"dgrid-row-odd":"dgrid-row-even")+
"!"+(0==c%2?"dgrid-row-odd":"dgrid-row-even")),a.rowIndex=c++);while((a=a.nextSibling)&&a.rowIndex!=c)}},renderArray:function(a,c,b){function d(){var c=arguments;if(-1<q)for(var e=0;e<c.length;e++){var g=c[e],h=m[g?0:m.length-1];if(h=h&&f(h)){var k=h[g?"previousSibling":"nextSibling"];k&&(k=l.row(k));k&&k.element!=h&&(g=g?"unshift":"push",a[g](k.data),m[g](k.element),b.count++)}}}function f(a){return!g.isDescendant(a,l.domNode)&&document.getElementById(a.id)?l.row(a.id.slice(l.id.length+5)).element:
a}function e(a){t=l.insertRow(a,s,null,k++,b);t.observerIndex=q;return t}function h(a){u=a.slice(0);(n=c?c.parentNode:l.contentNode)&&n.parentNode&&(n!==l.contentNode||a.length)?(n.insertBefore(s,c||null),(t=a[a.length-1])&&l.adjustRowIndices(t)):p[q]&&l.cleanEmptyObservers&&"undefined"!==typeof q&&(p[q].cancel(),p[q]=0,l._numObservers--);m=a;r&&(r.rows=m)}b=b||{};var l=this,k=b.start||0,p=this.observers,m,n,q;c||(this._lastCollection=a);if(a.observe&&this.shouldObserveStore){l._numObservers++;var r=
a.observe(function(e,g,h){var k,p,r;-1<g&&m[g]&&(k=m.splice(g,1)[0],k.parentNode==n&&((p=k.nextSibling)&&g!=h&&p.rowIndex--,l.removeRow(k)),b.count--,l._processScroll&&l._processScroll());if(-1<h){if(m.length)if(0===h)r=(r=m[h])&&f(r);else{if(r=m[h-1])r=f(r),r=(r.connected||r).nextSibling}else r=l._getFirstRowSibling&&l._getFirstRowSibling(n);k&&(r&&k.id===r.id)&&(r=(r.connected||r).nextSibling);r&&!r.parentNode&&(r=document.getElementById(r.id));k=c&&c.parentNode||r&&r.parentNode||l.contentNode;
if(k=l.newRow(e,k,r,b.start+h,b))if(k.observerIndex=q,m.splice(h,0,k),!p||h<g)p=k.previousSibling,p=!p||p.rowIndex+1==k.rowIndex||0==k.rowIndex?k:p;b.count++}0===g?d(1,1):g===a.length-(-1===h?0:1)&&d(0,0);g!=h&&p&&l.adjustRowIndices(p);l._onNotification(m,e,g,h)},!0);q=p.push(r)-1}var s=document.createDocumentFragment(),t,u;if(a.map){if(m=a.map(e,console.error),m.then)return a.then(function(c){a=c;return m.then(function(a){h(a);d(1,1,0,0);return u})})}else{m=[];for(var w=0,K=a.length;w<K;w++)m[w]=
e(a[w])}h(m);d(1,1,0,0);return u},_onNotification:function(a,c,b,d){},renderHeader:function(){},_autoId:0,insertRow:function(a,c,b,d,f){var e=f.parentId,e=this.id+"-row-"+(e?e+"-":"")+(this.store&&this.store.getIdentity?this.store.getIdentity(a):this._autoId++),g=document.getElementById(e),h=g&&g.previousSibling;g&&(g===b&&(b=(b.connected||b).nextSibling),this.removeRow(g));g=this.renderRow(a,f);g.className=(g.className||"")+" dgrid-row "+(1==d%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?
" ui-state-default":"");this._rowIdToObject[g.id=e]=a;c.insertBefore(g,b||null);h&&this.adjustRowIndices(h);g.rowIndex=d;return g},renderRow:function(a,c){return d("div",""+a)},removeRow:function(a,c){a=a.element||a;delete this._rowIdToObject[a.id];c||d(a,"!")},row:function(a){var c;if(a instanceof this._Row)return a;a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var b=a.id;if(c=this._rowIdToObject[b])return new this._Row(b.substring(this.id.length+5),c,a);a=a.parentNode}while(a&&a!=
this.domNode)}else return"object"==typeof a?c=this.store.getIdentity(a):(c=a,a=this._rowIdToObject[this.id+"-row-"+c]),new this._Row(c,a,document.getElementById(this.id+"-row-"+c))},cell:function(a){return{row:this.row(a)}},_move:function(a,c,b,d){var f,e;e=f=a.element;c=c||1;do if(a=f[0>c?"previousSibling":"nextSibling"]){do if((f=a)&&-1<(f.className+" ").indexOf(b+" ")){e=f;c+=0>c?1:-1;break}while(a=(!d||!f.hidden)&&f[0>c?"lastChild":"firstChild"])}else if(f=f.parentNode,!f||f===this.bodyNode||
f===this.headerNode)break;while(c);return e},up:function(a,c,b){a.element||(a=this.row(a));return this.row(this._move(a,-(c||1),"dgrid-row",b))},down:function(a,c,b){a.element||(a=this.row(a));return this.row(this._move(a,c||1,"dgrid-row",b))},scrollTo:k("touch")?function(a){return this.useTouchScroll?this.inherited(arguments):r.call(this,a)}:r,getScrollPosition:k("touch")?function(){return this.useTouchScroll?this.inherited(arguments):s.call(this)}:s,get:function(a){var c="_get"+a.charAt(0).toUpperCase()+
a.slice(1);return"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]},set:function(a,c){if("object"===typeof a)for(var b in a)this.set(b,a[b]);else b="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,1)):this[a]=c;return this},_getClass:h,_setClass:p,_getClassName:h,_setClassName:p,_setSort:function(a,c){this._sort="string"!=typeof a?a:[{attribute:a,descending:c}];this.refresh();this._lastCollection&&(a.length&&
("string"!=typeof a&&(c=a[0].descending,a=a[0].attribute),this._lastCollection.sort(function(b,d){var f=b[a],e=d[a];void 0===f&&(f="");void 0===e&&(e="");return f==e?0:f>e==!c?1:-1})),this.renderArray(this._lastCollection))},sort:function(a,c){n.deprecated("sort(...)",'use set("sort", ...) instead',"dgrid 0.4");this.set("sort",a,c)},_getSort:function(){return this._sort},_setShowHeader:function(a){var c=this.headerNode;this.showHeader=a;d(c,(a?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();
a&&(c.scrollLeft=this.getScrollPosition().x)},setShowHeader:function(a){n.deprecated("setShowHeader(...)",'use set("showHeader", ...) instead',"dgrid 0.4");this.set("showHeader",a)},_setShowFooter:function(a){this.showFooter=a;d(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"dgrid/util/misc":function(){define(["dojo/has","put-selector/put"],function(n,b){n.add("dom-contains",function(a,b,e){return!!e.contains});var g=[],e,k,m,a=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,q={defaultDelay:15,
throttle:function(a,b,e){var g=!1;e=e||q.defaultDelay;return function(){g||(g=!0,a.apply(b,arguments),setTimeout(function(){g=!1},e))}},throttleDelayed:function(a,b,e){var g=!1;e=e||q.defaultDelay;return function(){if(!g){g=!0;var k=arguments;setTimeout(function(){g=!1;a.apply(b,k)},e)}}},debounce:function(a,b,e){var g;e=e||q.defaultDelay;return function(){g&&(clearTimeout(g),g=null);var k=arguments;g=setTimeout(function(){a.apply(b,k)},e)}},each:function(a,b,e){var g,k;if(a)if("number"===typeof a.length){g=
0;for(k=a.length;g<k;g++)b.call(e,a[g],g,a)}else for(g in a)b.call(e,a[g],g,a)},contains:function(a,b){return n("dom-contains")?a.contains(b):a.compareDocumentPosition(b)&8},addCssRule:function(a,l){e||(e=b(document.getElementsByTagName("head")[0],"style"),e=e.sheet||e.styleSheet,k=e.deleteRule?"deleteRule":"removeRule",m=e.cssRules?"cssRules":"rules");var p=g.length;g[p]=(e.cssRules||e.rules).length;e.addRule?e.addRule(a,l):e.insertRule(a+"{"+l+"}",g[p]);return{get:function(a){return e[m][g[p]].style[a]},
set:function(a,b){"undefined"!==typeof g[p]&&(e[m][g[p]].style[a]=b)},remove:function(){var a=g[p],b,d;if(void 0!==a){e[k](a);g[p]=void 0;b=p+1;for(d=g.length;b<d;b++)g[b]>a&&g[b]--}}}},escapeCssIdentifier:function(b,e){return"string"===typeof b?b.replace(a,e||"\\$1"):b}};return q})},"xstyle/has-class":function(){define(["dojo/has"],function(n){var b={};return function(){for(var g,e=arguments,k=0;k<e.length;k++)if(g=e[k],!b[g]){b[g]=!0;var m=g.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),a=n(m[2]),
q=-m[4];if((0<q?q<=a&&(-m[5]||q)>=a:!!a)==!m[1])document.documentElement.className+=" has-"+g}}})},"xstyle/css":function(){define(["require"],function(n){function b(b,e,k){var m=document.documentElement;b=m.insertBefore(document.createElement(b),m.firstChild);b.id=e;e=(b.currentStyle||getComputedStyle(b,null))[k];m.removeChild(b);return e}return{load:function(g,e,k,m){function a(){var a=b("x-parse",null,"content");a&&"none"!=a?e([eval(a)],k):k()}var q=e.toUrl(g),d=e.cache["url:"+q];if(d)return d.xCss&&
(d=d.cssText),n(["./util/createStyleSheet"],function(a){a(d)}),a();if("none"==b("div",g.replace(/\//g,"-").replace(/\..*/,"")+"-loaded","display"))return a();n(["./load-css"],function(b){b(q,a)})}}})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "),function(n,b,g,e,k,m,a,q,d){return g("dgrid.OnDemandList",[n,b],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,
farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:q.defaultDelay,keepScrollPosition:!1,rowHeight:22,postCreate:function(){this.inherited(arguments);var b=this;a(this.bodyNode,"scroll",q[this.pagingMethod](function(a){b._processScroll(a)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(a,b){function g(a){d(A,"!");if(a)throw m._refreshDeferred&&(m._refreshDeferred.reject(a),delete m._refreshDeferred),
a;}var m=this,n=b&&b.container||this.contentNode,q={query:a,count:0,options:b},f,c=this.preload,u,w={node:d(n,"div.dgrid-preload",{rowIndex:0}),count:0,query:a,next:q,options:b};w.node.style.height="0";q.node=f=d(n,"div.dgrid-preload");q.previous=w;f.rowIndex=this.minRowsPerPage;c?((q.next=c.next)&&f.offsetTop>=c.node.offsetTop?q.previous=c:(q.next=c,q.previous=c.previous),q.previous.next=q,q.next.previous=q):this.preload=q;var A=d(f,"-div.dgrid-loading");d(A,"div.dgrid-below").innerHTML=this.loadingMessage;
b=e.mixin(this.get("queryOptions"),b,{start:0,count:this.minRowsPerPage},"level"in a?{queryLevel:a.level}:null);this._trackError(function(){return u=a(b)});if("undefined"===typeof u)g();else return k.when(m.renderArray(u,f,b),function(a){return k.when("undefined"===typeof u.total?u.length:u.total,function(c){var e=a.length,g=f.parentNode,h=m.noDataNode;d(A,"!");"queryLevel"in b||(m._total=c);0===c&&g&&(h&&(d(h,"!"),delete m.noDataNode),m.noDataNode=h=d("div.dgrid-no-data"),g.insertBefore(h,m._getFirstRowSibling(g)),
h.innerHTML=m.noDataMessage);for(h=g=0;h<e;h++)g+=m._calcRowHeight(a[h]);e&&g&&(m.rowHeight=g/e);c-=e;q.count=c;f.rowIndex=e;c?f.style.height=Math.min(c*m.rowHeight,m.maxEmptySpace)+"px":(f.style.display="none",b.count++);m._previousScrollPosition&&(m.scrollTo(m._previousScrollPosition),delete m._previousScrollPosition);m._processScroll();m._refreshDeferred&&(m._refreshDeferred.resolve(u),delete m._refreshDeferred);return a},g)},g),u},refresh:function(b){var d=this,e=b&&b.keepScrollPosition,g;"undefined"===
typeof e&&(e=this.keepScrollPosition);e&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this.store)return e=this._refreshDeferred=new k,g=d.renderQuery(function(a){return d.store.query(d.query,a)}),"undefined"===typeof g&&e.reject(),e.then(function(b){d._refreshTimeout=setTimeout(function(){a.emit(d.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:d,results:b});d._refreshTimeout=null},0);delete d._refreshDeferred;return b},function(a){delete d._refreshDeferred;
throw a;})},resize:function(){this.inherited(arguments);this._processScroll()},_getFirstRowSibling:function(a){return a.lastChild},_calcRowHeight:function(a){var b=a.nextSibling;return b&&!/\bdgrid-preload\b/.test(b.className)?b.offsetTop-a.offsetTop:a.offsetHeight},lastScrollTop:0,_processScroll:function(a){function b(a,c,f,e){var l=n.farOffRemoval,k=a.node;if(c>2*l){for(var p,m=k[f],q=0,s=0,t=[];p=m;){var u=n._calcRowHeight(p);if(q+u+l>c||0>m.className.indexOf("dgrid-row")&&0>m.className.indexOf("dgrid-loading"))break;
m=p[f];q+=u;s+=p.count||1;n.removeRow(p,!0);t.push(p)}a.count+=s;e?(k.rowIndex-=s,g(a)):k.style.height=k.offsetHeight+q+"px";var w=d("div",t);setTimeout(function(){d(w,"!")},1)}}function g(a,c){a.node.style.height=Math.min(a.count*n.rowHeight,c?Infinity:n.maxEmptySpace)+"px"}function m(a,c){do a=c?a.next:a.previous;while(a&&!a.node.offsetWidth);return a}var n=this,q=n.bodyNode;a=a&&a.scrollTop||this.getScrollPosition().y;var q=q.offsetHeight+a,f,c,u=n.preload,w=n.lastScrollTop,A=n.bufferRows*n.rowHeight,
x=A-n.rowHeight,B,C,F,G=!0;for(n.lastScrollTop=a;u&&!u.node.offsetWidth;)u=u.previous;for(;u&&u!=f;){f=n.preload;n.preload=u;c=u.node;var z=c.offsetTop;if(q+1+x<z)u=m(u,G=!1);else if(a-1-x>z+c.offsetHeight)u=m(u,G=!0);else{var y=((c.rowIndex?a-A:q)-z)/n.rowHeight,z=(q-a+2*A)/n.rowHeight,J=Math.max(Math.min((a-w)*n.rowHeight,n.maxRowsPerPage/2),n.maxRowsPerPage/-2),z=z+Math.min(Math.abs(J),10);0==c.rowIndex&&(y-=z);y=Math.max(y,0);10>y&&(0<y&&z+y<n.maxRowsPerPage)&&(z+=Math.max(0,y),y=0);z=Math.min(Math.max(z,
n.minRowsPerPage),n.maxRowsPerPage,u.count);if(0==z)u=m(u,G);else{var z=Math.ceil(z),y=Math.min(Math.floor(y),u.count-z),v=e.mixin(n.get("queryOptions"),u.options);u.count-=z;var H=c,M,L=n.queryRowsOverlap;if(J=(0<c.rowIndex||c.offsetTop>a)&&u){var I=u.previous;I&&(b(I,a-(I.node.offsetTop+I.node.offsetHeight),"nextSibling"),0<y&&I.node==c.previousSibling?(y=Math.min(u.count,y),u.previous.count+=y,g(u.previous,!0),c.rowIndex+=y,L=0):z+=y,u.count-=y);v.start=c.rowIndex-L;v.count=Math.min(z+L,n.maxRowsPerPage);
c.rowIndex=v.start+v.count}else u.next&&(b(u.next,u.next.node.offsetTop-q,"previousSibling",!0),H=c.nextSibling,H==u.next.node?(u.next.count+=u.count-y,u.next.node.rowIndex=y+z,g(u.next),u.count=y,L=0):M=!0),v.start=u.count,v.count=Math.min(z+L,n.maxRowsPerPage);M&&(H&&H.offsetWidth)&&(M=H.offsetTop);g(u);"level"in u.query&&(v.queryLevel=u.query.level);if("queryLevel"in v||!(v.start>n._total||0>v.count)){c=d(H,"-div.dgrid-loading[style\x3dheight:"+z*n.rowHeight+"px]");d(c,"div.dgrid-"+(J?"below":
"above")).innerHTML=n.loadingMessage;c.count=z;var O=u.query(v);if(void 0===n._trackError(function(){return O})){d(c,"!");return}(function(a,c,b,f){F=k.when(n.renderArray(f,a,v),function(e){C=f;H=a.nextSibling;d(a,"!");if(b&&H&&H.offsetWidth){var l=n.getScrollPosition();n.scrollTo({x:l.x,y:l.y+H.offsetTop-b,preserveMomentum:!0})}k.when(f.total||f.length,function(a){"queryLevel"in v||(n._total=a);c&&(c.count=a-c.node.rowIndex,0===c.count&&v.count++,g(c))});n._processScroll();return e},function(c){d(a,
"!");throw c;})}).call(this,c,J,M,O);u=u.previous}}}}if(F&&(B=this._refreshDeferred))delete this._refreshDeferred,k.when(F,function(){B.resolve(C)})},removeRow:function(a,b){if(a){var d=a.previousSibling,e=a.nextSibling,d=d&&(null!=d.observerIndex?d.observerIndex:d.previousObserverIndex),g=e&&(null!=e.observerIndex?e.observerIndex:e.nextObserverIndex),e=a.observerIndex;a.observerIndex=void 0;b&&(a.nextObserverIndex=g,a.previousObserverIndex=d);if(this.cleanEmptyObservers&&(-1<e&&e!==d&&e!==g)&&(d=
this.observers,g=d[e])){if(!b)for(var k=g.rows,f=0;f<k.length;f++)if(k[f]!=a&&m.isDescendant(k[f],this.domNode))return this.inherited(arguments);g.cancel();this._numObservers--;d[e]=0}}this.inherited(arguments)}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),function(n,b,g,e,k,m,a){function q(a){return a}function d(a){if("object"!==typeof a)a=Error(a);else if("cancel"===a.dojoType)return;
a.grid=this;k.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return b("dgrid._StoreMixin",null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};this._columnsWithSet={};m.before(this,"configStructure",g.hitch(this,function(){this._columnsWithSet={}}))},postCreate:function(){this.inherited(arguments);this.store&&this._updateNotifyHandle(this.store)},
destroy:function(){this.inherited(arguments);this._notifyHandle&&this._notifyHandle.remove()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_updateNotifyHandle:function(a){this._notifyHandle&&(this._notifyHandle.remove(),delete this._notifyHandle);a&&("function"===typeof a.notify&&this.shouldObserveStore)&&(this._notifyHandle=m.after(a,"notify",g.hitch(this,"_onNotify"),!0),a=this.get("sort"),(!a||!a.length)&&console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))},
_setStore:function(a,b,d){this._updateNotifyHandle(a);this.store=a;this.dirty={};this.set("query",b,d)},_setQuery:function(a,b){var d=b&&b.sort;this.query=void 0!==a?a:this.query;this.queryOptions=b||this.queryOptions;this._started&&(d?this.set("sort",d):this.refresh())},setStore:function(a,b,d){n.deprecated("setStore(...)",'use set("store", ...) instead',"dgrid 0.4");this.set("store",a,b,d)},setQuery:function(a,b){n.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 0.4");this.set("query",
a,b)},_getQueryOptions:function(){var a=g.delegate(this.queryOptions,{});if("function"===typeof this._sort||this._sort.length)a.sort=this._sort;return a},_getQuery:function(){var a=this.query;return"object"==typeof a&&null!=a?g.delegate(a,{}):a},_setSort:function(a,b){this.store&&(this._lastCollection=null);this.inherited(arguments)},_onNotify:function(a,b){this.inherited(arguments);a&&1>this._numObservers&&this.refresh({keepScrollPosition:!0})},refresh:function(){var b=this.inherited(arguments);
this.store||(this.noDataNode=a(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return b},renderArray:function(){var b=this,d=this.inherited(arguments);this.store||e.when(d,function(d){d.length&&b.noDataNode&&a(b.noDataNode,"!")});return d},insertRow:function(a,b,d,e,k){var m=this.store,f=this.dirty,m=m&&m.getIdentity(a),c;m in f&&!(m in this._updating)&&(c=f[m]);c&&(a=g.delegate(a,c));return this.inherited(arguments)},updateDirty:function(a,b,d){var e=this.dirty,
g=e[a];g||(g=e[a]={});g[b]=d},setDirty:function(a,b,d){n.deprecated("setDirty(...)","use updateDirty() instead","dgrid 0.4");this.updateDirty(a,b,d)},save:function(){function a(c,f){return function(a){var k=b._columnsWithSet,l=b._updating,m,n;if("function"===typeof a.set)a.set(f);else for(m in f)a[m]=f[m];for(m in k)n=k[m].set(a),void 0!==n&&(a[m]=n);l[c]=!0;return e.when(d.put(a),function(){delete g[c];delete l[c]})}}var b=this,d=this.store,g=this.dirty,k=new e,m=k.promise,f=function(a){var c;return b.getBeforePut||
!(c=b.row(a).data)?function(){return d.get(a)}:function(){return c}},c;for(c in g)var n=a(c,g[c]),m=m.then(f(c)).then(n);k.resolve();return m},revert:function(){this.dirty={};this.refresh()},_trackError:function(a){var b;"string"==typeof a&&(a=g.hitch(this,a));try{b=a()}catch(h){d.call(this,h)}return e.when(b,q,g.hitch(this,d))},newRow:function(){var b=this.inherited(arguments);this.noDataNode&&(a(this.noDataNode,"!"),delete this.noDataNode);return b},removeRow:function(b,d){var e={element:b};!d&&
(this.noDataMessage&&this.up(e).element===b&&this.down(e).element===b)&&(this.noDataNode=a(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})})},"dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),function(n,b,g,e,k,m,a,q,d){function l(a,b){for(var d=a.unselectable=b?"on":
"",f=a.getElementsByTagName("*"),e=f.length;--e;)"INPUT"===f[e].tagName||"TEXTAREA"===f[e].tagName||(f[e].unselectable=d)}function p(a,b){var d=a.bodyNode,f=b?"text":21>k("ff")?"-moz-none":"none";s&&"msUserSelect"!==s?d.style[s]=f:k("dom-selectstart")?!b&&!a._selectstartHandle?a._selectstartHandle=e(d,"selectstart",function(a){var c=a.target&&a.target.tagName;"INPUT"!==c&&"TEXTAREA"!==c&&a.preventDefault()}):b&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):(l(d,
!b),!b&&!a._unselectableHandle?a._unselectableHandle=m.after(a,"renderRow",function(a){l(a,!0);return a}):b&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle))}k.add("dom-comparedocumentposition",function(a,b,d){return!!d.compareDocumentPosition});k.add("pointer",function(a){return"PointerEvent"in a?"pointer":"MSPointerEvent"in a?"MSPointer":!1});k.add("css-user-select",function(a,b,d){a=d.style;b=["Khtml","O","ms","Moz","Webkit"];d=b.length;var f="userSelect";do if("undefined"!==
typeof a[f])return f;while(d--&&(f=b[d]+"UserSelect"));return!1});k.add("dom-selectstart","undefined"!==typeof document.onselectstart);var h=k("mac")?"metaKey":"ctrlKey",s=k("css-user-select"),r=(a=k("pointer"))&&"MS"===a.slice(0,2),t=a?a+(r?"Down":"down"):"mousedown",f=a?a+(r?"Up":"up"):"mouseup";return b("dgrid.Selection",null,{selectionDelegate:".dgrid-row",selectionEvents:t+","+f+",dgrid-cellfocusin",selectionTouchEvents:k("touch")?q.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},
selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},
_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){n.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");this.set("selectionMode",a)},_setAllowTextSelection:function(a){"undefined"!==typeof a?p(this,a):p(this,"none"===this.selectionMode);this.allowTextSelection=a},_handleSelect:function(a,
b){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(b))&&!("dgrid-cellfocusin"===a.type&&"mousedown"===a.parentType||a.type===f&&b!=this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===t&&this.isSelected(b))this._waitForMouseUp=b;else this[this._selectionHandlerName](a,b);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(a,b){var d=a.keyCode?a.ctrlKey:a[h];this._lastSelected===
b?this.select(b,null,!d||!this.isSelected(b)):(this.clearSelection(),this.select(b),this._lastSelected=b)},_multipleSelectionHandler:function(a,b){var d=this._lastSelected,f=a.keyCode?a.ctrlKey:a[h],e;a.shiftKey||(e=f?null:!0,d=null);this.select(b,d,e);d||(this._lastSelected=b)},_extendedSelectionHandler:function(a,b){(2===a.button?!this.isSelected(b):!(a.keyCode?a.ctrlKey:a[h]))&&this.clearSelection(null,!0);this._multipleSelectionHandler(a,b)},_toggleSelectionHandler:function(a,b){this.select(b,
null,null)},_initSelectionEvents:function(){var a=this,b=this.contentNode,d=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};k("touch")&&!k("pointer")&&this.selectionTouchEvents?(e(b,q.selector(d,this.selectionTouchEvents),function(b){a._handleSelect(b,this);a._ignoreMouseSelect=this}),e(b,e.selector(d,this.selectionEvents),function(b){a._ignoreMouseSelect!==this?a._handleSelect(b,this):b.type===f&&(a._ignoreMouseSelect=null)})):e(b,e.selector(d,this.selectionEvents),function(b){a._handleSelect(b,
this)});this.addKeyHandler&&this.addKeyHandler(32,function(b){a._handleSelect(b,b.target)});if(this.allowSelectAll)this.on("keydown",function(b){b[h]&&(65==b.keyCode&&!/\bdgrid-input\b/.test(b.target.className))&&(b.preventDefault(),a[a.allSelected?"clearSelection":"selectAll"]())});this._setStore&&m.after(this,"_setStore",function(){a._updateDeselectionAspect()});this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(c,d,f){c=d||c&&c[b.idProperty||"id"];if(null!=c&&(d=(c=
b.row(c))&&b.selection[c.id]))b[f](c,null,d)}var b=this,d=this.store,f,e;this._removeDeselectSignals&&this._removeDeselectSignals();d&&d.notify?(f=m.before(d,"notify",function(b,d){b||a(b,d,"deselect")}),e=m.after(d,"notify",function(b,d){a(b,d,"select")},!0),this._removeDeselectSignals=function(){f.remove();e.remove()}):(f=m.before(this,"removeRow",function(a,c){var b;c||(b=this.row(a))&&b.id in this.selection&&this.deselect(b)}),this._removeDeselectSignals=function(){f.remove()})},allowSelect:function(a){return!0},
_fireSelectionEvent:function(a){var b=this._selectionEventQueues[a],d=this._selectionTriggerEvent,f;f={bubbles:!0,grid:this};d&&(f.parentType=d.type);f[this._selectionTargetType]=b;this._selectionEventQueues[a]=[];e.emit(this.contentNode,"dgrid-"+a,f)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},_select:function(a,b,f){var e,g,h;"undefined"===typeof f&&(f=!0);a.element||(a=this.row(a));if(!1===f||this.allowSelect(a))if(e=
this.selection,g=!!e[a.id],null===f&&(f=!g),h=a.element,!f&&!this.allSelected?delete this.selection[a.id]:e[a.id]=f,h&&(f?d(h,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):d(h,"!dgrid-selected!ui-state-active")),f!==g&&h&&this._selectionEventQueues[(f?"":"de")+"select"].push(a),b)if(b.element||(b=this.row(b)),b){if(b=b.element){e=this._determineSelectionDirection(h,b);e||(b=document.getElementById(b.id),e=this._determineSelectionDirection(h,b));for(;a.element!=b&&(a=this[e](a));)this._select(a,
null,f)}}else this._lastSelected=h,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},_determineSelectionDirection:k("dom-comparedocumentposition")?function(a,b){var d=b.compareDocumentPosition(a);return d&1?!1:2===d?"down":"up"}:function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>
a.sourceIndex?"down":"up"},select:function(a,b,d){this._select(a,b,d);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var d in this.selection)a!==d&&this._select(d,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=this.row(this._rowIdToObject[a]);this._select(b.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===
typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var a=this,b=this.inherited(arguments);g.when(b,function(b){var d=a.selection,f,e,g;for(f=0;f<b.length;f++)e=a.row(b[f]),(g=e.id in d?d[e.id]:a.allSelected)&&a._select(e,null,g);a._fireSelectionEvents()});
return b}})})},"xstyle/main":function(){define("xstyle/main",["require","put-selector/put"],function(n,b){function g(a,c){return a&&a.then?a.then(c):c(a)}function e(a,c,b){return g(a,function(a){var d=c[0];if(!a)return b(d||a);if(d&&a.get)return e(a.get(d),c.slice(1),b);if(a.receive)return a.receive(d?function(a){e(a,c,b)}:b);if(d)return e(a[d],c.slice(1),b);b(a)})}function k(a,c,b){e(a,c.slice(0,c.length-1),function(a){var d=c[c.length-1];a.set?a.set(d,b):a[d]=b})}function m(a){a=z.getElementsByTagName(a);
for(var c=0;c<a.length;c++)d(a[c])}function a(){return this.join("")}function q(a){this.value=a}function d(a,c,b){function f(){n(["xstyle/load-imports"],function(b){b(a,function(){d(a,c,!0)})})}var e=a.sheet||a.styleSheet||a,g=e.needsParsing,h=e.rules||e.cssRules;if(e.imports&&!b&&e.imports.length)return f();if(!g)for(var k=0;k<h.length;k++){var m=h[k];if(m.href&&!b)return f();m.selectorText&&"x-"==m.selectorText.substring(0,2)&&(g=!0,/^'/.test(m.style.content))}l(e.localSource||(e.ownerNode||e.ownerElement).innerHTML,
e,c)}function l(b,d,e){function h(a,c,b){(N[a]||(N[a]={}))[c]=b}function k(a){N[a]||(N[a]={});h("selector","x-"+a,{onRule:function(c){c.eachProperty(function(c,b){var d=b.toString();do{d=d.match(/([^, \(]+)(?:[, ]+(.+))?/);if(!d)break;var f=d[1];if("module"==f)return h(a,c,b[1].args[0]);if("default"==f){if("pseudo"==a)try{z.querySelectorAll("x:"+c);break}catch(e){}}else if("prefix"!=f)return h(a,c,function(){return b})}while(d=d[2])})}})}function m(){}function p(a){this.caller=a;this.args=[]}function r(a,
c){c.onRule();var b=N.selector[a];b&&s(b,"onRule",c)}function s(a,c,b,f){if(a){var g=E,h=function(a){"string"==typeof a&&d.addRule(g.fullSelector(),a);0==--F&&e&&e(d)};F++;var k=function(a){function e(a){console.error("Error occurred processing "+c.slice(2).toLowerCase()+" "+b+("{"==g.operator?' in rule "'+g.selector+'" {'+g.cssText:"")+". "+a.message);a&&console.error(a)}try{var k=a[c](b,f,g,d);g instanceof p&&(g.result=k);k&&k.then?k.then(h,e):h(k)}catch(l){e(l)}};"string"==typeof a?n([a],k):k(a)}}
function v(b,d){function f(c,b){b||(k+=c);if(D)if(D.push)"string"==typeof D[D.length-1]&&"string"==typeof c?D[D.length-1]+=c:c&&D.push(c);else if("string"==typeof D&&"string"==typeof c)D+=c;else{var d=[D,c];d.toString=a;D=d}else D=c}E=Q;for(var g=w.lastIndex=0,h=!0,k="",m=!0;;){var p=w.exec(b),n=p[4],t=p[1],K=p[2],p=p[3],z,P,D,W,p=p&&y(p),t=y(t);if(m){if(K?(k=P=t,z=K.charAt(0),W="?"==K.charAt(1)):k=p=t,D=p,P||"/"!=n)m=!1}else p=p?t+K:t,f(p);switch(n){case "'":case '"':var S="'"==n?A:x;S.lastIndex=
w.lastIndex;(n=S.exec(b))||error("unterminated string");n=n[1];w.lastIndex=S.lastIndex;f(new q(n));continue;case "/":"*"==b[w.lastIndex]?(B.lastIndex=w.lastIndex+1,B.exec(b),w.lastIndex=B.lastIndex):f("/");continue;case "\\":n=S.lastIndex++;f(b.charAt(n));continue;case "(":case "{":case "[":var V=!1;if("{"==n){m=!0;f(t=E.newRule(k),!0);if(z){h=!1;if(!K||"\x3e"==K.charAt(1))D.creating=!0;"\x3d"==z&&p&&(V=!0)}E.root&&h&&(t.cssRule=d.cssRules[g++])}else K=p.match(/(.*?)([\w-]*)$/),f(t=E.newCall(K[2],
D,E)),t.ref=c(E,K[2]),(D.calls||(D.calls=[])).push(t);t.parent=E;t.selector=D.creating?".x-generated-"+C++:E.root?k:E.selector+" "+k;V&&(K=c(E,p.match(/[^\s]+$/)[0],!0))&&u(K,t);E.currentName=P;E.currentSequence=D;E.assignmentOperator=z;I.push(E=t);E.operator=n;E.start=w.lastIndex;k="";E.selector&&E.selector.replace(/:([-\w]+)/,function(a,c){var b=N.pseudo[c];b&&s(b,"onPseudo",c,E)});D=P=null;continue}if(D)if(t=D[0],t.charAt&&"@"==t.charAt(0))"import"==D[0].slice(1,7)&&(K=l.getStyleSheet(d.cssRules[g++],
D,d),F++,p=w.lastIndex,v(K.localSource,K),w.lastIndex=p);else try{E[":"==z?"setValue":"declareProperty"](P,D,W)}catch(X){console.error(X.stack||X)}switch(n){case ":":m=!0;z=":";break;case "}":case ")":case "]":G[E.operator]!=n&&console.error("Incorrect opening operator "+E.operator+" with closing operator "+n);P=null;E.cssText=b.slice(E.start,w.lastIndex-1);"}"==n&&(r(E.selector,E),h=!0,k="");I.pop();E=I[I.length-1];D=E.currentSequence;P=E.currentName;z=E.assignmentOperator;E.root&&"}"==n&&(m=!0,
z=!1);break;case "":e&&e();return;case ";":D=null,m=!0,z=h=!1,k=""}}}d.addRule||(d.addRule=function(a,c,b){return this.insertRule(a+"{"+c+"}",0<=b?b:this.cssRules.length)});d.deleteRule||(d.deleteRule=d.removeRule);var N={property:{}};k("property");k("function");k("pseudo");N["function"]["var"]=R;N["function"]["extends"]=R;var F=1;(d.href||location.href).replace(/[^\/]+$/,"");m.prototype={eachProperty:function(a){for(var c=this.values||0,b=0;b<c.length;b++){var d=c[b];a.call(this,d||"unnamed",c[d])}},
fullSelector:function(){return(this.parent?this.parent.fullSelector():"")+(this.selector||"")+" "},newRule:function(a){return(this.rules||(this.rules={}))[a]=new m},newCall:function(a,c,b){return new p(a)},addSheetRule:function(a,c){if(c&&"@"!=a.charAt(0)){var b=d.addRule(a,c);-1==b&&(b=d.cssRules.length-1);return d.cssRules[b]}},onRule:function(){this.getCssRule()},getCssRule:function(){this.cssRule||(this.cssRule=this.addSheetRule(this.selector,this.cssText));return this.cssRule},get:function(a){return this.values[a]},
declareProperty:function(a,b,d){if("\x3e"==b[0].toString().charAt(0))a||(this.generator=b,b=t(b,this),R.addRenderer("",b,this,b));else{var f=a in J.style||c(this,a);if(!d||!f)(this.properties||(this.properties={}))[a]=b,f&&console.warn('Overriding existing property "'+a+'"')}},setValue:function(a,b){var d=this.values||(this.values=[]);d.push(a);d[a]=b;if(d=b.calls)for(var e=0;e<d.length;e++){var h=d[e],k=h.ref;k&&"function"==typeof k.call&&k.call(h,this,a,b)}if(a){do{if(d=c(this,a)){var l=this;g(f(l,
a,d),function(c){c=c.splice?c:[c];for(var d=0;d<c.length&&!c[d].put(b,l,a);d++);});break}a=a.substring(0,a.lastIndexOf("-"))}while(a)}},cssText:""};var D=p.prototype=new m;D.declareProperty=D.setValue=function(a,c){this.args.push(c)};D.toString=function(){var a=this.operator;return a+this.args+G[a]};var E,Q=new m;Q.root=!0;Q.properties={Math:Math,module:function(a){return{then:function(c){n([a],c)}}},item:{forElement:function(a){for(;!a.item;)a=a.parentNode;return{element:a,receive:function(c){c(a.item)}}}},
prefix:{put:function(a,c,b){if("string"==typeof J.style[H+b])return c.addSheetRule(c.selector,H+b+":"+a)}},"var":{put:function(a,c,b){(c.variables||(c.variables={}))[b]=a;c=(c=c.variableListeners)&&c[b]||0;for(b=0;b<c.length;b++)c[b](a)},call:function(a,c,b,d){this.receive(function(a){c.addSheetRule(c.selector,b+": "+d.toString().replace(/var\([^)]+\)/g,a))},c,a.args[0])},receive:function(a,c,b){var d=c;do{if(c=d.variables&&d.variables[b])return d=d.variableListeners||(d.variableListeners={}),(d[b]||
(d[b]=[])).push(a),a(c);d=d.parent}while(d);a()}},on:{put:function(a,c,b){console.log("add event listener");f(c,b,a)}}};Q.css=b;Q.parse=v;var I=[Q];v(b,d);0==--F&&e&&e(d);return Q}function p(){m("link");m("style");if(!T)if(T=!0,M["dom-qsa2.1"]){for(var a=0,c=I.length;a<c;a++)h(I[a]);s()}else for(var b=z.all,a=0,c=b.length;a<c;a++)r(b[a])}function h(a){for(var c=z.querySelectorAll(a.selector),b=a.name,d=0,f=c.length;d<f;d++){var e=c[d],g=e.elementalStyle;g||(g=e.elementalStyle={},e.elementalSpecificities=
{});var h=e.renderings;h||(h=e.renderings=[],O.push(e));h.push({name:b,rendered:g[b]==a.propertyValue,renderer:a});g[b]=a.propertyValue}}function s(){for(var a=0;a<O.length;a++){var c=O[a],d=c.renderings,f=c.elementalStyle;delete c.renderings;for(var e=0;e<d.length;e++){var g=d[e],h=g.renderer,k=h.rendered;U=f[g.name]==h.propertyValue;if(!k&&U)try{h.render(c)}catch(l){console.error(l,l.stack),b(c,"div.error",l.toString())}k&&(!U&&h.unrender)&&(h.unrender(c),d.splice(e--,1))}}O=[]}function r(a,c){for(var b=
0,d=I.length;b<d;b++){var f=I[b];(!c||c==f.selector)&&(L?L.call(a,f.selector):a.currentStyle[f.name]==f.propertyValue)&&f.render(a)}}function t(a,c){C++;a=a.sort?a:[a];return function(d,e){for(var h=d,k=0,l=a.length;k<l;k++){var m=a[k];try{if(m.eachProperty)if(m.args)if("("==m.operator){var p=a[k+1];p&&p.eachProperty&&b(h,p.selector);var n=m.args.toString(),q=f(m,0,n);(function(a,d){g(q,function(f){f.forElement&&(f=f.forElement(d));var e=a.appendChild(z.createTextNode("Loading"));f.receive(function(c){if(c&&
c.sort){e&&(e.parentNode.removeChild(e),e=null);var d=p&&p.eachProperty&&p.get("each");d&&(d=t(d,p));c.forEach(d?function(c){d(a,c)}:function(c){b(a,F[a.tagName]||"div",c)})}else"value"in a?(a.value=c,a["-x-variable"]=f):e.nodeValue=c},c,n)})})(h,d)}else b(h,m.toString());else b(h,m.selector),R.update(h,m.selector);else if("string"==typeof m){"\x3d"==m.charAt(0)&&(m=m.slice(1));for(var r=m.split(","),m=0,s=r.length;m<s;m++){var u=r[m].trim();if(u){var u=u.replace(/\([^)]*\)/,function(a){}),w=b(0==
m?h:d,u);e&&(w.item=e);p=a[k+1];w!=h&&(!p||!p.eachProperty)&&R.update(w);h=w}}}else h.appendChild(z.createTextNode(m.value))}catch(v){console.error(v,v.stack),h.appendChild(z.createTextNode(v))}}return h}}function f(a,b,d){function h(){var a=m.length+1,c=[],b=[],d,f,l=function(e){return function(g){c[e]=g;a--;if(0>=a){f=!0;d=r?r.apply(this,c):c[0];for(g=0;g<b.length;g++)b[g](d)}}};if(r)for(var p=0;p<m.length;p++){var n=m[p];e(n[0],n.slice(1),l(p))}else{var n=m[0],q={then:function(a){b.push(a)}};g(n[0],
function(a){q=a;for(var c=1;c<n.length;c++)if(q&&q.get)q=q.get(n[c]);else{q={receive:function(c){e(a,n.slice(1),c)},put:function(a){k(resolve,n.slice(1),a)}};break}for(c=0;c<b.length;c++)b[c](q)});return q}l(-1)();return d&&d.then?d:{receive:function(a){b&&b.push(a);f&&a(d)}}}var l=a["var-expr-"+b];if(m)return l;var m=[],p;m.id=C++;var n=[],q;d=d.join?d.join(""):d.toString();l=d.match(/^[\w_$\/\.-]*$/);d=d.replace(/("[^\"]*")|([\w_$\.\/-]+)/g,function(b,d,e){if(e){q=e.split("/");b=q.join("_");n.push(b);
m.push(q);d=q[0];e=c(a,d);if("string"==typeof e||e instanceof Array)e=f(a,d,e);else if(!e)throw Error('Could not find reference "'+d+'"');e.forElement&&(p=!0);q[0]=e}return b});if(!l)var r=Function.apply(this,n.concat(["return xstyleReturn("+d+")"]));m.func=r;a["var-expr-"+b]=m;return a["var-expr-"+b]=p?{forElement:function(c){for(var b,d=c;!L.call(c,a.selector);)c=c.parentNode;for(c=0;c<m.length;c++){var f=m[c],e=f[0];e.forElement&&(e=f[0]=e.forElement(d));f=e.element;if(d!=b){for(;d!=f;){if(d==
b)return;d=d.parentNode}b=d}}d=b["expr-result-"+m.id];d||(b["expr-result-"+m.id]=d=h(),d.element=b);return d}}:h()}function c(a,c,b){do{var d=a.properties&&a.properties[c]||b&&a.rules&&a.rules[c];a=a.parent}while(!d&&a);return d}function u(a,c){c.cssText+=a.cssText;"values,properties,variables,calls".replace(/\w+/g,function(b){a[b]&&(c[b]=Object.create(a[b]))});var b=c.getCssRule();a.eachProperty(function(a,d){c.setValue(a,d);if(a){var f=b.style;f[a]||(f[a]=d)}});a.generator&&c.declareProperty(null,
a.generator)}var w=/\s*([^{\}\[\]\(\)\/\\'":=;]*)([=:]\??\s*([^{\}\[\]\(\)\/\\'":;]*))?([{\}\[\]\(\)\/\\'":;]|$)/g,A=/((?:\\.|[^'])*)'/g,x=/((?:\\.|[^"])*)"/g,B=/\*\//g,C=0,F={TABLE:"tr",TBODY:"tr",TR:"td",UL:"li",OL:"li",SELECT:"option"},G={"{":"}","[":"]","(":")"},z=document,y="".trim?function(a){return a.trim()}:function(a){return a.replace(/^\s+|\s+$/g,"")},J=z.createElement("div");q.prototype.toString=function(){return'"'+this.value.replace(/["\\\n\r]/g,"\\$\x26")+'"'};var v=navigator.userAgent,
H=-1<v.indexOf("WebKit")?"-webkit-":-1<v.indexOf("Firefox")?"-moz-":-1<v.indexOf("MSIE")?"-ms-":-1<v.indexOf("Opera")?"-o-":"";l.getStyleSheet=function(a,c){return a.styleSheet};z.addEventListener("change",function(a){a=a.target;var c=a["-x-variable"];c.put&&c.put(a.value)});var J=z.createElement("div"),M={"dom-qsa2.1":!!J.querySelectorAll},L=J.matches||J.matchesSelector||J.webkitMatchesSelector||J.mozMatchesSelector||J.msMatchesSelector||J.oMatchesSelector,I=[],O=[],T;/e/.test(z.readyState||"")?
setTimeout(p,200):z.addEventListener("DOMContentLoaded",p);var U,R={process:d,vendorPrefix:H,applyProperty:function(a,c){return"opacity"==a&&"-ms-"==H?"filter: alpha(opacity\x3d"+100*c+"); zoom: 1;":H+a+":"+c+";"},onFunction:function(a,c,b){},onCall:function(a,c){function b(){var c=f,e="extends"==a?"rules":"variables";do{if(!c)throw Error('Could not find "'+d[0]+'" in the defined '+e);var g=c[e]&&c[e][d[0]],c=c.parent}while(!g);return g}var d=c.args,f=c.parent;if("extends"==a){var e=b();u(e,f)}else if("var"==
a)return function(a){a.addSheetRule(a.selector,a.currentName+": "+a.currentSequence.toString().replace(/var\([^)]+\)/g,b()))}},parse:l,addRenderer:function(a,c,b,d){a={selector:b.selector,propertyValue:c,name:a,render:d};I.push(a);T&&h(a);s()},update:r,clearRenderers:function(){I=[]},load:function(a,c,b,d){c(["xstyle/css"],function(f){f.load(a,c,b,d)})}};return R});xstyleReturn=function(n){return 1==arguments.length?n:[].slice.call(arguments)}},"dojo/store/Memory":function(){define(["../_base/declare",
"./util/QueryResults","./util/SimpleQueryEngine"],function(n,b,g){return n("dojo.store.Memory",null,{constructor:function(b){for(var g in b)this[g]=b[g];this.setData(this.data||[])},data:null,idProperty:"id",index:null,queryEngine:g,get:function(b){return this.data[this.index[b]]},getIdentity:function(b){return b[this.idProperty]},put:function(b,g){var m=this.data,a=this.index,n=this.idProperty,n=b[n]=g&&"id"in g?g.id:n in b?b[n]:Math.random();if(n in a){if(g&&!1===g.overwrite)throw Error("Object already exists");
m[a[n]]=b}else a[n]=m.push(b)-1;return n},add:function(b,g){(g=g||{}).overwrite=!1;return this.put(b,g)},remove:function(b){var g=this.index,m=this.data;if(b in g)return m.splice(g[b],1),this.setData(m),!0},query:function(e,g){return b(this.queryEngine(e,g)(this.data))},setData:function(b){b.items?(this.idProperty=b.identifier||this.idProperty,b=this.data=b.items):this.data=b;this.index={};for(var g=0,m=b.length;g<m;g++)this.index[b[g][this.idProperty]]=g}})})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],
function(n){return function(b,g){function e(e){e=n.filter(e,b);var a=g&&g.sort;a&&e.sort("function"==typeof a?a:function(b,e){for(var g,h=0;g=a[h];h++){var k=b[g.attribute],m=e[g.attribute],k=null!=k?k.valueOf():k,m=null!=m?m.valueOf():m;if(k!=m)return!!g.descending==(null==k||k>m)?-1:1}return 0});if(g&&(g.start||g.count)){var k=e.length;e=e.slice(g.start||0,(g.start||0)+(g.count||Infinity));e.total=k}return e}switch(typeof b){default:throw Error("Can not query with a "+typeof b);case "object":case "undefined":var k=
b;b=function(b){for(var a in k){var e=k[a];if(e&&e.test){if(!e.test(b[a],b))return!1}else if(e!=b[a])return!1}return!0};break;case "string":if(!this[b])throw Error("No filter function "+b+" was found in store");b=this[b];case "function":}e.matches=b;return e}})},"dojo/dnd/Source":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom-class ../dom-geometry ../mouse ../ready ../topic ./common ./Selector ./Manager".split(" "),function(n,b,g,e,k,m,a,q,d,l,p,h){g.isAsync||
q(0,function(){require(["dojo/dnd/AutoSource","dojo/dnd/Target"])});var s=b("dojo.dnd.Source",p,{isSource:!0,horizontal:!1,copyOnly:!1,selfCopy:!1,selfAccept:!0,skipForm:!1,withHandles:!1,autoSync:!1,delay:0,accept:["text"],generateText:!0,constructor:function(a,b){e.mixin(this,e.mixin({},b));var f=this.accept;if(f.length){this.accept={};for(var c=0;c<f.length;++c)this.accept[f[c]]=1}this.mouseDown=this.isDragging=!1;this.targetBox=this.targetAnchor=null;this.before=!0;this._lastY=this._lastX=0;this.sourceState=
"";this.isSource&&k.add(this.node,"dojoDndSource");this.targetState="";this.accept&&k.add(this.node,"dojoDndTarget");this.horizontal&&k.add(this.node,"dojoDndHorizontal");this.topics=[d.subscribe("/dnd/source/over",e.hitch(this,"onDndSourceOver")),d.subscribe("/dnd/start",e.hitch(this,"onDndStart")),d.subscribe("/dnd/drop",e.hitch(this,"onDndDrop")),d.subscribe("/dnd/cancel",e.hitch(this,"onDndCancel"))]},checkAcceptance:function(a,b){if(this==a)return!this.copyOnly||this.selfAccept;for(var d=0;d<
b.length;++d){for(var c=a.getItem(b[d].id).type,e=!1,g=0;g<c.length;++g)if(c[g]in this.accept){e=!0;break}if(!e)return!1}return!0},copyState:function(a,b){if(a)return!0;2>arguments.length&&(b=this==h.manager().target);if(b){if(this.copyOnly)return this.selfCopy}else return this.copyOnly;return!1},destroy:function(){s.superclass.destroy.call(this);n.forEach(this.topics,function(a){a.remove()});this.targetAnchor=null},onMouseMove:function(a){if(!(this.isDragging&&"Disabled"==this.targetState)){s.superclass.onMouseMove.call(this,
a);var b=h.manager();if(!this.isDragging&&this.mouseDown&&this.isSource&&(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)){var d=this.getSelectedNodes();d.length&&b.startDrag(this,d,this.copyState(l.getCopyKeyState(a),!0))}if(this.isDragging){d=!1;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current)this.targetBox=m.position(this.current,!0);d=this.horizontal?a.pageX-this.targetBox.x<this.targetBox.w/2==m.isBodyLtr(this.current.ownerDocument):a.pageY-
this.targetBox.y<this.targetBox.h/2}if(this.current!=this.targetAnchor||d!=this.before)this._markTargetAnchor(d),b.canDrop(!this.current||b.source!=this||!(this.current.id in this.selection))}}},onMouseDown:function(a){if(!this.mouseDown&&this._legalMouseDown(a)&&(!this.skipForm||!l.isFormElement(a)))this.mouseDown=!0,this._lastX=a.pageX,this._lastY=a.pageY,s.superclass.onMouseDown.call(this,a)},onMouseUp:function(a){this.mouseDown&&(this.mouseDown=!1,s.superclass.onMouseUp.call(this,a))},onDndSourceOver:function(a){this!==
a?(this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor()):this.isDragging&&(a=h.manager(),a.canDrop("Disabled"!=this.targetState&&(!this.current||a.source!=this||!(this.current.id in this.selection))))},onDndStart:function(a,b,d){this.autoSync&&this.sync();this.isSource&&this._changeState("Source",this==a?d?"Copied":"Moved":"");b=this.accept&&this.checkAcceptance(a,b);this._changeState("Target",b?"":"Disabled");this==a&&h.manager().overSource(this);this.isDragging=!0},onDndDrop:function(a,
b,d,c){if(this==c)this.onDrop(a,b,d);this.onDndCancel()},onDndCancel:function(){this.targetAnchor&&(this._unmarkTargetAnchor(),this.targetAnchor=null);this.before=!0;this.mouseDown=this.isDragging=!1;this._changeState("Source","");this._changeState("Target","")},onDrop:function(a,b,d){if(this!=a)this.onDropExternal(a,b,d);else this.onDropInternal(b,d)},onDropExternal:function(a,b,d){var c=this._normalizedCreator;this._normalizedCreator=this.creator?function(b,d){return c.call(this,a.getItem(b.id).data,
d)}:d?function(c){var b=a.getItem(c.id);c=c.cloneNode(!0);c.id=l.getUniqueId();return{node:c,data:b.data,type:b.type}}:function(c){var b=a.getItem(c.id);a.delItem(c.id);return{node:c,data:b.data,type:b.type}};this.selectNone();!d&&!this.creator&&a.selectNone();this.insertNodes(!0,b,this.before,this.current);!d&&this.creator&&a.deleteSelectedNodes();this._normalizedCreator=c},onDropInternal:function(a,b){var d=this._normalizedCreator;if(!(this.current&&this.current.id in this.selection)){if(b)this._normalizedCreator=
this.creator?function(a,b){return d.call(this,this.getItem(a.id).data,b)}:function(a){var b=this.getItem(a.id);a=a.cloneNode(!0);a.id=l.getUniqueId();return{node:a,data:b.data,type:b.type}};else{if(!this.current)return;this._normalizedCreator=function(a){var b=this.getItem(a.id);return{node:a,data:b.data,type:b.type}}}this._removeSelection();this.insertNodes(!0,a,this.before,this.current);this._normalizedCreator=d}},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){s.superclass.onOverEvent.call(this);
h.manager().overSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOver()},onOutEvent:function(){s.superclass.onOutEvent.call(this);h.manager().outSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOut()},_markTargetAnchor:function(a){this.current==this.targetAnchor&&this.before==a||(this.targetAnchor&&this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=a,this.targetAnchor&&
this._addItemClass(this.targetAnchor,this.before?"Before":"After"))},_unmarkTargetAnchor:function(){this.targetAnchor&&(this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetBox=this.targetAnchor=null,this.before=!0)},_markDndStatus:function(a){this._changeState("Source",a?"Copied":"Moved")},_legalMouseDown:function(b){if("touchstart"!=b.type&&!a.isLeft(b))return!1;if(!this.withHandles)return!0;for(b=b.target;b&&b!==this.node;b=b.parentNode){if(k.contains(b,"dojoDndHandle"))return!0;
if(k.contains(b,"dojoDndItem")||k.contains(b,"dojoDndIgnore"))break}return!1}});return s})},"dojo/dnd/Selector":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom ../dom-construct ../mouse ../_base/NodeList ../on ../touch ./common ./Container".split(" "),function(n,b,g,e,k,m,a,q,d,l,p,h){var s=b("dojo.dnd.Selector",h,{constructor:function(a,b){b||(b={});this.singular=b.singular;this.autoSync=b.autoSync;this.selection={};this.anchor=null;this.simpleSelection=!1;
this.events.push(d(this.node,l.press,e.hitch(this,"onMouseDown")),d(this.node,l.release,e.hitch(this,"onMouseUp")))},singular:!1,getSelectedNodes:function(){var a=new q,b=p._empty,d;for(d in this.selection)d in b||a.push(k.byId(d));return a},selectNone:function(){return this._removeSelection()._removeAnchor()},selectAll:function(){this.forInItems(function(a,b){this._addItemClass(k.byId(b),"Selected");this.selection[b]=1},this);return this._removeAnchor()},deleteSelectedNodes:function(){var a=p._empty,
b;for(b in this.selection)if(!(b in a)){var d=k.byId(b);this.delItem(b);m.destroy(d)}this.anchor=null;this.selection={};return this},forInSelectedItems:function(a,b){b=b||g.global;var d=this.selection,c=p._empty,e;for(e in d)e in c||a.call(b,this.getItem(e),e,this)},sync:function(){s.superclass.sync.call(this);this.anchor&&!this.getItem(this.anchor.id)&&(this.anchor=null);var a=[],b=p._empty,d;for(d in this.selection)d in b||this.getItem(d)||a.push(d);n.forEach(a,function(a){delete this.selection[a]},
this);return this},insertNodes:function(a,b,d,c){var e=this._normalizedCreator;this._normalizedCreator=function(b,c){var d=e.call(this,b,c);a?(this.anchor?this.anchor!=d.node&&(this._removeItemClass(d.node,"Anchor"),this._addItemClass(d.node,"Selected")):(this.anchor=d.node,this._removeItemClass(d.node,"Selected"),this._addItemClass(this.anchor,"Anchor")),this.selection[d.node.id]=1):(this._removeItemClass(d.node,"Selected"),this._removeItemClass(d.node,"Anchor"));return d};s.superclass.insertNodes.call(this,
b,d,c);this._normalizedCreator=e;return this},destroy:function(){s.superclass.destroy.call(this);this.selection=this.anchor=null},onMouseDown:function(b){this.autoSync&&this.sync();if(this.current)if(!this.singular&&!p.getCopyKeyState(b)&&!b.shiftKey&&this.current.id in this.selection)this.simpleSelection=!0,a.isLeft(b)&&(b.stopPropagation(),b.preventDefault());else{if(!this.singular&&b.shiftKey){p.getCopyKeyState(b)||this._removeSelection();var d=this.getAllNodes();if(d.length&&(this.anchor||(this.anchor=
d[0],this._addItemClass(this.anchor,"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var f=0,c;f<d.length&&!(c=d[f],c==this.anchor||c==this.current);++f);for(++f;f<d.length;++f){c=d[f];if(c==this.anchor||c==this.current)break;this._addItemClass(c,"Selected");this.selection[c.id]=1}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1}}else this.singular?this.anchor==this.current?p.getCopyKeyState(b)&&this.selectNone():(this.selectNone(),this.anchor=
this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1):p.getCopyKeyState(b)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=
1):this.current.id in this.selection||(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);b.stopPropagation();b.preventDefault()}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=d(this.node,
l.move,e.hitch(this,"onMouseMove"))},onOutEvent:function(){this.onmousemoveEvent&&(this.onmousemoveEvent.remove(),delete this.onmousemoveEvent)},_removeSelection:function(){var a=p._empty,b;for(b in this.selection)if(!(b in a)){var d=k.byId(b);d&&this._removeItemClass(d,"Selected")}this.selection={};return this},_removeAnchor:function(){this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this.anchor=null);return this}});return s})},"dojo/dnd/Container":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../_base/window ../dom ../dom-class ../dom-construct ../Evented ../has ../on ../query ../touch ./common".split(" "),
function(n,b,g,e,k,m,a,q,d,l,p,h,s,r){b=b("dojo.dnd.Container",d,{skipForm:!1,allowNested:!1,constructor:function(b,d){this.node=m.byId(b);d||(d={});this.creator=d.creator||null;this.skipForm=d.skipForm;this.parent=d.dropParent&&m.byId(d.dropParent);this.map={};this.current=null;this.containerState="";a.add(this.node,"dojoDndContainer");(!d||!d._skipStartup)&&this.startup();this.events=[p(this.node,s.over,e.hitch(this,"onMouseOver")),p(this.node,s.out,e.hitch(this,"onMouseOut")),p(this.node,"dragstart",
e.hitch(this,"onSelectStart")),p(this.node,"selectstart",e.hitch(this,"onSelectStart"))]},creator:function(){},getItem:function(a){return this.map[a]},setItem:function(a,b){this.map[a]=b},delItem:function(a){delete this.map[a]},forInItems:function(a,b){b=b||g.global;var c=this.map,d=r._empty,e;for(e in c)e in d||a.call(b,c[e],e,this);return b},clearItems:function(){this.map={}},getAllNodes:function(){return h((this.allowNested?"":"\x3e ")+".dojoDndItem",this.parent)},sync:function(){var a={};this.getAllNodes().forEach(function(b){if(b.id){var c=
this.getItem(b.id);if(c){a[b.id]=c;return}}else b.id=r.getUniqueId();var c=b.getAttribute("dndType"),d=b.getAttribute("dndData");a[b.id]={data:d||b.innerHTML,type:c?c.split(/\s*,\s*/):["text"]}},this);this.map=a;return this},insertNodes:function(a,b,c){this.parent.firstChild?b?c||(c=this.parent.firstChild):c&&(c=c.nextSibling):c=null;var d;if(c)for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),c.parentNode.insertBefore(d.node,c);else for(b=0;b<
a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),this.parent.appendChild(d.node);return this},destroy:function(){n.forEach(this.events,function(a){a.remove()});this.clearItems();this.node=this.parent=this.current=null},markupFactory:function(a,b,c){a._skipStartup=!0;return new c(b,a)},startup:function(){if(!this.parent&&(this.parent=this.node,"table"==this.parent.tagName.toLowerCase())){var a=this.parent.getElementsByTagName("tbody");a&&a.length&&(this.parent=
a[0])}this.defaultCreator=r._defaultCreator(this.parent);this.sync()},onMouseOver:function(a){for(var b=a.relatedTarget;b&&b!=this.node;)try{b=b.parentNode}catch(c){b=null}b||(this._changeState("Container","Over"),this.onOverEvent());b=this._getChildByEvent(a);this.current!=b&&(this.current&&this._removeItemClass(this.current,"Over"),b&&this._addItemClass(b,"Over"),this.current=b)},onMouseOut:function(a){for(a=a.relatedTarget;a;){if(a==this.node)return;try{a=a.parentNode}catch(b){a=null}}this.current&&
(this._removeItemClass(this.current,"Over"),this.current=null);this._changeState("Container","");this.onOutEvent()},onSelectStart:function(a){if(!this.skipForm||!r.isFormElement(a))a.stopPropagation(),a.preventDefault()},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(b,d){var c="dojoDnd"+b,e=b.toLowerCase()+"State";a.replace(this.node,c+d,c+this[e]);this[e]=d},_addItemClass:function(b,d){a.add(b,"dojoDndItem"+d)},_removeItemClass:function(b,d){a.remove(b,"dojoDndItem"+d)},
_getChildByEvent:function(b){if(b=b.target)for(var d=b.parentNode;d;b=d,d=b.parentNode)if((d==this.parent||this.allowNested)&&a.contains(b,"dojoDndItem"))return b;return null},_normalizedCreator:function(b,d){var c=(this.creator||this.defaultCreator).call(this,b,d);e.isArray(c.type)||(c.type=["text"]);c.node.id||(c.node.id=r.getUniqueId());a.add(c.node,"dojoDndItem");return c}});r._createNode=function(a){return!a?r._createSpan:function(b){return q.create(a,{innerHTML:b})}};r._createTrTd=function(a){var b=
q.create("tr");q.create("td",{innerHTML:a},b);return b};r._createSpan=function(a){return q.create("span",{innerHTML:a})};r._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};r._defaultCreator=function(a){a=a.tagName.toLowerCase();var b="tbody"==a||"thead"==a?r._createTrTd:r._createNode(r._defaultCreatorNodes[a]);return function(a,d){var g=a&&e.isObject(a),h,k;g&&a.tagName&&a.nodeType&&a.getAttribute?(h=a.getAttribute("dndData")||a.innerHTML,g=(g=a.getAttribute("dndType"))?g.split(/\s*,\s*/):
["text"],k=a):(h=g&&a.data?a.data:a,g=g&&a.type?a.type:["text"],k=("avatar"==d?r._createSpan:b)(String(h)));k.id||(k.id=r.getUniqueId());return{node:k,data:h,type:g}}};return b})},"dojo/dnd/Manager":function(){define("../_base/array ../_base/declare ../_base/lang ../_base/window ../dom-class ../Evented ../has ../keys ../on ../topic ../touch ./common ./autoscroll ./Avatar".split(" "),function(n,b,g,e,k,m,a,q,d,l,p,h,s,r){var t=b("dojo.dnd.Manager",[m],{constructor:function(){this.source=this.avatar=
null;this.nodes=[];this.copy=!0;this.target=null;this.canDropFlag=!1;this.events=[]},OFFSET_X:a("touch")?0:16,OFFSET_Y:a("touch")?-64:16,overSource:function(a){this.avatar&&(this.target=a&&"Disabled"!=a.targetState?a:null,this.canDropFlag=Boolean(this.target),this.avatar.update());l.publish("/dnd/source/over",a)},outSource:function(a){this.avatar?this.target==a&&(this.target=null,this.canDropFlag=!1,this.avatar.update(),l.publish("/dnd/source/over",null)):l.publish("/dnd/source/over",null)},startDrag:function(a,
b,h){function m(a){a.preventDefault();a.stopPropagation()}s.autoScrollStart(e.doc);this.source=a;this.nodes=b;this.copy=Boolean(h);this.avatar=this.makeAvatar();e.body().appendChild(this.avatar.node);l.publish("/dnd/start",a,b,this.copy);this.events=[d(e.doc,p.move,g.hitch(this,"onMouseMove")),d(e.doc,p.release,g.hitch(this,"onMouseUp")),d(e.doc,"keydown",g.hitch(this,"onKeyDown")),d(e.doc,"keyup",g.hitch(this,"onKeyUp")),d(e.doc,"dragstart",m),d(e.body(),"selectstart",m)];k.add(e.body(),"dojoDnd"+
(h?"Copy":"Move"))},canDrop:function(a){a=Boolean(this.target&&a);this.canDropFlag!=a&&(this.canDropFlag=a,this.avatar.update())},stopDrag:function(){k.remove(e.body(),["dojoDndCopy","dojoDndMove"]);n.forEach(this.events,function(a){a.remove()});this.events=[];this.avatar.destroy();this.source=this.target=this.avatar=null;this.nodes=[]},makeAvatar:function(){return new r(this)},updateAvatar:function(){this.avatar.update()},onMouseMove:function(b){var c=this.avatar;c&&(s.autoScrollNodes(b),c=c.node.style,
c.left=b.pageX+this.OFFSET_X+"px",c.top=b.pageY+this.OFFSET_Y+"px",c=Boolean(this.source.copyState(h.getCopyKeyState(b))),this.copy!=c&&this._setCopyStatus(c));a("touch")&&b.preventDefault()},onMouseUp:function(a){if(this.avatar){if(this.target&&this.canDropFlag){var b=Boolean(this.source.copyState(h.getCopyKeyState(a)));l.publish("/dnd/drop/before",this.source,this.nodes,b,this.target,a);l.publish("/dnd/drop",this.source,this.nodes,b,this.target,a)}else l.publish("/dnd/cancel");this.stopDrag()}},
onKeyDown:function(a){if(this.avatar)switch(a.keyCode){case q.CTRL:a=Boolean(this.source.copyState(!0));this.copy!=a&&this._setCopyStatus(a);break;case q.ESCAPE:l.publish("/dnd/cancel"),this.stopDrag()}},onKeyUp:function(a){this.avatar&&a.keyCode==q.CTRL&&(a=Boolean(this.source.copyState(!1)),this.copy!=a&&this._setCopyStatus(a))},_setCopyStatus:function(a){this.copy=a;this.source._markDndStatus(this.copy);this.updateAvatar();k.replace(e.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?
"Move":"Copy"))}});h._manager=null;t.manager=h.manager=function(){h._manager||(h._manager=new t);return h._manager};return t})},"dojo/dnd/Avatar":function(){define("../_base/declare ../_base/window ../dom ../dom-attr ../dom-class ../dom-construct ../hccss ../query".split(" "),function(n,b,g,e,k,m,a,q){return n("dojo.dnd.Avatar",null,{constructor:function(a){this.manager=a;this.construct()},construct:function(){var b=m.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",
margin:"0px"}}),g=this.manager.source,k,h=m.create("tbody",null,b),n=m.create("tr",null,h),q=m.create("td",null,n),t=Math.min(5,this.manager.nodes.length),f=0;a("highcontrast")&&m.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"\x3c"},q);m.create("span",{innerHTML:g.generateText?this._generateText():""},q);for(e.set(n,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});f<t;++f)g.creator?k=g._normalizedCreator(g.getItem(this.manager.nodes[f].id).data,"avatar").node:(k=this.manager.nodes[f].cloneNode(!0),
"tr"==k.tagName.toLowerCase()&&(n=m.create("table"),m.create("tbody",null,n).appendChild(k),k=n)),k.id="",n=m.create("tr",null,h),q=m.create("td",null,n),q.appendChild(k),e.set(n,{"class":"dojoDndAvatarItem",style:{opacity:(9-f)/10}});this.node=b},destroy:function(){m.destroy(this.node);this.node=!1},update:function(){k.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(a("highcontrast")){var b=g.byId("a11yIcon"),e="+";this.manager.canDropFlag&&!this.manager.copy?e="\x3c ":!this.manager.canDropFlag&&
!this.manager.copy?e="o":this.manager.canDropFlag||(e="x");b.innerHTML=e}q("tr.dojoDndAvatarHeader td span"+(a("highcontrast")?" span":""),this.node).forEach(function(a){a.innerHTML=this.manager.source.generateText?this._generateText():""},this)},_generateText:function(){return this.manager.nodes.length.toString()}})})},"dijit/CheckedMenuItem":function(){define(["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(n,b,g,e){return n("dijit.CheckedMenuItem",
g,{baseClass:"dijitMenuItem dijitCheckedMenuItem",templateString:e,checked:!1,_setCheckedAttr:function(b){this.domNode.setAttribute("aria-checked",b?"true":"false");this._set("checked",b)},iconClass:"",role:"menuitemcheckbox",checkedChar:"\x26#10003;",onChange:function(){},_onClick:function(b){this.disabled||(this.set("checked",!this.checked),this.onChange(this.checked));this.onClick(b)}})})},"dojo/_base/query":function(){define(["../query","./NodeList"],function(n){return n})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),
function(n,b,g,e,k,m,a,q,d){e("dijit-legacy-requires")&&m(0,function(){n(["dijit/form/RadioButton"])});return b("dijit.form.CheckBox",[a,q],{templateString:d,baseClass:"dijitCheckBox",_setValueAttr:function(a,b){"string"==typeof a&&(this.inherited(arguments),a=!0);this._created&&this.set("checked",a,b)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},
_fillContent:function(){},_onFocus:function(){this.id&&k("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&k("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(n,b){return n("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(g){this._set("readOnly",
g);b.set(this.focusNode,"readOnly",g)},_setLabelAttr:void 0,_getSubmitValue:function(b){return null==b||""===b?"on":b},_setValueAttr:function(g){g=this._getSubmitValue(g);this._set("value",g);b.set(this.focusNode,"value",g)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));b.set(this.focusNode,"value",this.value)},_onClick:function(b){return this.readOnly?(b.stopPropagation(),b.preventDefault(),!1):this.inherited(arguments)}})})},"dijit/form/ComboBox":function(){define(["dojo/_base/declare",
"./ValidationTextBox","./ComboBoxMixin"],function(n,b,g){return n("dijit.form.ComboBox",[b,g],{})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(n,b,g,e,k,m,a,q,d){return n("dijit.form.ComboBoxMixin",[q,m],{dropDownClass:a,hasDownArrow:!0,templateString:d,baseClass:"dijitTextBox dijitComboBox",
cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_setHasDownArrowAttr:function(a){this._set("hasDownArrow",a);this._buttonNode.style.display=a?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(a){a.get||e.mixin(a,{_oldAPI:!0,get:function(a){var d=new b;this.fetchItemByIdentity({identity:a,onItem:function(a){d.resolve(a)},onError:function(a){d.reject(a)}});return d.promise},query:function(a,d){var g=new b(function(){l.abort&&l.abort()});
g.total=new b;var l=this.fetch(e.mixin({query:a,onBegin:function(a){g.total.resolve(a)},onComplete:function(a){g.resolve(a)},onError:function(a){g.reject(a)}},d));return k(g)}});this._set("store",a)},postMixInProperties:function(){var a=this.params.store||this.store;a&&this._setStoreAttr(a);this.inherited(arguments);if(!this.params.store&&this.store&&!this.store._oldAPI){var b=this.declaredClass;e.mixin(this.store,{getValue:function(a,d){g.deprecated(b+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly",
"","2.0");return a[d]},getLabel:function(a){g.deprecated(b+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return a.name},fetch:function(a){g.deprecated(b+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],e.hitch(this,function(b){(new b({objectStore:this})).fetch(a)}))}})}},buildRendering:function(){this.inherited(arguments);this.focusNode.setAttribute("aria-autocomplete",this.autoComplete?"both":
"list")}})})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),function(n,b,g,e,k,m,a,q,d,l,p){b=b("dijit.form._AutoCompleterMixin",p,{item:null,autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(a){var b=0;if("number"==typeof a.selectionStart)b=a.selectionStart;else if(q("ie")){var d=
a.ownerDocument.selection.createRange().duplicate();a=a.createTextRange();d.move("character",0);a.move("character",0);try{a.setEndPoint("EndToEnd",d),b=String(a.text).replace(/\r/g,"").length}catch(e){}}return b},_setCaretPos:function(a,b){b=parseInt(b);l.selectInputText(a,b,b)},_setDisabledAttr:function(a){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",a?"true":"false")},_onKey:function(a){if(!(32<=a.charCode)){var b=a.charCode||a.keyCode;if(!(b==e.ALT||b==e.CTRL||b==e.META||
b==e.SHIFT)){var d=this.dropDown,g=null;this._abortQuery();this.inherited(arguments);if(!a.altKey&&!a.ctrlKey&&!a.metaKey)switch(this._opened&&(g=d.getHighlightedOption()),b){case e.PAGE_DOWN:case e.DOWN_ARROW:case e.PAGE_UP:case e.UP_ARROW:this._opened&&this._announceOption(g);a.stopPropagation();a.preventDefault();break;case e.ENTER:if(g){if(g==d.nextButton){this._nextSearch(1);a.stopPropagation();a.preventDefault();break}else if(g==d.previousButton){this._nextSearch(-1);a.stopPropagation();a.preventDefault();
break}a.stopPropagation();a.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case e.TAB:b=this.get("displayedValue");if(d&&(b==d._messages.previousMessage||b==d._messages.nextMessage))break;g&&this._selectOption(g);case e.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},_autoCompleteText:function(a){var b=this.focusNode;l.selectInputText(b,b.value.length);var d=this.ignoreCase?"toLowerCase":"substr";0==a[d](0).indexOf(this.focusNode.value[d](0))?
(d=this.autoComplete?this._getCaretPos(b):b.value.length,d+1>b.value.length&&(b.value=a,l.selectInputText(b,d))):(b.value=a,l.selectInputText(b))},_openResultList:function(a,b,d){var e=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();!a.length&&0==d.start?this.closeDropDown():(this._nextSearch=this.dropDown.onPage=k.hitch(this,function(b){a.nextPage(-1!==b);this.focus()}),this.dropDown.createOptions(a,d,k.hitch(this,"_getMenuLabelFromItem")),this._showResultList(),"direction"in
d?(d.direction?this.dropDown.highlightFirstOption():d.direction||this.dropDown.highlightLastOption(),e&&this._announceOption(this.dropDown.getHighlightedOption())):this.autoComplete&&(!this._prev_key_backspace&&!/^[*]+$/.test(b[this.searchAttr].toString()))&&this._announceOption(this.dropDown.containerNode.firstChild.nextSibling))},_showResultList:function(){this.closeDropDown(!0);this.openDropDown();this.domNode.setAttribute("aria-expanded","true")},loadDropDown:function(){this._startSearchAll()},
isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var a=this.get("displayedValue"),b=this.dropDown;b&&(a==b._messages.previousMessage||a==b._messages.nextMessage)?this._setValueAttr(this._lastValueReported,!0):"undefined"==typeof this.item?(this.item=null,this.set("displayedValue",a)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0),
this._refreshState());this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(a,b,d){var e="";a&&(d||(d=this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]),e=this._getValueField()!=this.searchAttr?this.store.getIdentity(a):d);this.set("value",e,b,d,a)},_announceOption:function(a){if(a){var b;if(a==this.dropDown.nextButton||a==this.dropDown.previousButton)b=a.innerHTML,this.item=void 0,this.value="";else{var d=this.dropDown.items[a.getAttribute("item")];
b=(this.store._oldAPI?this.store.getValue(d,this.searchAttr):d[this.searchAttr]).toString();this.set("item",d,!1,b)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",g.get(a,"id"));this._autoCompleteText(b)}},_selectOption:function(a){this.closeDropDown();a&&this._announceOption(a);this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,!0);this.focusNode.removeAttribute("aria-activedescendant")},
_startSearchAll:function(){this._startSearch("")},_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(a){if(!this.dropDown){var b=this.id+"_popup";this.dropDown=new (k.isString(this.dropDownClass)?k.getObject(this.dropDownClass,!1):this.dropDownClass)({onChange:k.hitch(this,this._selectOption),id:b,dir:this.dir,textDir:this.textDir})}this._lastInput=a;this.inherited(arguments)},_getValueField:function(){return this.searchAttr},postMixInProperties:function(){this.inherited(arguments);
if(!this.store&&this.srcNodeRef&&(this.store=new d({},this.srcNodeRef),!("value"in this.params))){var a=this.item=this.store.fetchSelectedItem();if(a){var b=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(a,b):a[b]}}},postCreate:function(){var a=m('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",a[0].id));this.inherited(arguments);n.after(this,"onSearch",k.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(a){a=
this.labelFunc(a,this.store);var b=this.labelType;"none"!=this.highlightMatch&&("text"==this.labelType&&this._lastInput)&&(a=this.doHighlight(a,this._lastInput),b="html");return{html:"html"==b,label:a}},doHighlight:function(b,d){var e=(this.ignoreCase?"i":"")+("all"==this.highlightMatch?"g":""),g=this.queryExpr.indexOf("${0}");d=a.escapeString(d);return this._escapeHtml(b.replace(RegExp((0==g?"^":"")+"("+d+")"+(g==this.queryExpr.length-4?"$":""),e),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,
'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(a){return a=String(a).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=null;this.inherited(arguments)},labelFunc:function(a,b){return(b._oldAPI?b.getValue(a,this.labelAttr||this.searchAttr):a[this.labelAttr||this.searchAttr]).toString()},_setValueAttr:function(a,b,d,e){this._set("item",e||null);null==a&&(a="");this.inherited(arguments)}});
q("dojo-bidi")&&b.extend({_setTextDirAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",a)}});return b})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),function(n,b,g,e,k,m){function a(a){return{id:a.value,value:a.value,name:g.trim(a.innerText||a.textContent||"")}}return n("dijit.form.DataList",k,{constructor:function(k,d){this.domNode=b.byId(d);g.mixin(this,k);this.id&&
m.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:e("option",this.domNode).map(a)}])},destroy:function(){m.remove(this.id)},fetchSelectedItem:function(){var b=e("\x3e option[selected]",this.domNode)[0]||e("\x3e option",this.domNode)[0];return b&&a(b)}})})},"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),function(n,b,g,e,k,m,a){return n("dijit.form._SearchMixin",null,{pageSize:Infinity,
store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(a){this._set("list",a)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:!0,_patternToRegExp:function(a){return RegExp("^"+a.replace(/(\\.)|(\*)|(\?)|\W/g,function(a,b,e,g){return e?".*":g?".":b?b:"\\"+a})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&
(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=!0,this._fetchHandle.cancel(),this._cancelingQuery=!1),this._fetchHandle=null)},_processInput:function(a){if(!this.disabled&&!this.readOnly){var d=a.charOrCode;if(!("type"in a&&"key"==a.type.substring(0,3)&&(a.altKey||(a.ctrlKey||a.metaKey)&&"x"!=d&&"v"!=d||d==b.SHIFT))){this._prev_key_backspace=a=!1;switch(d){case b.DELETE:case b.BACKSPACE:a=this._maskValidSubsetError=
this._prev_key_backspace=!0;break;default:a="string"==typeof d||229==d}if(a)if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},_startSearch:function(a){this._abortQuery();var b=this,e=g.clone(this.query),n={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},h=k.substitute(this.queryExpr,[a.replace(/([\\\*\?])/g,"\\$1")]),s,r=function(){var a=
b._fetchHandle=b.store.query(e,n);!b.disabled&&!(b.readOnly||s!==b._lastQuery)&&m(a,function(f){b._fetchHandle=null;!b.disabled&&(!b.readOnly&&s===b._lastQuery)&&m(a.total,function(a){f.total=a;var g=b.pageSize;if(isNaN(g)||g>f.total)g=f.total;f.nextPage=function(a){n.direction=a=!1!==a;n.count=g;a?(n.start+=f.length,n.start>=f.total&&(n.count=0)):(n.start-=g,0>n.start&&(n.count=Math.max(g+n.start,0),n.start=0));0>=n.count?(f.length=0,b.onSearch(f,e,n)):r()};b.onSearch(f,e,n)})},function(a){b._fetchHandle=
null;b._cancelingQuery||console.error(b.declaredClass+" "+a.toString())})};g.mixin(n,this.fetchProperties);this.store._oldAPI?s=h:(s=this._patternToRegExp(h),s.toString=function(){return h});this._lastQuery=e[this.searchAttr]=s;this._queryDeferHandle=this.defer(r,this.searchDelay)},constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var b=this.list;b&&(this.store=a.byId(b))}this.inherited(arguments)}})})},"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),
function(n,b,g,e,k,m,a,q){return n("dijit.form._ComboBoxMenu",[k,m,q,a],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(b.add(this.previousButton,"dijitMenuItemRtl"),b.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var a=this.ownerDocument.createElement("div");a.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");a.setAttribute("role","option");return a},onHover:function(a){b.add(a,"dijitMenuItemHover")},onUnhover:function(a){b.remove(a,
"dijitMenuItemHover")},onSelect:function(a){b.add(a,"dijitMenuItemSelected")},onDeselect:function(a){b.remove(a,"dijitMenuItemSelected")},_page:function(a){var b=0,e=this.domNode.scrollTop,h=g.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();b<h;){var k=this.getHighlightedOption();if(a){if(!k.previousSibling||"none"==k.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!k.nextSibling||"none"==k.nextSibling.style.display)break;this.selectNextNode()}k=
this.domNode.scrollTop;b+=(k-e)*(a?-1:1);e=k}},handleKey:function(a){switch(a.keyCode){case e.DOWN_ARROW:return this.selectNextNode(),!1;case e.PAGE_DOWN:return this._page(!1),!1;case e.UP_ARROW:return this.selectPreviousNode(),!1;case e.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),function(n,b,g,e,k){var m=b("dijit.form._ComboBoxMenuMixin"+
(e("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=k.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(a){this._set("value",a);this.onChange(a)},onClick:function(a){if(a==this.previousButton)this._setSelectedAttr(null),this.onPage(-1);else if(a==
this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(a)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(a,b){var d=this._createMenuItem(),e=b(a);e.html?d.innerHTML=e.label:d.appendChild(d.ownerDocument.createTextNode(e.label));""==d.innerHTML&&(d.innerHTML="\x26#160;");return d},createOptions:function(a,b,d){this.items=a;this.previousButton.style.display=0==b.start?"none":"";g.set(this.previousButton,"id",this.id+
"_prev");n.forEach(a,function(a,b){var e=this._createOption(a,d);e.setAttribute("item",b);g.set(e,"id",this.id+b);this.nextButton.parentNode.insertBefore(e,this.nextButton)},this);var e=!1;a.total&&!a.total.then&&-1!=a.total?b.start+b.count<a.total?e=!0:b.start+b.count>a.total&&b.count==a.length&&(e=!0):b.count==a.length&&(e=!0);this.nextButton.style.display=e?"":"none";g.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var a=this.containerNode;2<a.childNodes.length;)a.removeChild(a.childNodes[a.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});e("dojo-bidi")&&(m=b("dijit.form._ComboBoxMenuMixin",
m,{_createOption:function(){var a=this.inherited(arguments);this.applyTextDir(a);return a}}));return m})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/touch","./_ListBase"],function(n,b,g,e){return n("dijit.form._ListMouseMixin",e,{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover",
"_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(b,e){this._setSelectedAttr(e,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=this.defer(function(){this._deferredClick=null;this.onClick(e)})},_onMouseDown:function(b,e){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(e,!1)},_onMouseUp:function(b,e){this._isDragging=!1;var a=this.selected,g=this._hoveredNode;a&&e==a?this.defer(function(){this._onClick(b,
a)}):g&&this.defer(function(){this._onClick(b,g)})},_onMouseOut:function(b,e){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(b,e){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=e;this.onHover(e);this._isDragging&&this._setSelectedAttr(e,!1)}})})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on",
"dojo/window"],function(n,b,g){return n("dijit.form._ListBase",null,{selected:null,_listConnect:function(e,g){var m=this;return m.own(b(m.containerNode,b.selector(function(a,b,d){return a.parentNode==d},e),function(a){m[g](a,this)}))},selectFirstNode:function(){for(var b=this.containerNode.firstChild;b&&"none"==b.style.display;)b=b.nextSibling;this._setSelectedAttr(b,!0)},selectLastNode:function(){for(var b=this.containerNode.lastChild;b&&"none"==b.style.display;)b=b.previousSibling;this._setSelectedAttr(b,
!0)},selectNextNode:function(){var b=this.selected;if(b){for(b=b.nextSibling;b&&"none"==b.style.display;)b=b.nextSibling;b?this._setSelectedAttr(b,!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var b=this.selected;if(b){for(b=b.previousSibling;b&&"none"==b.style.display;)b=b.previousSibling;b?this._setSelectedAttr(b,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(b,k){if(this.selected!=b){var m=this.selected;if(m)this.onDeselect(m);
b&&(k&&g.scrollIntoView(b),this.onSelect(b));this._set("selected",b)}else if(b)this.onSelect(b)}})})},"url:esri/dijit/templates/InfoWindow.html":'\x3cdiv id\x3d"${id}.infowindow" class\x3d"infowindow" dojoAttachPoint\x3d"_infowindow"\r\n  \x3e\x3cdiv style\x3d"position:relative;"\r\n    \x3e\x3cdiv class\x3d"window" dojoAttachPoint\x3d"_window"\r\n      \x3e\x3cdiv class\x3d"top"\r\n        \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_topleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n    \t\t\x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_topright"\r\n    \t\t\t\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\r\n    \t\t\t\x3e\x3cdiv class\x3d"user" dojoAttachPoint\x3d"_user"\r\n    \t\t\t  \x3e\x3cdiv class\x3d"titlebar" dojoAttachPoint\x3d"_titlebar"\r\n    \t\t\t    \x3e\x3ca class\x3d"hide" dojoAttachPoint\x3d"_hide" dojoAttachEvent\x3d"onclick:hide"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/a\r\n              \x3e\x3cdiv class\x3d"title" dojoAttachPoint\x3d"_title"\x3e${title}\x3c/div\r\n    \t\t\t  \x3e\x3c/div\r\n            \x3e\x3cdiv class\x3d"border" dojoAttachPoint\x3d"_border"\x3e\x3c/div\r\n    \t\t\t  \x3e\x3cdiv class\x3d"layout content" dojoAttachPoint\x3d"_content, containerNode"\r\n    \t\t\t  \x3e\x3c/div\r\n    \t\t\t\x3e\x3c/div\r\n    \t\t\x3e\x3c/div\r\n        \x3e\x3cdiv class\x3d"bottom"\r\n          \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_bottomleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n\t\t      \x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_bottomright"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n        \x3e\x3c/div\r\n      \x3e\x3c/div\r\n    \x3e\x3c/div\r\n    \x3e\x3cdiv class\x3d"pointer" dojoAttachPoint\x3d"_pointer"\x3e\x3cdiv dojoAttachPoint\x3d"_sprite" class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n  \x3e\x3c/div\r\n\x3e\x3c/div\x3e',
"url:jimu/dijit/templates/LoadingShelter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cimg data-dojo-attach-point\x3d"loadingImg"/\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e${nls.loading}...\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/templates/SymbolChooser.html":'\x3cdiv style\x3d"width:320px;"\x3e\r\n\t\x3cdiv class\x3d"symbol-section point-symbol-section" data-dojo-attach-point\x3d"pointSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"point-sym-class-select-tr"\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"pointSymClassSelect" data-dojo-type\x3d"dijit/form/Select"\r\n\t\t\t\t\t\t style\x3d"width:100%;height:30px;"\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'0\' selected\x3d"selected"\x3e${nls.basic}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'1\'\x3eA-Z\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'2\'\x3e${nls.arrows}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'3\'\x3e${nls.business}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'4\'\x3e${nls.cartographic}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'5\'\x3e${nls.nationalParkService}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'6\'\x3e${nls.outdoorRecreation}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'7\'\x3e${nls.peoplePlaces}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'8\'\x3e${nls.safetyHealth}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'9\'\x3e${nls.shapes}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'10\'\x3e${nls.transportation}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"point-icon-tables-tr"\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"pointIconTables"\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.symbolSize}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"pointSize" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;"\r\n                        data-dojo-props\x3d\'value:18,smallDelta:1,largeDelta:10,constraints:{min:1,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointColorTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.color}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:[0,0,128,128]\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOpacityTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t${nls.transparency}\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:0.5\' style\x3d"font-size:13px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOutlineColorTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.outlineColor}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointOutlineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:[0,0,128,255]\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOulineWidthTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e${nls.outlineWidth}:\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"pointOutlineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" \r\n                        data-dojo-props\x3d\'value:1,smallDelta:1,constraints:{min:0,max:5},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section line-symbol-section" data-dojo-attach-point\x3d"lineSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"lineIconTables"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.color}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#9bbb59"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.style}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"lineStylesSelect" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:100%;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"solid"\x3e${nls.solid}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"dash"\x3e${nls.dash}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"dot"\x3e${nls.dot}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"dashdot"\x3e${nls.dashDot}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"longdashdotdot"\x3e${nls.dashDotDot}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e${nls.transparency}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:1\' style\x3d"font-size:13px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.width}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"lineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" \r\n\t\t\t\t\t\tdata-dojo-props\x3d\'value:3,smallDelta:1,constraints:{min:1,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section fill-symbol-section" data-dojo-attach-point\x3d"fillSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"fillIconTables"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.color}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#9bbb59"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t${nls.transparency}\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:0.5\' style\x3d"font-size:13px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.outlineColor}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillOutlineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#738c3d"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.outlineWidth}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"fillOutlineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" \r\n\t\t\t\t\t\tdata-dojo-props\x3d\'value:2,smallDelta:1,constraints:{min:0,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section text-symbol-section" data-dojo-attach-point\x3d"textSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.preview}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"textPreview"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.text}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"inputText" type\x3d"text" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.fontColor}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"textColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#000"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.fontSize}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"textFontSize" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" data-dojo-props\x3d\'value:20,smallDelta:1,constraints:{min:1,max:100},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\r\n\trole\x3d"listbox" aria-haspopup\x3d"true"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\r\n\t\t/\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\r\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t${_buttonInputDisabled}\r\n\t\t/\x3e\x3c/td\r\n\t\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/form/templates/Spinner.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitButtonNode dijitSpinnerButtonContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitSpinnerButtonInner" type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton"\r\n\t\t\tdata-dojo-attach-point\x3d"upArrowNode"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9650; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\t\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton"\r\n\t\t\tdata-dojo-attach-point\x3d"downArrowNode"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' data-dojo-attach-point\x3d"textbox,focusNode" type\x3d"${type}" data-dojo-attach-event\x3d"onkeydown:_onKeyDown"\r\n\t\t\trole\x3d"spinbutton" autocomplete\x3d"off" ${!nameAttrSetting}\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/templates/ColorPalette.html":'\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"paletteTableNode" class\x3d"dijitPaletteTable" cellSpacing\x3d"0" cellPadding\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/_Transparency.html":'\x3cdiv style\x3d"min-width: 170px;"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"opacitySlider" data-dojo-type\x3d"dijit/form/HorizontalSlider" showbuttons\x3d"true" value\x3d"0" minimum\x3d"0" maximum\x3d"100" discretevalues\x3d"101" intermediatechanges\x3d"true" style\x3d"width:100%;" data-dojo-attach-event\x3d"change: _onAlphaChanged"\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/form/HorizontalRuleLabels" container\x3d"topDecoration" labels\x3d"${nls.opaque},${nls.transparent}" style\x3d"height: 1.5em; font-size: 0.8em; color: #666"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/form/HorizontalRule" container\x3d"bottomDecoration" count\x3d"5" style\x3d"height: 5px;"\x3e\r\n    \x3c/div\x3e\r\n    \x3col data-dojo-type\x3d"dijit/form/HorizontalRuleLabels" container\x3d"bottomDecoration" style\x3d"height: 1em; font-size: 0.75em; color: darkblue;"\x3e\r\n      \x3cli\x3e0%\x3c/li\x3e\r\n      \x3cli\x3e50%\x3c/li\x3e\r\n      \x3cli\x3e100%\x3c/li\x3e\r\n    \x3c/ol\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/form/templates/HorizontalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:jimu/dijit/templates/TabContainer3.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"control-node" data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"controlTable" class\x3d"control-table" cellpading\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-node" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"tab-shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/DrawBox.html":'\x3cdiv style\x3d"position:relative;width:100%;"\x3e\r\n\t\x3cdiv class\x3d"draw-items"\x3e\r\n\t\t\x3cdiv title\x3d"${nls.point}" data-geotype\x3d"POINT" data-commontype\x3d"point" class\x3d"draw-item point-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.line}" data-geotype\x3d"LINE" data-commontype\x3d"polyline" class\x3d"draw-item line-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.polyline}" data-geotype\x3d"POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item polyline-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.freehandPolyline}" data-geotype\x3d"FREEHAND_POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item freehand-polyline-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.triangle}" data-geotype\x3d"TRIANGLE" data-commontype\x3d"polygon" class\x3d"draw-item triangle-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.extent}" data-geotype\x3d"EXTENT" data-commontype\x3d"polygon" class\x3d"draw-item extent-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.circle}" data-geotype\x3d"CIRCLE" data-commontype\x3d"polygon" class\x3d"draw-item circle-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.ellipse}" data-geotype\x3d"ELLIPSE" data-commontype\x3d"polygon" class\x3d"draw-item ellipse-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.polygon}" data-geotype\x3d"POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item polygon-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.freehandPolygon}" data-geotype\x3d"FREEHAND_POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item freehand-polygon-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.text}" data-geotype\x3d"POINT" data-commontype\x3d"text" class\x3d"draw-item text-icon" data-dojo-attach-point\x3d"textIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cspan class\x3d"drawings-clear jimu-float-trailing" data-dojo-attach-point\x3d"btnClear"\x3e${nls.clear}\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/CheckedMenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"${role}" tabIndex\x3d"-1" aria-checked\x3d"${checked}"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuItemIcon dijitCheckedMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\x3cspan class\x3d"dijitMenuItemIconChar dijitCheckedMenuItemIconChar"\x3e${!checkedChar}\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,labelNode,textDirNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\x26#160;\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cinput\r\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\r\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\r\n\t\tdata-dojo-attach-point\x3d"focusNode"\r\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n/\x3e\x3c/div\x3e\r\n',"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}"\r\n\trole\x3d"combobox"\r\n\taria-haspopup\x3d"true"\r\n\tdata-dojo-attach-point\x3d"_popupStateNode"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"text" autocomplete\x3d"off"\r\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"*now":function(n){n(['dojo/i18n!*preload*jimu/nls/main*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","ROOT"]'])}}});
define("./ConfigManager ./LayoutManager ./DataManager dojo/_base/html dojo/_base/lang dojo/_base/array dojo/on dojo/mouse dojo/topic dojo/cookie dojo/Deferred dojo/promise/all dojo/io-query dojo/domReady! esri/request esri/urlUtils esri/IdentityManager jimu/portalUrlUtils ./utils require dojo/i18n dojo/i18n!./nls/main".split(" "),function(n,b,g,e,k,m,a,q,d,l,p,h,s,r,t,f,c,u,w,A,x,B){m={};"function"!==typeof l.getAll&&(l.getAll=function(a){var b=[];(a=l(a))&&b.push(a);return b});window.jimuNls=B;c.setProtocolErrorHandler(function(){return!0});
c=w.getAncestorWindow();var C=!1;try{C=0===c.location.href.indexOf("https://")}catch(F){console.log(F),C="https:"===window.location.protocol}t.setRequestPreCallback(function(a){a.content&&a.content.printFlag&&(a.timeout=3E5);C&&(a.url=a.url.replace(/^http(s?):\/\//gi,"//"));-1!==a.url.indexOf("/queryRelatedRecords?")&&!w.isHostedService(a.url)&&(a.url=a.url.replace("FeatureServer","MapServer"));return a});a(window,"mousedown",function(a){if(q.isMiddle(a))return a.preventDefault(),a.stopPropagation(),
a.returnValue=!1});String.prototype.startWith=function(a){return this.substr(0,a.length)===a?!0:!1};String.prototype.endWith=function(a){return this.substr(this.length-a.length,a.length)===a?!0:!1};"undefined"===typeof jimuConfig&&(jimuConfig={});jimuConfig=k.mixin({loadingId:"main-loading",layoutId:"jimu-layout-manager",mapId:"map",mainPageId:"main-page",timeout:5E3,widthBreaks:[600,1280]},jimuConfig);window.wabVersion="1.2";window.productVersion="Portal for ArcGIS 10.3.1";m.initApp=function(){var a,
c;console.log("jimu.js init...");c=window.location.search;a=""===c?{}:c=s.queryToObject(c.substr(1));g.getInstance();e.setStyle(jimuConfig.loadingId,"display","none");e.setStyle(jimuConfig.mainPageId,"display","block");c=b.getInstance({mapId:jimuConfig.mapId},jimuConfig.layoutId);a=n.getInstance(a);c.startup();a.loadConfig()};return m});