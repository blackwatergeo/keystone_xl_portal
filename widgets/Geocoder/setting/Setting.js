//>>built
require({cache:{"widgets/Geocoder/setting/Edit":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/dijit/Message jimu/dijit/GeocodeServiceChooser dojo/text!./Edit.html dijit/form/ValidationTextBox".split(" "),function(c,h,l,m,b,a,d,f){return c([b,m],{baseClass:"jimu-geocoder-Edit",singleLineFieldName:null,validService:!1,templateString:f,postCreate:function(){this.inherited(arguments);this.serviceChooser=(new d({url:this.config.url||
""})).placeAt(this.serviceChooser);this.own(l(this.geocodeName,"Change",h.hitch(this,"_onGeocodeNameChange")));this.own(l(this.serviceChooser,"ok",h.hitch(this,"_onServiceChooserOk")));this._setConfig(this.config)},startup:function(){this.inherited(arguments);this.serviceChooser.startup()},_setConfig:function(a){a.url&&(this.validService=!0);a.name&&this.geocodeName.set("value",a.name);a.singleLineFieldName&&(this.singleLineFieldName=a.singleLineFieldName);a.placeholder&&this.geocodePlaceholder.set("value",
a.placeholder)},getConfig:function(){return{url:this.serviceChooser.getUrl(),name:this.geocodeName.get("value"),singleLineFieldName:this.singleLineFieldName,placeholder:this.geocodePlaceholder.get("value")}},_onGeocodeNameChange:function(){this._checkRequiredField()},_onServiceChooserOk:function(b){(b=b.definition)&&b.singleLineAddressField&&b.singleLineAddressField.name?(this.singleLineFieldName=b.singleLineAddressField.name,this.validService=!0):(new a({message:this.nls.warning}),this.singleLineFieldName=
"",this.validService=!1);this._checkRequiredField()},_checkRequiredField:function(){!this.validService||!this.geocodeName.get("value")?this.popup&&this.popup.disableButton(0):this.popup&&this.popup.enableButton(0)}})})},"jimu/dijit/GeocodeServiceChooser":function(){define(["dojo/_base/declare","./_BasicServiceChooser","./_GeocodeServiceChooserContent"],function(c,h,l){return c([h],{baseClass:"jimu-geocode-service-chooser",declaredClass:"jimu.dijit.GeocodeServiceChooser",_createServiceChooserContent:function(c){return new l(c)}})})},
"jimu/dijit/_BasicServiceChooser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooser.html dojo/Evented dojo/_base/html dojo/_base/lang dojo/on dojo/Deferred dijit/TooltipDialog dijit/popup esri/request dijit/form/ValidationTextBox jimu/dijit/LoadingIndicator".split(" "),function(c,h,l,m,b,a,d,f,k,g,t,e,n){return c([h,l,m,a],{templateString:b,url:"",postMixInProperties:function(){this.nls=f.mixin({},
window.jimuNls.common);this.nls=f.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);d.addClass(this.domNode,"jimu-basic-service-chooser");this._initSelf()},setUrl:function(a){this.url=a;var b=new g;this.url&&"string"===typeof this.url?(this.urlTextBox.set("value",this.url),b=n({url:this.url,handleAs:"json",content:{f:"json"},callbackParamName:"callback"})):setTimeout(f.hitch(this,function(){b.reject("Invalid url.")}),0);return b},getUrl:function(){return this.urlTextBox.get("value")},
_initSelf:function(){this.scc=this._createServiceChooserContent({multiple:!1,url:this.url});this.own(k(this.scc,"ok",f.hitch(this,this._onOk)));this.own(k(this.scc,"cancel",f.hitch(this,this._onCancel)));var a=d.create("div");this.tooltipDialog=new t({content:a});this.scc.placeAt(a);this.url&&"string"===typeof this.url&&this.urlTextBox.set("value",this.url)},_createServiceChooserContent:function(a){},_onBtnSetSourceClick:function(a){a.stopPropagation();a.preventDefault();e.close(this.tooltipDialog);
e.open({popup:this.tooltipDialog,around:this.urlTextBox.domNode})},_onOk:function(a){var b=a[0];this.urlTextBox.set("value",b.url);e.close(this.tooltipDialog);b.definition?this.emit("ok",b):n({url:b.url,handleAs:"json",callbackParamName:"callback",content:{f:"json"}}).then(f.hitch(this,function(a){b.definition=a;this.emit("ok",b)}))},_onCancel:function(){e.close(this.tooltipDialog);this.emit("cancel")},destroy:function(){this.scc&&this.scc.destroy();this.scc=null;this.tooltipDialog&&this.tooltipDialog.destroy();
this.tooltipDialog=null;this.inherited(arguments)}})})},"jimu/dijit/_GeocodeServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent","./GeocodeServiceBrowser"],function(c,h,l){return c([h],{baseClass:"jimu-geocode-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/GeocodeServer"],_createServiceBrowser:function(c){return new l(c)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),
function(c,h,l,m,b,a,d,f,k,g,t,e,n,p,x){return c([h,l,m,a],{templateString:b,_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=g.mixin({},window.jimuNls.common);this.nls=g.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);
f.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(a){var b=new d;(this.url=a)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),b=this._onBtnValidateClick()):b.reject();return b},_initSelf:function(){this._examples&&0<this._examples.length?k.forEach(this._examples,g.hitch(this,function(a){f.create("div",{innerHTML:a,"class":"example-url"},this.exampleTd)})):
f.setStyle(this.exampleTr,"display","none");var a={multiple:this.multiple,_onTreeClick:g.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(a);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(e.after(this.urlInput,"validator",g.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url)},_createServiceBrowser:function(a){},_validateUrl:function(a){a=a.replace(/\/*$/g,"");if((a=
a.match(/\/rest\/services\/*(.*)/gi))&&0<a.length)if(a=a[0].replace(/\/rest\/services\/*/,"")){var b=a.split("/");if(1===b.length)return!0;if(2===b.length)return this.serviceBrowser.isServiceTypeSupported(b[1]);if(3<=b.length)return a=this.serviceBrowser.isServiceTypeSupported(b[1]),b=this.serviceBrowser.isServiceTypeSupported(b[2]),a||b}else return!0;else return!1},_afterUrlValidate:function(a){a&&(a=this.urlInput.get("value"),a=this._validateUrl(a));a?f.removeClass(this.btnValidate,"jimu-state-disabled"):
f.addClass(this.btnValidate,"jimu-state-disabled");return a},_onBtnValidateClick:function(){var a=new d;if(this.urlInput.validate()){var b=this.urlInput.get("value");this.serviceBrowser.setUrl(b).then(g.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.resolve()}),g.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.reject()}))}else a.reject();return a},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?f.removeClass(this.btnOk,"jimu-state-disabled"):
f.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},_onBtnOkClick:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"jimu/dijit/GeocodeServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array"],function(c,h,l,m){return c([h],{baseClass:"jimu-geocode-service-browser",declaredClass:"jimu.dijit.GeocodeServiceBrowser",
_leafType:"GeocodeServer",_serviceTypes:["GeocodeServer"],url:"",multiple:!1,getSelectedItems:function(){var b=this.inherited(arguments);return b=m.map(b,l.hitch(this,function(a){return{name:a.name,url:a.url}}))},_getIconImageName:function(b,a){}})})},"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/query dojo/on dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/dijit/_Tree dijit/registry esri/request jimu/dijit/Message jimu/dijit/LoadingShelter".split(" "),
function(c,h,l,m,b,a,d,f,k,g,t,e,n,p,x,q,s,v,y,C){return c([h,l,m,b],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_leafType:"",_serviceTypes:"",_def:null,_restInfoCache:null,url:"",multiple:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser;this._restInfoCache=
{}},postCreate:function(){this.inherited(arguments);d.addClass(this.domNode,"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},setUrl:function(b){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new t;(!b||!("string"===typeof b&&b.replace(/\/*$/g,"")))&&setTimeout(a.hitch(this,
function(){this._def.reject()}),0);b=b.replace(/\/*$/g,"");b=a.trim(b);var e=b.match(/^http(s?):\/\//gi);e&&0<e.length||(b="http://"+b);if(!(0>=b.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=b))return b=this._getRootItem(),(this._isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,b):this._isUrlContainsServiceType(this._currentUrl)?this._isUrlEndWithServiceType(this._currentUrl)?this._searchServiceUrl(this._currentUrl,b,!0):this._searchChildResource(this._currentUrl,
b,!0):this._searchFolderServiceUrl(this._currentUrl,b)).then(a.hitch(this,function(a){var b=this.tree.getAllLeafTreeNodeWidgets();1===b.length&&b[0].select();this._def.resolve(a)}),a.hitch(this,function(a){a&&(a.errorCode&&"NETWORK_ERROR"===a.errorCode)&&this._showRequestError();this._def.reject(a)})),this._def;setTimeout(a.hitch(this,function(){this._def.reject()}),0)},isServiceTypeSupported:function(a){return this._isServiceTypeSupported(a)},_isServiceTypeSupported:function(b){b=b.toLowerCase();
return f.some(this._serviceTypes,a.hitch(this,function(a){return a.toLowerCase()===b}))},_getStringEndWith:function(a,b){var e="",f=a.indexOf(b);0<=f&&(e=a.slice(0,f+b.length));return e},_isUrlContainsServiceType:function(b){b=b.toLowerCase();return f.some(this._serviceTypes,a.hitch(this,function(a){a=a.toLowerCase();return 0<=b.indexOf("/"+a)}))},_isUrlEndWithServiceType:function(b){return f.some(this._serviceTypes,a.hitch(this,function(a){return this._isStringEndWith(b,"/"+a)}))},_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,
"rest/services")},_getServiceName:function(a){var b="";a=a.split("/");return b=a[a.length-1]},_searchBaseServiceUrl:function(b,c){this.shelter.show();var d=new t;this._getRestInfo(b).then(a.hitch(this,function(n){if(this.domNode){f.forEach(n.services,a.hitch(this,function(a){this._isServiceTypeSupported(a.type)&&(a={name:this._getServiceName(a.name),type:a.type,url:b+"/"+a.name+"/"+a.type,parent:c.id},this._addItem(a))}));var s=f.map(n.folders,a.hitch(this,function(a){return{name:a,type:"folder",
url:b+"/"+a,parent:c.id}}));0===s.length?(this.shelter.hide(),d.resolve()):(n=f.map(s,a.hitch(this,function(a){return this._getRestInfo(a.url)})),e(n).then(a.hitch(this,function(e){this.domNode&&(this.shelter.hide(),f.forEach(e,a.hitch(this,function(e,d){var c=s[d],n=f.filter(e.services,a.hitch(this,function(a){return this._isServiceTypeSupported(a.type)}));0<n.length&&(c=this._addItem(c),f.forEach(n,a.hitch(this,function(a){a={name:this._getServiceName(a.name),type:a.type,url:b+"/"+a.name+"/"+a.type,
parent:c.id};this._addItem(a)})))})),d.resolve())}),a.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),d.resolve())})))}}),a.hitch(this,function(a){console.error("request layer info failed",a);this.domNode&&(this.shelter.hide(),d.reject({errorCode:"NETWORK_ERROR",error:a}))}));return d},_searchFolderServiceUrl:function(b,e){var d=new t,c=this._getBaseServiceUrl();this.shelter.show();this._getRestInfo(b).then(a.hitch(this,function(b){this.domNode&&(this.shelter.hide(),b.services&&
0<b.services.length&&f.forEach(b.services,a.hitch(this,function(a){this._isServiceTypeSupported(a.type)&&(a={name:this._getServiceName(a.name),type:a.type,url:c+"/"+a.name+"/"+a.type,parent:e.id},this._addItem(a))})),d.resolve())}),a.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),d.reject({errorCode:"NETWORK_ERROR",error:a}))}));return d},_searchServiceUrl:function(b,e){var d=new t;b=b.replace(/\/*$/g,"");var c=b.split("/"),f=c[c.length-1],n=c[c.length-2];this.shelter.show();
this._getRestInfo(b).then(a.hitch(this,function(c){if(this.domNode){c.url=b;this.shelter.hide();var s={name:n,type:f,url:b,parent:e.id},s=this._addItem(s);this._searchServiceUrlCallback(b,s,c).then(a.hitch(this,function(){this.domNode&&d.resolve()}),a.hitch(this,function(a){console.error(a)}))}}),a.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),d.reject({errorCode:"NETWORK_ERROR",error:a}))}));return d},_searchServiceUrlCallback:function(b,e,c){var d=new t;setTimeout(a.hitch(this,
function(){d.resolve()}),0);return d},_searchChildResource:function(b,e,d){var c=new t;setTimeout(a.hitch(this,function(){c.resolve()}),0);return c},_getRestInfo:function(b){var e=new t;b=b.replace(/\/*$/g,"");var c=this._restInfoCache[b];c?setTimeout(a.hitch(this,function(){e.resolve(c)})):v({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback",timeout:2E4}).then(a.hitch(this,function(a){this._restInfoCache[b]=a;e.resolve(a)}),a.hitch(this,function(a){e.reject(a)}));return e},_isStringEndWith:function(a,
b){return a.lastIndexOf(b)+b.length===a.length},_clear:function(){var b=this._store.query({parent:"root"});f.forEach(b,a.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_showRequestError:function(){new y({message:this.nls.invalidUrlTip})},_addItem:function(a){this._id++;a.id=this._id.toString();this._store.add(a);return a},_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var b=this._getRootItem(),b=new n({data:[b],getChildren:function(a){return this.query({parent:a.id})}});
this._store=new p(b);b=new x({store:this._store,query:{id:"root"},mayHaveChildren:a.hitch(this,this._mayHaveChildren)});this.tree=new q({multiple:this.multiple,model:b,showRoot:!1,leafType:this._leafType,style:{width:"100%"},onOpen:a.hitch(this,function(a,b){this._onTreeOpen(a,b);this.emit("tree-open",a,b)}),onClick:a.hitch(this,function(a,b,e){this._onTreeClick(a,b,e);this.emit("tree-click",a,b,e)}),getIconStyle:a.hitch(this,function(a,b){var e=null;if(!a)return null;var c={width:"20px",height:"20px",
backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},d=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),f=this._getIconImageName(a,b);f||("folder"===a.type?f=b?"folder_open.png":"folder_close.png":this._isServiceTypeSupported(a.type)&&(f=b?"folder_open.png":"folder_close.png"));f&&(c.backgroundImage="url("+d+"/css/images/"+f+")",e=c);return e})});d.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(a,
b){},_mayHaveChildren:function(a){return a.type!==this._leafType},_onTreeOpen:function(a,b){},_onTreeClick:function(a,b,e){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"dojo/store/Observable":function(){define(["../_base/kernel","../_base/lang","../when","../_base/array"],function(c,h,l,m){c=function(b){function a(a,e){var c=b[a];c&&(b[a]=function(d){var f;"put"===a&&(f=b.getIdentity(d));if(g)return c.apply(this,arguments);g=!0;try{var k=
c.apply(this,arguments);l(k,function(a){e("object"==typeof a&&a||d,f)});return k}finally{g=!1}})}var c=[],f=0;b=h.delegate(b);b.notify=function(a,b){f++;for(var n=c.slice(),p=0,k=n.length;p<k;p++)n[p](a,b)};var k=b.query;b.query=function(a,e){e=e||{};var n=k.apply(this,arguments);if(n&&n.forEach){var p=h.mixin({},e);delete p.start;delete p.count;var g=b.queryEngine&&b.queryEngine(a,p),q=f,s=[],v;n.observe=function(a,p){1==s.push(a)&&c.push(v=function(a,c){l(n,function(d){var n=d.length!=e.count,k,
y;if(++q!=f)throw Error("Query is out of date, you must observe() the query prior to any data modifications");var h,t=-1,l=-1;if(void 0!==c){k=0;for(y=d.length;k<y;k++){var v=d[k];if(b.getIdentity(v)==c){h=v;t=k;(g||!a)&&d.splice(k,1);break}}}if(g){if(a&&(g.matches?g.matches(a):g([a]).length))k=-1<t?t:d.length,d.splice(k,0,a),l=m.indexOf(g(d),a),d.splice(k,1),e.start&&0==l||!n&&l==d.length?l=-1:d.splice(l,0,a)}else a&&(void 0!==c?l=t:e.start||(l=b.defaultIndex||0,d.splice(l,0,a)));if((-1<t||-1<l)&&
(p||!g||t!=l)){n=s.slice();for(k=0;d=n[k];k++)d(a||h,t,l)}})});var k={};k.remove=k.cancel=function(){var b=m.indexOf(s,a);-1<b&&(s.splice(b,1),s.length||c.splice(m.indexOf(c,v),1))};return k}}return n};var g;a("put",function(a,c){b.notify(a,c)});a("add",function(a){b.notify(a)});a("remove",function(a){b.notify(void 0,a)});return b};h.setObject("dojo.store.Observable",c);return c})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),
function(c,h,l,m,b,a,d){return l("dijit.tree.ObjectStoreModel",d,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(a){b.mixin(this,a);this.childrenCache={}},getRoot:function(c,d){if(this.root)c(this.root);else{var g=this.store.query(this.query);g.then&&this.own(g);a(g,b.hitch(this,function(a){if(1!=a.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+a.length+" items, but must return exactly one");this.root=a[0];c(this.root);g.observe&&g.observe(b.hitch(this,
function(a){this.onChange(a)}),!0)}),d)}},mayHaveChildren:function(){return!0},getChildren:function(c,d,g){var h=this.store.getIdentity(c);if(this.childrenCache[h])a(this.childrenCache[h],d,g);else{var e=this.childrenCache[h]=this.store.getChildren(c);e.then&&this.own(e);e.observe&&this.own(e.observe(b.hitch(this,function(d,k,g){this.onChange(d);k!=g&&a(e,b.hitch(this,"onChildrenChange",c))}),!0));a(e,d,g)}},isItem:function(){return!0},getIdentity:function(a){return this.store.getIdentity(a)},getLabel:function(a){return a[this.labelAttr]},
newItem:function(a,b,c,d){return this.store.put(a,{parent:b,before:d})},pasteItem:function(a,d,g,h,e,n){var p=new m;if(d===g&&!h&&!n)return p.resolve(!0),p;d&&!h?this.getChildren(d,b.hitch(this,function(b){b=[].concat(b);var e=c.indexOf(b,a);b.splice(e,1);this.onChildrenChange(d,b);p.resolve(this.store.put(a,{overwrite:!0,parent:g,oldParent:d,before:n}))})):p.resolve(this.store.put(a,{overwrite:!0,parent:g,oldParent:d,before:n}));return p},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},
"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),function(c,h,l,m,b,a,d,f,k,g,t,e,n,p,x){var q=c([p._TreeNode,e],{templateString:m,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);a.addClass(this.domNode,"jimu-tree-node");
this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=a.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=a.toDom('\x3cinput type\x3d"checkbox" /\x3e');a.addClass(this.checkNode,"jimu-tree-check-node");a.place(this.checkNode,this.contentNode,"first");this.own(t(this.checkNode,"click",b.hitch(this,this._onClick)));this.isLeaf?this.groupId?a.setStyle(this.checkNode,"display","none"):a.setStyle(this.checkNode,"display","inline"):a.setStyle(this.checkNode,"display",
"none");this.isLeaf?a.addClass(this.domNode,"jimu-tree-leaf-node"):a.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&(this.checkNode.checked=!0,a.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,a.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?
this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(b.hitch(this,function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return c([p,e],{declaredClass:"jimu._Tree",openOnClick:!0,leafType:"",multiple:!0,uniqueId:"",postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+x.getRandomString()},
postCreate:function(){this.inherited(arguments);a.addClass(this.domNode,"jimu-tree");this.own(g.before(this,"onClick",b.hitch(this,this._jimuBeforeClick)))},removeItem:function(a){this.model.store.remove(a)},getAllItems:function(){var a=this.getAllTreeNodeWidgets();return d.map(a,b.hitch(this,function(a){var c=b.mixin({},a.item);c.selected=a.checkNode.checked;return c}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=d.filter(a,b.hitch(this,function(a){return a.checkNode.checked}));
return d.map(a,b.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var c=this.getAllTreeNodeWidgets(),c=d.map(c,b.hitch(this,function(a){var c=b.mixin({},a.item);c.selected=a.checkNode.checked;return c}));return d.filter(c,b.hitch(this,function(b){return a(b)}))},getTreeNodeByItemId:function(a){for(var b=this._getAllTreeNodeDoms(),c=0;c<b.length;c++){var d=n.byNode(b[c]);if(d.item.id.toString()===a.toString())return d}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&
a.isLeaf&&this.selectNodeWidget(a)},unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return d.filter(a,b.hitch(this,function(a){return a.isLeaf}))},getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return d.map(a,b.hitch(this,function(a){return n.byNode(a)}))},isLeafItem:function(a){return a&&a.type===this.leafType},_getAllTreeNodeDoms:function(){return k(".dijitTreeNode",this.domNode)},
_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);this.multiple||(a.groupId=this.uniqueId);return new q(a)},_onTreeNodeSelect:function(a){a={item:b.mixin({},a.item),treeNode:a};this.emit("item-select",a)},_onTreeNodeUnselect:function(a){a={item:b.mixin({},a.item),treeNode:a};this.emit("item-unselect",a)},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,b,c){b.isLeaf&&(this.multiple?b.toggleSelect():this.selectNodeWidget(b));
return arguments},_onCheckNodeClick:function(a,c,d){!this.multiple&&c&&this.unselectAllLeafNodeWidgets();f.stop(d);this.focusNode(a);setTimeout(b.hitch(this,function(){c?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,a,d)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();d.forEach(a,b.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(c,h,l,m,b,a,d,f,k,g,t,e,n,p,x,q,s,v,y,C,D,J,A,E,G,F,H,K,I,M,L,N,Q,O,P){function w(a){return q.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var B=m("dijit._TreeNode",[G,F,H,K,I],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a)},labelType:"text",isExpandable:null,isExpanded:!1,state:"NotLoaded",
templateString:L,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";g.set(this.domNode,"backgroundPosition",b+" 0px");g.set(this.rowNode,
this.isLeftToRight()?"paddingLeft":"paddingRight",b);c.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,"row","Row");this.tree._startPaint(!0)},
_applyClassAndStyle:function(a,b,c){var d="_"+b+"Class";b+="Node";var e=this[d];this[d]=this.tree["get"+c+"Class"](a,this.isExpanded);f.replace(this[b],this[d]||"",e||"");g.set(this[b],this.tree["get"+c+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;f.toggle(this.domNode,"dijitTreeIsRoot",a);f.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=["dijitTreeExpandoLoading",
"dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;f.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return w(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&this.containerNode.setAttribute("role",
"group");f.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var a=e.wipeIn({node:this.containerNode,duration:E.defaultDuration}),c=this._expandDeferred=new b(function(){a.stop()});h.after(a,"onEnd",function(){c.resolve(!0)},!0);a.play();return w(c)},collapse:function(){if(this._collapseDeferred)return w(this._collapseDeferred);this._expandDeferred&&
(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");f.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var a=e.wipeOut({node:this.containerNode,duration:E.defaultDuration}),c=this._collapseDeferred=new b(function(){a.stop()});h.after(a,"onEnd",function(){c.resolve(!0)},
!0);a.play();return w(c)},indent:0,setChildItems:function(b){var r=this.tree,e=r.model,f=[],n=r.focusedChild,p=this.getChildren();c.forEach(p,function(a){H.prototype.removeChild.call(this,a)},this);this.defer(function(){c.forEach(p,function(a){if(!a._destroyed&&!a.getParent()){r.dndController.removeTreeNode(a);var b=function(a){var u=e.getIdentity(a.item),d=r._itemNodesMap[u];1==d.length?delete r._itemNodesMap[u]:(u=c.indexOf(d,a),-1!=u&&d.splice(u,1));c.forEach(a.getChildren(),b)};b(a);if(r.persist){var u=
c.map(a.getTreePath(),function(a){return r.model.getIdentity(a)}).join("/"),f;for(f in r._openedNodes)f.substr(0,u.length)==u&&delete r._openedNodes[f];r._saveExpandedNodes()}r.lastFocusedChild&&!d.isDescendant(r.lastFocusedChild,r.domNode)&&delete r.lastFocusedChild;n&&!d.isDescendant(n,r.domNode)&&r.focus();a.destroyRecursive()}})});this.state="Loaded";b&&0<b.length?(this.isExpandable=!0,c.forEach(b,function(a){var b=e.getIdentity(a),u=r._itemNodesMap[b],c;if(u)for(var d=0;d<u.length;d++)if(u[d]&&
!u[d].getParent()){c=u[d];c.set("indent",this.indent+1);break}c||(c=this.tree._createTreeNode({item:a,tree:r,isExpandable:e.mayHaveChildren(a),label:r.getLabel(a),labelType:r.model&&r.model.labelType||"text",tooltip:r.getTooltip(a),ownerDocument:r.ownerDocument,dir:r.dir,lang:r.lang,textDir:r.textDir,indent:this.indent+1}),u?u.push(c):r._itemNodesMap[b]=[c]);this.addChild(c);(this.tree.autoExpand||this.tree._state(c))&&f.push(r._expandNode(c))},this),c.forEach(this.getChildren(),function(a){a._updateLayout()})):
this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);b=a(f);this.tree._startPaint(b);return w(b)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,this.collapse());c.forEach(b,function(a){a._updateLayout()})},
makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");f.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){J.focus(this.focusNode)}});n("dojo-bidi")&&B.extend({_setTextDirAttr:function(a){if(a&&(this.textDir!=a||!this._created))this._set("textDir",a),this.applyTextDir(this.labelNode),c.forEach(this.getChildren(),function(b){b.set("textDir",a)},this)}});var z=m("dijit.Tree",[G,M,F,I],{baseClass:"dijitTree",
store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:N,persist:!1,autoExpand:!1,dndController:P,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,
b){v.publish(this.id,q.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new b;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(s(this.containerNode,s.selector(".dijitTreeNode",y.enter),function(b){a._onNodeMouseEnter(A.byNode(this),
b)}),s(this.containerNode,s.selector(".dijitTreeNode",y.leave),function(b){a._onNodeMouseLeave(A.byNode(this),b)}),s(this.containerNode,s.selector(".dijitTreeRow",D.press),function(b){a._onNodePress(A.getEnclosingWidget(this),b)}),s(this.containerNode,s.selector(".dijitTreeRow",D),function(b){a._onClick(A.getEnclosingWidget(this),b)}),s(this.containerNode,s.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(A.getEnclosingWidget(this),b)}));this.model||this._store2model();this.own(h.after(this.model,
"onChange",q.hitch(this,"_onItemChange"),!0),h.after(this.model,"onChildrenChange",q.hitch(this,"_onItemChildrenChange"),!0),h.after(this.model,"onDelete",q.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){q.isString(this.dndController)&&(this.dndController=q.getObject(this.dndController));for(var b={},c=0;c<this.dndParams.length;c++)this[this.dndParams[c]]&&(b[this.dndParams[c]]=this[this.dndParams[c]]);this.dndController=new this.dndController(this,b)}this._load();
this.onLoadDeferred=w(this.pendingCommandsPromise);this.onLoadDeferred.then(q.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;p.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=q.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&(a.getChildren=q.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&
a===this.model.root?null:a,b,c)}));this.model=new O(a);this.showRoot=Boolean(this.label)},onLoad:function(){},_load:function(){this.model.getRoot(q.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",!this.dndController.singular),this.rootLoadingIndicator.style.display=
"none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),b.labelNode.setAttribute("role","presentation"),
b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(q.hitch(this,function(){this._destroyed||(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),
q.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=q.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(q.hitch(this,function(){var d=c.map(a,function(a){return!a||q.isString(a)?a:b.model.getIdentity(a)}),e=[];c.forEach(d,function(a){e=
e.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",e)}))},_setPathAttr:function(a){return a.length?w(this.set("paths",[a]).then(function(a){return a[0]})):w(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(b){function d(a,b){var u=a.shift(),f=c.filter(b,function(a){return a.getIdentity()==u})[0];if(f)return a.length?e._expandNode(f).then(function(){return d(a,f.getChildren())}):f;throw new z.PathError("Could not expand path at "+u);}var e=this;return w(this.pendingCommandsPromise=
this.pendingCommandsPromise.always(function(){return a(c.map(b,function(a){a=c.map(a,function(a){return q.isString(a)?a:e.model.getIdentity(a)});if(a.length)return d(a,[e.rootNode]);throw new z.PathError("Empty path");}))}).then(function(a){e.set("selectedNodes",a);return e.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},expandAll:function(){function b(e){return d._expandNode(e).then(function(){var d=c.filter(e.getChildren()||
[],function(a){return a.isExpandable});return a(c.map(d,b))})}var d=this;return w(b(this.rootNode))},collapseAll:function(){function b(e){var f=c.filter(e.getChildren()||[],function(a){return a.isExpandable}),f=a(c.map(f,b));return!e.isExpanded||e==d.rootNode&&!d.showRoot?f:f.then(function(){return d._collapseNode(e)})}var d=this;return w(b(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||
this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){var c=this._getNext(b);c&&c.isTreeNode&&this.focusNode(c)},_onUpArrow:function(a,b){var c=b.getPreviousSibling();if(c)for(b=c;b.isExpandable&&b.isExpanded&&b.hasChildren();)c=b.getChildren(),b=c[c.length-1];else if(c=b.getParent(),
this.showRoot||c!==this.rootNode)b=c;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){if(b.isExpandable&&b.isExpanded)this._collapseNode(b);else{var c=b.getParent();c&&(c.isTreeNode&&(this.showRoot||c!==this.rootNode))&&this.focusNode(c)}},focusLastChild:function(){var a=this._getLast();a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?
this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,b){return d.isDescendant(a,b.expandoNode)||d.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,
b){this.focusNode(a)},__click:function(a,b,c,d){var e=this.isExpandoNode(b.target,a);a.isExpandable&&(c||e)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[d](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):
this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){p.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){p.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&delete a._expandNodeDeferred;
if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var c=this.model,d=a.item,e=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new b,c.getChildren(d,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},function(b){console.error(e,": error loading "+a.label+" children: ",b);a._loadDeferred.reject(b)}));
c=a._loadDeferred.then(q.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(c);return c},focusNode:function(a){var b=this.domNode.scrollLeft;this.focusChild(a);this.domNode.scrollLeft=b},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var d=this.getLabel(a),e=this.getTooltip(a);c.forEach(b,function(b){b.set({item:a,label:d,tooltip:e});b._updateItemClasses(a)})}},
_onItemChildrenChange:function(a,b){var d=this.model.getIdentity(a);(d=this._itemNodesMap[d])&&c.forEach(d,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];b&&(c.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!d.isDescendant(this.lastFocusedChild,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!d.isDescendant(this.focusedChild,this.domNode)&&
this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=l(this.cookieName);a&&c.forEach(a.split(","),function(a){this._openedNodes[a]=!0},this)}},_state:function(a,b){if(!this.persist)return!1;var d=c.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[d];b?this._openedNodes[d]=!0:delete this._openedNodes[d];this._saveExpandedNodes()},
_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);l(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!q.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&k.setMarginBox(this.domNode,
a);this._nodePixelIndent=k.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(q.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=q.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&(!this._adjustWidthsTimer&&
this._started)&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});C(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new B(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});n("dojo-bidi")&&z.extend({_setTextDirAttr:function(a){a&&
this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});z.PathError=t("TreePathError");z._TreeNode=B;return z})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(c,h,l,m){return l("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(b){m.mixin(this,b);this.connects=[];b=this.store;
if(!b.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");b.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([h.after(b,"onNew",m.hitch(this,"onNewItem"),!0),h.after(b,"onDelete",m.hitch(this,"onDeleteItem"),!0),h.after(b,"onSet",m.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var b;b=this.connects.pop();)b.remove()},getRoot:function(b,a){this.root?b(this.root):this.store.fetch({query:this.query,
onComplete:m.hitch(this,function(a){if(1!=a.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+a.length+" items, but must return exactly one");this.root=a[0];b(this.root)}),onError:a})},mayHaveChildren:function(b){return c.some(this.childrenAttrs,function(a){return this.store.hasAttribute(b,a)},this)},getChildren:function(b,a,d){var f=this.store;if(f.isItemLoaded(b)){for(var k=[],g=0;g<this.childrenAttrs.length;g++)var h=f.getValues(b,this.childrenAttrs[g]),k=k.concat(h);var e=0;
this.deferItemLoadingUntilExpand||c.forEach(k,function(a){f.isItemLoaded(a)||e++});0==e?a(k):c.forEach(k,function(b,c){f.isItemLoaded(b)||f.loadItem({item:b,onItem:function(b){k[c]=b;0==--e&&a(k)},onError:d})})}else{var n=m.hitch(this,arguments.callee);f.loadItem({item:b,onItem:function(b){n(b,a,d)},onError:d})}},isItem:function(b){return this.store.isItem(b)},fetchItemByIdentity:function(b){this.store.fetchItemByIdentity(b)},getIdentity:function(b){return this.store.getIdentity(b)},getLabel:function(b){return this.labelAttr?
this.store.getValue(b,this.labelAttr):this.store.getLabel(b)},newItem:function(b,a,c){var f={parent:a,attribute:this.childrenAttrs[0]},k;this.newItemIdAttr&&b[this.newItemIdAttr]?this.fetchItemByIdentity({identity:b[this.newItemIdAttr],scope:this,onItem:function(g){g?this.pasteItem(g,null,a,!0,c):(k=this.store.newItem(b,f))&&void 0!=c&&this.pasteItem(k,a,a,!1,c)}}):(k=this.store.newItem(b,f))&&void 0!=c&&this.pasteItem(k,a,a,!1,c)},pasteItem:function(b,a,d,f,k){var g=this.store,h=this.childrenAttrs[0];
a&&c.forEach(this.childrenAttrs,function(d){if(g.containsValue(a,d,b)){if(!f){var e=c.filter(g.getValues(a,d),function(a){return a!=b});g.setValues(a,d,e)}h=d}});if(d)if("number"==typeof k){var e=g.getValues(d,h).slice();e.splice(k,0,b);g.setValues(d,h,e)}else g.setValues(d,h,g.getValues(d,h).concat(b))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(b,a){a&&this.getChildren(a.item,m.hitch(this,function(b){this.onChildrenChange(a.item,b)}))},onDeleteItem:function(b){this.onDelete(b)},
onSetItem:function(b,a){if(-1!=c.indexOf(this.childrenAttrs,a))this.getChildren(b,m.hitch(this,function(a){this.onChildrenChange(b,a)}));else this.onChange(b)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(c,h,l,m,b){return h("dijit.tree.ForestStoreModel",b,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(a){this.root={store:this,root:!0,id:a.rootId,label:a.rootLabel,
children:a.rootChildren}},mayHaveChildren:function(a){return a===this.root||this.inherited(arguments)},getChildren:function(a,b,c){a===this.root?this.root.children?b(this.root.children):this.store.fetch({query:this.query,onComplete:m.hitch(this,function(a){this.root.children=a;b(a)}),onError:c}):this.inherited(arguments)},isItem:function(a){return a===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(a){if(a.identity==this.root.id){var b=a.scope||l.global;a.onItem&&a.onItem.call(b,
this.root)}else this.inherited(arguments)},getIdentity:function(a){return a===this.root?this.root.id:this.inherited(arguments)},getLabel:function(a){return a===this.root?this.root.label:this.inherited(arguments)},newItem:function(a,b,c){return b===this.root?(this.onNewRootItem(a),this.store.newItem(a)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(a,b,c,k,g){if(b===this.root&&!k)this.onLeaveRoot(a);this.inherited(arguments,[a,b===this.root?null:b,c===this.root?null:c,k,
g]);if(c===this.root)this.onAddToRoot(a)},onAddToRoot:function(a){console.log(this,": item ",a," added to root")},onLeaveRoot:function(a){console.log(this,": item ",a," removed from root")},_requeryTop:function(){var a=this.root.children||[];this.store.fetch({query:this.query,onComplete:m.hitch(this,function(b){this.root.children=b;if(a.length!=b.length||c.some(a,function(a,c){return b[c]!=a}))this.onChildrenChange(this.root,b)})})},onNewItem:function(a,b){this._requeryTop();this.inherited(arguments)},
onDeleteItem:function(a){-1!=c.indexOf(this.root.children,a)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(a,b,c,k){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),function(c,h,l,m,b,a,d,f,k,g,t){return h("dijit.tree._dndSelector",t,{constructor:function(){this.selection=
{};this.anchor=null;this.events.push(f(this.tree.domNode,k.press,m.hitch(this,"onMouseDown")),f(this.tree.domNode,k.release,m.hitch(this,"onMouseUp")),f(this.tree.domNode,k.move,m.hitch(this,"onMouseMove")),f(this.tree.domNode,g.press,m.hitch(this,"onClickPress")),f(this.tree.domNode,g.release,m.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b=this.selection,c;for(c in b)a.push(b[c]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);
this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));b&&(this.anchor=a);return a},removeTreeNode:function(b){var d=c.filter(this.getSelectedTreeNodes(),function(c){return!a.isDescendant(c.domNode,b.domNode)});this.setSelection(d);return b},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},setSelection:function(a){var b=this.getSelectedTreeNodes();c.forEach(this._setDifference(b,a),m.hitch(this,function(a){a.setSelected(!1);
this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));c.forEach(this._setDifference(a,b),m.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,b){c.forEach(b,function(a){a.__exclude__=!0});var d=c.filter(a,function(a){return!a.__exclude__});c.forEach(b,function(a){delete a.__exclude__});return d},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=[],d=[];c.forEach(a,function(a){var c=a.getTreePath();
d.push(a);b.push(c)},this);a=c.map(d,function(a){return a.item});this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",d);this.tree._set("selectedNode",d[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!this.current||!this.current.isExpandable||!this.tree.isExpandoNode(a.target,this.current)){"mousedown"==a.type&&d.isLeft(a)&&a.preventDefault();var c="keydown"==a.type?this.tree.focusedChild:this.current;
if(c){var f=b.getCopyKeyState(a),g=c.id;!this.singular&&!a.shiftKey&&this.selection[g]?this._doDeselect=!0:(this._doDeselect=!1,this.userSelect(c,f,a.shiftKey))}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,b.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-
b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(a);var d=doc.createRange();d.setStartBefore(b);return c.compareBoundaryPoints(c.END_TO_END,d)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");},userSelect:function(a,b,c){if(this.singular)this.anchor==a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(c&&
this.anchor){b=this._compareNodes(this.anchor.rowNode,a.rowNode);c=this.anchor;0>b?b=c:(b=a,a=c);for(c=[];b!=a;)c.push(b),b=this.tree._getNext(b);c.push(a);this.setSelection(c)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,b){b=b||l.global;for(var c in this.selection)a.call(b,this.getItem(c),c,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),
function(c,h,l,m,b,a){return h("dijit.tree._dndContainer",null,{constructor:function(d,f){this.tree=d;this.node=d.domNode;m.mixin(this,f);this.containerState="";l.add(this.node,"dojoDndContainer");this.events=[b(this.node,a.enter,m.hitch(this,"onOverEvent")),b(this.node,a.leave,m.hitch(this,"onOutEvent")),c.after(this.tree,"_onNodeMouseEnter",m.hitch(this,"onMouseOver"),!0),c.after(this.tree,"_onNodeMouseLeave",m.hitch(this,"onMouseOut"),!0),b(this.node,"dragstart, selectstart",function(a){a.preventDefault()})]},
destroy:function(){for(var a;a=this.events.pop();)a.remove();this.node=this.parent=null},onMouseOver:function(a){this.current=a},onMouseOut:function(){this.current=null},_changeState:function(a,b){var c="dojoDnd"+a,g=a.toLowerCase()+"State";l.replace(this.node,c+b,c+this[g]);this[g]=b},_addItemClass:function(a,b){l.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){l.remove(a,"dojoDndItem"+b)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container",
"")}})})},"widgets/Geocoder/utils":function(){define([],function(){return{hasAppSearchInfo:function(c){return c.itemInfo&&c.itemInfo.itemData&&c.itemInfo.itemData.applicationProperties&&c.itemInfo.itemData.applicationProperties.viewing&&c.itemInfo.itemData.applicationProperties.viewing.search},searchLayer:function(c){if(!this.hasAppSearchInfo(c))return!1;c=c.itemInfo.itemData.applicationProperties.viewing.search;return!c.enabled||0===c.layers.length?!1:!0},isConfigured:function(c){return c&&c.geocoder&&
c.geocoder.geocoders&&0<c.geocoder.geocoders.length}}})},"widgets/Geocoder/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/_BasicServiceChooser.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\x3ccolgroup\x3e\r\n\t\t  \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t  \x3ccol width\x3d"100px;"\x3e\x3c/col\x3e\r\n\t  \x3c/colgroup\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctd\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true,trim:true,disabled:true\' style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\t\x3ctd\x3e\r\n\t\t\t\t\x3cdiv class\x3d"jimu-btn set-source" data-dojo-attach-point\x3d"btnSetSource" data-dojo-attach-event\x3d"onclick:_onBtnSetSourceClick"\x3e${nls.set}\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/Geocoder/setting/Edit.html":'\x3cdiv\x3e\r\n  \x3ctable class\x3d"setting-table input-table" cellspacing\x3d"0"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e*${nls.url}\x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv class\x3d"service-chooser" data-dojo-attach-point\x3d"serviceChooser" /\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"example"\x3e\r\n        \x3ctd class\x3d"first"\x3e\x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cspan class\x3d"example"\x3e${nls.example}: http://\x26lt;myServerName\x26gt;/arcgis/rest/services/World/GeocodeServer\x3c/span\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e*${nls.name}\x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"geocodeName" \r\n          placeHolder\x3d"${nls.geocoderNamePlaceHolder}"\r\n          required\x3d"true" data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e${nls.placeholder}\x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"geocodePlaceholder" \r\n          placeHolder\x3d"${nls.geocodePlaceHolder}" data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:widgets/Geocoder/setting/Setting.html":'\x3cdiv style\x3d"width:100%;"\x3e\r\n  \x3cdiv class\x3d"instruction"\x3e\r\n    \x3cspan class\x3d"instruction-inner"\x3e${nls.instruction}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"add-geocoder" data-dojo-attach-point\x3d"addGeocoderNode" data-dojo-attach-event\x3d"onclick: onAddGeocoderClick"\x3e\r\n    \x3cspan class\x3d"add-geocoder-icon"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"add-geocoder-label"\x3e${nls.add}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"table geocoder-table" data-dojo-attach-point\x3d"tableGeocoders"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Geocoder/setting/css/style.css":".jimu-widget-geocoder-setting{width: 100%; height: 100%; margin:0; padding:0; font-size: 14px; color: #596679;}.jimu-geocoder-Edit .setting-table{width: 100%;}.jimu-geocoder-Edit .jimu-basic-service-chooser{width: 100%;}.jimu-geocoder-Edit .setting-table \x3e thead \x3e tr \x3e th,.jimu-geocoder-Edit .setting-table \x3e tbody \x3e tr \x3e td{height:40px; vertical-align:middle;}.jimu-geocoder-Edit .setting-table \x3e tbody \x3e tr.example \x3e td{height:20px; vertical-align:middle;}.jimu-geocoder-Edit{font-size: 14px;}.jimu-geocoder-Edit .input-table \x3e tbody \x3e tr \x3e .first{width:auto; text-align: right; padding-right:15px;}.jimu-geocoder-Edit .input-table \x3e tbody \x3e tr \x3e .second{width:450px;}.jimu-geocoder-Edit .input-table \x3e tbody \x3e tr \x3e .second .example{font-style: italic; font-size: 12px; color: #a0acbf; width: 100%; display: inline-block;}.jimu-widget-geocoder-setting .location-section,.jimu-widget-geocoder-setting .query-section{overflow: hidden;}.jimu-widget-geocoder-setting .disable-section{color: #a0acbf;}.jimu-widget-geocoder-setting .instruction,.jimu-widget-geocoder-setting .add-geocoder,.jimu-widget-geocoder-setting .table {padding-left: 19px;}.jimu-widget-geocoder-setting .add-geocoder{margin: 5px 0; cursor: pointer; display: inline-block;}.jimu-widget-geocoder-setting .geocoder-table {margin-bottom: 20px;}.jimu-widget-geocoder-setting .add-geocoder-icon{background-image: url(images/add_icon.png); background-repeat: no-repeat; background-position: center; width: 14px; height: 14px; display: inline-block; vertical-align: middle;}.jimu-widget-geocoder-setting .add-geocoder-label{font-size: 14px; color: #518dca; margin-left: 10px; display: inline-block; height: 100%; text-decoration: underline;}.jimu-widget-geocoder-setting .instruction a{color: #518dca;}.jimu-widget-geocoder-setting .query-instruction{margin-bottom: 5px;}",
"*now":function(c){c(['dojo/i18n!*preload*widgets/Geocoder/setting/nls/Setting*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/keys dojo/Deferred dojo/promise/all dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/dijit/SimpleTable jimu/dijit/LoadingShelter jimu/dijit/Message jimu/dijit/Popup ./Edit esri/request jimu/portalUtils ../utils dojo/NodeList-dom".split(" "),function(c,h,l,m,b,a,d,f,k,g,t,e,n,p,x,q,s,v){return c([g,k],{baseClass:"jimu-widget-geocoder-setting",defaultGeocodeUrl:"geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",
edit:null,popup:null,popupState:"",editTr:null,hardcodeRegExp:/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,startup:function(){this.inherited(arguments);this.config.geocoder||(this.config.geocoder={});this._createAddressTable();this.shelter=new e({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();this._preProcessConfig()},_createAddressTable:function(){this.addressGeocoderTable=new t({fields:[{name:"url",title:this.nls.url,type:"text",
editable:!1,hidden:!0,unique:!0},{name:"name",title:this.nls.name,type:"text",editable:!1,unique:!0},{name:"singleLineFieldName",title:this.nls.singleLineFieldName,type:"text",hidden:!0,editable:!1},{name:"placeholder",title:this.nls.placeholder,type:"text",editable:!1,hidden:!0},{name:"",title:"",width:"100px",type:"actions",actions:["edit","up","down","delete"]}],selectable:!1});this.addressGeocoderTable.placeAt(this.tableGeocoders);this.own(b(this.addressGeocoderTable,"actions-edit",h.hitch(this,
"_onEditClick")));this.own(b(this.addressGeocoderTable,"BeforeRowDelete",h.hitch(this,"_onDeleteClick")));this.addressGeocoderTable.startup()},setConfig:function(a){this.config=a;this.addressGeocoderTable.clear();if(a.geocoder.geocoders){for(var b=[],c=a.geocoder.geocoders.length,d=0;d<c;d++){var e=a.geocoder.geocoders[d];e.type||b.push({url:e.url,name:e.name,singleLineFieldName:e.singleLineFieldName,placeholder:e.placeholder})}this.addressGeocoderTable.addRows(b)}},_preProcessConfig:function(){v.isConfigured(this.config)?
(this.setConfig(this.config),this.shelter.hide()):this._processConfigInfo(this.appConfig.portalUrl)},onAddGeocoderClick:function(){this.popupState="ADD";this._openEdit(this.nls.add,{})},_onEditClick:function(a){var b=this.addressGeocoderTable.getRowData(a);this.popupState="EDIT";this.editTr=a;this._openEdit(this.nls.edit,b)},_onDeleteClick:function(){return 1===this.addressGeocoderTable.getData().length?(new n({message:this.nls.deleteLastGeocoderError}),!1):!0},_openEdit:function(b,c){this.edit=new x({nls:this.nls,
config:c||{}});this.popup=new p({titleLabel:b,autoHeight:!0,content:this.edit,container:"main-page",width:640,height:300,buttons:[{label:this.nls.ok,key:a.ENTER,disable:!0,onClick:h.hitch(this,"_onEditOk")},{label:this.nls.cancel,key:a.ESCAPE}],onClose:h.hitch(this,"_onEditClose")});m.addClass(this.popup.domNode,"widget-setting-popup");this.edit.startup()},_getGeocodeName:function(a){if("string"!==typeof a)return"geocoder";a=a.split("/");return a[a.length-2]||"geocoder"},_getSingleLine:function(a){var b=
new d;a.singleLineFieldName?b.resolve(a):this.hardcodeRegExp.test(a.url)?(a.singleLineFieldName="SingleLine",b.resolve(a)):q({url:a.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(h.hitch(this,function(c){c.singleLineAddressField&&c.singleLineAddressField.name?(a.singleLineFieldName=c.singleLineAddressField.name,b.resolve(a)):(console.warn(a.url+"has no singleLineFieldName"),b.resolve(null))}),h.hitch(this,function(a){console.error(a);b.resolve(null)}));return b},_processConfigInfo:function(a){s.getPortalSelfInfo(a).then(h.hitch(this,
function(a){a=a.helperServices&&a.helperServices.geocode;var b=[];if(a&&0<a.length){for(var c=0,d=a.length;c<d;c++){var e=a[c];e&&b.push(this._getSingleLine(e))}f(b).then(h.hitch(this,function(a){for(var b=0;b<a.length;b++){var c=a[b];c&&(c={name:c.name||this._getGeocodeName(c.url),url:c.url,singleLineFieldName:c.singleLineFieldName,placeholder:c.placeholder||c.name||this._getGeocodeName(c.url)},this.addressGeocoderTable.addRow(c))}this.shelter.hide()}))}}),h.hitch(this,function(a){this.shelter.hide();
new n({message:this.nls.portalConnectionError});console.error(a)}))},_onEditOk:function(){var a=this.edit.getConfig(),b=null;!a.url||!a.name||!a.singleLineFieldName?new n({message:this.nls.warning}):("ADD"===this.popupState?b=this.addressGeocoderTable.addRow(a):"EDIT"===this.popupState&&(b=this.addressGeocoderTable.editRow(this.editTr,a)),b.success?(this.popup.close(),this.popupState="",this.editTr=null):(a=l.map(b.repeatFields,h.hitch(this,function(a){return a&&a.title})),new n({message:this.nls[b.errorCode]+
a.toString()})))},_onEditClose:function(){this.popup=this.edit=null},getConfig:function(){for(var a=this.addressGeocoderTable.getData(),b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);this.config.geocoder.arcgisGeocoder=0<b.length?!1:{placeholder:"Find address or place"};this.config.geocoder.geocoders=b;return this.config}})});