//>>built
require({cache:{"esri/dijit/Geocoder":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/event dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/keys dojo/on dojo/query dojo/i18n!../nls/jsapi dojo/text!./templates/Geocoder.html dojo/uacss dijit/a11yclick dijit/_TemplatedMixin dijit/focus ../kernel ../SpatialReference ../graphic ../symbols/PictureMarkerSymbol ./_EventedWidget ../geometry/Point ../geometry/Extent ../tasks/locator ../tasks/query ../tasks/QueryTask ../geometry/scaleUtils".split(" "),
function(h,w,k,t,s,p,f,v,x,l,u,b,y,B,D,q,C,r,a,n,m,g,e,z,A,E,F,G,H){return w("esri.dijit.Geocoder",[e,C],{templateString:B,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,_eventMap:{select:["result"],"find-results":["results"],"auto-complete":["results"],"geocoder-select":["geocoder"],clear:!0,"enter-key-select":!0,load:!0},constructor:function(c,d){this._css={GeocoderContainerClass:"esriGeocoderContainer",GeocoderClass:"esriGeocoder",GeocoderMultipleClass:"esriGeocoderMultiple",GeocoderIconClass:"esriGeocoderIcon",
GeocoderActiveClass:"esriGeocoderActive",GeocoderResultsOpenClass:"esriGeocoderResultsOpen",GeocoderMenuOpenClass:"esriGeocoderMenuOpen",loadingClass:"esriGeocoderLoading",resultsContainerClass:"esriGeocoderResults",resultsItemClass:"esriGeocoderResult",resultsItemEvenClass:"esriGeocoderResultEven",resultsItemOddClass:"esriGeocoderResultOdd",resultsItemFirstClass:"esriGeocoderResultFirst",resultsItemLastClass:"esriGeocoderResultLast",resultsPartialMatchClass:"esriGeocoderResultPartial",searchButtonClass:"esriGeocoderSearch",
clearButtonClass:"esriGeocoderReset",hasValueClass:"esriGeocoderHasValue",geocoderMenuClass:"esriGeocoderMenu",geocoderMenuHeaderClass:"esriGeocoderMenuHeader",geocoderMenuCloseClass:"esriGeocoderMenuClose",activeMenuClass:"esriGeocoderMenuActive",geocoderMenuArrowClass:"esriGeocoderMenuArrow",geocoderSelectedClass:"esriGeocoderSelected",geocoderSelectedCheckClass:"esriGeocoderSelectedCheck",GeocoderClearClass:"esriGeocoderClearFloat"};this.options={autoComplete:!1,arcgisGeocoder:!0,value:"",theme:"simpleGeocoder",
activeGeocoderIndex:0,maxLocations:6,minCharacters:3,searchDelay:300,geocoderMenu:!0,autoNavigate:!0,showResults:!0,map:null,activeGeocoder:null,geocoders:null,zoomScale:1E4,highlightLocation:!1,symbol:new g(h.toUrl(".")+"/images/sdk_gps_location.png",28,28),graphicsLayer:null};var a=k.mixin({},this.options,c);this.set("autoComplete",a.autoComplete);this.set("arcgisGeocoder",a.arcgisGeocoder);this.set("value",a.value);this.set("theme",a.theme);this.set("activeGeocoderIndex",a.activeGeocoderIndex);
this.set("maxLocations",a.maxLocations);this.set("minCharacters",a.minCharacters);this.set("searchDelay",a.searchDelay);this.set("geocoderMenu",a.geocoderMenu);this.set("autoNavigate",a.autoNavigate);this.set("showResults",a.showResults);this.set("map",a.map);this.set("activeGeocoder",a.activeGeocoder);this.set("geocoders",a.geocoders);this.set("zoomScale",a.zoomScale);this.set("highlightLocation",a.highlightLocation);this.set("symbol",a.symbol);this.set("graphicsLayer",a.graphicsLayer);this.set("results",
[]);this._i18n=y;this._deferreds=[];this._defaultSR=new n(4326);this.watch("value",this._updateValue);this.watch("theme",this._updateTheme);this.watch("activeGeocoder",this._setActiveGeocoder);this.watch("activeGeocoderIndex",this._setActiveGeocoderIndex);this.watch("geocoders",this._updateGeocoder);this.watch("arcgisGeocoder",this._updateGeocoder);this.watch("geocoderMenu",this._updateGeocoder);this.watch("map",this._setupEvents);this.domNode=d},startup:function(){if(this._geocoders.length)if(this.domNode)if(this.get("map"))if(this.get("map").loaded)this._init();
else u.once(this.get("map"),"load",k.hitch(this,function(){this._init()}));else this._init();else console.log("Geocoder:: domNode is undefined."),this.destroy();else console.log("Geocoder:: No geocoders defined."),this.destroy()},postCreate:function(){this.inherited(arguments);this.own(u(this.submitNode,q,k.hitch(this,this._findThenSelect)));this.own(u(this.geocoderMenuArrowNode,q,k.hitch(this,this._toggleGeolocatorMenu)));this.own(u(this.inputNode,q,k.hitch(this,this._inputClick)));this.own(u(this.clearNode,
q,k.hitch(this,this.clear)));this.own(u(this.geocoderMenuCloseNode,q,k.hitch(this,this._hideGeolocatorMenu)));this._updateGeocoder();this._setupEvents();this.get("value")&&this._checkStatus();this._hideMenus()},destroy:function(){this._removeEvents();x.empty(this.domNode);this.inherited(arguments)},clear:function(){this.onClear();var c=this.get("highlightGraphic"),d=this.get("graphicsLayer");c&&(d?d.remove(c):this.get("map").graphics.remove(c),this.set("highlightGraphic",null));p.set(this.inputNode,
"value","");this.set("value","");this.set("results",[]);f.remove(this.containerNode,this._css.hasValueClass);p.set(this.clearNode,"title","");this._hideMenus();this._hideLoading()},show:function(){v.set(this.domNode,"display","block")},hide:function(){v.set(this.domNode,"display","none")},find:function(c){var d=new t;if(c)if("string"===typeof c)this._findQuery(c).then(function(c){d.resolve(c)});else if("object"===typeof c&&c.hasOwnProperty("geometry")){var a;switch(c.geometry.type){case "extent":a=
c.geometry.getCenter();break;case "multipoint":a=c.geometry.getExtent().getCenter();break;case "point":a=c.geometry;break;case "polygon":a=c.geometry.getExtent().getCenter();break;case "polyline":a=c.geometry.getExtent().getCenter()}a&&this._reverseGeocodePoint(a,c.geometry).then(function(a){a.results[0]&&(c.hasOwnProperty("attributes")&&a.results[0].feature.setAttributes(k.mixin(a.results[0].feature.attributes,c.attributes)),c.hasOwnProperty("infoTemplate")&&a.results[0].feature.setInfoTemplate(c.infoTemplate),
c.hasOwnProperty("symbol")&&a.results[0].feature.setSymbol(c.symbol));d.resolve(a)},function(c){d.reject(c)})}else"object"===typeof c&&"point"===c.type?this._reverseGeocodePoint(c).then(function(c){d.resolve(c)},function(c){d.reject(c)}):c instanceof Array&&2===c.length?(a=new z(c,new n({wkid:4326})),this._reverseGeocodePoint(a).then(function(c){d.resolve(c)},function(c){d.reject(c)})):d.reject("Geocoder:: Invalid find type");else this._findQuery(this.get("value")).then(function(c){d.resolve(c)});
return d.promise},focus:function(){r.focus(this.inputNode)},blur:function(){r.curNode&&r.curNode.blur();this.inputNode.blur();this._hideMenus();var c=this.get("map");c&&c.enableKeyboardNavigation()},select:function(c){this.onSelect(c);this._hideMenus();this._hideLoading();this.get("autoNavigate")&&(c&&c.hasOwnProperty("extent")&&this.get("map"))&&this.get("map").setExtent(c.extent);if(c.feature){var d=this.get("highlightGraphic"),a=this.get("graphicsLayer"),b=this.get("symbol")||c.feature.symbol;
d?(d.setGeometry(c.feature.geometry),d.setAttributes(c.feature.attributes),d.setInfoTemplate(c.feature.infoTemplate),d.setSymbol(b)):(d=c.feature,this.get("highlightLocation")&&(d.setSymbol(b),a?a.add(d):this.get("map").graphics.add(d)));this.set("highlightGraphic",d)}},onSelect:function(){},onFindResults:function(){},onAutoComplete:function(){},onGeocoderSelect:function(){},onClear:function(){},onEnterKeySelect:function(){},onLoad:function(){},_autoComplete:function(){var c=this.get("activeGeocoder"),
d=this.reHostedFS.test(c.url);("query"!==c.type||d)&&this._query({delay:this.get("searchDelay"),autoComplete:!0,search:this.get("value")}).then(k.hitch(this,function(c){this.onAutoComplete(c);this.get("showResults")&&this._showResults(c)}))},_init:function(){this.set("loaded",!0);this.onLoad()},_containsNonLatinCharacter:function(c){for(var d=0;d<c.length;d++)if(255<c.charCodeAt(d))return!0;return!1},_findQuery:function(c){var d=new t;this._query({delay:0,search:c}).then(k.hitch(this,function(c){this.onFindResults(c);
d.resolve(c)}),k.hitch(this,function(c){this.onFindResults(c);d.reject(c)}));return d.promise},_reverseGeocodePoint:function(c,d){var a=new t;if(c&&this.get("activeGeocoder")){var b=d||c,m=this.get("activeGeocoder").distance||1500;this._task.outSpatialReference=this._defaultSR;this.get("map")&&(this._task.outSpatialReference=this.get("map").spatialReference);this._task.locationToAddress(c,m,k.hitch(this,function(c){c={results:[this._hydrateResult(c)],geometry:b};this.onFindResults(c);a.resolve(c)}),
k.hitch(this,function(c){a.reject(c)}))}else a.reject("Geocoder:: no point or active geocoder defined");return a.promise},_setEsriGeocoder:function(){this.get("arcgisGeocoder")?("object"===typeof this.get("arcgisGeocoder")?this._arcgisGeocoder=this.get("arcgisGeocoder"):this._arcgisGeocoder={},this._arcgisGeocoder.hasOwnProperty("suggest")||(this._arcgisGeocoder.suggest=!0),this._arcgisGeocoder.hasOwnProperty("singleLineFieldName")||(this._arcgisGeocoder.singleLineFieldName="SingleLine"),this._arcgisGeocoder.url||
(this._arcgisGeocoder.url=("file:"===location.protocol?"http:":location.protocol)+"//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),this._arcgisGeocoder.name||(this._arcgisGeocoder.name=y.widgets.Geocoder.esriGeocoderName),this._arcgisGeocoder.hasOwnProperty("localSearchOptions")||(this._arcgisGeocoder.localSearchOptions={minScale:3E5,distance:5E4}),this.set("arcgisGeocoder",this._arcgisGeocoder)):this.set("arcgisGeocoder",!1)},_setActiveGeocoder:function(){this.set("activeGeocoder",
this._geocoders[this.get("activeGeocoderIndex")]);this._task="query"===this.activeGeocoder.type?new G(this.get("activeGeocoder").url):new E(this.get("activeGeocoder").url);this._updatePlaceholder()},_setGeocoderList:function(){var c=[];this.get("arcgisGeocoder")&&(c=c.concat([this._arcgisGeocoder]));this.get("geocoders")&&this.get("geocoders").length&&(c=c.concat(this.get("geocoders")));this._geocoders=c},_updateGeocoder:function(){this.set("activeGeocoderIndex",0);this._setEsriGeocoder();this._setGeocoderList();
this._setActiveGeocoder();this._insertGeocoderMenuItems()},_updatePlaceholder:function(){this._placeholder="";this.get("activeGeocoder")&&this.get("activeGeocoder").placeholder&&(this._placeholder=this.get("activeGeocoder").placeholder);p.set(this.inputNode,"placeholder",this._placeholder);p.set(this.submitNode,"title",this._placeholder)},_updateValue:function(c,d,a){this._ignoreUpdateValue||(p.set(this.inputNode,"value",a),this._checkStatus())},_updateTheme:function(c,d,a){f.remove(this.domNode,
d);f.add(this.domNode,a)},_setActiveGeocoderIndex:function(c,d,a){this.set("activeGeocoderIndex",a);this._setActiveGeocoder();this._hideMenus();this._insertGeocoderMenuItems();c={attr:this.get("activeGeocoder"),oldVal:d,newVal:a};this.onGeocoderSelect(c)},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_query:function(c){c||(c={delay:0});c.search||(c.search=this.get("value"));var d=new t;this._deferreds.push(d);c.delay?(this._clearQueryTimeout(),this._queryTimer=setTimeout(k.hitch(this,
function(){this._performTask(d,c)}),c.delay)):this._performTask(d,c);return d.promise},_performTask:function(c,d){if(d.search){this._hideGeolocatorMenu();this._showLoading();var a="";this.get("activeGeocoder").prefix&&(a+=this.get("activeGeocoder").prefix);a+=d.search;this.get("activeGeocoder").suffix&&(a+=this.get("activeGeocoder").suffix);var b=this.get("activeGeocoder").outFields;b&&(b instanceof Array||(b=[b]));var m=this.get("maxLocations")||6,n=this.get("activeGeocoder").searchExtent,g=this._defaultSR;
this.get("map")&&(g=this.get("map").spatialReference);if("query"===this.get("activeGeocoder").type){var e=new F;e.outSpatialReference=g;e.returnGeometry=!0;e.num=m;n&&(e.geometry=n);m=this.get("activeGeocoder").exactMatch;n=this.get("activeGeocoder").field;g="";this.reHostedFS.test(this.get("activeGeocoder").url)&&this._containsNonLatinCharacter(a)&&(g="N");e.where=m?n+" \x3d "+g+"'"+a+"'":"UPPER("+n+") LIKE "+g+"'%"+a.toUpperCase()+"%'";b&&(e.outFields=b);this._task.execute(e,k.hitch(this,function(a){this._receivedResults(a.features,
c,d)}),k.hitch(this,function(a){this._receivedResults([],c,d)}))}else{e={};this.get("activeGeocoder").categories&&(e.categories=this.get("activeGeocoder").categories);this._task.outSpatialReference=g;if(this.get("map")&&(this.get("activeGeocoder").localSearchOptions&&this.get("activeGeocoder").localSearchOptions.hasOwnProperty("distance")&&this.get("activeGeocoder").localSearchOptions.hasOwnProperty("minScale"))&&(g=this.get("map").getScale(),!this.get("activeGeocoder").localSearchOptions.minScale||
g&&g<=parseFloat(this.get("activeGeocoder").localSearchOptions.minScale)))e.location=this.get("map").extent.getCenter(),e.distance=this.get("activeGeocoder").localSearchOptions.distance;this.get("activeGeocoder").suggest&&d.autoComplete?(e.text=a,n&&(e.searchExtent=n),this._task.suggestLocations(e).then(k.hitch(this,function(a){this._receivedResults(a,c,d)}),k.hitch(this,function(a){this._receivedResults(a,c,d)}))):(e.address={},e.maxLocations=m,n&&(e.searchExtent=n),this.get("activeGeocoder").sourceCountry&&
(e.countryCode=this.get("activeGeocoder").sourceCountry),d.magicKey&&(e.magicKey=d.magicKey),this.get("activeGeocoder").singleLineFieldName?e.address[this.get("activeGeocoder").singleLineFieldName]=a:e.address["Single Line Input"]=a,b&&(e.outFields=b),this._task.addressToLocations(e,k.hitch(this,function(a){this._receivedResults(a,c,d)}),k.hitch(this,function(a){this._receivedResults(a,c,d)})))}}else this._hideLoading(),c.reject("Geocoder:: no search to perform");(a=this.get("map"))&&a.enableKeyboardNavigation()},
_showResults:function(){this._hideGeolocatorMenu();var c="";if(this.get("results")&&this.get("results").length&&this.resultsNode){for(var a=this.get("value"),b=RegExp("("+a+")","gi"),c=c+'\x3cul role\x3d"presentation"\x3e',a=0;a<this.get("results").length&&5>a;++a){var e=this.get("results")[a].text||this.get("results")[a].name,n=this._css.resultsItemClass+" ",n=0===a%2?n+this._css.resultsItemOddClass:n+this._css.resultsItemEvenClass;0===a?n+=" "+this._css.resultsItemFirstClass:a===this.get("results").length-
1&&(n+=" "+this._css.resultsItemLastClass);c+='\x3cli title\x3d"'+e+'" data-text\x3d"'+e+'" data-item\x3d"true" data-index\x3d"'+a+'" role\x3d"menuitem" tabindex\x3d"0" class\x3d"'+n+'"\x3e'+e.replace(b,'\x3cstrong class\x3d"'+this._css.resultsPartialMatchClass+'"\x3e$1\x3c/strong\x3e')+"\x3c/li\x3e"}c+="\x3c/ul\x3e";this.resultsNode&&(this.resultsNode.innerHTML=c);this._autoCompleteEvent();this._showResultsMenu()}else this.resultsNode&&(this.resultsNode.innerHTML=c),this._hideResultsMenu()},_receivedResults:function(c,
a){this._hideLoading();var b=this._hydrateResults(c);this.set("results",b);b={results:b,value:this.get("value")};a.resolve(b)},_showLoading:function(){f.add(this.containerNode,this._css.loadingClass)},_hideLoading:function(){f.remove(this.containerNode,this._css.loadingClass)},_showGeolocatorMenu:function(){f.add(this.containerNode,this._css.activeMenuClass);f.add(this.domNode,this._css.GeocoderMenuOpenClass);v.set(this.geocoderMenuNode,"display","block");p.set(this.geocoderMenuInsertNode,"aria-hidden",
"false");p.set(this.geocoderMenuArrowNode,"aria-expanded","true")},_hideGeolocatorMenu:function(){f.remove(this.containerNode,this._css.activeMenuClass);f.remove(this.domNode,this._css.GeocoderMenuOpenClass);v.set(this.geocoderMenuNode,"display","none");p.set(this.geocoderMenuInsertNode,"aria-hidden","true");p.set(this.geocoderMenuArrowNode,"aria-expanded","false")},_toggleGeolocatorMenu:function(){this._hideResultsMenu();"block"===v.get(this.geocoderMenuNode,"display")?this._hideGeolocatorMenu():
this._showGeolocatorMenu()},_showResultsMenu:function(){f.add(this.containerNode,this._css.GeocoderActiveClass);f.add(this.domNode,this._css.GeocoderResultsOpenClass);v.set(this.resultsNode,"display","block");p.set(this.resultsNode,"aria-hidden","false")},_hideResultsMenu:function(){v.set(this.resultsNode,"display","none");f.remove(this.containerNode,this._css.GeocoderActiveClass);f.remove(this.domNode,this._css.GeocoderResultsOpenClass);p.set(this.resultsNode,"aria-hidden","true")},_hideMenus:function(){this._hideGeolocatorMenu();
this._hideResultsMenu()},_insertGeocoderMenuItems:function(){if(this.get("geocoderMenu")&&this._geocoders&&1<this._geocoders.length){var c,a="",b;c='\x3cul role\x3d"presentation"\x3e';for(b=0;b<this._geocoders.length;b++){a=this._css.resultsItemClass+" ";a=0===b%2?a+this._css.resultsItemOddClass:a+this._css.resultsItemEvenClass;b===this.get("activeGeocoderIndex")&&(a+=" "+this._css.geocoderSelectedClass);0===b?a+=" "+this._css.resultsItemFirstClass:b===this._geocoders.length-1&&(a+=" "+this._css.resultsItemLastClass);
var n=this._geocoders[b].name||y.widgets.Geocoder.main.untitledGeocoder;c+='\x3cli data-index\x3d"'+b+'" data-item\x3d"true" role\x3d"menuitem" tabindex\x3d"0" class\x3d"'+a+'"\x3e';c+='\x3cdiv class\x3d"'+this._css.geocoderSelectedCheckClass+'"\x3e\x3c/div\x3e';c+=n;c+='\x3cdiv class\x3d"'+this._css.GeocoderClearClass+'"\x3e\x3c/div\x3e';c+="\x3c/li\x3e"}this.geocoderMenuInsertNode.innerHTML=c+"\x3c/ul\x3e";this._geocoderMenuEvent();v.set(this.geocoderMenuNode,"display","none");v.set(this.geocoderMenuArrowNode,
"display","block");f.add(this.containerNode,this._css.GeocoderMultipleClass)}else this.geocoderMenuInsertNode.innerHTML="",v.set(this.geocoderMenuNode,"display","none"),v.set(this.geocoderMenuArrowNode,"display","none"),f.remove(this.containerNode,this._css.GeocoderMultipleClass)},_checkStatus:function(){this.get("value")?(f.add(this.containerNode,this._css.hasValueClass),p.set(this.clearNode,"title",y.widgets.Geocoder.main.clearButtonTitle)):this.clear()},_autoCompleteEvent:function(){var c=b('[data-item\x3d"true"]',
this.resultsNode);this._acEvent&&this._acEvent.remove();this._acEvent=u(c,"click, keydown",k.hitch(this,function(a){this._clearQueryTimeout();var b=parseInt(p.get(a.currentTarget,"data-index"),10),n=p.get(a.currentTarget,"data-text");"click"===a.type||"keydown"===a.type&&a.keyCode===l.ENTER?(p.set(this.inputNode,"value",n),this.set("value",n),this.get("results")&&this.get("results")[b]&&(a=this.get("results")[b],a.name?this.select(a):this._query({delay:0,search:a.text,magicKey:a.magicKey||null}).then(k.hitch(this,
function(c){this.select(c.results[0])})))):"keydown"===a.type&&(a.keyCode===l.BACKSPACE||a.keyCode===l.DELETE)?(s.stop(a),this.inputNode.focus(),a=this.inputNode.value.slice(0,-1),p.set(this.inputNode,"value",a),this.set("value",a)):"keydown"===a.type&&a.keyCode===l.UP_ARROW?(s.stop(a),a=b-1,0>a?this.inputNode.focus():c[a].focus()):"keydown"===a.type&&a.keyCode===l.DOWN_ARROW?(s.stop(a),a=b+1,a>=c.length?this.inputNode.focus():c[a].focus()):a.keyCode===l.ESCAPE&&this._hideMenus()}))},_geocoderMenuEvent:function(){var c=
b('[data-item\x3d"true"]',this.geocoderMenuInsertNode);this._gmEvent&&this._gmEvent.remove();this._gmEvent=u(c,"click, keydown",k.hitch(this,function(a){var b=parseInt(p.get(a.currentTarget,"data-index"),10);"click"===a.type||"keydown"===a.type&&a.keyCode===l.ENTER?(this._setActiveGeocoderIndex(null,null,b),this._hideGeolocatorMenu()):"keydown"===a.type&&a.keyCode===l.UP_ARROW?(s.stop(a),a=b-1,0>a?this.geocoderMenuArrowNode.focus():c[a].focus()):"keydown"===a.type&&a.keyCode===l.DOWN_ARROW?(s.stop(a),
a=b+1,a>=c.length?this.geocoderMenuArrowNode.focus():c[a].focus()):a.keyCode===l.ESCAPE&&this._hideGeolocatorMenu()}))},_removeEvents:function(){var a;if(this._events&&this._events.length)for(a=0;a<this._events.length;a++)this._events[a].remove();this._acEvent&&this._acEvent.remove();this._gmEvent&&this._gmEvent.remove();this._events=[]},_setupEvents:function(){this._removeEvents();var a=u(document,"click",k.hitch(this,function(a){this._hideResultsMenu(a)}));this._events.push(a);a=u(this.inputNode,
"keyup",k.hitch(this,function(a){this._inputKeyUp(a)}));this._events.push(a);a=u(this.inputNode,"keydown",k.hitch(this,function(a){this._inputKeyDown(a)}));this._events.push(a);a=u(this.geocoderMenuArrowNode,"keydown",this._geocoderMenuButtonKeyDown());this._events.push(a);this.get("map")&&(a=u(this.get("map"),"mouse-down",k.hitch(this,function(){this.blur()})),this._events.push(a));this._geocoderMenuEvent();this._autoCompleteEvent()},_findThenSelect:function(){this.find().then(k.hitch(this,function(a){a.results&&
a.results.length&&(this.select(a.results[0]),this.onEnterKeySelect())}))},_inputKeyUp:function(a){if(a){this._clearQueryTimeout();var d=this.inputNode.value;this._ignoreUpdateValue=!0;this.set("value",d);this._ignoreUpdateValue=!1;var b=0;d&&(b=d.length);if(a.ctrlKey||a.metaKey||a.altKey||a.keyCode===l.copyKey||a.keyCode===l.ALT||a.keyCode===l.CTRL||a.keyCode===l.META||a.keyCode===l.SHIFT||a.keyCode===l.UP_ARROW||a.keyCode===l.DOWN_ARROW||a.keyCode===l.LEFT_ARROW||a.keyCode===l.RIGHT_ARROW)return a;
a&&a.keyCode===l.ENTER?(this._cancelDeferreds(),this._findThenSelect()):a&&a.keyCode===l.ESCAPE?(this._cancelDeferreds(),this._hideMenus()):a&&a.keyCode===l.TAB?(this._cancelDeferreds(),this._hideMenus()):this.get("autoComplete")&&b>=this.get("minCharacters")?this._autoComplete():this._hideMenus();this._checkStatus()}},_cancelDeferreds:function(){if(this._deferreds.length){for(var a=0;a<this._deferreds.length;a++)this._deferreds[a].cancel("Geocoder:: stop query");this._deferreds=[]}},_inputKeyDown:function(a){var d=
b('[data-item\x3d"true"]',this.resultsNode);a&&a.keyCode===l.TAB?(this._cancelDeferreds(),this._hideMenus()):a&&a.keyCode===l.UP_ARROW?(s.stop(a),(a=d.length)&&d[a-1].focus()):a&&a.keyCode===l.DOWN_ARROW&&(s.stop(a),d[0]&&d[0].focus())},_geocoderMenuButtonKeyDown:function(a){var d=b('[data-item\x3d"true"]',this.geocoderMenuInsertNode);a&&a.keyCode===l.UP_ARROW?(s.stop(a),this._showGeolocatorMenu(),(a=d.length)&&d[a-1].focus()):a&&a.keyCode===l.DOWN_ARROW&&(s.stop(a),this._showGeolocatorMenu(),d[0]&&
d[0].focus())},_inputClick:function(){this._hideGeolocatorMenu();var a=this.get("map");a&&a.disableKeyboardNavigation()},_hydrateResult:function(a){var d={},b=this._defaultSR,e;this.get("map")&&(b=this.get("map").spatialReference);if(a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;if(a.hasOwnProperty("feature"))d.feature=new m(a.feature),(e=d.feature.geometry)&&e.setSpatialReference(b);else if(a.hasOwnProperty("geometry")){var g=a.symbol||null;e=a.attributes||{};d.feature=new m(a.geometry,
g,e,a.infoTemplate||null);(e=d.feature.geometry)&&e.setSpatialReference(b)}else a.hasOwnProperty("location")?(g=new z(a.location.x,a.location.y,b),e={},a.hasOwnProperty("attributes")&&(e=a.attributes),a.hasOwnProperty("score")&&(e.score=a.score),d.feature=new m(g,null,e,null)):d.feature=null;if(a.hasOwnProperty("extent"))d.extent=new A(a.extent),d.extent.setSpatialReference(new n(b));else if(d.feature&&d.feature.geometry)switch(d.feature.geometry.type){case "extent":d.extent=d.feature.geometry;break;
case "multipoint":d.extent=d.feature.geometry.getExtent();break;case "polygon":d.extent=d.feature.geometry.getExtent();break;case "polyline":d.extent=d.feature.geometry.getExtent();break;case "point":this.get("map")?this.get("map").getScale()>this.get("zoomScale")?d.extent=H.getExtentForScale(this.get("map"),this.get("zoomScale")).centerAt(d.feature.geometry):d.extent=this.get("map").extent.centerAt(d.feature.geometry):d.extent=new A({xmin:d.feature.geometry.x-0.25,ymin:d.feature.geometry.y-0.25,
xmax:d.feature.geometry.x+0.25,ymax:d.feature.geometry.y+0.25,spatialReference:{wkid:4326}})}else d.extent=null;a.hasOwnProperty("name")?d.name=a.name:"query"===this.activeGeocoder.type&&this.activeGeocoder.field&&a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty(this.activeGeocoder.field)?d.name=a.attributes[this.activeGeocoder.field]:a.hasOwnProperty("Match_addr")&&"string"===typeof a.Match_addr?d.name=a.Match_addr:a.hasOwnProperty("address")&&"object"===typeof a.address&&a.address.hasOwnProperty("Match_addr")?
d.name=a.address.Match_addr:a.hasOwnProperty("address")&&"string"===typeof a.address?d.name=a.address:a.hasOwnProperty("address")&&"object"===typeof a.address&&a.address.hasOwnProperty("Address")?d.name=a.address.Address:d.name=d.feature&&d.feature.geometry?d.feature.geometry.x+","+d.feature.geometry.y:"";return d},_hydrateResults:function(a){var d=[],b=0;if(a&&a.length)for(b;b<a.length;b++){var e=this._hydrateResult(a[b]);d.push(e)}return d}})})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),
function(h,w,k,t,s,p,f,v,x,l,u){return h(l,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},constructor:function(b){this._geocodeHandler=w.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=w.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=w.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},
outSpatialReference:null,setOutSpatialReference:function(b){this.outSpatialReference=b},_geocodeHandler:function(b,f,k,l,q){try{var h=b.candidates,r;f=[];var a,n=h.length,m=b.spatialReference,g;for(a=0;a<n;a++){r=h[a];if(g=r.location)g.spatialReference=m;f[a]=new u(r)}this._successHandler([f],"onAddressToLocationsComplete",k,q)}catch(e){this._errorHandler(e,l,q)}},_geocodeAddressesHandler:function(b,f,k,l,q){try{var h=b.locations;f=[];var r,a=h.length,n=b.spatialReference,m;for(r=0;r<a;r++){if(m=
h[r].location)m.spatialReference=n;f[r]=new u(h[r])}this._successHandler([f],"onAddressesToLocationsComplete",k,q)}catch(g){this._errorHandler(g,l,q)}},addressToLocations:function(b,f,k,l,q){var h,r,a,n,m,g,e;b.address&&(l=k,k=f,f=b.outFields,q=b.searchExtent,e=b.countryCode,h=b.magicKey,r=b.distance,g=b.categories,b.location&&this.normalization&&(a=b.location.normalize()),n=b.maxLocations,m=b.forStorage,b=b.address);q&&(q=q.shiftCentralMeridian());var z=this.outSpatialReference;b=this._encode(w.mixin({},
this._url.query,b,{f:"json",outSR:z&&s.toJson(z.toJson()),outFields:f&&f.join(",")||null,searchExtent:q&&s.toJson(q.toJson()),category:g&&g.join(",")||null,countryCode:e||null,magicKey:h||null,distance:r||null,location:a||null,maxLocations:n||null,forStorage:m||null}));var A=this._geocodeHandler,p=this._errorHandler,u=new t(x._dfdCanceller);u._pendingDfd=v({url:this._url.path+"/findAddressCandidates",content:b,callbackParamName:"callback",load:function(a,b){A(a,b,k,l,u)},error:function(a){p(a,l,u)}});
return u},suggestLocations:function(b){var f;f=new t;b.hasOwnProperty("location")&&this.normalization&&(b.location=b.location.normalize());b.searchExtent&&(b.searchExtent=b.searchExtent.shiftCentralMeridian());b=this._encode(w.mixin({},this._url.query,{f:"json",text:b.text,searchExtent:b.searchExtent&&s.toJson(b.searchExtent.toJson()),category:b.categories&&b.categories.join(",")||null,location:b.location||null,distance:b.distance||null},{f:"json"}));v({url:this._url.path+"/suggest",content:b,callbackParamName:"callback"}).then(w.hitch(this,
function(b){b=b.suggestions||[];this.onSuggestLocationsComplete(b);f.resolve(b)}),w.hitch(this,function(b){this._errorHandler(b);f.reject(b)}));return f},addressesToLocations:function(b,f,l){var h=this.outSpatialReference,q=[];k.forEach(b.addresses,function(a,b){q.push({attributes:a})});b=this._encode(w.mixin({},this._url.query,{addresses:s.toJson({records:q})},{f:"json",outSR:h&&s.toJson(h.toJson())}));var p=this._geocodeAddressesHandler,r=this._errorHandler,a=new t(x._dfdCanceller);a._pendingDfd=
v({url:this._url.path+"/geocodeAddresses",content:b,callbackParamName:"callback",load:function(b,m){p(b,m,f,l,a)},error:function(b){r(b,l,a)}});return a},_reverseGeocodeHandler:function(b,f,l,k,h){try{var p=new u({address:b.address,location:b.location,score:100});this._successHandler([p],"onLocationToAddressComplete",l,h)}catch(r){this._errorHandler(r,k,h)}},locationToAddress:function(b,f,l,k){b&&this.normalization&&(b=b.normalize());var h=this.outSpatialReference;b=this._encode(w.mixin({},this._url.query,
{outSR:h&&s.toJson(h.toJson()),location:b&&s.toJson(b.toJson()),distance:f,f:"json"}));var p=this._reverseGeocodeHandler,r=this._errorHandler,a=new t(x._dfdCanceller);a._pendingDfd=v({url:this._url.path+"/reverseGeocode",content:b,callbackParamName:"callback",load:function(b,m){p(b,m,l,k,a)},error:function(b){r(b,k,a)}});return a},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}})})},
"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(h,w,k,t,s){return h(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(k){w.mixin(this,k);this.location=new s(this.location)}})})},"widgets/Geocoder/utils":function(){define([],function(){return{hasAppSearchInfo:function(h){return h.itemInfo&&h.itemInfo.itemData&&h.itemInfo.itemData.applicationProperties&&h.itemInfo.itemData.applicationProperties.viewing&&
h.itemInfo.itemData.applicationProperties.viewing.search},searchLayer:function(h){if(!this.hasAppSearchInfo(h))return!1;h=h.itemInfo.itemData.applicationProperties.viewing.search;return!h.enabled||0===h.layers.length?!1:!0},isConfigured:function(h){return h&&h.geocoder&&h.geocoder.geocoders&&0<h.geocoder.geocoders.length}}})},"widgets/Geocoder/_build-generate_module":function(){define(["dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:esri/dijit/templates/Geocoder.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\r\n    \x3cdiv class\x3d"${_css.GeocoderContainerClass}" role\x3d"presentation"\x3e\r\n    \t\x3cdiv class\x3d"${_css.GeocoderClass}" data-dojo-attach-point\x3d"containerNode" role\x3d"presentation"\x3e\r\n    \t\t\x3cdiv title\x3d"${_i18n.widgets.Geocoder.main.searchButtonTitle}" tabindex\x3d"0" class\x3d"${_css.searchButtonClass} ${_css.GeocoderIconClass}" data-dojo-attach-point\x3d"submitNode" role\x3d"button"\x3e\x3c/div\x3e\r\n    \t\t\x3cdiv aria-haspopup\x3d"true" id\x3d"${id}_menu_button" title\x3d"${_i18n.widgets.Geocoder.main.geocoderMenuButtonTitle}" tabindex\x3d"0" class\x3d"${_css.geocoderMenuArrowClass} ${_css.GeocoderIconClass}" data-dojo-attach-point\x3d"geocoderMenuArrowNode" role\x3d"button" aria-expanded\x3d"false"\x3e\x3c/div\x3e\r\n    \t\t\x3cinput aria-haspopup\x3d"true" id\x3d"${id}_input" tabindex\x3d"0" placeholder\x3d"" value\x3d"${value}" autocomplete\x3d"off" type\x3d"text" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n    \t\t\x3cdiv tabindex\x3d"0" class\x3d"${_css.clearButtonClass} ${_css.GeocoderIconClass}" data-dojo-attach-point\x3d"clearNode" role\x3d"button"\x3e\x3c/div\x3e\r\n    \t\t\x3cdiv class\x3d"${_css.GeocoderClearClass}" role\x3d"presentation"\x3e\x3c/div\x3e\r\n    \t\x3c/div\x3e\r\n    \t\x3cdiv class\x3d"${_css.resultsContainerClass}" data-dojo-attach-point\x3d"resultsNode" aria-labelledby\x3d"${id}_input" role\x3d"menu" aria-hidden\x3d"true"\x3e\x3c/div\x3e\r\n    \t\x3cdiv class\x3d"${_css.geocoderMenuClass}" data-dojo-attach-point\x3d"geocoderMenuNode" role\x3d"presentation"\x3e\r\n    \t\t\x3cdiv class\x3d"${_css.geocoderMenuHeaderClass}"\x3e\r\n    \t\t\t${_i18n.widgets.Geocoder.main.geocoderMenuHeader}\r\n    \t\t\t\x3cdiv role\x3d"button" data-dojo-attach-point\x3d"geocoderMenuCloseNode" title\x3d"${_i18n.widgets.Geocoder.main.geocoderMenuCloseTitle}" tabindex\x3d"0" class\x3d"${_css.geocoderMenuCloseClass}"\x3e\x3c/div\x3e\r\n    \t\t\t\x3cdiv class\x3d"${_css.GeocoderClearClass}" role\x3d"presentation"\x3e\x3c/div\x3e\r\n    \t\t\x3c/div\x3e\r\n    \t\t\x3cdiv data-dojo-attach-point\x3d"geocoderMenuInsertNode" aria-labelledby\x3d"${id}_menu_button" role\x3d"menu" aria-hidden\x3d"true"\x3e\x3c/div\x3e\r\n    \t\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Geocoder/css/style.css":".jimu-widget-geocoder{width: 225px !important; height: 30px !important; background-color: rgba(72, 85, 102, 0.5); border-radius: 5px;}.jimu-widget-geocoder input::-ms-clear {display: none;}.jimu-widget-geocoder .simpleGeocoder .esriGeocoder {border: 1px solid #666; opacity: 0.9;}.jimu-widget-geocoder .simpleGeocoder .esriGeocoderResults{border: 1px solid #666;}.esriPopup .titlePane {background-color: #5491B8; border-color: #777777;}.esriPopup .sizer {width: 400px;}",
"url:widgets/Geocoder/config.json":'{\r\n  "geocoder": {\r\n    "autoComplete": true,\r\n    "minCharacters": 3,\r\n    "arcgisGeocoder": {\r\n      "placeholder": "Find address or place"\r\n    }\r\n  }\r\n}',"*now":function(h){h(['dojo/i18n!*preload*widgets/Geocoder/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","ROOT"]'])}}});
define("dojo/_base/declare jimu/BaseWidget esri/dijit/Geocoder dojo/_base/html dojo/on dojo/query dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all jimu/portalUtils jimu/dijit/Message jimu/LayerInfos/LayerInfos libs/usng/usng esri/request esri/lang esri/dijit/Popup ./utils".split(" "),function(h,w,k,t,s,p,f,v,x,l,u,b,y,B,D,q,C,r){return h([w],{name:"Geocoder",baseClass:"jimu-widget-geocoder",lastMgrsResult:null,searchResults:null,geocodeInfoWindow:null,geocoderDijit:null,miscHandles:null,
hardcodeRegExp:/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this._initGeocoder()},_initGeocoder:function(){y.getInstance(this.map,this.map.itemInfo).then(f.hitch(this,function(a){this.layerInfosObj=a;this._getGeocoders(this.appConfig.portalUrl).then(f.hitch(this,function(){if(this.domNode){this.config.geocoder.arcgisGeocoder=0===this.config.geocoder.geocoders.length?!0:!1;
var a=this.config.geocoder;a.map=this.map;this.geocoderDijit=new k(a);this.own(s(this.geocoderDijit,"select",f.hitch(this,"showResults")));this.own(s(this.geocoderDijit,"auto-complete",f.hitch(this,"onAutoComplete")));this.own(s(this.geocoderDijit,"find-results",f.hitch(this,"onFindResults")));t.place(this.geocoderDijit.domNode,this.domNode);this.geocoderDijit.startup();this.miscHandles=[]}}),f.hitch(this,function(a){console.error(a)}))}))},_getGeocodeName:function(a){if("string"!==typeof a)return"geocoder";
a=a.split("/");return a[a.length-2]||"geocoder"},_getSingleLine:function(a){var b=new x;a.singleLineFieldName?b.resolve(a):this.hardcodeRegExp.test(a.url)?(a.singleLineFieldName="SingleLine",b.resolve(a)):D({url:a.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(f.hitch(this,function(m){m.singleLineAddressField&&m.singleLineAddressField.name?(a.singleLineFieldName=m.singleLineAddressField.name,b.resolve(a)):(console.warn(a.url+"has no singleLineFieldName"),b.resolve(null))}),
f.hitch(this,function(a){console.error(a);b.resolve(null)}));return b},_getQueryTypeGeocoder:function(a,b){var m=new x,g=this.map.getLayer(a.id),e=null,f=null,k=null,k=q.isDefined(a.subLayer)?a.id+"_"+a.subLayer:a.id,e=b.traversal(function(a){return a.id===k?(f=a,!0):!1});g&&e&&f?(e=q.isDefined(a.subLayer)?f.url||g.url+"/"+a.subLayer:f.url||g.url,g={name:f.title,url:e,field:a.field.name,outFields:"*",type:"query",placeholder:a.hintText,exactMatch:a.field.exactMatch||!1,layerId:a.id,subLayerId:parseInt(a.subLayer,
10)},m.resolve(g)):m.resolve(null);return m},_getGeocoders:function(a){var n=new x,m=[],g=null;r.searchLayer(this.map)&&(g=this.map.itemInfo.itemData.applicationProperties.viewing.search,v.forEach(g.layers,f.hitch(this,function(a){a.hintText=g.hintText;m.push(this._getQueryTypeGeocoder(a,this.layerInfosObj))})));r.isConfigured(this.config)?0<m.length?l(m).then(f.hitch(this,function(a){var b=[];v.forEach(a,function(a){a&&b.push(a)});this.config.geocoder.geocoders=this.config.geocoder.geocoders.concat(b);
n.resolve("success")})):n.resolve("success"):u.getPortalSelfInfo(a).then(f.hitch(this,function(a){a=a.helperServices&&a.helperServices.geocode;var b=[];if(a&&0<a.length){for(var g=0,k=a.length;g<k;g++){var h=a[g];h&&m.splice(g,0,this._getSingleLine(h))}l(m).then(f.hitch(this,function(a){for(var e=0;e<a.length;e++){var c=a[e];c&&(c&&"query"===c.type||(c={name:c.name||this._getGeocodeName(c.url),url:c.url,singleLineFieldName:c.singleLineFieldName,placeholder:c.placeholder||c.name||this._getGeocodeName(c.url)}),
b.push(c))}this.config.geocoder.geocoders=b;n.resolve("success")}))}else this.config.geocoder.arcgisGeocoder=!0,console.error("portal doesn't configure geocode, use arcgisGeocoder instead"),n.resolve("success")}),f.hitch(this,function(a){new b({message:this.nls.portalConnectionError});n.reject("error");console.error(a)}));return n},lookupMgrs:function(a){var b=null;try{var m=[];B.USNGtoLL(a,m);b=2<=m.length&&!isNaN(m[0])&&!isNaN(m[1])?{text:a.toUpperCase(),latitude:m[0],longitude:m[1]}:null}catch(g){b=
null}return b},onAutoComplete:function(){this.hideGeocodeInfoWindow();this.searchResults=null},hideGeocodeInfoWindow:function(){this.geocodeInfoWindow&&(this.geocodeInfoWindow.hide(),this.geocodeInfoWindow.destroy(),this.geocodeInfoWindow=null);this.map.infoWindow.hide()},onFindResults:function(a){if(a.results&&a.results.results&&a.results.results.length)this.searchResults=a.results.results;else{var f="",f="string"===typeof a.results?a.results:q.substitute({LOCATION:a.results.value||""},this.nls.notFound);
new b({message:f})}},showResults:function(a,f){var m=this.geocoderDijit;m.autoNavigate=!0;var g=null,e=null,k=null,h=null,l=null;a&&a.result&&(g=a.result.feature,e=a.result.extent,k=a.result.name);g?(h=g.geometry,"point"===h.type?(l=h,h=this.map.extent.centerAt(l).expand(0.0625)):"polyline"===h.type?(l=h.getPoint(0,0),h=h.getExtent().expand(1.1)):"polygon"===h.type?(l=h.getCentroid(),h=h.getExtent().expand(1.1)):"mulitpoint"===h.type?(l=h.getPoint(0),h=h.getExtent().expand(1.1)):(l=h,h=this.map.extent),
m=m.get("activeGeocoder"),"query"===m.type?(e=this.map.getLayer(m.layerId),g.infoTemplate=e.infoTemplate||m.subLayerId&&e.infoTemplates&&e.infoTemplates[m.subLayerId.toString()]&&e.infoTemplates[m.subLayerId.toString()].infoTemplate||null,g.infoTemplate?this.map.infoWindow.setFeatures([g]):(this.map.infoWindow.setTitle(this.nls.locationTitle),this.map.infoWindow.setContent(k||null)),this.map.infoWindow.show(l),this.map.setExtent(h)):(q.isDefined(f)||(f=0),g=a.result,this.setupInfoWindowAndZoom(g.name,
l,g.extent,g,f))):e?this.map.setExtent(e):new b({message:q.substitute({LOCATION:k},this.nls.notFound)})},_generateInfoContent:function(a,b){var f=a,g="",g=this.searchResults[b].feature.attributes;a="\x3cdiv id\x3d'geocodeCurrentResult' style\x3d'display:none;'\x3e\x3cspan style\x3d'font-weight:bold;'\x3e"+this.nls.currentLocation;a+="\x3c/span\x3e\x3c/div\x3e\x3cspan\x3e";g.Match_addr?(a+=g.Match_addr,"POI"===g.Addr_type&&g.StAddr&&(a=g.City?a+(" - "+g.StAddr+", "+g.City):a+(" - "+g.StAddr))):a+=
f;a+="\x3c/span\x3e";a+="\x3cdiv id\x3d'geocodeWantOtherResults'\x3e";a+="\x3cA showOther\x3d'true' href\x3d'JavaScript:void(0);'\x3e";a+=this.nls.notWhatYouWanted;a+="\x3c/A\x3e";a+="\x3c/div\x3e";a+="\x3cdiv id\x3d'geocodeOtherResults' style\x3d'display:none;'\x3e\x3cspan style\x3d'font-weight:bold;'\x3e";a+=this.nls.selectAnother;a+="\x3c/span\x3e\x3cbr/\x3e";for(f=0;f<this.searchResults.length;f++)if(f!==b){var e=this.searchResults[f],g=e.feature.attributes;a+="\x3cA href\x3d'JavaScript:void(0)' idx \x3d '"+
f+"'\x3e";g.Match_addr?(a+=g.Match_addr,"POI"===g.Addr_type&&g.StAddr&&(a=g.City?a+(" - "+g.StAddr+", "+g.City):a+(" - "+g.StAddr))):a+=e.name;a+="\x3c/A\x3e\x3cbr/\x3e"}return a+="\x3c/div\x3e"},_processInfoWindowContent:function(a,b,h){var g=!1;"query"===this.geocoderDijit.get("activeGeocoder").type&&(g=!0);var e="",k=!1;!g&&this.searchResults&&1<this.searchResults.length?(a=this._generateInfoContent(a,h),k=!0):(e=b.feature.attributes,e.Match_addr&&(a=e.Match_addr,"POI"===e.Addr_type&&e.StAddr&&
(a=e.City?a+(" - "+e.StAddr+", "+e.City):a+(" - "+e.StAddr))));a=t.toDom(a);this.miscHandles&&0<this.miscHandles.length&&(v.forEach(this.miscHandles,function(a){a&&a.remove&&a.remove()}),this.miscHandles=[]);k&&p("a",a).forEach(f.hitch(this,function(a){this.miscHandles.push(s(a,"click",f.hitch(this,function(a){a=a.target;q.isDefined(t.getAttr(a,"showOther"))?this.showOtherResults():q.isDefined(t.getAttr(a,"idx"))&&this.selectAnotherResult(parseInt(t.getAttr(a,"idx"),10))})))}));return a},setupInfoWindowAndZoom:function(a,
b,h,g,e){this.geocodeInfoWindow||(this.geocodeInfoWindow=new C(null,t.create("div",{"class":"blueTheme"},this.map.root)),this.geocodeInfoWindow.resize(400,400),p(".zoomTo",this.geocodeInfoWindow.domNode).forEach(function(a){t.setStyle(a,"display","none")}),this.geocodeInfoWindow.map=this.map);this.geocodeInfoWindow.setTitle(this.nls.locationTitle);a=this._processInfoWindowContent(a,g,e);this.geocodeInfoWindow.setContent(a);var k=s(this.map,"extent-change",f.hitch(this,function(){this.geocodeInfoWindow.show(b);
k.remove()}));this.map.setExtent(h)},showOtherResults:function(){t.setStyle(t.byId("geocodeWantOtherResults"),"display","none");t.setStyle(t.byId("geocodeCurrentResult"),"display","block");t.setStyle(t.byId("geocodeOtherResults"),"display","block")},selectAnotherResult:function(a){this.showResults({result:this.searchResults[a]},a)},destroy:function(){this.geocodersDef&&(!this.geocodersDef.isFulfilled()&&!this.geocodersDef.isCanceled())&&this.geocodersDef.cancel();this.geocodeInfoWindow&&this.geocodeInfoWindow.destroy&&
this.geocodeInfoWindow.destroy();this.inherited(arguments)}})});