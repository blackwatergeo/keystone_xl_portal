//>>built
require({cache:{"esri/dijit/LayerSwipe":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/has ../kernel dijit/_WidgetBase dijit/_TemplatedMixin dojo/on dojo/text!./templates/LayerSwipe.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style dojo/dnd/move dojo/dnd/Mover dojo/sniff dojo/dom-geometry ../geometry/Point dojo/Deferred dojo/promise/all".split(" "),function(m,n,e,h,p,r,s,k,t,c,f,q,w,x,u,l,y,v,z){var A=n([x],{onFirstMove:function(a){var b=this.node.style,g,c=this.host;
switch(b.position){case "relative":case "absolute":g=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;default:b.position="absolute",b=l.getMarginBox(this.node),g=b.l,b=b.t}this.marginBox.l=g-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(c&&c.onFirstMove)c.onFirstMove(this,a);this.events.shift().remove()}});return n("esri.dijit.LayerSwipe",[r,s,m],{templateString:t,options:{theme:"LayerSwipe",layers:[],enabled:!0,type:"vertical",invertPlacement:!1,clip:9},constructor:function(a,
b){var g=e.mixin({},this.options,a);this.domNode=b;this._i18n=c;this.set("map",g.map);this.set("layers",g.layers);this.set("top",g.top);this.set("left",g.left);this.set("theme",g.theme);this.set("enabled",g.enabled);this.set("type",g.type);this.set("clip",g.clip);this.set("invertPlacement",g.invertPlacement);this.watch("theme",this._updateThemeWatch);this.watch("enabled",this._enabled);this.watch("type",this._type);this.watch("invertPlacement",this._invertPlacement);this._css={handleContainer:"handleContainer",
handle:"handle"};this._listeners=[]},startup:function(){this.map||(this.destroy(),console.log("LayerSwipe::map required"));this.set("layers",this.layers);this.layers.length||(this.destroy(),console.log("LayerSwipe::layer required"));this._allLoaded().then(e.hitch(this,function(){this._init()}),function(a){console.log("LayerSwipe::"+a.message)})},destroy:function(){this._removeEvents();this._unclipLayers();this.inherited(arguments)},swipe:function(){this._swipe()},enable:function(){this.set("enabled",
!0)},disable:function(){this.set("enabled",!1)},_allLoaded:function(){for(var a=[],b=0;b<this.layers.length;b++){"string"===typeof this.layers[b]&&(this.layers[b]=this.map.getLayer(this.layers[b]),this.layers[b]||console.log("LayerSwipe::Could not get layer by ID"));var g=new v;this.layers[b].loaded?g.resolve("layer loaded"):this._layerLoadedPromise(b,g);a.push(g.promise)}var c=new v;if(this.map.loaded)c.resolve("map loaded");else k.once(this.map,"load",e.hitch(this,function(){c.resolve("map loaded")}));
a.push(c.promise);return z(a)},_layerLoadedPromise:function(a,b){k.once(this.layers[a],"load",function(){b.resolve("layer loaded")})},_mb:function(){var a=l.getMarginBox(this.map.root);return{t:0,l:0,w:a.l+a.w,h:a.h+a.t}},_setInitialPosition:function(){var a,b,g,c,f,e,h;b=a=0;c=l.getMarginBox(this._moveableNode);g=this.get("type");f=this.get("top");e=this.get("left");h=this.get("invertPlacement");"scope"===g?(b="undefined"!==typeof f?f:this.map.height/2-c.h/2,a="undefined"!==typeof e?e:this.map.width/
2-c.w/2):"horizontal"===g?(b=this.map.height/4-c.h/2,b="undefined"!==typeof f?f:h?this.map.height-b:b):(a=this.map.width/4-c.w/2,a="undefined"!==typeof e?e:h?this.map.width-a:a);q.set(this._moveableNode,{top:b+"px",left:a+"px"})},_setSwipeType:function(){var a=this.get("moveable"),b=this.get("type");b&&(a&&a.destroy(),f.add(this._moveableNode,b),a=new w.parentConstrainedMoveable(this._moveableNode,{area:"content",within:!0,handle:this._moveableNode,constraints:e.hitch(this,this._mb),mover:A}),this.set("moveable",
a),this._setInitialPosition())},_init:function(){this._setSwipeType();this._setupEvents();this._enabled();this.set("loaded",!0);this.emit("load",{});this.swipe()},_removeEvents:function(){if(this._listeners&&this._listeners.length)for(var a=0;a<this._listeners.length;a++)this._listeners[a]&&this._listeners[a].remove();this._listeners=[]},_repositionMover:function(){var a=l.getMarginBox(this._moveableNode);a&&(a.t>this.map.height||0>a.t||a.l>this.map.width||0>a.l)&&this._setInitialPosition()},_setupEvents:function(){this._removeEvents();
this._mapResize=k.pausable(this.map,"resize",e.hitch(this,function(){this._repositionMover()}));this._listeners.push(this._mapResize);this._swipeMove=k.pausable(this.moveable,"Move",e.hitch(this,function(){this.swipe()}));this._listeners.push(this._swipeMove);this._swipePanEnd=k.pausable(this.map,"pan-end",e.hitch(this,function(){this._swipe()}));this._listeners.push(this._swipePanEnd);this._mapUpdateStart=k.pausable(this.map,"update-start",e.hitch(this,function(){this._swipe()}));this._listeners.push(this._mapUpdateStart);
this._mapUpdateEnd=k.pausable(this.map,"update-end",e.hitch(this,function(){this._swipe()}));this._listeners.push(this._mapUpdateEnd);this._swipePan=k.pausable(this.map,"pan",e.hitch(this,function(){this._swipe()}));this._listeners.push(this._swipePan);this._toolClick=k.pausable(this._moveableNode,"click",e.hitch(this,function(a){if("scope"===this.get("type")){a=this._clickPosition(a);try{this.map.onClick(a,"other")}catch(b){console.log("LayerSwipe::scope click error")}this._clickCoords=null}}));
this._listeners.push(this._toolClick);this._toolDblClick=k.pausable(this._moveableNode,"dblclick",e.hitch(this,function(a){if("scope"===this.get("type")){a=this._clickPosition(a);try{this.map.navigationManager.mouseEvents.onDblClick(a,"other")}catch(b){console.log("LayerSwipe::scope dblclick error")}this._clickCoords=null}}));this._listeners.push(this._toolDblClick);this._evtCoords=k.pausable(this.moveable,"MouseDown",e.hitch(this,function(a){"scope"===this.get("type")&&(this._clickCoords={x:a.x,
y:a.y})}));this._listeners.push(this._evtCoords)},_clickPosition:function(a){if(this._clickCoords&&this._clickCoords.x===a.x&&this._clickCoords.y===a.y){var b=l.position(this.map.root,!0),g=a.pageX-b.x,b=a.pageY-b.y;a.x=g;a.y=b;a.screenPoint={x:g,y:b};a.mapPoint=this.map.toMap(new y(g,b,this.map.spatialReference))}return a},_positionValues:function(a){var b,g,c,f,e,h,d={layerNode:a._div,layerGraphics:a.graphics,swipeType:this.get("type"),l:0,r:0,t:0,b:0};c=this.get("clip");h=this.get("invertPlacement");
a=l.getMarginBox(this._moveableNode);if("vertical"===d.swipeType||"horizontal"===d.swipeType)d.layerNode&&(b=l.getMarginBox(d.layerNode),f=Math.abs(b.t),e=Math.abs(b.l)),g=l.getMarginBox(this.map.root);"vertical"===d.swipeType?(h?b&&0<b.l?(d.l=a.l-e,d.r=this.map.width-e):b&&0>b.l?(d.l=a.l+e,d.r=this.map.width+e):(d.l=a.l,d.r=this.map.width):b&&0<b.l?(d.l=0-e,d.r=a.l-e):b&&0>b.l?(d.l=0+e,d.r=a.l+e):(d.l=0,d.r=a.l),b&&0<b.t?(d.t=0-f,d.b=g.h-f):b&&0>b.t?(d.t=0+f,d.b=g.h+f):(d.t=0,d.b=g.h)):"horizontal"===
d.swipeType?(h?b&&0<b.t?(d.t=a.t-f,d.b=this.map.height-f):b&&0>b.t?(d.t=a.t+f,d.b=this.map.height+f):(d.t=a.t,d.b=this.map.height):b&&0<b.t?(d.t=0-f,d.b=a.t-f):b&&0>b.t?(d.t=0+f,d.b=a.t+f):(d.t=0,d.b=a.t),b&&0<b.l?(d.l=0-e,d.r=g.w-e):b&&0>b.l?(d.l=0+e,d.r=g.w+e):(d.l=0,d.r=g.w)):"scope"===d.swipeType&&(d.layerGraphics?(d.l=a.l,d.r=a.w,d.t=a.t,d.b=a.h,"undefined"!==typeof c&&(d.l+=c,d.r+=-(2*c),d.t+=c,d.b+=-(2*c))):(d.l=a.l,d.r=d.l+a.w,d.t=a.t,d.b=d.t+a.h,"undefined"!==typeof c&&(d.l+=c,d.r+=-c,d.t+=
c,d.b+=-c)));return d},_clipLayer:function(a){if(a.layerNode)if(a.layerGraphics){var b=a.layerNode.getTransform();b&&(b.hasOwnProperty("dx")&&(a.l+=-b.dx),b.hasOwnProperty("dy")&&(a.t+=-b.dy));a.layerNode.setClip({x:a.l,y:a.t,width:a.r,height:a.b})}else{if(b=a.layerNode.style,a&&b&&a.hasOwnProperty("r")&&a.hasOwnProperty("l")&&a.hasOwnProperty("t")&&a.hasOwnProperty("b")){if("css-transforms"===this.map.navigationMode){if(b&&(b=this._getTransformValue(b)))b=this._parseTransformValue(b),a.l-=b.x,a.r-=
b.x,a.t-=b.y,a.b-=b.y}else b&&"scope"===a.swipeType&&(b=this._parseScopeStyle(b),a.l-=b.x,a.r-=b.x,a.t-=b.y,a.b-=b.y);b=u("ie");q.set(a.layerNode,"clip",b&&8>b?"rect("+a.t+"px "+a.r+"px "+a.b+"px "+a.l+"px)":"rect("+a.t+"px, "+a.r+"px, "+a.b+"px, "+a.l+"px)")}}else console.log("LayerSwipe::Invalid layer type")},_swipe:function(){if(this.get("loaded")&&this.get("enabled")){var a={layers:[]};if(this.layers&&this.layers.length)for(var b=0;b<this.layers.length;b++){var c=this._positionValues(this.layers[b]);
this._clipLayer(c);a.layers.push({layer:this.layers[b],left:c.l,right:c.r,top:c.t,bottom:c.b})}this.emit("swipe",a)}},_getTransformValue:function(a){var b,c;if(a){c=["transform","-webkit-transform","-ms-transform","-moz-transform","-o-transform"];for(var f=0;f<c.length&&!(b=a[c[f]]);f++){try{b=a.getPropertyValue(c[f])}catch(e){}if(b)break}}return b},_parseTransformValue:function(a){var b={x:0,y:0};-1!==a.toLowerCase().indexOf("translate3d")?a=a.replace("translate3d(","").replace(")","").replace(/px/ig,
"").replace(/\s/i,"").split(","):-1!==a.toLowerCase().indexOf("translate")&&(a=a.replace("translate(","").replace(")","").replace(/px/ig,"").replace(/\s/i,"").split(","));try{b.x=parseFloat(a[0]),b.y=parseFloat(a[1])}catch(c){console.log("LayerSwipe::Error parsing transform number")}return b},_parseScopeStyle:function(a){var b={x:0,y:0};try{b.x=parseFloat(a.left.replace(/px/ig,"").replace(/\s/i,"")),b.y=parseFloat(a.top.replace(/px/ig,"").replace(/\s/i,""))}catch(c){console.log("LayerSwipe::Error parsing div style float")}return b},
_updateThemeWatch:function(a,b,c){f.remove(this.domNode,b);f.add(this.domNode,c)},_type:function(a,b){b&&f.remove(this._moveableNode,b);this._setSwipeType();this._setupEvents();this.swipe()},_pauseEvents:function(){if(this._listeners&&this._listeners.length)for(var a=0;a<this._listeners.length;a++)this._listeners[a].pause()},_resumeEvents:function(){if(this._listeners&&this._listeners.length)for(var a=0;a<this._listeners.length;a++)this._listeners[a].resume()},_unclipLayers:function(){if(this.get("loaded")&&
this.layers&&this.layers.length)for(var a=0;a<this.layers.length;a++){var b=this.layers[a]._div,c=this.layers[a].graphics;b&&(c?b.setClip(null):(c=u("ie"),q.set(b,"clip",c&&8>c?"rect(auto auto auto auto)":"auto")))}},_invertPlacement:function(){this.swipe()},_enabled:function(){this.get("enabled")?(q.set(this.domNode,"display","block"),this._resumeEvents(),this.swipe()):(this._pauseEvents(),q.set(this.domNode,"display","none"),this._unclipLayers())}})})},"widgets/Swipe/_build-generate_module":function(){define(["dojo/text!./Widget.html",
"dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:esri/dijit/templates/LayerSwipe.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\r\n    \x3cdiv title\x3d"${_i18n.widgets.layerSwipe.title}" data-dojo-attach-point\x3d"_moveableNode"\x3e\r\n        \x3cdiv class\x3d"${_css.handleContainer}"\x3e\r\n            \x3cdiv class\x3d"${_css.handle}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Swipe/Widget.html":'\x3cdiv class\x3d"jimu-widget-swipe" data-dojo-attach-event\x3d"mouseenter:onMouseEnter, mouseleave:onMouseLeave"\x3e\r\n\t\x3cdiv class\x3d"swipe-icon" data-dojo-attach-point\x3d"swipeIcon" title\x3d"${nls.enableTips}" data-dojo-attach-event\x3d"click:onIconClick"\x3e\r\n\t\t\x3cdiv class\x3d"swipe-icon-inner" data-dojo-attach-point\x3d"swipeImg"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"swipe-layer-menu" data-dojo-attach-point\x3d"swipeLayersMenu" style\x3d"display:none"\x3e\r\n\t\t\x3cspan class\x3d"hint" data-dojo-attach-point\x3d"hintNode"\x3e\x3c/span\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"dijit/form/Select" style\x3d"width:100%" data-dojo-attach-point\x3d"swipeLayers"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"layerSwipe"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Swipe/css/style.css":'.jimu-widget-swipe {width: 32px !important; height: 30px !important; position: absolute;}.jimu-widget-swipe .swipe-icon{width: 30px; height: 100%; padding: 5px; border-radius: 5px; background: #666; background: rgba(0,0,0,0.2); cursor: pointer;}.jimu-widget-swipe .swipe-icon:hover{background: #333; background: rgba(0,0,0,0.4);}.jimu-widget-swipe .swipe-icon-enable{background: #333; background: rgba(0,0,0,0.6);}.jimu-widget-swipe .swipe-icon .swipe-icon-inner{width: 20px; height: 20px; background-position: center; background-repeat: no-repeat; background-image: url("images/loading.gif");}.jimu-widget-swipe .swipe-layer-menu{position: absolute; top: 0; left: 32px; min-width: 320px; font-size: 14px; color: #686868; padding: 14px; background: #fff; z-index: 50;}.jimu-rtl .jimu-widget-swipe .swipe-layer-menu{right: 32px; left: auto;}.jimu-widget-swipe .swipe-layer-menu .hint{display: inline-block; font-weight: bold; padding-bottom: 10px;}.claro .jimu-widget-swipe .swipe-layer-menu .dijitSelect {color: #7989a0; border-color: #d2dade;}.claro .jimu-widget-swipe .swipe-layer-menu .dijitSelectHover,.claro .jimu-widget-swipe .swipe-layer-menu .dijitSelectFocused {border-color: #759dc0;}.claro .jimu-widget-swipe .swipe-layer-menu .dijitArrowButton{padding: 1px;}.claro .jimu-widget-swipe .swipe-layer-menu .dijitSelect .dijitButtonContents {border-style: none; border-width: 0; background: #fafafc !important;}.claro .jimu-widget-swipe .swipe-layer-menu .dijitSelect .dijitArrowButton {border-style: none; border-width: 0; background: #fafafc !important;}',
"url:widgets/Swipe/config.json":'{\r\n\t"style": "vertical",\r\n\t"layer": ""\r\n}',"*now":function(m){m(['dojo/i18n!*preload*widgets/Swipe/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/html dojo/on jimu/BaseWidget jimu/LayerInfos/LayerInfos dijit/_WidgetsInTemplateMixin esri/dijit/LayerSwipe dijit/form/Select".split(" "),function(m,n,e,h,p,r,s,k,t){return m([r,k],{baseClass:"jimu-widget-swipe",loaded:!1,swipeDijit:null,layerInfosObj:null,open:!1,postCreate:function(){this.inherited(arguments);this.own(p(this.swipeLayers,"Change",e.hitch(this,this.onSwipeLayersChange)));this.own(p(this.swipeLayers.dropDown.domNode,
"mouseenter",e.hitch(this,this.onDropMouseEnter)));this.own(p(this.swipeLayers.dropDown.domNode,"mouseleave",e.hitch(this,this.onDropMouseLeave)));this.own(p(this.map,"layer-add",e.hitch(this,this._onMainMapBasemapChange)));s.getInstance(this.map,this.map.itemInfo).then(e.hitch(this,function(c){this.layerInfosObj=c;this.own(c.on("layerInfosChanged",e.hitch(this,this.onLayerInfosChanged)));c=c.getLayerInfoArray();this.hintNode.innerHTML="scope"===this.config.style?this.nls.spyglassText:this.nls.swipeText;
this._setOptionsOfSwipeLayers(c);this._loadSwipeDijit(c);this.swipeLayers.set("value",this.swipeDijit.layers[0].id);h.setStyle(this.swipeImg,"backgroundImage",'url("'+this.folderUrl+'css/images/icon.png")');this.loaded=!0}))},_setOptionsOfSwipeLayers:function(c){c=n.map(c,function(c){return{label:c.title,value:c.id}});this.swipeLayers.set("options",c)},_loadSwipeDijit:function(c){var f=e.clone(this.config);f.style||(f.style="vertical");var h=!1;if(!this.map.getLayer(f.layer)){var k=null;0<c.length?
k=c[0].id:h=!0;f.layer=k}this.createSwipeDijit(f.style,f.layer,this.open,h)},onIconClick:function(){this.loaded&&this.swipeDijit&&(this.swipeDijit.enabled?(this.swipeDijit.disable(),h.setStyle(this.swipeLayersMenu,"display","none"),h.setAttr(this.swipeIcon,"title",this.nls.enableTips),h.removeClass(this.swipeIcon,"swipe-icon-enable"),this.open=!1):(this.swipeDijit.enable(),h.setStyle(this.swipeLayersMenu,"display","block"),h.setAttr(this.swipeIcon,"title",this.nls.disableTips),h.addClass(this.swipeIcon,
"swipe-icon-enable"),this.open=!0))},onMouseEnter:function(c){this.loaded&&(this.swipeDijit&&this.swipeDijit.enabled)&&h.setStyle(this.swipeLayersMenu,"display","block");c.preventDefault();c.stopPropagation()},onPressSwipeImg:function(c){c.preventDefault()},onDropMouseEnter:function(c){this._mouseOnDropDown=!0;this.onMouseEnter(c)},onDropMouseLeave:function(){this._mouseOnDropDown=!1;this.onMouseLeave();this.swipeLayers.dropDown.onCancel()},onMouseLeave:function(){this._mouseOnDropDown||this.loaded&&
h.setStyle(this.swipeLayersMenu,"display","none")},onSwipeLayersChange:function(){if(this.swipeDijit){var c=this.swipeDijit.enabled;this.destroySwipeDijit();var f=this.swipeLayers.get("value");this.createSwipeDijit(this.config.style||"vertical",f,c);h.setStyle(this.swipeLayersMenu,"display","none")}},createSwipeDijit:function(c,f,e,k){f=this._getLayerParams(f,k);this.swipeDijit=new t({enabled:!!e,type:c,map:this.map,layers:f},this.layerSwipe);this.swipeDijit.startup();h.place(this.swipeDijit.domNode,
this.map.root,"before")},_getLayerParams:function(c,f){var h=this.layerInfosObj.getLayerInfoById(c),k=[];f?(h=this.layerInfosObj.getBasemapLayers(),n.forEach(h,e.hitch(this,function(c){k.push(this.map.getLayer(c.id))}))):h.traversal(e.hitch(this,function(c){(c=this.map.getLayer(c.id))&&k.push(c)}));return k},destroySwipeDijit:function(){this.swipeDijit&&this.swipeDijit.destroy&&(this.swipeDijit.destroy(),this.swipeDijit=null,this.layerSwipe=h.create("div",{},this.swipeLayersMenu,"after"))},onLayerInfosChanged:function(c,
e,h){if(this.swipeDijit){var k=this.layerInfosObj.getLayerInfoArray();this._setOptionsOfSwipeLayers(k||c);"removed"===e&&this.swipeDijit.layers[0].id===h.id&&(this.destroySwipeDijit(),this._loadSwipeDijit(k));this.swipeLayers.set("value",this.swipeDijit.layers[0].id)}},_onMainMapBasemapChange:function(c){c.layer&&c.layer._basemapGalleryLayerType&&(c=this.swipeLayers.get("options"),!(c&&0<c.length)&&this.loaded&&(c=this.swipeDijit.enabled,this.destroySwipeDijit(),this.createSwipeDijit(this.config.style||
"vertical",null,c,!0),h.setStyle(this.swipeLayersMenu,"display","none")))},destroy:function(){this.destroySwipeDijit();this.inherited(arguments)}})});